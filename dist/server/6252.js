"use strict";exports.id=6252,exports.ids=[6252,748],exports.modules={96252:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ROUTES:()=>ROUTES,ValidateEmailErrorStateMatcher:()=>ValidateEmailErrorStateMatcher});var core=__webpack_require__(19519),i18n_breadcrumb_resolver=__webpack_require__(12213),group_administrator_guard=__webpack_require__(83917),site_administrator_guard=__webpack_require__(90660),access_control_routing_paths=__webpack_require__(55990),ngx_translate_core=__webpack_require__(2385),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),bulk_access_control_service=__webpack_require__(46549),btn_disabled_directive=__webpack_require__(69919),selectable_list_service=__webpack_require__(85984),common=__webpack_require__(87514),ng_bootstrap=__webpack_require__(87969),fesm2022_core=__webpack_require__(25376);class PaginationService{constructor(){this.change=new fesm2022_core.bkB,this.instances={},this.DEFAULT_ID="DEFAULT_PAGINATION_ID"}defaultId(){return this.DEFAULT_ID}register(instance){return null==instance.id&&(instance.id=this.DEFAULT_ID),this.instances[instance.id]?this.updateInstance(instance):(this.instances[instance.id]=instance,!0)}updateInstance(instance){let changed=!1;for(let prop in this.instances[instance.id])instance[prop]!==this.instances[instance.id][prop]&&(this.instances[instance.id][prop]=instance[prop],changed=!0);return changed}getCurrentPage(id){return this.instances[id]?this.instances[id].currentPage:1}setCurrentPage(id,page){if(this.instances[id]){let instance=this.instances[id];page<=Math.ceil(instance.totalItems/instance.itemsPerPage)&&1<=page&&(this.instances[id].currentPage=page,this.change.emit(id))}}setTotalItems(id,totalItems){this.instances[id]&&0<=totalItems&&(this.instances[id].totalItems=totalItems,this.change.emit(id))}setItemsPerPage(id,itemsPerPage){this.instances[id]&&(this.instances[id].itemsPerPage=itemsPerPage,this.change.emit(id))}getInstance(id=this.DEFAULT_ID){return this.instances[id]?this.clone(this.instances[id]):{}}clone(obj){var target={};for(var i in obj)obj.hasOwnProperty(i)&&(target[i]=obj[i]);return target}}const LARGE_NUMBER=Number.MAX_SAFE_INTEGER;let PaginatePipe=(()=>{class PaginatePipe2{constructor(service){this.service=service,this.state={}}transform(collection,args){if(!(collection instanceof Array)){let _id=args.id||this.service.defaultId();return this.state[_id]?this.state[_id].slice:collection}let start,end,serverSideMode=args.totalItems&&args.totalItems!==collection.length,instance=this.createInstance(collection,args),id=instance.id,perPage=instance.itemsPerPage,emitChange=this.service.register(instance);if(!serverSideMode&&collection instanceof Array){if(perPage=+perPage||LARGE_NUMBER,start=(instance.currentPage-1)*perPage,end=start+perPage,this.stateIsIdentical(id,collection,start,end))return this.state[id].slice;{let slice=collection.slice(start,end);return this.saveState(id,collection,slice,start,end),this.service.change.emit(id),slice}}return emitChange&&this.service.change.emit(id),this.saveState(id,collection,collection,start,end),collection}createInstance(collection,config){return this.checkConfig(config),{id:null!=config.id?config.id:this.service.defaultId(),itemsPerPage:+config.itemsPerPage||0,currentPage:+config.currentPage||1,totalItems:+config.totalItems||collection.length}}checkConfig(config){const missing=["itemsPerPage","currentPage"].filter(prop=>!(prop in config));if(0<missing.length)throw new Error(`PaginatePipe: Argument is missing the following required properties: ${missing.join(", ")}`)}saveState(id,collection,slice,start,end){this.state[id]={collection,size:collection.length,slice,start,end}}stateIsIdentical(id,collection,start,end){let state=this.state[id];return!(!state||state.size!==collection.length||state.start!==start||state.end!==end)&&state.slice.every((element,index)=>element===collection[start+index])}}return PaginatePipe2.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||PaginatePipe2)(fesm2022_core.rXU(PaginationService,16))},PaginatePipe2.\u0275pipe=fesm2022_core.EJ8({name:"paginate",type:PaginatePipe2,pure:!1}),PaginatePipe2})(),NgxPaginationModule=(()=>{class NgxPaginationModule2{}return NgxPaginationModule2.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||NgxPaginationModule2)},NgxPaginationModule2.\u0275mod=fesm2022_core.$C({type:NgxPaginationModule2}),NgxPaginationModule2.\u0275inj=fesm2022_core.G2t({providers:[PaginationService],imports:[[common.MD]]}),NgxPaginationModule2})();var paginated_list_model=__webpack_require__(29481),page_info_model=__webpack_require__(23474),search_configuration_service=__webpack_require__(11013),my_dspace_configuration_service=__webpack_require__(16948),empty_util=__webpack_require__(2794),listable_object_component_loader_component=__webpack_require__(90690),selectable_list_item_control_component=__webpack_require__(70200),pagination_component=__webpack_require__(42191),pagination_component_options_model=__webpack_require__(54396),remote_data_utils=__webpack_require__(84953),themed_search_component=__webpack_require__(32647),browser_only_pipe=__webpack_require__(96340);const _c0=a0=>({number:a0}),_c1=a0=>({repeatable:!0,listId:a0}),_c2=(a0,a1,a2)=>({itemsPerPage:a0,currentPage:a1,totalItems:a2});function BulkAccessBrowseComponent_ng_template_3_Template(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"div",6),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r1),fesm2022_core.XpG();const acc_r2=fesm2022_core.sdS(1);return fesm2022_core.Njj(acc_r2.toggle("browse"))}),fesm2022_core.j41(1,"button",7),fesm2022_core.bIt("click",function($event){return fesm2022_core.eBV(_r1),fesm2022_core.Njj($event.preventDefault())}),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s()()}if(2&rf){fesm2022_core.XpG();const acc_r2=fesm2022_core.sdS(1);fesm2022_core.R7$(),fesm2022_core.BMQ("aria-expanded",acc_r2.isExpanded("browse")),fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,2,"admin.access-control.bulk-access-browse.header")," ")}}function BulkAccessBrowseComponent_ng_template_4_ng_template_7_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",14),fesm2022_core.nrm(1,"ds-search",15),fesm2022_core.k0s()),2&rf){const ctx_r3=fesm2022_core.XpG(2);fesm2022_core.R7$(),fesm2022_core.Y8G("configuration","administrativeBulkAccess")("selectable",!0)("selectionConfig",fesm2022_core.eq3(4,_c1,ctx_r3.listId))("showThumbnails",!1)}}function BulkAccessBrowseComponent_ng_template_4_ng_template_14_Conditional_4_For_2_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"li",18),fesm2022_core.nI1(1,"dsBrowserOnly"),fesm2022_core.nrm(2,"ds-selectable-list-item-control",19)(3,"ds-listable-object-component-loader",20),fesm2022_core.k0s()),2&rf){const object_r6=ctx.$implicit,\u0275$index_50_r7=ctx.$index,ctx_r3=fesm2022_core.XpG(4);fesm2022_core.BMQ("data-test",fesm2022_core.bMT(1,9,"list-object")),fesm2022_core.R7$(2),fesm2022_core.Y8G("index",\u0275$index_50_r7)("object",object_r6)("selectionConfig",fesm2022_core.eq3(11,_c1,ctx_r3.listId)),fesm2022_core.R7$(),fesm2022_core.Y8G("listID",ctx_r3.listId)("index",\u0275$index_50_r7)("object",object_r6)("showThumbnails",!1)("viewMode","list")}}function BulkAccessBrowseComponent_ng_template_4_ng_template_14_Conditional_4_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ul",17),fesm2022_core.Z7z(1,BulkAccessBrowseComponent_ng_template_4_ng_template_14_Conditional_4_For_2_Template,4,13,"li",18,fesm2022_core.fX1),fesm2022_core.nI1(3,"async"),fesm2022_core.nI1(4,"async"),fesm2022_core.nI1(5,"async"),fesm2022_core.nI1(6,"async"),fesm2022_core.nI1(7,"paginate"),fesm2022_core.k0s()),2&rf){let tmp_5_0;const ctx_r3=fesm2022_core.XpG(3);fesm2022_core.R7$(),fesm2022_core.Dyx(fesm2022_core.i5U(7,8,null==(tmp_5_0=fesm2022_core.bMT(3,0,ctx_r3.objectsSelected$))||null==tmp_5_0.payload?null:tmp_5_0.payload.page,fesm2022_core.sMw(11,_c2,fesm2022_core.bMT(4,2,ctx_r3.paginationOptions$).pageSize,fesm2022_core.bMT(5,4,ctx_r3.paginationOptions$).currentPage,null==(tmp_5_0=fesm2022_core.bMT(6,6,ctx_r3.objectsSelected$))||null==tmp_5_0.payload?null:tmp_5_0.payload.page.length)))}}function BulkAccessBrowseComponent_ng_template_4_ng_template_14_Template(rf,ctx){if(1&rf){const _r5=fesm2022_core.RV6();fesm2022_core.j41(0,"ds-pagination",16),fesm2022_core.nI1(1,"async"),fesm2022_core.nI1(2,"async"),fesm2022_core.nI1(3,"async"),fesm2022_core.bIt("prev",function(){fesm2022_core.eBV(_r5);const ctx_r3=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r3.pagePrev())})("next",function(){fesm2022_core.eBV(_r5);const ctx_r3=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r3.pageNext())}),fesm2022_core.DNE(4,BulkAccessBrowseComponent_ng_template_4_ng_template_14_Conditional_4_Template,8,15,"ul",17),fesm2022_core.nI1(5,"async"),fesm2022_core.k0s()}if(2&rf){let tmp_5_0,tmp_8_0;const ctx_r3=fesm2022_core.XpG(2);fesm2022_core.Y8G("paginationOptions",fesm2022_core.bMT(1,5,ctx_r3.paginationOptions$))("collectionSize",null==(tmp_5_0=fesm2022_core.bMT(2,7,ctx_r3.objectsSelected$))||null==tmp_5_0.payload?null:tmp_5_0.payload.totalElements)("objects",fesm2022_core.bMT(3,9,ctx_r3.objectsSelected$))("showPaginator",!1),fesm2022_core.R7$(4),fesm2022_core.vxM(null!=(tmp_8_0=fesm2022_core.bMT(5,11,ctx_r3.objectsSelected$))&&tmp_8_0.hasSucceeded?4:-1)}}function BulkAccessBrowseComponent_ng_template_4_Template(rf,ctx){if(1&rf){const _r3=fesm2022_core.RV6();fesm2022_core.j41(0,"div",8)(1,"ul",9,1),fesm2022_core.mxI("activeIdChange",function($event){fesm2022_core.eBV(_r3);const ctx_r3=fesm2022_core.XpG();return fesm2022_core.DH7(ctx_r3.activateId,$event)||(ctx_r3.activateId=$event),fesm2022_core.Njj($event)}),fesm2022_core.j41(3,"li",10)(4,"a",11),fesm2022_core.EFF(5),fesm2022_core.nI1(6,"translate"),fesm2022_core.k0s(),fesm2022_core.DNE(7,BulkAccessBrowseComponent_ng_template_4_ng_template_7_Template,2,6,"ng-template",12),fesm2022_core.k0s(),fesm2022_core.j41(8,"li",10)(9,"a",11),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"async"),fesm2022_core.nI1(12,"async"),fesm2022_core.nI1(13,"translate"),fesm2022_core.k0s(),fesm2022_core.DNE(14,BulkAccessBrowseComponent_ng_template_4_ng_template_14_Template,6,13,"ng-template",12),fesm2022_core.k0s()(),fesm2022_core.nrm(15,"div",13),fesm2022_core.k0s()}if(2&rf){let tmp_7_0;const nav_r8=fesm2022_core.sdS(2),ctx_r3=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.R50("activeId",ctx_r3.activateId),fesm2022_core.R7$(2),fesm2022_core.Y8G("ngbNavItem","search"),fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(6,6,"admin.access-control.bulk-access-browse.search.header")),fesm2022_core.R7$(3),fesm2022_core.Y8G("ngbNavItem","selected"),fesm2022_core.R7$(2),fesm2022_core.SpI(" ",fesm2022_core.i5U(13,12,"admin.access-control.bulk-access-browse.selected.header",fesm2022_core.eq3(15,_c0,null!=(tmp_7_0=fesm2022_core.bMT(11,8,ctx_r3.objectsSelected$))&&null!=tmp_7_0.payload&&tmp_7_0.payload.totalElements?null==(tmp_7_0=fesm2022_core.bMT(12,10,ctx_r3.objectsSelected$))||null==tmp_7_0.payload?null:tmp_7_0.payload.totalElements:"0"))," "),fesm2022_core.R7$(5),fesm2022_core.Y8G("ngbNavOutlet",nav_r8)}}let BulkAccessBrowseComponent=(()=>{class BulkAccessBrowseComponent2{constructor(selectableListService){this.selectableListService=selectableListService,this.activateId="search",this.objectsSelected$=new cjs.BehaviorSubject(null),this.paginationOptions$=new cjs.BehaviorSubject(Object.assign(new pagination_component_options_model.W,{id:"bas",pageSize:5,currentPage:1})),this.subs=[]}ngOnInit(){this.subs.push(this.selectableListService.getSelectableList(this.listId).pipe((0,operators.F)(),(0,operators.Tj)(list=>this.generatePaginatedListBySelectedElements(list))).subscribe(this.objectsSelected$))}pageNext(){this.paginationOptions$.next(Object.assign(new pagination_component_options_model.W,this.paginationOptions$.value,{currentPage:this.paginationOptions$.value.currentPage+1}))}pagePrev(){this.paginationOptions$.next(Object.assign(new pagination_component_options_model.W,this.paginationOptions$.value,{currentPage:this.paginationOptions$.value.currentPage-1}))}calculatePageCount(pageSize,totalCount=0){return totalCount<pageSize?1:Math.ceil(totalCount/pageSize)}generatePaginatedListBySelectedElements(list){const pageInfo=new page_info_model.Q({elementsPerPage:this.paginationOptions$.value.pageSize,totalElements:list?.selection.length,totalPages:this.calculatePageCount(this.paginationOptions$.value.pageSize,list?.selection.length),currentPage:this.paginationOptions$.value.currentPage});return pageInfo.currentPage>pageInfo.totalPages&&(pageInfo.currentPage=pageInfo.totalPages,this.paginationOptions$.next(Object.assign(new pagination_component_options_model.W,this.paginationOptions$.value,{currentPage:pageInfo.currentPage}))),(0,remote_data_utils.SP)((0,paginated_list_model.g)(pageInfo,list?.selection||[]))}ngOnDestroy(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe()),this.selectableListService.deselectAll(this.listId)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||BulkAccessBrowseComponent2)(fesm2022_core.rXU(selectable_list_service.K))}}static{this.\u0275cmp=fesm2022_core.VBU({type:BulkAccessBrowseComponent2,selectors:[["ds-bulk-access-browse"]],inputs:{listId:"listId"},standalone:!0,features:[fesm2022_core.Jv_([{provide:my_dspace_configuration_service.EN,useClass:search_configuration_service.g}]),fesm2022_core.aNF],decls:5,vars:2,consts:[["acc","ngbAccordion"],["nav","ngbNav"],[3,"activeIds"],[3,"id"],["ngbPanelTitle",""],["ngbPanelContent",""],["data-test","browse",1,"w-100","d-flex","gap-3","justify-content-between","collapse-toggle",3,"click"],["type","button","aria-controls","bulk-access-browse-panel-content",1,"btn","btn-link","p-0",3,"click"],["id","bulk-access-browse-panel-content"],["ngbNav","",1,"nav-pills",3,"activeIdChange","activeId"],["role","presentation",3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-5",3,"ngbNavOutlet"],[1,"bulk-access-search"],[3,"configuration","selectable","selectionConfig","showThumbnails"],[3,"prev","next","paginationOptions","collectionSize","objects","showPaginator"],[1,"list-unstyled","ms-4"],[1,"mt-4","mb-4","d-flex"],[3,"index","object","selectionConfig"],[3,"listID","index","object","showThumbnails","viewMode"]],template:function(rf,ctx){1&rf&&(fesm2022_core.j41(0,"ngb-accordion",2,0)(2,"ngb-panel",3),fesm2022_core.DNE(3,BulkAccessBrowseComponent_ng_template_3_Template,4,4,"ng-template",4)(4,BulkAccessBrowseComponent_ng_template_4_Template,16,17,"ng-template",5),fesm2022_core.k0s()()),2&rf&&(fesm2022_core.Y8G("activeIds","browse"),fesm2022_core.R7$(2),fesm2022_core.Y8G("id","browse"))},dependencies:[common.Jj,browser_only_pipe.L,listable_object_component_loader_component.v,ng_bootstrap._f,ng_bootstrap.W1,ng_bootstrap.CT,ng_bootstrap.sb,ng_bootstrap.t3,ng_bootstrap.Pv,ng_bootstrap.Um,ng_bootstrap.X9,ng_bootstrap.sy,ng_bootstrap.Ri,ng_bootstrap.m_,NgxPaginationModule,PaginatePipe,pagination_component.e,selectable_list_item_control_component.Y,themed_search_component.N,ngx_translate_core.h,ngx_translate_core.D9],styles:[".bulk-access-search[_ngcontent-%COMP%]{margin-right:calc(var(--bs-gutter-x, 1.5rem) / -2);margin-left:calc(var(--bs-gutter-x, 1.5rem) / -2)}"]})}}return BulkAccessBrowseComponent2})();var access_control_form_container_component=__webpack_require__(58840);const bulk_access_settings_component_c0=["dsAccessControlForm"];function BulkAccessSettingsComponent_ng_template_3_Template(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"div",6),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r1),fesm2022_core.XpG();const acc_r2=fesm2022_core.sdS(1);return fesm2022_core.Njj(acc_r2.toggle("settings"))}),fesm2022_core.j41(1,"button",7),fesm2022_core.bIt("click",function($event){return fesm2022_core.eBV(_r1),fesm2022_core.Njj($event.preventDefault())}),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s()()}if(2&rf){fesm2022_core.XpG();const acc_r2=fesm2022_core.sdS(1);fesm2022_core.R7$(),fesm2022_core.BMQ("aria-expanded",acc_r2.isExpanded("settings")),fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,2,"admin.access-control.bulk-access-settings.header")," ")}}function BulkAccessSettingsComponent_ng_template_4_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-access-control-form-container",8,1),2&rf&&fesm2022_core.Y8G("showSubmit",!1)}let BulkAccessSettingsComponent=(()=>{class BulkAccessSettingsComponent2{getValue(){return this.controlForm.getFormValue()}reset(){this.controlForm.reset()}isFormValid(){return this.controlForm.isValid()}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||BulkAccessSettingsComponent2)}}static{this.\u0275cmp=fesm2022_core.VBU({type:BulkAccessSettingsComponent2,selectors:[["ds-bulk-access-settings"]],viewQuery:function(rf,ctx){if(1&rf&&fesm2022_core.GBs(bulk_access_settings_component_c0,5),2&rf){let _t;fesm2022_core.mGM(_t=fesm2022_core.lsd())&&(ctx.controlForm=_t.first)}},exportAs:["dsBulkSettings"],standalone:!0,features:[fesm2022_core.aNF],decls:5,vars:2,consts:[["acc","ngbAccordion"],["dsAccessControlForm",""],[3,"activeIds"],[3,"id"],["ngbPanelTitle",""],["ngbPanelContent",""],["ngbPanelToggle","","data-test","settings",1,"w-100","d-flex","gap-3","justify-content-between","collapse-toggle",3,"click"],["type","button","aria-controls","bulk-access-settings-panel-content",1,"btn","btn-link","p-0",3,"click"],["id","bulk-access-settings-panel-content",3,"showSubmit"]],template:function(rf,ctx){1&rf&&(fesm2022_core.j41(0,"ngb-accordion",2,0)(2,"ngb-panel",3),fesm2022_core.DNE(3,BulkAccessSettingsComponent_ng_template_3_Template,4,4,"ng-template",4)(4,BulkAccessSettingsComponent_ng_template_4_Template,2,1,"ng-template",5),fesm2022_core.k0s()()),2&rf&&(fesm2022_core.Y8G("activeIds","settings"),fesm2022_core.R7$(2),fesm2022_core.Y8G("id","settings"))},dependencies:[access_control_form_container_component.o,ng_bootstrap._f,ng_bootstrap.W1,ng_bootstrap.CT,ng_bootstrap.sb,ng_bootstrap.t3,ngx_translate_core.h,ngx_translate_core.D9]})}}return BulkAccessSettingsComponent2})();const bulk_access_component_c0=["dsBulkSettings"];let BulkAccessComponent=(()=>{class BulkAccessComponent2{constructor(bulkAccessControlService,selectableListService){this.bulkAccessControlService=bulkAccessControlService,this.selectableListService=selectableListService,this.listId="bulk-access-list",this.objectsSelected$=new cjs.BehaviorSubject([]),this.subs=[]}ngOnInit(){this.subs.push(this.selectableListService.getSelectableList(this.listId).pipe((0,operators.F)(),(0,operators.Tj)(list=>this.generateIdListBySelectedElements(list))).subscribe(this.objectsSelected$))}canExport(){return this.objectsSelected$.value?.length>0&&this.settings?.isFormValid()}reset(){this.settings.reset()}submit(){const settings=this.settings.getValue(),bitstreamAccess=settings.bitstream,itemAccess=settings.item,{file}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess,itemAccess,state:settings.state});this.bulkAccessControlService.executeScript(this.objectsSelected$.value||[],file).subscribe()}generateIdListBySelectedElements(list){return list?.selection?.map(entry=>entry.indexableObject.uuid)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||BulkAccessComponent2)(fesm2022_core.rXU(bulk_access_control_service.r),fesm2022_core.rXU(selectable_list_service.K))}}static{this.\u0275cmp=fesm2022_core.VBU({type:BulkAccessComponent2,selectors:[["ds-bulk-access"]],viewQuery:function(rf,ctx){if(1&rf&&fesm2022_core.GBs(bulk_access_component_c0,5),2&rf){let _t;fesm2022_core.mGM(_t=fesm2022_core.lsd())&&(ctx.settings=_t.first)}},standalone:!0,features:[fesm2022_core.aNF],decls:16,vars:11,consts:[["dsBulkSettings",""],[1,"container"],[3,"listId"],[1,"clearfix","mb-3"],[1,"d-flex","justify-content-end"],[1,"btn","btn-outline-primary","me-3",3,"click"],[1,"btn","btn-primary",3,"click","dsBtnDisabled"]],template:function(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"div",1)(1,"h1"),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.nrm(4,"ds-bulk-access-browse",2)(5,"div",3)(6,"ds-bulk-access-settings",null,0)(8,"hr"),fesm2022_core.j41(9,"div",4)(10,"button",5),fesm2022_core.bIt("click",function(){return fesm2022_core.eBV(_r1),fesm2022_core.Njj(ctx.reset())}),fesm2022_core.EFF(11),fesm2022_core.nI1(12,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(13,"button",6),fesm2022_core.bIt("click",function(){return fesm2022_core.eBV(_r1),fesm2022_core.Njj(ctx.submit())}),fesm2022_core.EFF(14),fesm2022_core.nI1(15,"translate"),fesm2022_core.k0s()()()}2&rf&&(fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(3,5,"admin.access-control.bulk-access.title")),fesm2022_core.R7$(2),fesm2022_core.Y8G("listId",ctx.listId),fesm2022_core.R7$(7),fesm2022_core.SpI(" ",fesm2022_core.bMT(12,7,"access-control-cancel")," "),fesm2022_core.R7$(2),fesm2022_core.Y8G("dsBtnDisabled",!ctx.canExport()),fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(15,9,"access-control-execute")," "))},dependencies:[btn_disabled_directive.A,BulkAccessBrowseComponent,BulkAccessSettingsComponent,ngx_translate_core.h,ngx_translate_core.D9],changeDetection:0})}}return BulkAccessComponent2})();var fesm2022_forms=__webpack_require__(13054),router=__webpack_require__(18134),dso_name_service=__webpack_require__(11481),authorization_data_service=__webpack_require__(76509),feature_id=__webpack_require__(86583),request_service=__webpack_require__(64806),eperson_data_service=__webpack_require__(15318),eperson_dto_model=__webpack_require__(63378),pagination_service=__webpack_require__(31903),shared_operators=__webpack_require__(39022),confirmation_modal_component=__webpack_require__(3849),themed_loading_component=__webpack_require__(18869),notifications_service=__webpack_require__(76623);const epeople_registry_component_c0=a0=>({"table-primary":a0}),epeople_registry_component_c1=a0=>({name:a0});function EPeopleRegistryComponent_Conditional_39_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-loading")}function EPeopleRegistryComponent_Conditional_41_For_20_Conditional_13_Template(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"button",30),fesm2022_core.nI1(1,"translate"),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r1);const epersonDto_r2=fesm2022_core.XpG().$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.deleteEPerson(epersonDto_r2.eperson))}),fesm2022_core.nrm(2,"i",31),fesm2022_core.k0s()}if(2&rf){const epersonDto_r2=fesm2022_core.XpG().$implicit,ctx_r2=fesm2022_core.XpG(2);fesm2022_core.FS9("title",fesm2022_core.i5U(1,1,ctx_r2.labelPrefix+"table.edit.buttons.remove",fesm2022_core.eq3(4,epeople_registry_component_c1,ctx_r2.dsoNameService.getName(epersonDto_r2.eperson))))}}function EPeopleRegistryComponent_Conditional_41_For_20_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"tr",25),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"td"),fesm2022_core.EFF(3),fesm2022_core.k0s(),fesm2022_core.j41(4,"td"),fesm2022_core.EFF(5),fesm2022_core.k0s(),fesm2022_core.j41(6,"td"),fesm2022_core.EFF(7),fesm2022_core.k0s(),fesm2022_core.j41(8,"td")(9,"div",26)(10,"button",27),fesm2022_core.nI1(11,"translate"),fesm2022_core.nrm(12,"i",28),fesm2022_core.k0s(),fesm2022_core.DNE(13,EPeopleRegistryComponent_Conditional_41_For_20_Conditional_13_Template,3,6,"button",29),fesm2022_core.k0s()()()),2&rf){const epersonDto_r2=ctx.$implicit,ctx_r2=fesm2022_core.XpG(2);fesm2022_core.Y8G("ngClass",fesm2022_core.eq3(12,epeople_registry_component_c0,fesm2022_core.bMT(1,7,ctx_r2.activeEPerson$)===epersonDto_r2.eperson)),fesm2022_core.R7$(3),fesm2022_core.JRh(epersonDto_r2.eperson.id),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r2.dsoNameService.getName(epersonDto_r2.eperson)),fesm2022_core.R7$(2),fesm2022_core.JRh(epersonDto_r2.eperson.email),fesm2022_core.R7$(3),fesm2022_core.FS9("title",fesm2022_core.i5U(11,9,ctx_r2.labelPrefix+"table.edit.buttons.edit",fesm2022_core.eq3(14,epeople_registry_component_c1,ctx_r2.dsoNameService.getName(epersonDto_r2.eperson)))),fesm2022_core.Y8G("routerLink",ctx_r2.getEditEPeoplePage(epersonDto_r2.eperson.id)),fesm2022_core.R7$(3),fesm2022_core.vxM(epersonDto_r2.ableToDelete?13:-1)}}function EPeopleRegistryComponent_Conditional_41_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ds-pagination",20),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"div",22)(3,"table",23)(4,"thead")(5,"tr")(6,"th",24),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",24),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",24),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(15,"th"),fesm2022_core.EFF(16),fesm2022_core.nI1(17,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(18,"tbody"),fesm2022_core.Z7z(19,EPeopleRegistryComponent_Conditional_41_For_20_Template,14,16,"tr",25,fesm2022_core.fX1),fesm2022_core.nI1(21,"async"),fesm2022_core.k0s()()()()),2&rf){let tmp_2_0,tmp_9_0;const ctx_r2=fesm2022_core.XpG();fesm2022_core.Y8G("paginationOptions",ctx_r2.config)("collectionSize",null==(tmp_2_0=fesm2022_core.bMT(1,8,ctx_r2.pageInfoState$))?null:tmp_2_0.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,10,ctx_r2.labelPrefix+"table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,12,ctx_r2.labelPrefix+"table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,14,ctx_r2.labelPrefix+"table.email")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(17,16,ctx_r2.labelPrefix+"table.edit")),fesm2022_core.R7$(3),fesm2022_core.Dyx(null==(tmp_9_0=fesm2022_core.bMT(21,18,ctx_r2.ePeopleDto$))?null:tmp_9_0.page)}}function EPeopleRegistryComponent_Conditional_44_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",21),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r2=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r2.labelPrefix+"no-items")," ")}}let EPeopleRegistryComponent=(()=>{class EPeopleRegistryComponent2{constructor(epersonService,translateService,notificationsService,authorizationService,formBuilder,router2,modalService,paginationService,requestService,dsoNameService){this.epersonService=epersonService,this.translateService=translateService,this.notificationsService=notificationsService,this.authorizationService=authorizationService,this.formBuilder=formBuilder,this.router=router2,this.modalService=modalService,this.paginationService=paginationService,this.requestService=requestService,this.dsoNameService=dsoNameService,this.labelPrefix="admin.access-control.epeople.",this.ePeople$=new cjs.BehaviorSubject((0,paginated_list_model.g)(new page_info_model.Q,[])),this.ePeopleDto$=new cjs.BehaviorSubject({}),this.pageInfoState$=new cjs.BehaviorSubject(void 0),this.searching$=new cjs.BehaviorSubject(!1),this.config=Object.assign(new pagination_component_options_model.W,{id:"elp",pageSize:5,currentPage:1}),this.subs=[],this.currentSearchQuery="",this.currentSearchScope="metadata",this.searchForm=this.formBuilder.group({scope:"metadata",query:""})}ngOnInit(){this.initialisePage()}initialisePage(){this.searching$.next(!0),this.search({scope:this.currentSearchScope,query:this.currentSearchQuery}),this.activeEPerson$=this.epersonService.getActiveEPerson(),this.subs.push(this.ePeople$.pipe((0,operators.nx)(epeople=>epeople.pageInfo.totalElements>0?(0,cjs.combineLatest)(epeople.page.map(eperson=>this.authorizationService.isAuthorized(feature_id._.CanDelete,(0,empty_util.a4)(eperson)?eperson.self:void 0).pipe((0,operators.Tj)(authorized=>{const epersonDtoModel=new eperson_dto_model.h;return epersonDtoModel.ableToDelete=authorized,epersonDtoModel.eperson=eperson,epersonDtoModel})))).pipe((0,operators.Tj)(dtos=>(0,paginated_list_model.g)(epeople.pageInfo,dtos))):[epeople])).subscribe(value=>{this.searching$.next(!1),this.ePeopleDto$.next(value),this.pageInfoState$.next(value.pageInfo)}))}search(data){this.searching$.next(!0),(0,empty_util.a4)(this.findListOptionsSub)&&this.findListOptionsSub.unsubscribe(),this.findListOptionsSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.nx)(findListOptions=>{const query=data.query,scope=data.scope;return null!=query&&this.currentSearchQuery!==query&&(this.router.navigate([(0,access_control_routing_paths.bL)()],{queryParamsHandling:"merge"}),this.currentSearchQuery=query,this.paginationService.resetPage(this.config.id)),null!=scope&&this.currentSearchScope!==scope&&(this.router.navigate([(0,access_control_routing_paths.bL)()],{queryParamsHandling:"merge"}),this.currentSearchScope=scope,this.paginationService.resetPage(this.config.id)),this.epersonService.searchByScope(this.currentSearchScope,this.currentSearchQuery,{currentPage:findListOptions.currentPage,elementsPerPage:findListOptions.pageSize})}),(0,shared_operators.v7)()).subscribe(peopleRD=>{this.ePeople$.next(peopleRD.payload),this.pageInfoState$.next(peopleRD.payload.pageInfo)})}deleteEPerson(ePerson){if((0,empty_util.a4)(ePerson.id)){const modalRef=this.modalService.open(confirmation_modal_component.M);modalRef.componentInstance.name=this.dsoNameService.getName(ePerson),modalRef.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",modalRef.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",modalRef.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",modalRef.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.s)(1)).subscribe(confirm=>{confirm&&(0,empty_util.a4)(ePerson.id)&&this.epersonService.deleteEPerson(ePerson).pipe((0,shared_operators.qD)()).subscribe(restResponse=>{restResponse.hasSucceeded?this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.deleted.success",{name:this.dsoNameService.getName(ePerson)})):this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.deleted.success",{id:ePerson.id,statusCode:restResponse.statusCode,errorMessage:restResponse.errorMessage}))})})}}ngOnDestroy(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}cleanupSubscribes(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe())}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}getEditEPeoplePage(id){return(0,access_control_routing_paths.Ax)(id)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EPeopleRegistryComponent2)(fesm2022_core.rXU(eperson_data_service.EPersonDataService),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(authorization_data_service.AuthorizationDataService),fesm2022_core.rXU(fesm2022_forms.ze),fesm2022_core.rXU(router.Ix),fesm2022_core.rXU(ng_bootstrap.Bq),fesm2022_core.rXU(pagination_service.m),fesm2022_core.rXU(request_service.B),fesm2022_core.rXU(dso_name_service.f))}}static{this.\u0275cmp=fesm2022_core.VBU({type:EPeopleRegistryComponent2,selectors:[["ds-epeople-registry"]],standalone:!0,features:[fesm2022_core.aNF],decls:46,vars:40,consts:[[1,"container"],[1,"epeople-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[1,"me-auto","btn","btn-success","addEPerson-button",3,"routerLink"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline","ms-1"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"ngSubmit","formGroup"],["name","scope","id","scope","formControlName","scope","aria-label","Search scope",1,"form-select"],["value","metadata"],["value","email"],[1,"flex-grow-1","me-3","ms-3"],[1,"mb-3","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"search-button","btn","btn-secondary",3,"click"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[1,"table-responsive"],["id","epeople",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[3,"ngClass"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","access-control-editEPersonButton",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],[1,"delete-button","btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"title"],[1,"delete-button","btn","btn-outline-danger","btn-sm","access-control-deleteEPersonButton",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"]],template:function(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),fesm2022_core.EFF(5),fesm2022_core.nI1(6,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(7,"div")(8,"button",5),fesm2022_core.nrm(9,"i",6),fesm2022_core.j41(10,"span",7),fesm2022_core.EFF(11),fesm2022_core.nI1(12,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(13,"h2",8),fesm2022_core.EFF(14),fesm2022_core.nI1(15,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(16,"form",9),fesm2022_core.bIt("ngSubmit",function(){return ctx.search(ctx.searchForm.value)}),fesm2022_core.j41(17,"div")(18,"select",10)(19,"option",11),fesm2022_core.EFF(20),fesm2022_core.nI1(21,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(22,"option",12),fesm2022_core.EFF(23),fesm2022_core.nI1(24,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(25,"div",13)(26,"div",14),fesm2022_core.nrm(27,"input",15),fesm2022_core.nI1(28,"translate"),fesm2022_core.nI1(29,"translate"),fesm2022_core.j41(30,"span",16)(31,"button",17),fesm2022_core.nrm(32,"i",18),fesm2022_core.EFF(33),fesm2022_core.nI1(34,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(35,"div")(36,"button",19),fesm2022_core.bIt("click",function(){return ctx.clearFormAndResetResult()}),fesm2022_core.EFF(37),fesm2022_core.nI1(38,"translate"),fesm2022_core.k0s()()(),fesm2022_core.DNE(39,EPeopleRegistryComponent_Conditional_39_Template,1,0,"ds-loading"),fesm2022_core.nI1(40,"async"),fesm2022_core.DNE(41,EPeopleRegistryComponent_Conditional_41_Template,22,20,"ds-pagination",20),fesm2022_core.nI1(42,"async"),fesm2022_core.nI1(43,"async"),fesm2022_core.DNE(44,EPeopleRegistryComponent_Conditional_44_Template,3,3,"div",21),fesm2022_core.nI1(45,"async"),fesm2022_core.k0s()()()),2&rf){let tmp_12_0,tmp_13_0;fesm2022_core.R7$(5),fesm2022_core.JRh(fesm2022_core.bMT(6,14,ctx.labelPrefix+"head")),fesm2022_core.R7$(3),fesm2022_core.Y8G("routerLink","create"),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(12,16,ctx.labelPrefix+"button.add")),fesm2022_core.R7$(3),fesm2022_core.SpI(" ",fesm2022_core.bMT(15,18,ctx.labelPrefix+"search.head")," "),fesm2022_core.R7$(2),fesm2022_core.Y8G("formGroup",ctx.searchForm),fesm2022_core.R7$(4),fesm2022_core.JRh(fesm2022_core.bMT(21,20,ctx.labelPrefix+"search.scope.metadata")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(24,22,ctx.labelPrefix+"search.scope.email")),fesm2022_core.R7$(4),fesm2022_core.Y8G("placeholder",fesm2022_core.bMT(28,24,ctx.labelPrefix+"search.placeholder")),fesm2022_core.BMQ("aria-label",fesm2022_core.bMT(29,26,ctx.labelPrefix+"search.placeholder")),fesm2022_core.R7$(6),fesm2022_core.SpI(" ",fesm2022_core.bMT(34,28,ctx.labelPrefix+"search.button")," "),fesm2022_core.R7$(4),fesm2022_core.JRh(fesm2022_core.bMT(38,30,ctx.labelPrefix+"button.see-all")),fesm2022_core.R7$(2),fesm2022_core.vxM(fesm2022_core.bMT(40,32,ctx.searching$)?39:-1),fesm2022_core.R7$(2),fesm2022_core.vxM((null==(tmp_12_0=fesm2022_core.bMT(42,34,ctx.pageInfoState$))?null:tmp_12_0.totalElements)>0&&!0!==fesm2022_core.bMT(43,36,ctx.searching$)?41:-1),fesm2022_core.R7$(3),fesm2022_core.vxM(0===(null==(tmp_13_0=fesm2022_core.bMT(45,38,ctx.pageInfoState$))?null:tmp_13_0.totalElements)?44:-1)}},dependencies:[common.Jj,common.YU,pagination_component.e,fesm2022_forms.X1,fesm2022_forms.qT,fesm2022_forms.xH,fesm2022_forms.y7,fesm2022_forms.me,fesm2022_forms.wz,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,router.iI,router.Wk,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return EPeopleRegistryComponent2})();var auth_service=__webpack_require__(54545),eperson_registration_service=__webpack_require__(54255),group_data_service=__webpack_require__(14557),eperson_model=__webpack_require__(65434),register_email_form_component=__webpack_require__(47811),form_builder_service=__webpack_require__(84697),form_component=__webpack_require__(27790),follow_link_config_model=__webpack_require__(76715),has_no_value_pipe=__webpack_require__(23219);class ValidateEmailNotTaken{static createValidator(ePersonDataService){return control=>ePersonDataService.getEPersonByEmail(control.value).pipe((0,shared_operators.yd)(),(0,operators.Tj)(res=>res.payload?{emailTaken:!0}:null))}}const eperson_form_component_c0=a0=>[a0];function EPersonFormComponent_Conditional_3_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"h1",3),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r0=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.JRh(fesm2022_core.bMT(2,1,ctx_r0.messagePrefix+".edit"))}}function EPersonFormComponent_Conditional_5_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"h1",3),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r0=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.JRh(fesm2022_core.bMT(2,1,ctx_r0.messagePrefix+".create"))}}function EPersonFormComponent_Conditional_12_Template(rf,ctx){if(1&rf){const _r2=fesm2022_core.RV6();fesm2022_core.j41(0,"div",8)(1,"button",11),fesm2022_core.nI1(2,"async"),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r2);const ctx_r0=fesm2022_core.XpG();return fesm2022_core.Njj(ctx_r0.resetPassword())}),fesm2022_core.nrm(3,"i",12),fesm2022_core.EFF(4),fesm2022_core.nI1(5,"translate"),fesm2022_core.k0s()()}if(2&rf){const ctx_r0=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.Y8G("dsBtnDisabled",!0!==fesm2022_core.bMT(2,2,ctx_r0.canReset$)),fesm2022_core.R7$(3),fesm2022_core.SpI(" ",fesm2022_core.bMT(5,4,"admin.access-control.epeople.actions.reset")," ")}}function EPersonFormComponent_Conditional_13_Conditional_1_Template(rf,ctx){if(1&rf){const _r3=fesm2022_core.RV6();fesm2022_core.j41(0,"button",14),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r3);const ctx_r0=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r0.impersonate())}),fesm2022_core.nrm(1,"i",15),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s()}2&rf&&(fesm2022_core.R7$(2),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,1,"admin.access-control.epeople.actions.impersonate")," "))}function EPersonFormComponent_Conditional_13_Conditional_2_Template(rf,ctx){if(1&rf){const _r4=fesm2022_core.RV6();fesm2022_core.j41(0,"button",14),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r4);const ctx_r0=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r0.stopImpersonating())}),fesm2022_core.nrm(1,"i",15),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s()}2&rf&&(fesm2022_core.R7$(2),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,1,"admin.access-control.epeople.actions.stop-impersonating")," "))}function EPersonFormComponent_Conditional_13_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",8),fesm2022_core.DNE(1,EPersonFormComponent_Conditional_13_Conditional_1_Template,4,3,"button",13)(2,EPersonFormComponent_Conditional_13_Conditional_2_Template,4,3,"button",13),fesm2022_core.k0s()),2&rf){const ctx_r0=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.vxM(ctx_r0.isImpersonated?-1:1),fesm2022_core.R7$(),fesm2022_core.vxM(ctx_r0.isImpersonated?2:-1)}}function EPersonFormComponent_Conditional_15_Template(rf,ctx){if(1&rf){const _r5=fesm2022_core.RV6();fesm2022_core.j41(0,"button",16),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r5);const ctx_r0=fesm2022_core.XpG();return fesm2022_core.Njj(ctx_r0.delete())}),fesm2022_core.nrm(1,"i",17),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s()}2&rf&&(fesm2022_core.R7$(2),fesm2022_core.SpI(" ",fesm2022_core.bMT(3,1,"admin.access-control.epeople.actions.delete")," "))}function EPersonFormComponent_Conditional_17_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-loading",10),2&rf&&fesm2022_core.Y8G("showMessage",!1)}function EPersonFormComponent_Conditional_18_Conditional_4_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-loading",10),2&rf&&fesm2022_core.Y8G("showMessage",!1)}function EPersonFormComponent_Conditional_18_Conditional_7_For_17_Template(rf,ctx){if(1&rf){const _r7=fesm2022_core.RV6();fesm2022_core.j41(0,"tr")(1,"td",24),fesm2022_core.EFF(2),fesm2022_core.k0s(),fesm2022_core.j41(3,"td",24)(4,"a",25),fesm2022_core.bIt("click",function(){const group_r8=fesm2022_core.eBV(_r7).$implicit,ctx_r0=fesm2022_core.XpG(3);return fesm2022_core.Njj(ctx_r0.groupsDataService.startEditingNewGroup(group_r8))}),fesm2022_core.EFF(5),fesm2022_core.k0s()(),fesm2022_core.j41(6,"td",24),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"async"),fesm2022_core.k0s()()}if(2&rf){let tmp_15_0;const group_r8=ctx.$implicit,ctx_r0=fesm2022_core.XpG(3);fesm2022_core.R7$(2),fesm2022_core.JRh(group_r8.id),fesm2022_core.R7$(2),fesm2022_core.Y8G("routerLink",fesm2022_core.eq3(6,eperson_form_component_c0,ctx_r0.groupsDataService.getGroupEditPageRouterLink(group_r8))),fesm2022_core.R7$(),fesm2022_core.SpI(" ",ctx_r0.dsoNameService.getName(group_r8)," "),fesm2022_core.R7$(2),fesm2022_core.SpI(" ",ctx_r0.dsoNameService.getName(null==(tmp_15_0=fesm2022_core.bMT(8,4,group_r8.object))?null:tmp_15_0.payload)," ")}}function EPersonFormComponent_Conditional_18_Conditional_7_Template(rf,ctx){if(1&rf){const _r6=fesm2022_core.RV6();fesm2022_core.j41(0,"ds-pagination",20),fesm2022_core.nI1(1,"async"),fesm2022_core.bIt("pageChange",function($event){fesm2022_core.eBV(_r6);const ctx_r0=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r0.onPageChange($event))}),fesm2022_core.j41(2,"div",21)(3,"table",22)(4,"thead")(5,"tr")(6,"th",23),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",23),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",23),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(15,"tbody"),fesm2022_core.Z7z(16,EPersonFormComponent_Conditional_18_Conditional_7_For_17_Template,9,8,"tr",null,fesm2022_core.fX1),fesm2022_core.nI1(18,"async"),fesm2022_core.k0s()()()()}if(2&rf){let tmp_3_0,tmp_9_0;const ctx_r0=fesm2022_core.XpG(2);fesm2022_core.Y8G("paginationOptions",ctx_r0.config)("collectionSize",null==(tmp_3_0=fesm2022_core.bMT(1,7,ctx_r0.groups$))||null==tmp_3_0.payload?null:tmp_3_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,9,ctx_r0.messagePrefix+".table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,11,ctx_r0.messagePrefix+".table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,13,ctx_r0.messagePrefix+".table.collectionOrCommunity")),fesm2022_core.R7$(3),fesm2022_core.Dyx(null==(tmp_9_0=fesm2022_core.bMT(18,15,ctx_r0.groups$))||null==tmp_9_0.payload?null:tmp_9_0.payload.page)}}function EPersonFormComponent_Conditional_18_Conditional_9_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",19)(1,"div"),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(4,"div")(5,"button",26),fesm2022_core.EFF(6),fesm2022_core.nI1(7,"translate"),fesm2022_core.k0s()()()),2&rf){const ctx_r0=fesm2022_core.XpG(2);fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(3,3,ctx_r0.messagePrefix+".memberOfNoGroups")),fesm2022_core.R7$(3),fesm2022_core.Y8G("routerLink",fesm2022_core.eq3(7,eperson_form_component_c0,ctx_r0.groupsDataService.getGroupRegistryRouterLink())),fesm2022_core.R7$(),fesm2022_core.JRh(fesm2022_core.bMT(7,5,ctx_r0.messagePrefix+".goToGroups"))}}function EPersonFormComponent_Conditional_18_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div")(1,"h2"),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.DNE(4,EPersonFormComponent_Conditional_18_Conditional_4_Template,1,1,"ds-loading",10),fesm2022_core.nI1(5,"async"),fesm2022_core.nI1(6,"dsHasNoValue"),fesm2022_core.DNE(7,EPersonFormComponent_Conditional_18_Conditional_7_Template,19,17,"ds-pagination",18),fesm2022_core.nI1(8,"async"),fesm2022_core.DNE(9,EPersonFormComponent_Conditional_18_Conditional_9_Template,8,9,"div",19),fesm2022_core.nI1(10,"async"),fesm2022_core.k0s()),2&rf){let tmp_3_0,tmp_4_0;const ctx_r0=fesm2022_core.XpG();fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(3,4,ctx_r0.messagePrefix+".groupsEPersonIsMemberOf")),fesm2022_core.R7$(2),fesm2022_core.vxM(fesm2022_core.bMT(6,8,fesm2022_core.bMT(5,6,ctx_r0.groups$))?4:-1),fesm2022_core.R7$(3),fesm2022_core.vxM((null==(tmp_3_0=fesm2022_core.bMT(8,10,ctx_r0.groups$))||null==tmp_3_0.payload?null:tmp_3_0.payload.totalElements)>0?7:-1),fesm2022_core.R7$(2),fesm2022_core.vxM(0===(null==(tmp_4_0=fesm2022_core.bMT(10,12,ctx_r0.groups$))||null==tmp_4_0.payload?null:tmp_4_0.payload.totalElements)?9:-1)}}let EPersonFormComponent=(()=>{class EPersonFormComponent2{constructor(changeDetectorRef,epersonService,groupsDataService,formBuilderService,translateService,notificationsService,authService,authorizationService,modalService,paginationService,requestService,epersonRegistrationService,dsoNameService,route,router2){this.changeDetectorRef=changeDetectorRef,this.epersonService=epersonService,this.groupsDataService=groupsDataService,this.formBuilderService=formBuilderService,this.translateService=translateService,this.notificationsService=notificationsService,this.authService=authService,this.authorizationService=authorizationService,this.modalService=modalService,this.paginationService=paginationService,this.requestService=requestService,this.epersonRegistrationService=epersonRegistrationService,this.dsoNameService=dsoNameService,this.route=route,this.router=router2,this.labelPrefix="admin.access-control.epeople.form.",this.formId="eperson-form",this.messagePrefix="admin.access-control.epeople.form",this.formLayout={firstName:{grid:{host:"row"}},lastName:{grid:{host:"row"}},email:{grid:{host:"row"}},canLogIn:{grid:{host:"col col-sm-6 d-inline-block"}},requireCertificate:{grid:{host:"col col-sm-6 d-inline-block"}}},this.submitForm=new fesm2022_core.bkB,this.cancelForm=new fesm2022_core.bkB,this.subs=[],this.config=Object.assign(new pagination_component_options_model.W,{id:"gem",pageSize:5,currentPage:1}),this.isImpersonated=!1,this.displayResetPassword=!1,this.submitLabel="form.create"}ngOnInit(){this.activeEPerson$=this.epersonService.getActiveEPerson(),this.subs.push(this.activeEPerson$.subscribe(eperson=>{this.epersonInitial=eperson,(0,empty_util.a4)(eperson)&&(this.isImpersonated=this.authService.isImpersonatingUser(eperson.id),this.displayResetPassword=!0,this.submitLabel="form.submit")})),this.initialisePage()}initialisePage(){this.route.snapshot.params.id&&this.subs.push(this.epersonService.findById(this.route.snapshot.params.id).subscribe(ePersonRD=>{this.epersonService.editEPerson(ePersonRD.payload)})),this.firstName=new core.rA_({id:"firstName",label:this.translateService.instant(`${this.messagePrefix}.firstName`),name:"firstName",validators:{required:null},required:!0}),this.lastName=new core.rA_({id:"lastName",label:this.translateService.instant(`${this.messagePrefix}.lastName`),name:"lastName",validators:{required:null},required:!0}),this.email=new core.rA_({id:"email",label:this.translateService.instant(`${this.messagePrefix}.email`),name:"email",validators:{required:null,pattern:"^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$"},required:!0,errorMessages:{emailTaken:"error.validation.emailTaken",pattern:"error.validation.NotValidEmail"},hint:this.translateService.instant(`${this.messagePrefix}.emailHint`)}),this.canLogIn=new core.M7d({id:"canLogIn",label:this.translateService.instant(`${this.messagePrefix}.canLogIn`),name:"canLogIn",value:null==this.epersonInitial||this.epersonInitial.canLogIn}),this.requireCertificate=new core.M7d({id:"requireCertificate",label:this.translateService.instant(`${this.messagePrefix}.requireCertificate`),name:"requireCertificate",value:null!=this.epersonInitial&&this.epersonInitial.requireCertificate}),this.formModel=[this.firstName,this.lastName,this.email,this.canLogIn,this.requireCertificate],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.subs.push(this.activeEPerson$.subscribe(eperson=>{null!=eperson&&(this.groups$=this.groupsDataService.findListByHref(eperson._links.groups.href,{currentPage:1,elementsPerPage:this.config.pageSize},void 0,void 0,(0,follow_link_config_model.s)("object"))),this.formGroup.patchValue({firstName:null!=eperson?eperson.firstMetadataValue("eperson.firstname"):"",lastName:null!=eperson?eperson.firstMetadataValue("eperson.lastname"):"",email:null!=eperson?eperson.email:"",canLogIn:null==eperson||eperson.canLogIn,requireCertificate:null!=eperson&&eperson.requireCertificate}),null===eperson&&this.formGroup.controls.email&&(this.formGroup.controls.email.setAsyncValidators(ValidateEmailNotTaken.createValidator(this.epersonService)),this.emailValueChangeSubscribe=this.email.valueChanges.pipe((0,operators.BL)(300)).subscribe(()=>{this.changeDetectorRef.detectChanges()}))})),this.groups$=this.activeEPerson$.pipe((0,operators.nx)(eperson=>(0,cjs.combineLatest)([(0,cjs.of)(eperson),this.paginationService.getFindListOptions(this.config.id,{currentPage:1,elementsPerPage:this.config.pageSize})])),(0,operators.nx)(([eperson,findListOptions])=>null!=eperson?this.groupsDataService.findListByHref(eperson._links.groups.href,findListOptions,!0,!0,(0,follow_link_config_model.s)("object")):(0,cjs.of)(void 0))),this.groupsPageInfoState$=this.groups$.pipe((0,operators.Tj)(groupsRD=>groupsRD.payload.pageInfo)),this.canImpersonate$=this.activeEPerson$.pipe((0,operators.nx)(eperson=>(0,empty_util.a4)(eperson)?this.authorizationService.isAuthorized(feature_id._.LoginOnBehalfOf,eperson.self):(0,cjs.of)(!1))),this.canDelete$=this.activeEPerson$.pipe((0,operators.nx)(eperson=>this.authorizationService.isAuthorized(feature_id._.CanDelete,(0,empty_util.a4)(eperson)?eperson.self:void 0))),this.canReset$=(0,cjs.of)(!0)}onCancel(){this.epersonService.cancelEditEPerson(),this.cancelForm.emit(),this.router.navigate([(0,access_control_routing_paths.bL)()])}onSubmit(){this.activeEPerson$.pipe((0,operators.s)(1)).subscribe(ePerson=>{const values={metadata:{"eperson.firstname":[{value:this.firstName.value}],"eperson.lastname":[{value:this.lastName.value}]},email:this.email.value,canLogIn:this.canLogIn.value,requireCertificate:this.requireCertificate.value};null==ePerson?this.createNewEPerson(values):this.editEPerson(ePerson,values)})}createNewEPerson(values){const ePersonToCreate=Object.assign(new eperson_model.f,values);this.epersonService.create(ePersonToCreate).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.created.success",{name:this.dsoNameService.getName(ePersonToCreate)})),this.submitForm.emit(ePersonToCreate),this.epersonService.clearEPersonRequests(),this.router.navigateByUrl((0,access_control_routing_paths.bL)())):(this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.created.failure",{name:this.dsoNameService.getName(ePersonToCreate)})),this.cancelForm.emit())}),this.showNotificationIfEmailInUse(ePersonToCreate,"created")}editEPerson(ePerson,values){const editedEperson=Object.assign(new eperson_model.f,{id:ePerson.id,metadata:{"eperson.firstname":[{value:this.firstName.value?this.firstName.value:ePerson.firstMetadataValue("eperson.firstname")}],"eperson.lastname":[{value:this.lastName.value?this.lastName.value:ePerson.firstMetadataValue("eperson.lastname")}]},email:(0,empty_util.a4)(values.email)?values.email:ePerson.email,canLogIn:(0,empty_util.a4)(values.canLogIn)?values.canLogIn:ePerson.canLogIn,requireCertificate:(0,empty_util.a4)(values.requireCertificate)?values.requireCertificate:ePerson.requireCertificate,_links:ePerson._links});this.epersonService.updateEPerson(editedEperson).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.edited.success",{name:this.dsoNameService.getName(editedEperson)})),this.submitForm.emit(editedEperson),this.router.navigateByUrl((0,access_control_routing_paths.bL)())):(this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification.edited.failure",{name:this.dsoNameService.getName(editedEperson)})),this.cancelForm.emit())}),null!=values.email&&values.email!==ePerson.email&&this.showNotificationIfEmailInUse(editedEperson,"edited")}onPageChange(event){this.updateGroups({currentPage:event,elementsPerPage:this.config.pageSize})}impersonate(){this.authService.impersonate(this.epersonInitial.id),this.isImpersonated=!0}delete(){this.activeEPerson$.pipe((0,operators.s)(1),(0,operators.nx)(eperson=>{const modalRef=this.modalService.open(confirmation_modal_component.M);return modalRef.componentInstance.name=this.dsoNameService.getName(eperson),modalRef.componentInstance.headerLabel="confirmation-modal.delete-eperson.header",modalRef.componentInstance.infoLabel="confirmation-modal.delete-eperson.info",modalRef.componentInstance.cancelLabel="confirmation-modal.delete-eperson.cancel",modalRef.componentInstance.confirmLabel="confirmation-modal.delete-eperson.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.s)(1),(0,operators.nx)(confirm=>confirm&&(0,empty_util.a4)(eperson.id)?(this.canDelete$=(0,cjs.of)(!1),this.epersonService.deleteEPerson(eperson).pipe((0,shared_operators.qD)(),(0,operators.Tj)(restResponse=>({restResponse,eperson})))):(0,cjs.of)(null)),(0,operators.jE)(()=>this.canDelete$=(0,cjs.of)(!0)))})).subscribe(({restResponse,eperson})=>{restResponse?.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.labelPrefix+"notification.deleted.success",{name:this.dsoNameService.getName(eperson)})),this.router.navigate([(0,access_control_routing_paths.bL)()])):this.notificationsService.error(`Error occurred when trying to delete EPerson with id: ${eperson?.id} with code: ${restResponse?.statusCode} and message: ${restResponse?.errorMessage}`),this.cancelForm.emit()})}stopImpersonating(){this.authService.stopImpersonatingAndRefresh(),this.isImpersonated=!1}resetPassword(){(0,empty_util.a4)(this.epersonInitial.email)&&this.epersonRegistrationService.registerEmail(this.epersonInitial.email,null,register_email_form_component.TYPE_REQUEST_FORGOT).pipe((0,shared_operators.qD)()).subscribe(response=>{response.hasSucceeded?this.notificationsService.success(this.translateService.get("admin.access-control.epeople.actions.reset"),this.translateService.get("forgot-email.form.success.content",{email:this.epersonInitial.email})):this.notificationsService.error(this.translateService.get("forgot-email.form.error.head"),this.translateService.get("forgot-email.form.error.content",{email:this.epersonInitial.email}))})}ngOnDestroy(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe()),this.paginationService.clearPagination(this.config.id),(0,empty_util.a4)(this.emailValueChangeSubscribe)&&this.emailValueChangeSubscribe.unsubscribe()}showNotificationIfEmailInUse(ePerson,notificationSection){this.subs.push(this.epersonService.searchByScope("email",ePerson.email,{currentPage:1,elementsPerPage:0}).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(list=>{list.totalElements>0&&this.notificationsService.error(this.translateService.get(this.labelPrefix+"notification."+notificationSection+".failure.emailInUse",{name:this.dsoNameService.getName(ePerson),email:ePerson.email}))}))}updateGroups(options){this.subs.push(this.activeEPerson$.subscribe(eperson=>{this.groups$=this.groupsDataService.findListByHref(eperson._links.groups.href,options)}))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EPersonFormComponent2)(fesm2022_core.rXU(fesm2022_core.gRc),fesm2022_core.rXU(eperson_data_service.EPersonDataService),fesm2022_core.rXU(group_data_service.GroupDataService),fesm2022_core.rXU(form_builder_service.j),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(auth_service.uR),fesm2022_core.rXU(authorization_data_service.AuthorizationDataService),fesm2022_core.rXU(ng_bootstrap.Bq),fesm2022_core.rXU(pagination_service.m),fesm2022_core.rXU(request_service.B),fesm2022_core.rXU(eperson_registration_service.f),fesm2022_core.rXU(dso_name_service.f),fesm2022_core.rXU(router.nX),fesm2022_core.rXU(router.Ix))}}static{this.\u0275cmp=fesm2022_core.VBU({type:EPersonFormComponent2,selectors:[["ds-eperson-form"]],outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},standalone:!0,features:[fesm2022_core.aNF],decls:20,vars:23,consts:[[1,"container"],[1,"group-form","row"],[1,"col-12"],[1,"border-bottom","pb-2"],[3,"submitForm","formId","formModel","formGroup","formLayout","displayCancel","submitLabel"],["before","",1,"btn-group"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["between","",1,"btn-group"],["after","","type","button",1,"btn","btn-danger","delete-button"],[3,"showMessage"],["type","button",1,"btn","btn-primary",3,"click","dsBtnDisabled"],[1,"fa","fa-key"],["type","button",1,"btn","btn-primary"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-user-secret"],["after","","type","button",1,"btn","btn-danger","delete-button",3,"click"],[1,"fas","fa-trash"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[3,"pageChange","paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col",1,"align-middle"],[1,"align-middle"],[3,"click","routerLink"],[1,"btn","btn-primary",3,"routerLink"]],template:function(rf,ctx){1&rf&&(fesm2022_core.j41(0,"div",0)(1,"div",1)(2,"div",2),fesm2022_core.DNE(3,EPersonFormComponent_Conditional_3_Template,3,3,"h1",3),fesm2022_core.nI1(4,"async"),fesm2022_core.DNE(5,EPersonFormComponent_Conditional_5_Template,3,3,"h1",3),fesm2022_core.j41(6,"ds-form",4),fesm2022_core.bIt("submitForm",function(){return ctx.onSubmit()}),fesm2022_core.j41(7,"div",5)(8,"button",6),fesm2022_core.bIt("click",function(){return ctx.onCancel()}),fesm2022_core.nrm(9,"i",7),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s()(),fesm2022_core.DNE(12,EPersonFormComponent_Conditional_12_Template,6,6,"div",8)(13,EPersonFormComponent_Conditional_13_Template,3,2,"div",8),fesm2022_core.nI1(14,"async"),fesm2022_core.DNE(15,EPersonFormComponent_Conditional_15_Template,4,3,"button",9),fesm2022_core.nI1(16,"async"),fesm2022_core.k0s(),fesm2022_core.DNE(17,EPersonFormComponent_Conditional_17_Template,1,1,"ds-loading",10)(18,EPersonFormComponent_Conditional_18_Template,11,14,"div"),fesm2022_core.nI1(19,"async"),fesm2022_core.k0s()()()),2&rf&&(fesm2022_core.R7$(3),fesm2022_core.vxM(fesm2022_core.bMT(4,13,ctx.activeEPerson$)?3:5),fesm2022_core.R7$(3),fesm2022_core.Y8G("formId",ctx.formId)("formModel",ctx.formModel)("formGroup",ctx.formGroup)("formLayout",ctx.formLayout)("displayCancel",!1)("submitLabel",ctx.submitLabel),fesm2022_core.R7$(4),fesm2022_core.SpI(" ",fesm2022_core.bMT(11,15,ctx.messagePrefix+".return")," "),fesm2022_core.R7$(2),fesm2022_core.vxM(ctx.displayResetPassword?12:-1),fesm2022_core.R7$(),fesm2022_core.vxM(fesm2022_core.bMT(14,17,ctx.canImpersonate$)?13:-1),fesm2022_core.R7$(2),fesm2022_core.vxM(fesm2022_core.bMT(16,19,ctx.canDelete$)?15:-1),fesm2022_core.R7$(2),fesm2022_core.vxM(ctx.formGroup?-1:17),fesm2022_core.R7$(),fesm2022_core.vxM(fesm2022_core.bMT(19,21,ctx.activeEPerson$)?18:-1))},dependencies:[common.Jj,btn_disabled_directive.A,form_component.s,has_no_value_pipe.n,pagination_component.e,router.Wk,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return EPersonFormComponent2})();var resolver_actions=__webpack_require__(14998),ngrx_store=__webpack_require__(22609);const EPERSON_EDIT_FOLLOW_LINKS=[(0,follow_link_config_model.s)("groups")];let EPersonResolver=(()=>{class EPersonResolver2{constructor(ePersonService,store){this.ePersonService=ePersonService,this.store=store}resolve(route,state){const ePersonRD$=this.ePersonService.findById(route.params.id,!0,!1,...EPERSON_EDIT_FOLLOW_LINKS).pipe((0,shared_operators.qD)());return ePersonRD$.subscribe(ePersonRD=>{this.store.dispatch(new resolver_actions.j(state.url,ePersonRD.payload))}),ePersonRD$}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EPersonResolver2)(fesm2022_core.KVO(eperson_data_service.EPersonDataService),fesm2022_core.KVO(ngrx_store.il))}}static{this.\u0275prov=fesm2022_core.jDH({token:EPersonResolver2,factory:EPersonResolver2.\u0275fac,providedIn:"root"})}}return EPersonResolver2})();var environment=__webpack_require__(64369),collection_page_routing_paths=__webpack_require__(35408),community_page_routing_paths=__webpack_require__(92064),dspace_object_data_service=__webpack_require__(98944),group_model=__webpack_require__(38435),collection_model=__webpack_require__(70652),community_model=__webpack_require__(36541),alert_component=__webpack_require__(6213),alert_type=__webpack_require__(83113),context_help_directive=__webpack_require__(80321),members_list_component=__webpack_require__(6341);const subgroups_list_component_c0=()=>["top","right","bottom"],subgroups_list_component_c1=a0=>({content:"admin.access-control.groups.form.tooltip.editGroup.addSubgroups",id:"edit-group-add-subgroups",iconPlacement:"right",tooltipPlacement:a0}),subgroups_list_component_c2=a0=>[a0],_c3=a0=>({name:a0});function SubgroupsListComponent_Conditional_7_For_20_Template(rf,ctx){if(1&rf){const _r1=fesm2022_core.RV6();fesm2022_core.j41(0,"tr")(1,"td",16),fesm2022_core.EFF(2),fesm2022_core.k0s(),fesm2022_core.j41(3,"td",16)(4,"a",17),fesm2022_core.bIt("click",function(){const group_r2=fesm2022_core.eBV(_r1).$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.groupDataService.startEditingNewGroup(group_r2))}),fesm2022_core.EFF(5),fesm2022_core.k0s()(),fesm2022_core.j41(6,"td",16),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"async"),fesm2022_core.k0s(),fesm2022_core.j41(9,"td",16)(10,"div",18)(11,"button",19),fesm2022_core.nI1(12,"translate"),fesm2022_core.bIt("click",function(){const group_r2=fesm2022_core.eBV(_r1).$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.deleteSubgroupFromGroup(group_r2))}),fesm2022_core.nrm(13,"i",20),fesm2022_core.k0s()()()()}if(2&rf){let tmp_14_0;const group_r2=ctx.$implicit,ctx_r2=fesm2022_core.XpG(2);fesm2022_core.R7$(2),fesm2022_core.JRh(group_r2.id),fesm2022_core.R7$(2),fesm2022_core.Y8G("routerLink",fesm2022_core.eq3(10,subgroups_list_component_c2,ctx_r2.groupDataService.getGroupEditPageRouterLink(group_r2))),fesm2022_core.R7$(),fesm2022_core.SpI(" ",ctx_r2.dsoNameService.getName(group_r2)," "),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r2.dsoNameService.getName(null==(tmp_14_0=fesm2022_core.bMT(8,5,group_r2.object))?null:tmp_14_0.payload)),fesm2022_core.R7$(4),fesm2022_core.FS9("title",fesm2022_core.i5U(12,7,ctx_r2.messagePrefix+".table.edit.buttons.remove",fesm2022_core.eq3(12,_c3,ctx_r2.dsoNameService.getName(group_r2))))}}function SubgroupsListComponent_Conditional_7_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ds-pagination",1),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"div",13)(3,"table",14)(4,"thead")(5,"tr")(6,"th",15),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",15),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",15),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(15,"th"),fesm2022_core.EFF(16),fesm2022_core.nI1(17,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(18,"tbody"),fesm2022_core.Z7z(19,SubgroupsListComponent_Conditional_7_For_20_Template,14,14,"tr",null,fesm2022_core.fX1),fesm2022_core.nI1(21,"async"),fesm2022_core.k0s()()()()),2&rf){let tmp_2_0,tmp_9_0;const ctx_r2=fesm2022_core.XpG();fesm2022_core.Y8G("paginationOptions",ctx_r2.config)("collectionSize",null==(tmp_2_0=fesm2022_core.bMT(1,8,ctx_r2.subGroups$))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,10,ctx_r2.messagePrefix+".table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,12,ctx_r2.messagePrefix+".table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,14,ctx_r2.messagePrefix+".table.collectionOrCommunity")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(17,16,ctx_r2.messagePrefix+".table.edit")),fesm2022_core.R7$(3),fesm2022_core.Dyx(null==(tmp_9_0=fesm2022_core.bMT(21,18,ctx_r2.subGroups$))||null==tmp_9_0.payload?null:tmp_9_0.payload.page)}}function SubgroupsListComponent_Conditional_9_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",2),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r2=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r2.messagePrefix+".no-subgroups-yet")," ")}}function SubgroupsListComponent_span_12_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"span"),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r2=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r2.messagePrefix+".search.head")," ")}}function SubgroupsListComponent_Conditional_26_For_20_Template(rf,ctx){if(1&rf){const _r4=fesm2022_core.RV6();fesm2022_core.j41(0,"tr")(1,"td",16),fesm2022_core.EFF(2),fesm2022_core.k0s(),fesm2022_core.j41(3,"td",16)(4,"a",17),fesm2022_core.bIt("click",function(){const group_r5=fesm2022_core.eBV(_r4).$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.groupDataService.startEditingNewGroup(group_r5))}),fesm2022_core.EFF(5),fesm2022_core.k0s()(),fesm2022_core.j41(6,"td",16),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"async"),fesm2022_core.k0s(),fesm2022_core.j41(9,"td",16)(10,"div",18)(11,"button",22),fesm2022_core.nI1(12,"translate"),fesm2022_core.bIt("click",function(){const group_r5=fesm2022_core.eBV(_r4).$implicit,ctx_r2=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r2.addSubgroupToGroup(group_r5))}),fesm2022_core.nrm(13,"i",23),fesm2022_core.k0s()()()()}if(2&rf){let tmp_14_0;const group_r5=ctx.$implicit,ctx_r2=fesm2022_core.XpG(2);fesm2022_core.R7$(2),fesm2022_core.JRh(group_r5.id),fesm2022_core.R7$(2),fesm2022_core.Y8G("routerLink",fesm2022_core.eq3(10,subgroups_list_component_c2,ctx_r2.groupDataService.getGroupEditPageRouterLink(group_r5))),fesm2022_core.R7$(),fesm2022_core.SpI(" ",ctx_r2.dsoNameService.getName(group_r5)," "),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r2.dsoNameService.getName(null==(tmp_14_0=fesm2022_core.bMT(8,5,group_r5.object))?null:tmp_14_0.payload)),fesm2022_core.R7$(4),fesm2022_core.FS9("title",fesm2022_core.i5U(12,7,ctx_r2.messagePrefix+".table.edit.buttons.add",fesm2022_core.eq3(12,_c3,ctx_r2.dsoNameService.getName(group_r5))))}}function SubgroupsListComponent_Conditional_26_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ds-pagination",1),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"div",13)(3,"table",21)(4,"thead")(5,"tr")(6,"th",15),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",15),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",15),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(15,"th",16),fesm2022_core.EFF(16),fesm2022_core.nI1(17,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(18,"tbody"),fesm2022_core.Z7z(19,SubgroupsListComponent_Conditional_26_For_20_Template,14,14,"tr",null,fesm2022_core.fX1),fesm2022_core.nI1(21,"async"),fesm2022_core.k0s()()()()),2&rf){let tmp_2_0,tmp_9_0;const ctx_r2=fesm2022_core.XpG();fesm2022_core.Y8G("paginationOptions",ctx_r2.configSearch)("collectionSize",null==(tmp_2_0=fesm2022_core.bMT(1,8,ctx_r2.searchResults$))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,10,ctx_r2.messagePrefix+".table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,12,ctx_r2.messagePrefix+".table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,14,ctx_r2.messagePrefix+".table.collectionOrCommunity")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(17,16,ctx_r2.messagePrefix+".table.edit")),fesm2022_core.R7$(3),fesm2022_core.Dyx(null==(tmp_9_0=fesm2022_core.bMT(21,18,ctx_r2.searchResults$))||null==tmp_9_0.payload?null:tmp_9_0.payload.page)}}function SubgroupsListComponent_Conditional_28_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",2),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r2=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r2.messagePrefix+".no-items")," ")}}var SubKey=function(SubKey2){return SubKey2[SubKey2.Members=0]="Members",SubKey2[SubKey2.ActiveGroup=1]="ActiveGroup",SubKey2[SubKey2.SearchResults=2]="SearchResults",SubKey2}(SubKey||{});let SubgroupsListComponent=(()=>{class SubgroupsListComponent2{constructor(groupDataService,translateService,notificationsService,formBuilder,paginationService,router2,dsoNameService){this.groupDataService=groupDataService,this.translateService=translateService,this.notificationsService=notificationsService,this.formBuilder=formBuilder,this.paginationService=paginationService,this.router=router2,this.dsoNameService=dsoNameService,this.searchResults$=new cjs.BehaviorSubject(void 0),this.subGroups$=new cjs.BehaviorSubject(void 0),this.subs=new Map,this.configSearch=Object.assign(new pagination_component_options_model.W,{id:"ssgl",pageSize:5,currentPage:1}),this.config=Object.assign(new pagination_component_options_model.W,{id:"sgl",pageSize:5,currentPage:1}),this.currentSearchQuery=""}ngOnInit(){this.searchForm=this.formBuilder.group({query:""}),this.subs.set(SubKey.ActiveGroup,this.groupDataService.getActiveGroup().subscribe(activeGroup=>{null!=activeGroup&&(this.groupBeingEdited=activeGroup,this.retrieveSubGroups(),this.search({query:""}))})),this.subGroupsPageInfoState$=this.subGroups$.pipe((0,operators.Tj)(subGroupsRD=>subGroupsRD?.payload?.pageInfo))}retrieveSubGroups(){this.unsubFrom(SubKey.Members),this.subs.set(SubKey.Members,this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.nx)(config=>this.groupDataService.findListByHref(this.groupBeingEdited._links.subgroups.href,{currentPage:config.currentPage,elementsPerPage:config.pageSize},!0,!0,(0,follow_link_config_model.s)("object")))).subscribe(rd=>{this.subGroups$.next(rd)}))}deleteSubgroupFromGroup(subgroup){this.groupDataService.getActiveGroup().pipe((0,operators.s)(1)).subscribe(activeGroup=>{if(null!=activeGroup){const response=this.groupDataService.deleteSubGroupFromGroup(activeGroup,subgroup);this.showNotifications("deleteSubgroup",response,this.dsoNameService.getName(subgroup),activeGroup),null!=this.currentSearchQuery&&this.search({query:this.currentSearchQuery})}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}addSubgroupToGroup(subgroup){this.groupDataService.getActiveGroup().pipe((0,operators.s)(1)).subscribe(activeGroup=>{if(null!=activeGroup)if(activeGroup.uuid!==subgroup.uuid){const response=this.groupDataService.addSubGroupToGroup(activeGroup,subgroup);this.showNotifications("addSubgroup",response,this.dsoNameService.getName(subgroup),activeGroup),null!=this.currentSearchQuery&&this.search({query:this.currentSearchQuery})}else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.subgroupToAddIsActiveGroup"));else this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure.noActiveGroup"))})}search(data){this.unsubFrom(SubKey.SearchResults),this.subs.set(SubKey.SearchResults,this.paginationService.getCurrentPagination(this.configSearch.id,this.configSearch).pipe((0,operators.nx)(paginationOptions=>{const query=data.query;return null!=query&&this.currentSearchQuery!==query&&this.groupBeingEdited&&(this.currentSearchQuery=query,this.paginationService.resetPage(this.configSearch.id)),this.searchDone=!0,this.groupDataService.searchNonMemberGroups(this.currentSearchQuery,this.groupBeingEdited.id,{currentPage:paginationOptions.currentPage,elementsPerPage:paginationOptions.pageSize},!1,!0,(0,follow_link_config_model.s)("object"))}),(0,shared_operators.bD)(),(0,operators.Tj)(rd=>{if(!rd.hasFailed)return rd;this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure",{cause:rd.errorMessage}))})).subscribe(rd=>{this.searchResults$.next(rd)}))}unsubFrom(key){this.subs.has(key)&&(this.subs.get(key).unsubscribe(),this.subs.delete(key))}ngOnDestroy(){for(const key of this.subs.keys())this.unsubFrom(key);this.paginationService.clearPagination(this.config.id),this.paginationService.clearPagination(this.configSearch.id)}showNotifications(messageSuffix,response,nameObject,activeGroup){response.pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.success."+messageSuffix,{name:nameObject})),this.groupDataService.clearGroupLinkRequests(activeGroup._links.subgroups.href)):this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.failure."+messageSuffix,{name:nameObject}))})}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||SubgroupsListComponent2)(fesm2022_core.rXU(group_data_service.GroupDataService),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(fesm2022_forms.ze),fesm2022_core.rXU(pagination_service.m),fesm2022_core.rXU(router.Ix),fesm2022_core.rXU(dso_name_service.f))}}static{this.\u0275cmp=fesm2022_core.VBU({type:SubgroupsListComponent2,selectors:[["ds-subgroups-list"]],inputs:{messagePrefix:"messagePrefix"},standalone:!0,features:[fesm2022_core.aNF],decls:30,vars:29,consts:[[1,"border-bottom","pb-2"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],["id","search",1,"border-bottom","pb-2"],[4,"dsContextHelp"],[1,"d-flex","justify-content-between",3,"ngSubmit","formGroup"],[1,"flex-grow-1","me-3"],[1,"mb-3","input-group","me-3"],["type","text","name","query","id","query","formControlName","query","aria-label","Search input",1,"form-control"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary","float-end",3,"click"],[1,"table-responsive"],["id","subgroupsOfGroup",1,"table","table-striped","table-hover","table-bordered"],["scope","col",1,"align-middle"],[1,"align-middle"],[3,"click","routerLink"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-danger","btn-sm","deleteButton",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"],["id","groupsSearch",1,"table","table-striped","table-hover","table-bordered"],[1,"btn","btn-outline-primary","btn-sm","addButton",3,"click","title"],[1,"fas","fa-plus","fa-fw"]],template:function(rf,ctx){if(1&rf&&(fesm2022_core.qex(0),fesm2022_core.j41(1,"h3",0),fesm2022_core.EFF(2),fesm2022_core.nI1(3,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(4,"h4"),fesm2022_core.EFF(5),fesm2022_core.nI1(6,"translate"),fesm2022_core.k0s(),fesm2022_core.DNE(7,SubgroupsListComponent_Conditional_7_Template,22,20,"ds-pagination",1),fesm2022_core.nI1(8,"async"),fesm2022_core.DNE(9,SubgroupsListComponent_Conditional_9_Template,3,3,"div",2),fesm2022_core.nI1(10,"async"),fesm2022_core.j41(11,"h4",3),fesm2022_core.DNE(12,SubgroupsListComponent_span_12_Template,3,3,"span",4),fesm2022_core.k0s(),fesm2022_core.j41(13,"form",5),fesm2022_core.bIt("ngSubmit",function(){return ctx.search(ctx.searchForm.value)}),fesm2022_core.j41(14,"div",6)(15,"div",7),fesm2022_core.nrm(16,"input",8),fesm2022_core.j41(17,"span",9)(18,"button",10),fesm2022_core.nrm(19,"i",11),fesm2022_core.EFF(20),fesm2022_core.nI1(21,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(22,"div")(23,"button",12),fesm2022_core.bIt("click",function(){return ctx.clearFormAndResetResult()}),fesm2022_core.EFF(24),fesm2022_core.nI1(25,"translate"),fesm2022_core.k0s()()(),fesm2022_core.DNE(26,SubgroupsListComponent_Conditional_26_Template,22,20,"ds-pagination",1),fesm2022_core.nI1(27,"async"),fesm2022_core.DNE(28,SubgroupsListComponent_Conditional_28_Template,3,3,"div",2),fesm2022_core.nI1(29,"async"),fesm2022_core.bVm()),2&rf){let tmp_2_0,tmp_3_0,tmp_8_0,tmp_9_0;fesm2022_core.R7$(2),fesm2022_core.JRh(fesm2022_core.bMT(3,10,ctx.messagePrefix+".head")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(6,12,ctx.messagePrefix+".headSubgroups")),fesm2022_core.R7$(2),fesm2022_core.vxM((null==(tmp_2_0=fesm2022_core.bMT(8,14,ctx.subGroups$))||null==tmp_2_0.payload?null:tmp_2_0.payload.totalElements)>0?7:-1),fesm2022_core.R7$(2),fesm2022_core.vxM(0===(null==(tmp_3_0=fesm2022_core.bMT(10,16,ctx.subGroups$))||null==tmp_3_0.payload?null:tmp_3_0.payload.totalElements)?9:-1),fesm2022_core.R7$(3),fesm2022_core.Y8G("dsContextHelp",fesm2022_core.eq3(27,subgroups_list_component_c1,fesm2022_core.lJ4(26,subgroups_list_component_c0))),fesm2022_core.R7$(),fesm2022_core.Y8G("formGroup",ctx.searchForm),fesm2022_core.R7$(7),fesm2022_core.SpI(" ",fesm2022_core.bMT(21,18,ctx.messagePrefix+".search.button")," "),fesm2022_core.R7$(4),fesm2022_core.SpI(" ",fesm2022_core.bMT(25,20,ctx.messagePrefix+".button.see-all")," "),fesm2022_core.R7$(2),fesm2022_core.vxM((null==(tmp_8_0=fesm2022_core.bMT(27,22,ctx.searchResults$))||null==tmp_8_0.payload?null:tmp_8_0.payload.totalElements)>0?26:-1),fesm2022_core.R7$(2),fesm2022_core.vxM(0===(null==(tmp_9_0=fesm2022_core.bMT(29,24,ctx.searchResults$))||null==tmp_9_0.payload?null:tmp_9_0.payload.totalElements)&&ctx.searchDone?28:-1)}},dependencies:[common.Jj,context_help_directive.G,pagination_component.e,fesm2022_forms.X1,fesm2022_forms.qT,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return SubgroupsListComponent2})();class ValidateGroupExists{static createValidator(groupDataService){return control=>groupDataService.searchGroups(control.value,{currentPage:1,elementsPerPage:100}).pipe((0,shared_operators.Ar)(),(0,operators.Tj)(groups=>groups.filter(group=>group.name===control.value)),(0,operators.Tj)(groups=>groups.length>0?{groupExists:!0}:null))}}const group_form_component_c0=()=>["right","bottom"],group_form_component_c1=a0=>({content:"admin.access-control.groups.form.tooltip.editGroupPage",id:"edit-group-page",iconPlacement:"right",tooltipPlacement:a0}),group_form_component_c2=(a0,a1,a2)=>({name:a0,comcol:a1,comcolEditRolesRoute:a2});function GroupFormComponent_Conditional_3_span_1_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"span"),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r0=fesm2022_core.XpG(2);fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r0.messagePrefix+".head.edit")," ")}}function GroupFormComponent_Conditional_3_Template(rf,ctx){1&rf&&(fesm2022_core.j41(0,"h1",3),fesm2022_core.DNE(1,GroupFormComponent_Conditional_3_span_1_Template,3,3,"span",9),fesm2022_core.k0s()),2&rf&&(fesm2022_core.R7$(),fesm2022_core.Y8G("dsContextHelp",fesm2022_core.eq3(2,group_form_component_c1,fesm2022_core.lJ4(1,group_form_component_c0))))}function GroupFormComponent_Conditional_5_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"h1",3),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r0=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.JRh(fesm2022_core.bMT(2,1,ctx_r0.messagePrefix+".head.create"))}}function GroupFormComponent_Conditional_6_Conditional_0_Template(rf,ctx){if(1&rf&&fesm2022_core.nrm(0,"ds-alert",10),2&rf){const ctx_r0=fesm2022_core.XpG(2);fesm2022_core.Y8G("type",ctx_r0.AlertType.Warning)("content",ctx_r0.messagePrefix+".alert.permanent")}}function GroupFormComponent_Conditional_6_Conditional_1_Conditional_0_Template(rf,ctx){if(1&rf&&(fesm2022_core.nrm(0,"ds-alert",10),fesm2022_core.nI1(1,"async"),fesm2022_core.nI1(2,"translate")),2&rf){const activeGroupLinkedDSO_r2=fesm2022_core.XpG(),ctx_r0=fesm2022_core.XpG(2);fesm2022_core.Y8G("type",ctx_r0.AlertType.Warning)("content",fesm2022_core.i5U(2,4,ctx_r0.messagePrefix+".alert.workflowGroup",fesm2022_core.sMw(7,group_form_component_c2,ctx_r0.dsoNameService.getName(activeGroupLinkedDSO_r2),activeGroupLinkedDSO_r2.type,fesm2022_core.bMT(1,2,ctx_r0.linkedEditRolesRoute$))))}}function GroupFormComponent_Conditional_6_Conditional_1_Template(rf,ctx){if(1&rf&&(fesm2022_core.DNE(0,GroupFormComponent_Conditional_6_Conditional_1_Conditional_0_Template,3,11,"ds-alert",10),fesm2022_core.nI1(1,"async")),2&rf){const ctx_r0=fesm2022_core.XpG(2);fesm2022_core.vxM(!0!==fesm2022_core.bMT(1,1,ctx_r0.canEdit$)?0:-1)}}function GroupFormComponent_Conditional_6_Template(rf,ctx){if(1&rf&&(fesm2022_core.DNE(0,GroupFormComponent_Conditional_6_Conditional_0_Template,1,2,"ds-alert",10)(1,GroupFormComponent_Conditional_6_Conditional_1_Template,2,3),fesm2022_core.nI1(2,"async")),2&rf){let tmp_3_0;const groupBeingEdited_r3=ctx,ctx_r0=fesm2022_core.XpG();fesm2022_core.vxM(null!=groupBeingEdited_r3&&groupBeingEdited_r3.permanent?0:-1),fesm2022_core.R7$(),fesm2022_core.vxM((tmp_3_0=fesm2022_core.bMT(2,2,ctx_r0.activeGroupLinkedDSO$))?1:-1,tmp_3_0)}}function GroupFormComponent_Conditional_14_Template(rf,ctx){if(1&rf){const _r4=fesm2022_core.RV6();fesm2022_core.j41(0,"div",8)(1,"button",11),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r4);const ctx_r0=fesm2022_core.XpG();return fesm2022_core.Njj(ctx_r0.delete())}),fesm2022_core.nrm(2,"i",12),fesm2022_core.EFF(3),fesm2022_core.nI1(4,"translate"),fesm2022_core.k0s()()}if(2&rf){const ctx_r0=fesm2022_core.XpG();fesm2022_core.R7$(3),fesm2022_core.SpI(" ",fesm2022_core.bMT(4,1,ctx_r0.messagePrefix+".actions.delete")," ")}}function GroupFormComponent_Conditional_17_Conditional_1_Template(rf,ctx){if(1&rf&&fesm2022_core.nrm(0,"ds-members-list",14),2&rf){const ctx_r0=fesm2022_core.XpG(2);fesm2022_core.Y8G("messagePrefix",ctx_r0.messagePrefix+".members-list")}}function GroupFormComponent_Conditional_17_Conditional_2_Template(rf,ctx){if(1&rf&&fesm2022_core.nrm(0,"ds-subgroups-list",14),2&rf){const ctx_r0=fesm2022_core.XpG(2);fesm2022_core.Y8G("messagePrefix",ctx_r0.messagePrefix+".subgroups-list")}}function GroupFormComponent_Conditional_17_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",13),fesm2022_core.DNE(1,GroupFormComponent_Conditional_17_Conditional_1_Template,1,1,"ds-members-list",14),fesm2022_core.k0s(),fesm2022_core.DNE(2,GroupFormComponent_Conditional_17_Conditional_2_Template,1,1,"ds-subgroups-list",14)),2&rf){const groupBeingEdited_r5=ctx;fesm2022_core.R7$(),fesm2022_core.vxM(void 0!==groupBeingEdited_r5?1:-1),fesm2022_core.R7$(),fesm2022_core.vxM(void 0!==groupBeingEdited_r5?2:-1)}}let GroupFormComponent=(()=>{class GroupFormComponent2{constructor(groupDataService,dSpaceObjectDataService,formBuilderService,translateService,notificationsService,route,router2,authorizationService,modalService,requestService,changeDetectorRef,dsoNameService){this.groupDataService=groupDataService,this.dSpaceObjectDataService=dSpaceObjectDataService,this.formBuilderService=formBuilderService,this.translateService=translateService,this.notificationsService=notificationsService,this.route=route,this.router=router2,this.authorizationService=authorizationService,this.modalService=modalService,this.requestService=requestService,this.changeDetectorRef=changeDetectorRef,this.dsoNameService=dsoNameService,this.messagePrefix="admin.access-control.groups.form",this.formId="group-form",this.formLayout={groupName:{grid:{host:"row"}},groupDescription:{grid:{host:"row"}}},this.submitForm=new fesm2022_core.bkB,this.cancelForm=new fesm2022_core.bkB,this.subs=[],this.AlertType=alert_type.v}ngOnInit(){"newGroup"!==this.route.snapshot.params.groupId&&this.setActiveGroup(this.route.snapshot.params.groupId),this.activeGroup$=this.groupDataService.getActiveGroup(),this.activeGroupLinkedDSO$=this.getActiveGroupLinkedDSO(),this.linkedEditRolesRoute$=this.getLinkedEditRolesRoute(),this.canEdit$=this.activeGroupLinkedDSO$.pipe((0,operators.nx)(dso=>(0,empty_util.a4)(dso)?[!1]:this.activeGroup$.pipe((0,empty_util.Az)(),(0,operators.nx)(group=>this.authorizationService.isAuthorized(feature_id._.CanDelete,group.self))))),this.initialisePage()}initialisePage(){const groupNameModel=new core.rA_({id:"groupName",label:this.translateService.instant(`${this.messagePrefix}.groupName`),name:"groupName",validators:{required:null},required:!0}),groupCommunityModel=new core.rA_({id:"groupCommunity",label:this.translateService.instant(`${this.messagePrefix}.groupCommunity`),name:"groupCommunity",required:!1,readOnly:!0}),groupDescriptionModel=new core.Zex({id:"groupDescription",label:this.translateService.instant(`${this.messagePrefix}.groupDescription`),name:"groupDescription",required:!1,spellCheck:environment.c.form.spellCheck});this.formModel=[groupNameModel,groupDescriptionModel],this.formGroup=this.formBuilderService.createFormGroup(this.formModel),this.groupName=this.formGroup.get("groupName"),this.groupDescription=this.formGroup.get("groupDescription"),(0,empty_util.a4)(this.groupName)&&(this.groupName.setAsyncValidators(ValidateGroupExists.createValidator(this.groupDataService)),this.groupNameValueChangeSubscribe=this.groupName.valueChanges.pipe((0,operators.BL)(300)).subscribe(()=>{this.changeDetectorRef.detectChanges()})),this.subs.push((0,cjs.combineLatest)([this.activeGroup$,this.canEdit$,this.activeGroupLinkedDSO$]).subscribe(([activeGroup,canEdit,linkedObject])=>{null!=activeGroup&&(this.formGroup.controls.groupName.clearAsyncValidators(),(0,empty_util.hj)(linkedObject?.name)?(this.formGroup.controls.groupCommunity||(this.formBuilderService.insertFormGroupControl(1,this.formGroup,this.formModel,groupCommunityModel),this.groupDescription=this.formGroup.get("groupCommunity")),this.formGroup.patchValue({groupName:activeGroup.name,groupCommunity:linkedObject?.name??"",groupDescription:activeGroup.firstMetadataValue("dc.description")})):(this.formModel=[groupNameModel,groupDescriptionModel],this.formGroup.patchValue({groupName:activeGroup.name,groupDescription:activeGroup.firstMetadataValue("dc.description")})),!canEdit||activeGroup.permanent?this.formGroup.disable():this.formGroup.enable())}))}onCancel(){this.groupDataService.cancelEditGroup(),this.cancelForm.emit(),this.router.navigate([(0,access_control_routing_paths.mK)()])}onSubmit(){this.activeGroup$.pipe((0,operators.s)(1)).subscribe(group=>{null===group?this.createNewGroup({name:this.groupName.value,metadata:{"dc.description":[{value:this.groupDescription.value}]}}):this.editGroup(group)})}createNewGroup(values){const groupToCreate=Object.assign(new group_model.Y,values);this.groupDataService.create(groupToCreate).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.created.success",{name:groupToCreate.name})),this.submitForm.emit(groupToCreate),(0,empty_util.hj)(rd.payload)&&(this.setActiveGroupWithLink(rd.payload._links.self.href),this.groupDataService.clearGroupsRequests(),this.router.navigateByUrl((0,access_control_routing_paths.xl)(rd.payload.uuid)))):(this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.created.failure",{name:groupToCreate.name})),this.showNotificationIfNameInUse(groupToCreate,"created"),this.cancelForm.emit())})}showNotificationIfNameInUse(group,notificationSection){this.subs.push(this.groupDataService.searchGroups(group.name,{currentPage:1,elementsPerPage:0}).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(list=>{list.totalElements>0&&this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification."+notificationSection+".failure.groupNameInUse",{name:this.dsoNameService.getName(group)}))}))}editGroup(group){let operations=[];(0,empty_util.a4)(this.groupDescription.value)&&(operations=[...operations,{op:"add",path:"/metadata/dc.description",value:this.groupDescription.value}]),(0,empty_util.a4)(this.groupName.value)&&(operations=[...operations,{op:"replace",path:"/name",value:this.groupName.value}]),this.groupDataService.patch(group,operations).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.edited.success",{name:this.dsoNameService.getName(rd.payload)})),this.submitForm.emit(rd.payload)):(this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.edited.failure",{name:this.dsoNameService.getName(group)})),this.cancelForm.emit())})}setActiveGroup(groupId){this.groupDataService.cancelEditGroup(),this.groupDataService.findById(groupId).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(group=>{this.groupDataService.editGroup(group)})}setActiveGroupWithLink(groupSelfLink){this.activeGroup$.pipe((0,operators.s)(1)).subscribe(activeGroup=>{null===activeGroup&&(this.groupDataService.cancelEditGroup(),this.groupDataService.findByHref(groupSelfLink,!1,!1,(0,follow_link_config_model.s)("subgroups"),(0,follow_link_config_model.s)("epersons"),(0,follow_link_config_model.s)("object")).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(group=>{this.groupDataService.editGroup(group)}))})}delete(){this.activeGroup$.pipe((0,operators.s)(1)).subscribe(group=>{const modalRef=this.modalService.open(confirmation_modal_component.M);modalRef.componentInstance.name=this.dsoNameService.getName(group),modalRef.componentInstance.headerLabel=this.messagePrefix+".delete-group.modal.header",modalRef.componentInstance.infoLabel=this.messagePrefix+".delete-group.modal.info",modalRef.componentInstance.cancelLabel=this.messagePrefix+".delete-group.modal.cancel",modalRef.componentInstance.confirmLabel=this.messagePrefix+".delete-group.modal.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash",modalRef.componentInstance.response.pipe((0,operators.s)(1)).subscribe(confirm=>{confirm&&(0,empty_util.a4)(group.id)&&this.groupDataService.delete(group.id).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get(this.messagePrefix+".notification.deleted.success",{name:this.dsoNameService.getName(group)})),this.onCancel()):this.notificationsService.error(this.translateService.get(this.messagePrefix+".notification.deleted.failure.title",{name:this.dsoNameService.getName(group)}),this.translateService.get(this.messagePrefix+".notification.deleted.failure.content",{cause:rd.errorMessage}))})})})}ngOnDestroy(){this.groupDataService.cancelEditGroup(),this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe()),(0,empty_util.a4)(this.groupNameValueChangeSubscribe)&&this.groupNameValueChangeSubscribe.unsubscribe()}getActiveGroupLinkedDSO(){return this.activeGroup$.pipe((0,empty_util.Az)(),(0,operators.nx)(group=>void 0===group.object?this.dSpaceObjectDataService.findByHref(group._links.object.href):group.object),(0,shared_operators.bD)(),(0,shared_operators.Bo)())}getLinkedEditRolesRoute(){return this.activeGroupLinkedDSO$.pipe((0,empty_util.Az)(),(0,operators.Tj)(dso=>{switch(dso.type){case community_model.E.type.value:return(0,community_page_routing_paths.EU)(dso.id);case collection_model.p.type.value:return(0,collection_page_routing_paths.BW)(dso.id)}}))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||GroupFormComponent2)(fesm2022_core.rXU(group_data_service.GroupDataService),fesm2022_core.rXU(dspace_object_data_service.DSpaceObjectDataService),fesm2022_core.rXU(form_builder_service.j),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(router.nX),fesm2022_core.rXU(router.Ix),fesm2022_core.rXU(authorization_data_service.AuthorizationDataService),fesm2022_core.rXU(ng_bootstrap.Bq),fesm2022_core.rXU(request_service.B),fesm2022_core.rXU(fesm2022_core.gRc),fesm2022_core.rXU(dso_name_service.f))}}static{this.\u0275cmp=fesm2022_core.VBU({type:GroupFormComponent2,selectors:[["ds-group-form"]],hostBindings:function(rf,ctx){1&rf&&fesm2022_core.bIt("beforeunload",function(){return ctx.ngOnDestroy()},!1,fesm2022_core.tSv)},outputs:{submitForm:"submitForm",cancelForm:"cancelForm"},standalone:!0,features:[fesm2022_core.aNF],decls:19,vars:22,consts:[[1,"container"],[1,"group-form","row"],[1,"col-12"],[1,"border-bottom","pb-2"],[3,"submitForm","formId","formModel","formGroup","formLayout","displayCancel"],["before","",1,"btn-group"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["after","",1,"btn-group"],[4,"dsContextHelp"],[3,"type","content"],["type","button",1,"btn","btn-danger","delete-button",3,"click"],[1,"fa","fa-trash"],[1,"mb-5"],[3,"messagePrefix"]],template:function(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",0)(1,"div",1)(2,"div",2),fesm2022_core.DNE(3,GroupFormComponent_Conditional_3_Template,2,4,"h1",3),fesm2022_core.nI1(4,"async"),fesm2022_core.DNE(5,GroupFormComponent_Conditional_5_Template,3,3,"h1",3)(6,GroupFormComponent_Conditional_6_Template,3,4),fesm2022_core.nI1(7,"async"),fesm2022_core.j41(8,"ds-form",4),fesm2022_core.bIt("submitForm",function(){return ctx.onSubmit()}),fesm2022_core.j41(9,"div",5)(10,"button",6),fesm2022_core.bIt("click",function(){return ctx.onCancel()}),fesm2022_core.nrm(11,"i",7),fesm2022_core.EFF(12),fesm2022_core.nI1(13,"translate"),fesm2022_core.k0s()(),fesm2022_core.DNE(14,GroupFormComponent_Conditional_14_Template,5,3,"div",8),fesm2022_core.nI1(15,"async"),fesm2022_core.nI1(16,"async"),fesm2022_core.k0s(),fesm2022_core.DNE(17,GroupFormComponent_Conditional_17_Template,3,2),fesm2022_core.nI1(18,"async"),fesm2022_core.k0s()()()),2&rf){let tmp_1_0,tmp_8_0,tmp_9_0;fesm2022_core.R7$(3),fesm2022_core.vxM(fesm2022_core.bMT(4,10,ctx.activeGroup$)?3:5),fesm2022_core.R7$(3),fesm2022_core.vxM((tmp_1_0=fesm2022_core.bMT(7,12,ctx.activeGroup$))?6:-1,tmp_1_0),fesm2022_core.R7$(2),fesm2022_core.Y8G("formId",ctx.formId)("formModel",ctx.formModel)("formGroup",ctx.formGroup)("formLayout",ctx.formLayout)("displayCancel",!1),fesm2022_core.R7$(4),fesm2022_core.SpI(" ",fesm2022_core.bMT(13,14,ctx.messagePrefix+".return"),""),fesm2022_core.R7$(2),fesm2022_core.vxM(!fesm2022_core.bMT(15,16,ctx.canEdit$)||null!=(tmp_8_0=fesm2022_core.bMT(16,18,ctx.activeGroup$))&&tmp_8_0.permanent?-1:14),fesm2022_core.R7$(3),fesm2022_core.vxM((tmp_9_0=fesm2022_core.bMT(18,20,ctx.activeGroup$))?17:-1,tmp_9_0)}},dependencies:[alert_component.C,common.Jj,context_help_directive.G,form_component.s,members_list_component.v,SubgroupsListComponent,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return GroupFormComponent2})();var some_feature_authorization_guard=__webpack_require__(52884),hal_endpoint_service=__webpack_require__(26139);const defaultGroupPageGetObjectUrl=(route,state)=>(0,fesm2022_core.WQX)(hal_endpoint_service.Y).getEndpoint("groups").pipe((0,operators.Tj)(groupsUrl=>`${groupsUrl}/${route?.params?.groupId}`));class GroupDtoModel{}var route_service=__webpack_require__(87964);const groups_registry_component_c0=a0=>({name:a0});function GroupsRegistryComponent_Conditional_31_Template(rf,ctx){1&rf&&fesm2022_core.nrm(0,"ds-loading")}function GroupsRegistryComponent_Conditional_33_For_23_Case_12_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"button",23),fesm2022_core.nI1(1,"translate"),fesm2022_core.nrm(2,"i",26),fesm2022_core.k0s()),2&rf){const groupDto_r1=fesm2022_core.XpG().$implicit,ctx_r1=fesm2022_core.XpG(2);fesm2022_core.FS9("title",fesm2022_core.i5U(1,2,ctx_r1.messagePrefix+"table.edit.buttons.edit",fesm2022_core.eq3(5,groups_registry_component_c0,ctx_r1.dsoNameService.getName(groupDto_r1.group)))),fesm2022_core.Y8G("routerLink",ctx_r1.groupService.getGroupEditPageRouterLink(groupDto_r1.group))}}function GroupsRegistryComponent_Conditional_33_For_23_Case_13_Template(rf,ctx){1&rf&&(fesm2022_core.j41(0,"button",24),fesm2022_core.nI1(1,"translate"),fesm2022_core.nrm(2,"i",26),fesm2022_core.k0s()),2&rf&&fesm2022_core.Y8G("dsBtnDisabled",!0)("ngbTooltip",fesm2022_core.bMT(1,2,"admin.access-control.epeople.table.edit.buttons.edit-disabled"))}function GroupsRegistryComponent_Conditional_33_For_23_Conditional_14_Template(rf,ctx){if(1&rf){const _r3=fesm2022_core.RV6();fesm2022_core.j41(0,"button",27),fesm2022_core.nI1(1,"translate"),fesm2022_core.bIt("click",function(){fesm2022_core.eBV(_r3);const groupDto_r1=fesm2022_core.XpG().$implicit,ctx_r1=fesm2022_core.XpG(2);return fesm2022_core.Njj(ctx_r1.confirmDelete(groupDto_r1))}),fesm2022_core.nrm(2,"i",28),fesm2022_core.k0s()}if(2&rf){const groupDto_r1=fesm2022_core.XpG().$implicit,ctx_r1=fesm2022_core.XpG(2);fesm2022_core.FS9("title",fesm2022_core.i5U(1,1,ctx_r1.messagePrefix+"table.edit.buttons.remove",fesm2022_core.eq3(4,groups_registry_component_c0,ctx_r1.dsoNameService.getName(groupDto_r1.group))))}}function GroupsRegistryComponent_Conditional_33_For_23_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"tr")(1,"td"),fesm2022_core.EFF(2),fesm2022_core.k0s(),fesm2022_core.j41(3,"td"),fesm2022_core.EFF(4),fesm2022_core.k0s(),fesm2022_core.j41(5,"td"),fesm2022_core.EFF(6),fesm2022_core.nI1(7,"async"),fesm2022_core.k0s(),fesm2022_core.j41(8,"td"),fesm2022_core.EFF(9),fesm2022_core.k0s(),fesm2022_core.j41(10,"td")(11,"div",22),fesm2022_core.DNE(12,GroupsRegistryComponent_Conditional_33_For_23_Case_12_Template,3,7,"button",23)(13,GroupsRegistryComponent_Conditional_33_For_23_Case_13_Template,3,4,"button",24)(14,GroupsRegistryComponent_Conditional_33_For_23_Conditional_14_Template,3,6,"button",25),fesm2022_core.k0s()()()),2&rf){let tmp_13_0,tmp_15_0;const groupDto_r1=ctx.$implicit,ctx_r1=fesm2022_core.XpG(2);fesm2022_core.R7$(2),fesm2022_core.JRh(groupDto_r1.group.id),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r1.dsoNameService.getName(groupDto_r1.group)),fesm2022_core.R7$(2),fesm2022_core.JRh(ctx_r1.dsoNameService.getName(null==(tmp_13_0=fesm2022_core.bMT(7,6,groupDto_r1.group.object))?null:tmp_13_0.payload)),fesm2022_core.R7$(3),fesm2022_core.JRh((null==groupDto_r1.epersons?null:groupDto_r1.epersons.totalElements)+(null==groupDto_r1.subgroups?null:groupDto_r1.subgroups.totalElements)),fesm2022_core.R7$(3),fesm2022_core.vxM(!0===(tmp_15_0=groupDto_r1.ableToEdit)?12:!1===tmp_15_0?13:-1),fesm2022_core.R7$(2),fesm2022_core.vxM(null!=groupDto_r1.group&&groupDto_r1.group.permanent||!groupDto_r1.ableToDelete?-1:14)}}function GroupsRegistryComponent_Conditional_33_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"ds-pagination",17),fesm2022_core.nI1(1,"async"),fesm2022_core.j41(2,"div",19)(3,"table",20)(4,"thead")(5,"tr")(6,"th",21),fesm2022_core.EFF(7),fesm2022_core.nI1(8,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(9,"th",21),fesm2022_core.EFF(10),fesm2022_core.nI1(11,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(12,"th",21),fesm2022_core.EFF(13),fesm2022_core.nI1(14,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(15,"th",21),fesm2022_core.EFF(16),fesm2022_core.nI1(17,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(18,"th"),fesm2022_core.EFF(19),fesm2022_core.nI1(20,"translate"),fesm2022_core.k0s()()(),fesm2022_core.j41(21,"tbody"),fesm2022_core.Z7z(22,GroupsRegistryComponent_Conditional_33_For_23_Template,15,8,"tr",null,fesm2022_core.fX1),fesm2022_core.nI1(24,"async"),fesm2022_core.k0s()()()()),2&rf){let tmp_2_0,tmp_10_0;const ctx_r1=fesm2022_core.XpG();fesm2022_core.Y8G("paginationOptions",ctx_r1.config)("collectionSize",null==(tmp_2_0=fesm2022_core.bMT(1,9,ctx_r1.pageInfoState$))?null:tmp_2_0.totalElements)("hideGear",!0)("hidePagerWhenSinglePage",!0),fesm2022_core.R7$(7),fesm2022_core.JRh(fesm2022_core.bMT(8,11,ctx_r1.messagePrefix+"table.id")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(11,13,ctx_r1.messagePrefix+"table.name")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(14,15,ctx_r1.messagePrefix+"table.collectionOrCommunity")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(17,17,ctx_r1.messagePrefix+"table.members")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(20,19,ctx_r1.messagePrefix+"table.edit")),fesm2022_core.R7$(3),fesm2022_core.Dyx(null==(tmp_10_0=fesm2022_core.bMT(24,21,ctx_r1.groupsDto$))?null:tmp_10_0.page)}}function GroupsRegistryComponent_Conditional_36_Template(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",18),fesm2022_core.EFF(1),fesm2022_core.nI1(2,"translate"),fesm2022_core.k0s()),2&rf){const ctx_r1=fesm2022_core.XpG();fesm2022_core.R7$(),fesm2022_core.SpI(" ",fesm2022_core.bMT(2,1,ctx_r1.messagePrefix+"no-items")," ")}}const ValidateEmailErrorStateMatcher=(control,model,hasFocus)=>control.touched&&!hasFocus||control.errors?.emailTaken&&hasFocus,providers=[{provide:core.P3,useValue:ValidateEmailErrorStateMatcher}],ROUTES=[{path:access_control_routing_paths.P5,component:EPeopleRegistryComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.epeople.title",breadcrumbKey:"admin.access-control.epeople"},canActivate:[site_administrator_guard.Y]},{path:`${access_control_routing_paths.P5}/create`,component:EPersonFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.epeople.add.title",breadcrumbKey:"admin.access-control.epeople.add"},canActivate:[site_administrator_guard.Y]},{path:`${access_control_routing_paths.P5}/:id/edit`,component:EPersonFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S,ePerson:EPersonResolver},providers,data:{title:"admin.access-control.epeople.edit.title",breadcrumbKey:"admin.access-control.epeople.edit"},canActivate:[site_administrator_guard.Y]},{path:access_control_routing_paths.w4,component:(()=>{class GroupsRegistryComponent2{constructor(groupService,ePersonDataService,dSpaceObjectDataService,translateService,notificationsService,formBuilder,routeService,authorizationService,paginationService,requestService,dsoNameService,modalService){this.groupService=groupService,this.ePersonDataService=ePersonDataService,this.dSpaceObjectDataService=dSpaceObjectDataService,this.translateService=translateService,this.notificationsService=notificationsService,this.formBuilder=formBuilder,this.routeService=routeService,this.authorizationService=authorizationService,this.paginationService=paginationService,this.requestService=requestService,this.dsoNameService=dsoNameService,this.modalService=modalService,this.messagePrefix="admin.access-control.groups.",this.config=Object.assign(new pagination_component_options_model.W,{id:"gl",pageSize:5,currentPage:1}),this.groupsDto$=new cjs.BehaviorSubject({}),this.deletedGroupsIds=[],this.pageInfoState$=new cjs.BehaviorSubject(void 0),this.loading$=new cjs.BehaviorSubject(!1),this.subs=[],this.currentSearchQuery="",this.searchForm=this.formBuilder.group({query:this.currentSearchQuery})}ngOnInit(){this.search({query:this.currentSearchQuery})}search(data){(0,empty_util.a4)(this.searchSub)&&(this.searchSub.unsubscribe(),this.subs=this.subs.filter(sub=>sub!==this.searchSub)),this.searchSub=this.paginationService.getCurrentPagination(this.config.id,this.config).pipe((0,operators.Mi)(()=>this.loading$.next(!0)),(0,operators.nx)(paginationOptions=>{const query=data.query;return null!=query&&this.currentSearchQuery!==query&&(this.currentSearchQuery=query,this.paginationService.updateRouteWithUrl(this.config.id,[],{page:1})),this.groupService.searchGroups(this.currentSearchQuery.trim(),{currentPage:paginationOptions.currentPage,elementsPerPage:paginationOptions.pageSize},!0,!0,(0,follow_link_config_model.s)("object"))}),(0,shared_operators.v7)(),(0,shared_operators.Bo)(),(0,operators.nx)(groups=>0===groups.page.length?(0,cjs.of)((0,paginated_list_model.g)(groups.pageInfo,[])):this.authorizationService.isAuthorized(feature_id._.AdministratorOf).pipe((0,operators.nx)(isSiteAdmin=>(0,cjs.combineLatest)([...groups.page.map(group=>(0,empty_util.a4)(group)&&!this.deletedGroupsIds.includes(group.id)?(0,cjs.combineLatest)([this.authorizationService.isAuthorized(feature_id._.CanDelete,group.self),this.canManageGroup$(isSiteAdmin,group),this.hasLinkedDSO(group),this.getSubgroups(group),this.getMembers(group)]).pipe((0,operators.Tj)(([canDelete,canManageGroup,hasLinkedDSO,subgroups,members])=>{const groupDtoModel=new GroupDtoModel;return groupDtoModel.ableToDelete=canDelete&&!hasLinkedDSO,groupDtoModel.ableToEdit=canManageGroup,groupDtoModel.group=group,groupDtoModel.subgroups=subgroups.payload,groupDtoModel.epersons=members.payload,groupDtoModel})):cjs.EMPTY)]).pipe((0,operators.US)([]),(0,operators.Tj)(dtos=>(0,paginated_list_model.g)(groups.pageInfo,dtos))))))).subscribe(value=>{this.groupsDto$.next(value),this.pageInfoState$.next(value.pageInfo),this.loading$.next(!1)}),this.subs.push(this.searchSub)}canManageGroup$(isSiteAdmin,group){return isSiteAdmin?(0,cjs.of)(!0):this.authorizationService.isAuthorized(feature_id._.CanManageGroup,group.self)}deleteGroup(group){(0,empty_util.a4)(group.group.id)&&this.groupService.delete(group.group.id).pipe((0,shared_operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.deletedGroupsIds=[...this.deletedGroupsIds,group.group.id],this.notificationsService.success(this.translateService.get(this.messagePrefix+"notification.deleted.success",{name:this.dsoNameService.getName(group.group)}))):this.notificationsService.error(this.translateService.get(this.messagePrefix+"notification.deleted.failure.title",{name:this.dsoNameService.getName(group.group)}),this.translateService.get(this.messagePrefix+"notification.deleted.failure.content",{cause:rd.errorMessage}))})}getMembers(group){return this.ePersonDataService.findListByHref(group._links.epersons.href,{currentPage:1,elementsPerPage:1}).pipe((0,shared_operators.yd)())}getSubgroups(group){return this.groupService.findListByHref(group._links.subgroups.href,{currentPage:1,elementsPerPage:1}).pipe((0,shared_operators.yd)())}hasLinkedDSO(group){return this.dSpaceObjectDataService.findByHref(group._links.object.href).pipe((0,shared_operators.yd)(),(0,operators.Tj)(rd=>(0,empty_util.a4)(rd)&&(0,empty_util.a4)(rd.payload)),(0,operators.WL)(()=>(0,cjs.of)(!1)))}clearFormAndResetResult(){this.searchForm.patchValue({query:""}),this.search({query:""})}ngOnDestroy(){this.cleanupSubscribes(),this.paginationService.clearPagination(this.config.id)}cleanupSubscribes(){(0,empty_util.a4)(this.paginationSub)&&this.paginationSub.unsubscribe(),this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe()),this.paginationService.clearPagination(this.config.id)}confirmDelete(group){const modalRef=this.modalService.open(confirmation_modal_component.M);modalRef.componentInstance.name=this.dsoNameService.getName(group.group),modalRef.componentInstance.headerLabel="admin.access-control.epeople.table.edit.buttons.remove.modal.header",modalRef.componentInstance.infoLabel="admin.access-control.epeople.table.edit.buttons.remove.modal.info",modalRef.componentInstance.cancelLabel="admin.access-control.epeople.table.edit.buttons.remove.modal.cancel",modalRef.componentInstance.confirmLabel="admin.access-control.epeople.table.edit.buttons.remove.modal.confirm",modalRef.componentInstance.brandColor="danger",modalRef.componentInstance.confirmIcon="fas fa-trash";const modalSub=modalRef.componentInstance.response.pipe((0,operators.QK)(modalRef.closed)).subscribe(result=>{!0===result&&this.deleteGroup(group)});modalRef.result.then().finally(()=>{modalRef.close(),modalSub&&!modalSub.closed&&modalSub.unsubscribe()})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||GroupsRegistryComponent2)(fesm2022_core.rXU(group_data_service.GroupDataService),fesm2022_core.rXU(eperson_data_service.EPersonDataService),fesm2022_core.rXU(dspace_object_data_service.DSpaceObjectDataService),fesm2022_core.rXU(ngx_translate_core.c$),fesm2022_core.rXU(notifications_service.I),fesm2022_core.rXU(fesm2022_forms.ze),fesm2022_core.rXU(route_service.v$),fesm2022_core.rXU(authorization_data_service.AuthorizationDataService),fesm2022_core.rXU(pagination_service.m),fesm2022_core.rXU(request_service.B),fesm2022_core.rXU(dso_name_service.f),fesm2022_core.rXU(ng_bootstrap.Bq))}}static{this.\u0275cmp=fesm2022_core.VBU({type:GroupsRegistryComponent2,selectors:[["ds-groups-registry"]],standalone:!0,features:[fesm2022_core.aNF],decls:38,vars:34,consts:[[1,"container"],[1,"groups-registry","row"],[1,"col-12"],[1,"d-flex","justify-content-between","border-bottom","mb-3"],["id","header",1,"pb-2"],[1,"me-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline","ms-1"],["id","search",1,"border-bottom","pb-2"],[1,"d-flex","justify-content-between",3,"ngSubmit","formGroup"],[1,"flex-grow-1","me-3"],[1,"mb-3","input-group"],["type","text","name","query","id","query","formControlName","query",1,"form-control",3,"placeholder"],[1,"input-group-append"],["type","submit",1,"search-button","btn","btn-primary"],[1,"fas","fa-search"],[1,"btn","btn-secondary",3,"click"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],["role","alert",1,"alert","alert-info","w-100","mb-2"],[1,"table-responsive"],["id","groups",1,"table","table-striped","table-hover","table-bordered"],["scope","col"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm","btn-edit",3,"routerLink","title"],["placement","left",1,"btn","btn-outline-primary","btn-sm","btn-edit",3,"dsBtnDisabled","ngbTooltip"],[1,"btn","btn-outline-danger","btn-sm","btn-delete",3,"title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm","btn-delete",3,"click","title"],[1,"fas","fa-trash-alt","fa-fw"]],template:function(rf,ctx){if(1&rf&&(fesm2022_core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),fesm2022_core.EFF(5),fesm2022_core.nI1(6,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(7,"div")(8,"button",5),fesm2022_core.nrm(9,"i",6),fesm2022_core.j41(10,"span",7),fesm2022_core.EFF(11),fesm2022_core.nI1(12,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(13,"h2",8),fesm2022_core.EFF(14),fesm2022_core.nI1(15,"translate"),fesm2022_core.k0s(),fesm2022_core.j41(16,"form",9),fesm2022_core.bIt("ngSubmit",function(){return ctx.search(ctx.searchForm.value)}),fesm2022_core.j41(17,"div",10)(18,"div",11),fesm2022_core.nrm(19,"input",12),fesm2022_core.nI1(20,"translate"),fesm2022_core.nI1(21,"translate"),fesm2022_core.j41(22,"span",13)(23,"button",14),fesm2022_core.nrm(24,"i",15),fesm2022_core.EFF(25),fesm2022_core.nI1(26,"translate"),fesm2022_core.k0s()()()(),fesm2022_core.j41(27,"div")(28,"button",16),fesm2022_core.bIt("click",function(){return ctx.clearFormAndResetResult()}),fesm2022_core.EFF(29),fesm2022_core.nI1(30,"translate"),fesm2022_core.k0s()()(),fesm2022_core.DNE(31,GroupsRegistryComponent_Conditional_31_Template,1,0,"ds-loading"),fesm2022_core.nI1(32,"async"),fesm2022_core.DNE(33,GroupsRegistryComponent_Conditional_33_Template,25,23,"ds-pagination",17),fesm2022_core.nI1(34,"async"),fesm2022_core.nI1(35,"async"),fesm2022_core.DNE(36,GroupsRegistryComponent_Conditional_36_Template,3,3,"div",18),fesm2022_core.nI1(37,"async"),fesm2022_core.k0s()()()),2&rf){let tmp_10_0,tmp_11_0;fesm2022_core.R7$(5),fesm2022_core.JRh(fesm2022_core.bMT(6,12,ctx.messagePrefix+"head")),fesm2022_core.R7$(3),fesm2022_core.Y8G("routerLink","create"),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(12,14,ctx.messagePrefix+"button.add")),fesm2022_core.R7$(3),fesm2022_core.JRh(fesm2022_core.bMT(15,16,ctx.messagePrefix+"search.head")),fesm2022_core.R7$(2),fesm2022_core.Y8G("formGroup",ctx.searchForm),fesm2022_core.R7$(3),fesm2022_core.Y8G("placeholder",fesm2022_core.bMT(20,18,ctx.messagePrefix+"search.placeholder")),fesm2022_core.BMQ("aria-label",fesm2022_core.bMT(21,20,ctx.messagePrefix+"search.placeholder")),fesm2022_core.R7$(6),fesm2022_core.SpI(" ",fesm2022_core.bMT(26,22,ctx.messagePrefix+"search.button")," "),fesm2022_core.R7$(4),fesm2022_core.SpI(" ",fesm2022_core.bMT(30,24,ctx.messagePrefix+"button.see-all")," "),fesm2022_core.R7$(2),fesm2022_core.vxM(fesm2022_core.bMT(32,26,ctx.loading$)?31:-1),fesm2022_core.R7$(2),fesm2022_core.vxM((null==(tmp_10_0=fesm2022_core.bMT(34,28,ctx.pageInfoState$))?null:tmp_10_0.totalElements)>0&&!0!==fesm2022_core.bMT(35,30,ctx.loading$)?33:-1),fesm2022_core.R7$(3),fesm2022_core.vxM(0===(null==(tmp_11_0=fesm2022_core.bMT(37,32,ctx.pageInfoState$))?null:tmp_11_0.totalElements)?36:-1)}},dependencies:[common.Jj,btn_disabled_directive.A,ng_bootstrap.n8,ng_bootstrap.md,pagination_component.e,fesm2022_forms.X1,fesm2022_forms.qT,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,router.Wk,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return GroupsRegistryComponent2})(),resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.groups.title",breadcrumbKey:"admin.access-control.groups"},canActivate:[group_administrator_guard.i]},{path:`${access_control_routing_paths.w4}/create`,component:GroupFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.groups.title.addGroup",breadcrumbKey:"admin.access-control.groups.addGroup"},canActivate:[group_administrator_guard.i]},{path:`${access_control_routing_paths.w4}/:groupId/edit`,component:GroupFormComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},providers,data:{title:"admin.access-control.groups.title.singleGroup",breadcrumbKey:"admin.access-control.groups.singleGroup"},canActivate:[(getObjectUrl=defaultGroupPageGetObjectUrl,getEPersonUuid)=>(0,some_feature_authorization_guard.h)(()=>(0,cjs.of)([feature_id._.CanManageGroup]),getObjectUrl,getEPersonUuid)]},{path:"bulk-access",component:BulkAccessComponent,resolve:{breadcrumb:i18n_breadcrumb_resolver.S},data:{title:"admin.access-control.bulk-access.title",breadcrumbKey:"admin.access-control.bulk-access"},canActivate:[site_administrator_guard.Y]}]},48020:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>Breadcrumb});class Breadcrumb{constructor(text,url){this.text=text,this.url=url}}},12213:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>i18nBreadcrumbResolver});var core=__webpack_require__(25376),empty_util=__webpack_require__(2794),route_utils=__webpack_require__(93359),cjs=__webpack_require__(9238),breadcrumb_model=__webpack_require__(48020);let I18nBreadcrumbsService=(()=>{class I18nBreadcrumbsService2{getBreadcrumbs(key,url){return(0,cjs.of)([new breadcrumb_model.Q(key+".breadcrumbs",url)])}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||I18nBreadcrumbsService2)}}static{this.\u0275prov=core.jDH({token:I18nBreadcrumbsService2,factory:I18nBreadcrumbsService2.\u0275fac,providedIn:"root"})}}return I18nBreadcrumbsService2})();const i18nBreadcrumbResolver=(route,state,breadcrumbService=(0,core.WQX)(I18nBreadcrumbsService))=>{const key=route.data.breadcrumbKey;if((0,empty_util.Tn)(key))throw new Error('You provided an i18nBreadcrumbResolver for url "'+route.url+"\" but no breadcrumbKey in the route's data");return{provider:breadcrumbService,key,url:(0,route_utils.F)(route)}}},30748:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BulkAccessConfigDataService:()=>BulkAccessConfigDataService});var _cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(80996),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(63311),_data_request_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(64806),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26139),_config_data_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(72684),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(25376);let BulkAccessConfigDataService=(()=>{class BulkAccessConfigDataService2 extends _config_data_service__WEBPACK_IMPORTED_MODULE_4__.O{constructor(requestService,rdbService,objectCache,halService){super("bulkaccessconditionoptions",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||BulkAccessConfigDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_data_request_service__WEBPACK_IMPORTED_MODULE_2__.B),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__.o),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__.$),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_5__.jDH({token:BulkAccessConfigDataService2,factory:BulkAccessConfigDataService2.\u0275fac,providedIn:"root"})}}return BulkAccessConfigDataService2})()},72684:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>ConfigDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(60444),_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(61640),_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39022);class ConfigDataService extends _data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_0__.W{findByHref(href,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return super.findByHref(href,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.Tj)(rd=>{if(rd.hasFailed)throw new Error("Couldn't retrieve the config");return rd}))}findByName(name,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return super.findById(name,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}}},54255:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{f:()=>EpersonRegistrationService});var http=__webpack_require__(98465),operators=__webpack_require__(60444),empty_util=__webpack_require__(2794),remote_data_build_service=__webpack_require__(80996),hal_endpoint_service=__webpack_require__(26139),shared_operators=__webpack_require__(39022),registration_model=__webpack_require__(89113),response_models=__webpack_require__(56601),core=__webpack_require__(25376);let RegistrationResponseParsingService=(()=>{class RegistrationResponseParsingService2{parse(request,data){const payload=data.payload,registration=Object.assign(new registration_model.cH,payload);return new response_models.hT(data.statusCode,void 0,registration)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||RegistrationResponseParsingService2)}}static{this.\u0275prov=core.jDH({token:RegistrationResponseParsingService2,factory:RegistrationResponseParsingService2.\u0275fac,providedIn:"root"})}}return RegistrationResponseParsingService2})();var request_models=__webpack_require__(99381),request_service=__webpack_require__(64806);let EpersonRegistrationService=(()=>{class EpersonRegistrationService2{constructor(requestService,rdbService,halService){this.requestService=requestService,this.rdbService=rdbService,this.halService=halService,this.linkPath="registrations",this.searchByTokenPath="/search/findByToken?token="}getRegistrationEndpoint(){return this.halService.getEndpoint(this.linkPath)}getTokenSearchEndpoint(token){return this.halService.getEndpoint(this.linkPath).pipe((0,operators.pb)(href=>(0,empty_util.hj)(href)),(0,operators.Tj)(href=>`${href}${this.searchByTokenPath}${token}`))}registerEmail(email,captchaToken=null,type){const registration=new registration_model.cH;registration.email=email;const requestId=this.requestService.generateRequestId(),href$=this.getRegistrationEndpoint(),options=Object.create({});let headers=new http.Lr;return captchaToken&&(headers=headers.append("x-captcha-payload",captchaToken)),options.headers=headers,(0,empty_util.a4)(type)&&(options.params=type?new http.Nl({fromString:"accountRequestType="+type}):new http.Nl),href$.pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)),(0,operators.Tj)(href=>{const request=new request_models.Qf(requestId,href,registration,options);this.requestService.send(request)})).subscribe(),this.rdbService.buildFromRequestUUID(requestId).pipe((0,shared_operators.qD)())}searchByTokenAndUpdateData(token){const requestId=this.requestService.generateRequestId(),href$=this.getTokenSearchEndpoint(token).pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)));return href$.subscribe(href=>{const request=new request_models.IP(requestId,href);Object.assign(request,{getResponseParser:()=>RegistrationResponseParsingService}),this.requestService.send(request,!0)}),this.rdbService.buildSingle(href$).pipe((0,operators.Tj)(rd=>rd.hasSucceeded&&(0,empty_util.a4)(rd.payload)?Object.assign(rd,{payload:Object.assign(new registration_model.cH,{email:rd.payload.email,token,user:rd.payload.user})}):rd))}searchByTokenAndHandleError(token){const requestId=this.requestService.generateRequestId(),href$=this.getTokenSearchEndpoint(token).pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)));return href$.subscribe(href=>{const request=new request_models.IP(requestId,href);Object.assign(request,{getResponseParser:()=>RegistrationResponseParsingService}),this.requestService.send(request,!0)}),this.rdbService.buildSingle(href$)}patchUpdateRegistration(values,field,registrationId,token,operator){const requestId=this.requestService.generateRequestId();return this.getRegistrationEndpoint().pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)),(0,operators.Tj)(href=>`${href}/${registrationId}?token=${token}`)).subscribe(href=>{const operations=this.generateOperations(values,field,operator),patchRequest=new request_models.EA(requestId,href,operations);this.requestService.send(patchRequest)}),this.rdbService.buildFromRequestUUID(requestId)}generateOperations(values,field,operator){let operations=[];return values.length>0&&(0,empty_util.a4)(field)&&(operations=[{op:operator,path:`/${field}`,value:values}]),operations}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EpersonRegistrationService2)(core.KVO(request_service.B),core.KVO(remote_data_build_service.o),core.KVO(hal_endpoint_service.Y))}}static{this.\u0275prov=core.jDH({token:EpersonRegistrationService2,factory:EpersonRegistrationService2.\u0275fac,providedIn:"root"})}}return EpersonRegistrationService2})()},14998:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{j:()=>ResolvedAction});const ResolverActionTypes={RESOLVED:(0,__webpack_require__(29841).N)("dspace/resolver/RESOLVED")};class ResolvedAction{constructor(url,dso){this.type=ResolverActionTypes.RESOLVED,this.payload={url,dso}}}},47811:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{RegisterEmailFormComponent:()=>RegisterEmailFormComponent,TYPE_REQUEST_FORGOT:()=>TYPE_REQUEST_FORGOT,TYPE_REQUEST_REGISTER:()=>TYPE_REQUEST_REGISTER});var _angular_common__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(87514),_angular_forms__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(13054),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(2385),rxjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(9238),rxjs_operators__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(60444),_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(93876),_core_data_eperson_registration_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(54255),_core_google_recaptcha_google_recaptcha_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(92679),_core_shared_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(39022),_shared_alert_alert_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6213),_shared_alert_alert_type__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(83113),_shared_btn_disabled_directive__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(69919),_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(2794),_shared_google_recaptcha_google_recaptcha_component__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(80173),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(76623),_angular_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(25376),_angular_router__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(18134),_core_services_cookie_service__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(28719),_shared_cookies_orejime_service__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(3337);const _c0=a0=>({domains:a0});function RegisterEmailFormComponent_Conditional_7_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"p"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Lme(" ",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(2,2,ctx_r0.MESSAGE_PREFIX+".info.maildomain")," ",ctx_r0.validMailDomains.join(", ")," ")}}function RegisterEmailFormComponent_Conditional_17_Conditional_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"span",11),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(2,1,ctx_r0.MESSAGE_PREFIX+".email.error.required")," ")}}function RegisterEmailFormComponent_Conditional_17_Conditional_2_Conditional_3_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(0),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(1,"translate")),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG(3);_angular_core__WEBPACK_IMPORTED_MODULE_8__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_8__.i5U(1,1,ctx_r0.MESSAGE_PREFIX+".email.error.not-valid-domain",_angular_core__WEBPACK_IMPORTED_MODULE_8__.eq3(4,_c0,ctx_r0.validMailDomains.join(", ")))," ")}}function RegisterEmailFormComponent_Conditional_17_Conditional_2_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"span",12),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.DNE(3,RegisterEmailFormComponent_Conditional_17_Conditional_2_Conditional_3_Template,2,6),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG(2);_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(2,2,ctx_r0.MESSAGE_PREFIX+".email.error.not-email-form")," "),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.vxM(ctx_r0.validMailDomains.length>0?3:-1)}}function RegisterEmailFormComponent_Conditional_17_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"div",7),_angular_core__WEBPACK_IMPORTED_MODULE_8__.DNE(1,RegisterEmailFormComponent_Conditional_17_Conditional_1_Template,3,3,"span",11)(2,RegisterEmailFormComponent_Conditional_17_Conditional_2_Template,4,4,"span",12),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.vxM(ctx_r0.email.errors&&ctx_r0.email.errors.required?1:-1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.vxM(ctx_r0.email.errors&&(ctx_r0.email.errors.pattern&&ctx_r0.typeRequest===ctx_r0.TYPE_REQUEST_REGISTER||ctx_r0.email.errors.email)?2:-1)}}function RegisterEmailFormComponent_Conditional_21_Template(rf,ctx){if(1&rf){const _r2=_angular_core__WEBPACK_IMPORTED_MODULE_8__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"ds-alert",8),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nrm(1,"p",13),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(3,"p",14)(4,"a",15),_angular_core__WEBPACK_IMPORTED_MODULE_8__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_8__.eBV(_r2);const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_8__.Njj(ctx_r0.orejimeService.showSettings())}),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(5),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(6,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()()()}if(2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("type",ctx_r0.AlertTypeEnum.Warning),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("innerHTML",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(2,3,ctx_r0.MESSAGE_PREFIX+".google-recaptcha.must-accept-cookies"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.npT),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_8__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(6,5,ctx_r0.MESSAGE_PREFIX+".google-recaptcha.open-cookie-settings"))}}function RegisterEmailFormComponent_Conditional_22_Template(rf,ctx){if(1&rf){const _r3=_angular_core__WEBPACK_IMPORTED_MODULE_8__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"div",9)(1,"ds-google-recaptcha",16),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(2,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.bIt("executeRecaptcha",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_8__.eBV(_r3);const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_8__.Njj(ctx_r0.register($event))})("checkboxChecked",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_8__.eBV(_r3);const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_8__.Njj(ctx_r0.onCheckboxChecked($event))})("showNotification",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_8__.eBV(_r3);const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_8__.Njj(ctx_r0.showNotification($event))}),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()()}if(2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("captchaMode",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(2,1,ctx_r0.captchaMode$))}}function RegisterEmailFormComponent_Conditional_24_Template(rf,ctx){if(1&rf){const _r4=_angular_core__WEBPACK_IMPORTED_MODULE_8__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"button",17),_angular_core__WEBPACK_IMPORTED_MODULE_8__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_8__.eBV(_r4);const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_8__.Njj(ctx_r0.register())}),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()}if(2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("dsBtnDisabled",ctx_r0.form.invalid||ctx_r0.registrationVerification&&!ctx_r0.isRecaptchaCookieAccepted()||ctx_r0.disableUntilChecked),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(2,2,ctx_r0.MESSAGE_PREFIX+".submit")," ")}}function RegisterEmailFormComponent_Conditional_27_Template(rf,ctx){if(1&rf){const _r5=_angular_core__WEBPACK_IMPORTED_MODULE_8__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"button",17),_angular_core__WEBPACK_IMPORTED_MODULE_8__.bIt("click",function(){_angular_core__WEBPACK_IMPORTED_MODULE_8__.eBV(_r5);const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_8__.Njj(ctx_r0.executeRecaptcha())}),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()}if(2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_8__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("dsBtnDisabled",ctx_r0.form.invalid),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(2,2,ctx_r0.MESSAGE_PREFIX+".submit")," ")}}const TYPE_REQUEST_FORGOT="forgot",TYPE_REQUEST_REGISTER="register";let RegisterEmailFormComponent=(()=>{class RegisterEmailFormComponent2{constructor(epersonRegistrationService,notificationService,translateService,router,formBuilder,configService,googleRecaptchaService,cookieService,orejimeService,changeDetectorRef,notificationsService){this.epersonRegistrationService=epersonRegistrationService,this.notificationService=notificationService,this.translateService=translateService,this.router=router,this.formBuilder=formBuilder,this.configService=configService,this.googleRecaptchaService=googleRecaptchaService,this.cookieService=cookieService,this.orejimeService=orejimeService,this.changeDetectorRef=changeDetectorRef,this.notificationsService=notificationsService,this.typeRequest=null,this.AlertTypeEnum=_shared_alert_alert_type__WEBPACK_IMPORTED_MODULE_5__.v,this.registrationVerification=!1,this.checkboxCheckedSubject$=new rxjs__WEBPACK_IMPORTED_MODULE_9__.BehaviorSubject(!1),this.disableUntilChecked=!0,this.TYPE_REQUEST_REGISTER=TYPE_REQUEST_REGISTER,this.subscriptions=[]}ngOnDestroy(){this.subscriptions.forEach(sub=>sub.unsubscribe())}ngOnInit(){this.captchaVersion$=this.googleRecaptchaService.captchaVersion(),this.captchaMode$=this.googleRecaptchaService.captchaMode();const validators=[_angular_forms__WEBPACK_IMPORTED_MODULE_10__.k0.required,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.k0.email,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.k0.pattern("^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$")];this.form=this.formBuilder.group({email:new _angular_forms__WEBPACK_IMPORTED_MODULE_10__.hs("",{validators})}),this.validMailDomains=[],this.typeRequest===TYPE_REQUEST_REGISTER&&this.subscriptions.push(this.configService.findByPropertyName("authentication-password.domain.valid").pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_3__.Hz)()).subscribe(remoteData=>{this.validMailDomains=remoteData.values;for(const remoteValue of remoteData.values)0!==this.validMailDomains.length&&(this.form.get("email").setValidators([...validators,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.k0.pattern(this.validMailDomains.map(domain=>"(^.*"+domain.replace(new RegExp("\\.","g"),"\\.")+"$)").join("|"))]),this.form.updateValueAndValidity());this.changeDetectorRef.detectChanges()})),this.subscriptions.push(this.configService.findByPropertyName("registration.verification.enabled").pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_3__.ak)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.Tj)(res=>"true"===res?.values[0].toLowerCase())).subscribe(res=>{this.registrationVerification=res})),this.subscriptions.push(this.disableUntilCheckedFcn().subscribe(res=>{this.disableUntilChecked=res,this.changeDetectorRef.detectChanges()}))}executeRecaptcha(){this.googleRecaptchaService.executeRecaptcha()}register(tokenV2){this.form.invalid||(this.registrationVerification?this.subscriptions.push((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.combineLatest)([this.captchaVersion$,this.captchaMode$]).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.switchMap)(([captchaVersion,captchaMode])=>"v3"===captchaVersion?this.googleRecaptchaService.getRecaptchaToken("register_email"):"v2"===captchaVersion&&"checkbox"===captchaMode?(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(this.googleRecaptchaService.getRecaptchaTokenResponse()):"v2"===captchaVersion&&"invisible"===captchaMode?(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)(tokenV2):(console.error(`Invalid reCaptcha configuration: version = ${captchaVersion}, mode = ${captchaMode}`),void this.showNotification("error"))),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.s)(1)).subscribe(token=>{(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.hj)(token)?this.registration(token):(console.error("reCaptcha error"),this.showNotification("error"))})):this.registration())}registration(captchaToken=null){const registerEmail$=this.epersonRegistrationService.registerEmail(this.email.value,captchaToken||null,this.typeRequest);this.subscriptions.push(registerEmail$.subscribe(response=>{response.hasSucceeded?(this.notificationService.success(this.translateService.get(`${this.MESSAGE_PREFIX}.success.head`),this.translateService.get(`${this.MESSAGE_PREFIX}.success.content`,{email:this.email.value})),this.router.navigate(["/home"])):this.notificationService.error(this.translateService.get(`${this.MESSAGE_PREFIX}.error.head`),422===response.statusCode?this.translateService.get(`${this.MESSAGE_PREFIX}.error.maildomain`,{domains:this.validMailDomains.join(", ")}):this.translateService.get(`${this.MESSAGE_PREFIX}.error.content`,{email:this.email.value}))}))}isRecaptchaCookieAccepted(){const orejimeAnonymousCookie=this.cookieService.get("orejime-anonymous");return!!(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.hj)(orejimeAnonymousCookie)&&orejimeAnonymousCookie[_core_google_recaptcha_google_recaptcha_service__WEBPACK_IMPORTED_MODULE_2__.BA]}disableUntilCheckedFcn(){const checked$=this.checkboxCheckedSubject$.asObservable();return(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.combineLatest)([this.captchaVersion$,this.captchaMode$,checked$]).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_9__.switchMap)(([captchaVersion,captchaMode,checked])=>(0,rxjs__WEBPACK_IMPORTED_MODULE_9__.of)("v2"===captchaVersion&&"checkbox"===captchaMode&&!checked)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.ql)(!0))}get email(){return this.form.get("email")}onCheckboxChecked(checked){this.checkboxCheckedSubject$.next(checked)}showNotification(key){const notificationTitle=this.translateService.get(this.MESSAGE_PREFIX+".google-recaptcha.notification.title"),notificationErrorMsg=this.translateService.get(this.MESSAGE_PREFIX+".google-recaptcha.notification.message.error"),notificationExpiredMsg=this.translateService.get(this.MESSAGE_PREFIX+".google-recaptcha.notification.message.expired");switch(key){case"expired":this.notificationsService.warning(notificationTitle,notificationExpiredMsg);break;case"error":this.notificationsService.error(notificationTitle,notificationErrorMsg);break;default:console.warn(`Unimplemented notification '${key}' from reCaptcha service`)}}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||RegisterEmailFormComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_data_eperson_registration_service__WEBPACK_IMPORTED_MODULE_1__.f),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_7__.I),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_14__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_forms__WEBPACK_IMPORTED_MODULE_10__.ze),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_0__.ConfigurationDataService),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_google_recaptcha_google_recaptcha_service__WEBPACK_IMPORTED_MODULE_2__.wq),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_services_cookie_service__WEBPACK_IMPORTED_MODULE_15__.O),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_shared_cookies_orejime_service__WEBPACK_IMPORTED_MODULE_16__.B,8),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_core__WEBPACK_IMPORTED_MODULE_8__.gRc),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_7__.I))}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_8__.VBU({type:RegisterEmailFormComponent2,selectors:[["ds-base-register-email-form"]],inputs:{MESSAGE_PREFIX:"MESSAGE_PREFIX",typeRequest:"typeRequest"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_8__.aNF],decls:28,vars:32,consts:[[1,"container"],[3,"formGroup"],[1,"mb-3"],[1,"row"],[1,"col-12"],["for","email",1,"fw-bold","form-label"],["type","text","id","email","formControlName","email",3,"className"],[1,"invalid-feedback","show-feedback"],[3,"type"],[1,"my-3"],[1,"btn","btn-primary",3,"dsBtnDisabled"],["id","email-errors-required"],["id","email-error-not-valid"],[1,"m-0",3,"innerHTML"],[1,"m-0"],["href","javascript:void(0);",3,"click"],[3,"executeRecaptcha","checkboxChecked","showNotification","captchaMode"],[1,"btn","btn-primary",3,"click","dsBtnDisabled"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"div",0)(1,"h1"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(4,"p"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(5),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(6,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.DNE(7,RegisterEmailFormComponent_Conditional_7_Template,3,4,"p"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(8,"form",1)(9,"div",2)(10,"div",3)(11,"div",4)(12,"label",5),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(13),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(14,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nrm(15,"input",6),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(16,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.DNE(17,RegisterEmailFormComponent_Conditional_17_Template,3,2,"div",7),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(18,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(19),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(20,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()()(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.DNE(21,RegisterEmailFormComponent_Conditional_21_Template,7,7,"ds-alert",8)(22,RegisterEmailFormComponent_Conditional_22_Template,3,3,"div",9),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(23,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.DNE(24,RegisterEmailFormComponent_Conditional_24_Template,3,4,"button",10),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(25,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(26,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.DNE(27,RegisterEmailFormComponent_Conditional_27_Template,3,4,"button",10),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(3,16,ctx.MESSAGE_PREFIX+".header")),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_8__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(6,18,ctx.MESSAGE_PREFIX+".info")),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.vxM(0!==ctx.validMailDomains.length&&ctx.typeRequest===ctx.TYPE_REQUEST_REGISTER?7:-1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.HbH("ng-invalid"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("formGroup",ctx.form),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(5),_angular_core__WEBPACK_IMPORTED_MODULE_8__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(14,20,ctx.MESSAGE_PREFIX+".email")),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("className",ctx.email.invalid&&(ctx.email.dirty||ctx.email.touched)?"form-control is-invalid":"form-control"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(16,22,ctx.MESSAGE_PREFIX+".aria.label"))("aria-describedby",ctx.email.errors?ctx.email.errors.required?"email-errors-required":"email-error-not-valid":"")("aria-invalid",ctx.email.invalid),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.vxM(ctx.email.invalid&&(ctx.email.dirty||ctx.email.touched)?17:-1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(20,24,ctx.MESSAGE_PREFIX+".email.hint")," "),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.vxM(ctx.registrationVerification&&!ctx.isRecaptchaCookieAccepted()?21:-1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.vxM(ctx.isRecaptchaCookieAccepted()&&"v2"===_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(23,26,ctx.captchaVersion$)?22:-1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.vxM(!ctx.registrationVerification||"v2"!==_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(25,28,ctx.captchaVersion$)&&"invisible"===_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(26,30,ctx.captchaMode$)?24:27))},dependencies:[_shared_alert_alert_component__WEBPACK_IMPORTED_MODULE_4__.C,_angular_common__WEBPACK_IMPORTED_MODULE_17__.Jj,_shared_btn_disabled_directive__WEBPACK_IMPORTED_MODULE_18__.A,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.qT,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.me,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.BC,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.cb,_shared_google_recaptcha_google_recaptcha_component__WEBPACK_IMPORTED_MODULE_6__.U,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.X1,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.j4,_angular_forms__WEBPACK_IMPORTED_MODULE_10__.JD,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_13__.D9],encapsulation:2})}}return RegisterEmailFormComponent2})()},58840:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>AccessControlFormContainerComponent});var common=__webpack_require__(87514),fesm2022_forms=__webpack_require__(13054),ngx_translate_core=__webpack_require__(2385),ngx_ui_switch=__webpack_require__(53359),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),bulk_access_config_data_service=__webpack_require__(30748),shared_operators=(__webpack_require__(18683),__webpack_require__(39022)),alert_component=__webpack_require__(6213),alert_type=__webpack_require__(83113),btn_disabled_directive=__webpack_require__(69919),selectable_list_service=__webpack_require__(85984),ng_bootstrap=__webpack_require__(87969),date_util=__webpack_require__(13651),core=__webpack_require__(25376);let ToDatePipe=(()=>{class ToDatePipe2{transform(dateValue){if(!dateValue)return null;const date=new Date(dateValue);return{year:date.getFullYear(),month:date.getMonth()+1,day:date.getDate()}}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ToDatePipe2)}}static{this.\u0275pipe=core.EJ8({name:"toDate",type:ToDatePipe2,pure:!1,standalone:!0})}}return ToDatePipe2})();const _c0=["ngForm"];function AccessControlArrayFormComponent_Conditional_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",3),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"access-control-no-access-conditions-warning-message")," "))}function AccessControlArrayFormComponent_For_4_For_9_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",11),core.EFF(1),core.k0s()),2&rf){const option_r5=ctx.$implicit;core.Y8G("value",option_r5.name),core.R7$(),core.SpI(" ",option_r5.name," ")}}function AccessControlArrayFormComponent_For_4_Conditional_13_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",13)(1,"label",8),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",15)(5,"input",18,1),core.nI1(7,"toDate"),core.mxI("ngModelChange",function($event){core.eBV(_r6);const control_r3=core.XpG().$implicit;return core.DH7(control_r3.startDate,$event)||(control_r3.startDate=$event),core.Njj($event)}),core.k0s(),core.j41(8,"div",19)(9,"button",20),core.bIt("click",function(){core.eBV(_r6);const d_r7=core.sdS(6);return core.Njj(d_r7.toggle())}),core.k0s()()(),core.j41(10,"small",12),core.EFF(11),core.nI1(12,"translate"),core.k0s()()}if(2&rf){const control_r3=core.XpG().$implicit;core.XpG();const ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("for","accesscontrolstartdate-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(3,11,"access-control-option-start-date")," "),core.R7$(3),core.Mz_("id","accesscontrolstartdate-",control_r3.id,""),core.Mz_("name","startDate-",control_r3.id,""),core.R50("ngModel",control_r3.startDate),core.Y8G("maxDate",core.bMT(7,13,control_r3.maxStartDate)),core.R7$(4),core.Y8G("dsBtnDisabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(12,15,"access-control-option-start-date-note")," ")}}function AccessControlArrayFormComponent_For_4_Conditional_14_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"div",13)(1,"label",8),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",15)(5,"input",18,2),core.nI1(7,"toDate"),core.mxI("ngModelChange",function($event){core.eBV(_r9);const control_r3=core.XpG().$implicit;return core.DH7(control_r3.endDate,$event)||(control_r3.endDate=$event),core.Njj($event)}),core.k0s(),core.j41(8,"div",19)(9,"button",20),core.bIt("click",function(){core.eBV(_r9);const d1_r10=core.sdS(6);return core.Njj(d1_r10.toggle())}),core.k0s()()(),core.j41(10,"small",12),core.EFF(11),core.nI1(12,"translate"),core.k0s()()}if(2&rf){const control_r3=core.XpG().$implicit;core.XpG();const ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("for","accesscontrolenddate-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(3,11,"access-control-option-end-date")," "),core.R7$(3),core.Mz_("id","accesscontrolenddate-",control_r3.id,""),core.Mz_("name","endDate-",control_r3.id,""),core.R50("ngModel",control_r3.endDate),core.Y8G("maxDate",core.bMT(7,13,control_r3.maxEndDate)),core.R7$(4),core.Y8G("dsBtnDisabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(12,15,"access-control-option-end-date-note")," ")}}function AccessControlArrayFormComponent_For_4_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"div",4)(1,"div",7)(2,"div")(3,"label",8),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"select",9),core.mxI("ngModelChange",function($event){const control_r3=core.eBV(_r2).$implicit;return core.DH7(control_r3.itemName,$event)||(control_r3.itemName=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){const control_r3=core.eBV(_r2).$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.accessControlChanged(control_r3,$event))}),core.nrm(7,"option",10),core.Z7z(8,AccessControlArrayFormComponent_For_4_For_9_Template,2,2,"option",11,core.fX1),core.k0s(),core.j41(10,"small",12),core.EFF(11),core.nI1(12,"translate"),core.k0s()(),core.DNE(13,AccessControlArrayFormComponent_For_4_Conditional_13_Template,13,17,"div",13)(14,AccessControlArrayFormComponent_For_4_Conditional_14_Template,13,17,"div",13),core.k0s(),core.j41(15,"div")(16,"span",14),core.EFF(17,"\xa0"),core.k0s(),core.j41(18,"div",15)(19,"button",16),core.nI1(20,"translate"),core.bIt("click",function(){const control_r3=core.eBV(_r2).$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.removeAccessControlItem(control_r3.id))}),core.nrm(21,"i",17),core.k0s()()()()}if(2&rf){const control_r3=ctx.$implicit,ctx_r3=core.XpG(),ngForm_r8=core.sdS(1);core.Mz_("ngModelGroup","access-control-item-",control_r3.id,""),core.R7$(3),core.Mz_("for","accesscontroloption-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(5,16,"access-control-option-label")," "),core.R7$(2),core.Mz_("id","accesscontroloption-",control_r3.id,""),core.Mz_("name","itemName-",control_r3.id,""),core.Y8G("disabled",ngForm_r8.disabled),core.R50("ngModel",control_r3.itemName),core.R7$(2),core.Dyx(ctx_r3.dropdownOptions),core.R7$(3),core.SpI(" ",core.bMT(12,18,"access-control-option-note")," "),core.R7$(2),core.vxM(control_r3.hasStartDate?13:-1),core.R7$(),core.vxM(control_r3.hasEndDate?14:-1),core.R7$(5),core.Y8G("dsBtnDisabled",ngForm_r8.disabled||1===ctx_r3.form.accessControls.length),core.BMQ("aria-label",core.bMT(20,20,"access-control-remove"))}}let AccessControlArrayFormComponent=(()=>{class AccessControlArrayFormComponent2{constructor(){this.dropdownOptions=[],this.form={accessControls:[emptyAccessControlItem()]},this.formDisabled=!0,this.disable=()=>{this.ngForm.form.disable(),this.formDisabled=!0},this.enable=()=>{this.ngForm.form.enable(),this.formDisabled=!1}}ngOnInit(){this.disable()}get allControlsAreEmpty(){return this.form.accessControls.every(x=>null===x.itemName||""===x.itemName)}get showWarning(){return"replace"===this.mode&&this.allControlsAreEmpty&&!this.formDisabled}addAccessControlItem(itemName=null){this.form.accessControls=[...this.form.accessControls,{...emptyAccessControlItem(),itemName}]}removeAccessControlItem(id){this.form.accessControls=this.form.accessControls.filter(item=>item.id!==id)}getValue(){return this.form.accessControls.filter(x=>null!==x.itemName&&""!==x.itemName).map(x=>({name:x.itemName,startDate:x.startDate?(0,date_util.Sd)(x.startDate):null,endDate:x.endDate?(0,date_util.Sd)(x.endDate):null}))}reset(){this.form.accessControls=[],this.addAccessControlItem(),this.disable()}accessControlChanged(control,selectedItem){const item=this.dropdownOptions.find(x=>x.name===selectedItem);control.startDate=null,control.endDate=null,control.hasStartDate=item?.hasStartDate||!1,control.hasEndDate=item?.hasEndDate||!1,control.maxStartDate=item?.maxStartDate||null,control.maxEndDate=item?.maxEndDate||null}trackById(index,item){return item.id}isValid(){return this.ngForm.valid}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||AccessControlArrayFormComponent2)}}static{this.\u0275cmp=core.VBU({type:AccessControlArrayFormComponent2,selectors:[["ds-access-control-array-form"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(_c0,7),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.ngForm=_t.first)}},inputs:{dropdownOptions:"dropdownOptions",mode:"mode",type:"type"},exportAs:["accessControlArrayForm"],standalone:!0,features:[core.aNF],decls:9,vars:7,consts:[["ngForm","ngForm"],["d","ngbDatepicker"],["d1","ngbDatepicker"],[1,"alert","alert-warning"],[1,"access-control-item","mt-3",3,"ngModelGroup"],["type","button",1,"btn","btn-outline-primary","mt-3",3,"click","id","dsBtnDisabled"],[1,"fas","fa-plus"],[1,"d-flex","flex-column"],[1,"form-label",3,"for"],[1,"form-select",3,"ngModelChange","id","disabled","ngModel","name"],["value",""],[3,"value"],[1,"form-text","text-muted"],[1,"mt-3"],["aria-hidden","true",1,"mb-2","d-inline-block"],[1,"input-group"],["type","button",1,"btn","btn-outline-danger",3,"click","dsBtnDisabled"],[1,"fas","fa-trash"],["placeholder","yyyy-mm-dd","ngbDatepicker","","placement","top-start top-end bottom-start bottom-end",1,"form-control",3,"ngModelChange","id","ngModel","name","maxDate"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","fas","fa-calendar",3,"click","dsBtnDisabled"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"form",null,0),core.DNE(2,AccessControlArrayFormComponent_Conditional_2_Template,3,3,"div",3),core.Z7z(3,AccessControlArrayFormComponent_For_4_Template,22,22,"div",4,ctx.trackById,!0),core.j41(5,"button",5),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.addAccessControlItem())}),core.nrm(6,"i",6),core.EFF(7),core.nI1(8,"translate"),core.k0s()()}if(2&rf){const ngForm_r8=core.sdS(1);core.R7$(2),core.vxM(ctx.showWarning?2:-1),core.R7$(),core.Dyx(ctx.form.accessControls),core.R7$(2),core.Mz_("id","add-btn-",ctx.type,""),core.Y8G("dsBtnDisabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(8,5,"access-control-add-more")," ")}},dependencies:[btn_disabled_directive.A,fesm2022_forms.YN,fesm2022_forms.qT,fesm2022_forms.xH,fesm2022_forms.y7,fesm2022_forms.me,fesm2022_forms.wz,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.vS,fesm2022_forms.Y4,fesm2022_forms.cV,ng_bootstrap.IQ,ng_bootstrap.cw,ToDatePipe,ngx_translate_core.h,ngx_translate_core.D9],styles:[".access-control-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 50px;grid-gap:10px;padding-bottom:15px;border-bottom:2px dotted gray}"]})}}return AccessControlArrayFormComponent2})();const emptyAccessControlItem=()=>({id:randomID(),itemName:null,startDate:null,hasStartDate:!1,maxStartDate:null,endDate:null,hasEndDate:!1,maxEndDate:null}),randomID=()=>Math.floor(1e6*Math.random());var bulk_access_control_service=__webpack_require__(46549),context_model=__webpack_require__(21571),bitstream_data_service=__webpack_require__(94999),pagination_service=__webpack_require__(31903),object_collection_component=(__webpack_require__(43575),__webpack_require__(66613)),pagination_component_options_model=__webpack_require__(54396);const item_access_control_select_bitstreams_modal_component_c0=a0=>({repeatable:!0,listId:a0});function ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Conditional_0_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-viewable-collection",6),2&rf){const bitstreams_r1=core.XpG(),ctx_r1=core.XpG();core.Y8G("config",ctx_r1.paginationConfig)("context",ctx_r1.context)("objects",bitstreams_r1)("selectable",!0)("selectionConfig",core.eq3(6,item_access_control_select_bitstreams_modal_component_c0,ctx_r1.LIST_ID))("showPaginator",!0)}}function ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Conditional_1_Template(rf,ctx){1&rf&&(core.j41(0,"div",7),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"access-control-select-bitstreams-modal.no-items")," "))}function ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Template(rf,ctx){if(1&rf&&core.DNE(0,ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Conditional_0_Template,1,8,"ds-viewable-collection",6)(1,ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Conditional_1_Template,3,3,"div",7),2&rf){const bitstreams_r1=ctx;core.vxM(bitstreams_r1.payload.page.length>0?0:-1),core.R7$(),core.vxM(bitstreams_r1&&0===bitstreams_r1.payload.page.length?1:-1)}}let ItemAccessControlSelectBitstreamsModalComponent=(()=>{class ItemAccessControlSelectBitstreamsModalComponent2{constructor(bitstreamService,paginationService,translateService,activeModal){this.bitstreamService=bitstreamService,this.paginationService=paginationService,this.translateService=translateService,this.activeModal=activeModal,this.LIST_ID="item-access-control-select-bitstreams",this.selectedBitstreams=[],this.context=context_model.o.Bitstream,this.paginationConfig=Object.assign(new pagination_component_options_model.W,{id:"iacsbm",currentPage:1,pageSize:5})}ngOnInit(){this.bitstreams$=this.paginationService.getCurrentPagination(this.paginationConfig.id,this.paginationConfig).pipe((0,operators.nx)(options=>this.bitstreamService.findAllByItemAndBundleName(this.item,"ORIGINAL",{elementsPerPage:options.pageSize,currentPage:options.currentPage},!0,!0)))}ngOnDestroy(){this.paginationService.clearPagination(this.paginationConfig.id)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemAccessControlSelectBitstreamsModalComponent2)(core.rXU(bitstream_data_service.BitstreamDataService),core.rXU(pagination_service.m),core.rXU(ngx_translate_core.c$),core.rXU(ng_bootstrap.Lw))}}static{this.\u0275cmp=core.VBU({type:ItemAccessControlSelectBitstreamsModalComponent2,selectors:[["ds-item-access-control-select-bitstreams-modal"]],inputs:{item:"item",selectedBitstreams:"selectedBitstreams"},standalone:!0,features:[core.aNF],decls:12,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[3,"config","context","objects","selectable","selectionConfig","showPaginator"],["role","alert",1,"alert","alert-info","w-100"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",0)(1,"h4",1),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",2),core.bIt("click",function(){return ctx.activeModal.dismiss("Cross click")}),core.k0s()(),core.j41(5,"div",3),core.DNE(6,ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Template,2,2),core.nI1(7,"async"),core.k0s(),core.j41(8,"div",4)(9,"button",5),core.bIt("click",function(){return ctx.activeModal.close("Close click")}),core.EFF(10),core.nI1(11,"translate"),core.k0s()()),2&rf){let tmp_1_0;core.R7$(2),core.SpI(" ",core.bMT(3,3,"access-control-select-bitstreams-modal.title")," "),core.R7$(4),core.vxM((tmp_1_0=core.bMT(7,5,ctx.bitstreams$))?6:-1,tmp_1_0),core.R7$(4),core.SpI(" ",core.bMT(11,7,"access-control-select-bitstreams-modal.close")," ")}},dependencies:[common.Jj,object_collection_component.h,ngx_translate_core.h,ngx_translate_core.D9]})}}return ItemAccessControlSelectBitstreamsModalComponent2})();const access_control_form_container_component_c0=["bitstreamAccessCmp"],_c1=["itemAccessCmp"],_c2=()=>[];function AccessControlFormContainerComponent_Conditional_3_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-alert",5),2&rf){const ctx_r1=core.XpG();core.Y8G("type",ctx_r1.AlertType.Info)("content",ctx_r1.titleMessage)}}function AccessControlFormContainerComponent_Conditional_43_Conditional_15_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"button",34),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r4);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.openSelectBitstreamsModal(ctx_r1.itemRD.payload))}),core.nrm(2,"i",35),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("dsBtnDisabled",!ctx_r1.state.bitstream.toggleStatus||"selected"!==ctx_r1.state.bitstream.changesLimit),core.BMQ("aria-label",core.bMT(1,2,"access-control-bitstreams-select"))}}function AccessControlFormContainerComponent_Conditional_43_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"div",11)(1,"fieldset",27)(2,"legend",28),core.EFF(3),core.nI1(4,"translate"),core.k0s(),core.j41(5,"div",14)(6,"input",29),core.mxI("ngModelChange",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.DH7(ctx_r1.state.bitstream.changesLimit,$event)||(ctx_r1.state.bitstream.changesLimit=$event),core.Njj($event)}),core.k0s(),core.j41(7,"label",30),core.EFF(8),core.nI1(9,"translate"),core.k0s()(),core.j41(10,"div",14)(11,"input",31),core.mxI("ngModelChange",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.DH7(ctx_r1.state.bitstream.changesLimit,$event)||(ctx_r1.state.bitstream.changesLimit=$event),core.Njj($event)}),core.k0s(),core.j41(12,"label",32),core.EFF(13),core.nI1(14,"translate"),core.DNE(15,AccessControlFormContainerComponent_Conditional_43_Conditional_15_Template,3,4,"button",33),core.k0s()()()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(3),core.SpI(" ",core.bMT(4,9,"access-control-limit-to-specific")," "),core.R7$(3),core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus),core.R50("ngModel",ctx_r1.state.bitstream.changesLimit),core.R7$(2),core.SpI(" ",core.bMT(9,11,"access-control-process-all-bitstreams")," "),core.R7$(3),core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus),core.R50("ngModel",ctx_r1.state.bitstream.changesLimit),core.R7$(2),core.Lme(" ",ctx_r1.state.bitstream.selectedBitstreams.length," ",core.bMT(14,13,"access-control-bitstreams-selected")," "),core.R7$(2),core.vxM(ctx_r1.itemRD?15:-1)}}function AccessControlFormContainerComponent_Conditional_66_Template(rf,ctx){1&rf&&core.nrm(0,"hr")}function AccessControlFormContainerComponent_Conditional_67_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",26)(1,"button",36),core.bIt("click",function(){core.eBV(_r5);const ctx_r1=core.XpG();return core.Njj(ctx_r1.reset())}),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",37),core.bIt("click",function(){core.eBV(_r5);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.SpI(" ",core.bMT(3,3,"access-control-cancel")," "),core.R7$(2),core.Y8G("dsBtnDisabled",!ctx_r1.state.item.toggleStatus&&!ctx_r1.state.bitstream.toggleStatus),core.R7$(),core.SpI(" ",core.bMT(6,5,"access-control-execute")," ")}}let AccessControlFormContainerComponent=(()=>{class AccessControlFormContainerComponent2{constructor(bulkAccessConfigService,bulkAccessControlService,selectableListService,modalService,cdr){this.bulkAccessConfigService=bulkAccessConfigService,this.bulkAccessControlService=bulkAccessControlService,this.selectableListService=selectableListService,this.modalService=modalService,this.cdr=cdr,this.showLimitToSpecificBitstreams=!1,this.titleMessage="",this.showSubmit=!0,this.AlertType=alert_type.v,this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}},this.dropdownData$=this.bulkAccessConfigService.findByName("default").pipe((0,shared_operators.qD)(),(0,operators.Tj)(configRD=>configRD.hasSucceeded?configRD.payload:null),(0,cjs.shareReplay)({refCount:!1,bufferSize:1}))}getFormValue(){return console.log({bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}),{bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}}reset(){this.bitstreamAccessCmp.reset(),this.itemAccessCmp.reset(),this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}}}submit(){const bitstreamAccess=this.bitstreamAccessCmp.getValue(),itemAccess=this.itemAccessCmp.getValue(),{file}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess,itemAccess,state:this.state});this.bulkAccessControlService.executeScript([this.itemRD.payload.uuid],file).pipe((0,operators.s)(1)).subscribe(res=>{console.log("success",res)})}handleStatusChange(type,active){"bitstream"===type?active?this.bitstreamAccessCmp.enable():this.bitstreamAccessCmp.disable():"item"===type&&(active?this.itemAccessCmp.enable():this.itemAccessCmp.disable())}openSelectBitstreamsModal(item){const ref=this.modalService.open(ItemAccessControlSelectBitstreamsModalComponent);ref.componentInstance.selectedBitstreams=this.state.bitstream.selectedBitstreams,ref.componentInstance.item=item,ref.closed.pipe((0,cjs.concatMap)(()=>this.selectableListService.getSelectableList("item-access-control-select-bitstreams")),(0,operators.s)(1)).subscribe(list=>{this.state.bitstream.selectedBitstreams=list?.selection||[],this.cdr.detectChanges()})}ngOnDestroy(){this.selectableListService.deselectAll("item-access-control-select-bitstreams")}isValid(){return this.bitstreamAccessCmp.isValid()||this.itemAccessCmp.isValid()}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||AccessControlFormContainerComponent2)(core.rXU(bulk_access_config_data_service.BulkAccessConfigDataService),core.rXU(bulk_access_control_service.r),core.rXU(selectable_list_service.K),core.rXU(ng_bootstrap.Bq),core.rXU(core.gRc))}}static{this.\u0275cmp=core.VBU({type:AccessControlFormContainerComponent2,selectors:[["ds-access-control-form-container"]],viewQuery:function(rf,ctx){if(1&rf&&(core.GBs(access_control_form_container_component_c0,7),core.GBs(_c1,7)),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.bitstreamAccessCmp=_t.first),core.mGM(_t=core.lsd())&&(ctx.itemAccessCmp=_t.first)}},inputs:{showLimitToSpecificBitstreams:"showLimitToSpecificBitstreams",titleMessage:"titleMessage",itemRD:"itemRD",showSubmit:"showSubmit"},exportAs:["dsAccessControlForm"],standalone:!0,features:[core.aNF],decls:68,vars:62,consts:[["itemAccessCmp",""],["bitstreamAccessCmp",""],[1,"container"],[1,"card","border-0"],[1,"card-body"],[1,"d-block","pb-3",3,"type","content"],[1,"row","mt-5"],[1,"col-12","col-md-6","border-end","d-flex","flex-column","justify-content-between"],[1,"d-flex","align-items-center"],[1,"h3","mb-0","me-4"],[3,"ngModelChange","ariaLabel","ngModel"],[1,"row","mt-3"],[1,"h4","col-12","col-md-3"],[1,"col-12","col-md-8"],[1,"form-check"],["type","radio","name","itemMode","id","itemReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemReplace",1,"form-check-label"],["type","radio","name","itemMode","id","itemAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemAdd",1,"form-check-label"],[1,"h4","mt-3"],[3,"type","mode","dropdownOptions"],[1,"col-12","col-md-6","d-flex","flex-column","justify-content-between"],["type","radio","name","bitstreamMode","id","bitstreamReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamReplace",1,"form-check-label"],["type","radio","name","bitstreamMode","id","bitstreamAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamAdd",1,"form-check-label"],[1,"d-flex","justify-content-end"],[1,"col-12"],[1,"h4"],["type","radio","name","changesLimit","id","processAll","value","all",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","processAll",1,"form-check-label"],["type","radio","name","changesLimit","id","processSelected","value","selected",1,"form-check-input","mt-2",3,"ngModelChange","disabled","ngModel"],["for","processSelected",1,"form-check-label"],["type","button",1,"btn","btn-outline-dark","border-0",3,"dsBtnDisabled"],["type","button",1,"btn","btn-outline-dark","border-0",3,"click","dsBtnDisabled"],[1,"fa","fa-search"],["type","button",1,"btn","btn-outline-primary","me-3",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","dsBtnDisabled"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",2)(1,"div",3)(2,"div",4),core.DNE(3,AccessControlFormContainerComponent_Conditional_3_Template,1,2,"ds-alert",5),core.j41(4,"div",6)(5,"div",7)(6,"div")(7,"div",8)(8,"h2",9),core.EFF(9),core.nI1(10,"translate"),core.k0s(),core.j41(11,"ui-switch",10),core.nI1(12,"translate"),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.toggleStatus,$event)||(ctx.state.item.toggleStatus=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){return core.eBV(_r1),core.Njj(ctx.handleStatusChange("item",$event))}),core.k0s()(),core.j41(13,"fieldset",11)(14,"legend",12),core.EFF(15),core.nI1(16,"translate"),core.k0s(),core.j41(17,"div",13)(18,"div",14)(19,"input",15),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.accessMode,$event)||(ctx.state.item.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(20,"label",16),core.EFF(21),core.nI1(22,"translate"),core.k0s()(),core.j41(23,"div",14)(24,"input",17),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.accessMode,$event)||(ctx.state.item.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(25,"label",18),core.EFF(26),core.nI1(27,"translate"),core.k0s()()()()(),core.j41(28,"div")(29,"h3",19),core.EFF(30),core.nI1(31,"translate"),core.k0s(),core.nrm(32,"ds-access-control-array-form",20,0),core.nI1(34,"async"),core.k0s()(),core.j41(35,"div",21)(36,"div")(37,"div",8)(38,"h2",9),core.EFF(39),core.nI1(40,"translate"),core.k0s(),core.j41(41,"ui-switch",10),core.nI1(42,"translate"),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.toggleStatus,$event)||(ctx.state.bitstream.toggleStatus=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){return core.eBV(_r1),core.Njj(ctx.handleStatusChange("bitstream",$event))}),core.k0s()(),core.DNE(43,AccessControlFormContainerComponent_Conditional_43_Template,16,15,"div",11),core.k0s(),core.j41(44,"fieldset",11)(45,"legend",12),core.EFF(46),core.nI1(47,"translate"),core.k0s(),core.j41(48,"div",13)(49,"div",14)(50,"input",22),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.accessMode,$event)||(ctx.state.bitstream.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(51,"label",23),core.EFF(52),core.nI1(53,"translate"),core.k0s()(),core.j41(54,"div",14)(55,"input",24),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.accessMode,$event)||(ctx.state.bitstream.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(56,"label",25),core.EFF(57),core.nI1(58,"translate"),core.k0s()()()(),core.j41(59,"div")(60,"h3",19),core.EFF(61),core.nI1(62,"translate"),core.k0s(),core.nrm(63,"ds-access-control-array-form",20,1),core.nI1(65,"async"),core.k0s()()(),core.DNE(66,AccessControlFormContainerComponent_Conditional_66_Template,1,0,"hr")(67,AccessControlFormContainerComponent_Conditional_67_Template,7,7,"div",26),core.k0s()()()}if(2&rf){let tmp_16_0,tmp_31_0;core.R7$(3),core.vxM(ctx.titleMessage?3:-1),core.R7$(6),core.SpI(" ",core.bMT(10,32,"access-control-item-header-toggle")," "),core.R7$(2),core.Y8G("ariaLabel",core.bMT(12,34,ctx.state.bitstream.toggleStatus?"access-control-item-toggle.disable":"access-control-item-toggle.enable")),core.R50("ngModel",ctx.state.item.toggleStatus),core.R7$(4),core.SpI(" ",core.bMT(16,36,"access-control-mode")," "),core.R7$(4),core.Y8G("disabled",!ctx.state.item.toggleStatus),core.R50("ngModel",ctx.state.item.accessMode),core.R7$(2),core.SpI(" ",core.bMT(22,38,"access-control-replace-all")," "),core.R7$(3),core.Y8G("disabled",!ctx.state.item.toggleStatus),core.R50("ngModel",ctx.state.item.accessMode),core.R7$(2),core.SpI(" ",core.bMT(27,40,"access-control-add-to-existing")," "),core.R7$(4),core.JRh(core.bMT(31,42,"access-control-access-conditions")),core.R7$(2),core.Y8G("type","item")("mode",ctx.state.item.accessMode)("dropdownOptions",(null==(tmp_16_0=core.bMT(34,44,ctx.dropdownData$))?null:tmp_16_0.itemAccessConditionOptions)||core.lJ4(60,_c2)),core.R7$(7),core.SpI(" ",core.bMT(40,46,"access-control-bitstream-header-toggle")," "),core.R7$(2),core.Y8G("ariaLabel",core.bMT(42,48,ctx.state.bitstream.toggleStatus?"access-control-bitstream-toggle.disable":"access-control-bitstream-toggle.enable")),core.R50("ngModel",ctx.state.bitstream.toggleStatus),core.R7$(2),core.vxM(ctx.showLimitToSpecificBitstreams?43:-1),core.R7$(3),core.SpI(" ",core.bMT(47,50,"access-control-mode")," "),core.R7$(4),core.Y8G("disabled",!ctx.state.bitstream.toggleStatus),core.R50("ngModel",ctx.state.bitstream.accessMode),core.R7$(2),core.SpI(" ",core.bMT(53,52,"access-control-replace-all")," "),core.R7$(3),core.Y8G("disabled",!ctx.state.bitstream.toggleStatus),core.R50("ngModel",ctx.state.bitstream.accessMode),core.R7$(2),core.SpI(" ",core.bMT(58,54,"access-control-add-to-existing")," "),core.R7$(4),core.JRh(core.bMT(62,56,"access-control-access-conditions")),core.R7$(2),core.Y8G("type","bitstream")("mode",ctx.state.bitstream.accessMode)("dropdownOptions",(null==(tmp_31_0=core.bMT(65,58,ctx.dropdownData$))?null:tmp_31_0.bitstreamAccessConditionOptions)||core.lJ4(61,_c2)),core.R7$(3),core.vxM(ctx.showSubmit?66:-1),core.R7$(),core.vxM(ctx.showSubmit?67:-1)}},dependencies:[AccessControlArrayFormComponent,alert_component.C,common.Jj,btn_disabled_directive.A,fesm2022_forms.YN,fesm2022_forms.me,fesm2022_forms.Fm,fesm2022_forms.BC,fesm2022_forms.vS,ngx_translate_core.h,ngx_translate_core.D9,ngx_ui_switch.z,ngx_ui_switch.S],styles:["fieldset[_ngcontent-%COMP%] > legend.col-12.col-md-3[_ngcontent-%COMP%]{width:100%}"]})}}return AccessControlFormContainerComponent2})()},46549:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{r:()=>BulkAccessControlService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(60444),_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(83183),_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39022),_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(54663),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2794),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(76623),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(25376),_angular_router__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(18134),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2385);let BulkAccessControlService=(()=>{class BulkAccessControlService2{constructor(notificationsService,router,scriptService,translationService){this.notificationsService=notificationsService,this.router=router,this.scriptService=scriptService,this.translationService=translationService}createPayloadFile(payload){const content=convertToBulkAccessControlFileModel(payload),blob=new Blob([JSON.stringify(content,null,2)],{type:"application/json"}),file=new File([blob],"data.json",{type:"application/json"});return{url:URL.createObjectURL(file),file}}executeScript(uuids,file){console.log("execute",{uuids,file});const params=[{name:"-f",value:file.name}];return uuids.forEach(uuid=>{params.push({name:"-u",value:uuid})}),this.scriptService.invoke("bulk-access-control",params,[file]).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.Tj)(rd=>{if(rd.hasSucceeded){const title=this.translationService.get("process.new.notification.success.title"),content=this.translationService.get("process.new.notification.success.content");return this.notificationsService.success(title,content),(0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.hj)(rd.payload)&&this.router.navigateByUrl((0,_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_5__.yJ)(rd.payload.processId)),!0}{const title=this.translationService.get("process.new.notification.error.title"),content=this.translationService.get("process.new.notification.error.content");return this.notificationsService.error(title,content),!1}}))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||BulkAccessControlService2)(_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__.I),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_angular_router__WEBPACK_IMPORTED_MODULE_7__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_0__.ScriptDataService),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__.c$))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_6__.jDH({token:BulkAccessControlService2,factory:BulkAccessControlService2.\u0275fac,providedIn:"root"})}}return BulkAccessControlService2})();const convertToBulkAccessControlFileModel=payload=>{const finalPayload={},bitstreamEnabled=payload.state.bitstream.toggleStatus;if(payload.state.item.toggleStatus&&(finalPayload.item={mode:payload.state.item.accessMode,accessConditions:payload.itemAccess}),bitstreamEnabled){const constraints={uuid:[]};bitstreamEnabled&&"selected"===payload.state.bitstream.changesLimit&&(constraints.uuid=payload.state.bitstream.selectedBitstreams.map(x=>x.id)),finalPayload.bitstream={constraints,mode:payload.state.bitstream.accessMode,accessConditions:payload.bitstreamAccess}}return finalPayload}},80173:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{U:()=>GoogleRecaptchaComponent});var _angular_common__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(87514),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(25376),src_app_core_services_window_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(97497),_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(93876),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(39022),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2794);let GoogleRecaptchaComponent=(()=>{class GoogleRecaptchaComponent2{constructor(_window,configService){this._window=_window,this.configService=configService,this.executeRecaptcha=new _angular_core__WEBPACK_IMPORTED_MODULE_3__.bkB,this.checkboxChecked=new _angular_core__WEBPACK_IMPORTED_MODULE_3__.bkB,this.showNotification=new _angular_core__WEBPACK_IMPORTED_MODULE_3__.bkB,this.dataCallbackFcn=$event=>{switch(this.captchaMode){case"invisible":this.executeRecaptcha.emit($event);break;case"checkbox":this.checkboxChecked.emit((0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.hj)($event));break;default:console.error(`Invalid reCaptcha mode '${this.captchaMode}`),this.showNotification.emit("error")}},this.expiredCallbackFcn=()=>{this.checkboxChecked.emit(!1),this.showNotification.emit("expired")},this.errorCallbackFcn=()=>{this.showNotification.emit("error")}}ngOnInit(){this.recaptchaKey$=this.configService.findByPropertyName("google.recaptcha.key.site").pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.ak)()),this._window.nativeWindow.dataCallback=this.dataCallbackFcn,this._window.nativeWindow.expiredCallback=this.expiredCallbackFcn,this._window.nativeWindow.errorCallback=this.errorCallbackFcn}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||GoogleRecaptchaComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_3__.rXU(src_app_core_services_window_service__WEBPACK_IMPORTED_MODULE_0__.lc),_angular_core__WEBPACK_IMPORTED_MODULE_3__.rXU(_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_1__.ConfigurationDataService))}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_3__.VBU({type:GoogleRecaptchaComponent2,selectors:[["ds-google-recaptcha"]],inputs:{captchaMode:"captchaMode"},outputs:{executeRecaptcha:"executeRecaptcha",checkboxChecked:"checkboxChecked",showNotification:"showNotification"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_3__.aNF],decls:2,vars:7,consts:[[1,"g-recaptcha"]],template:function(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_3__.nrm(0,"div",0),_angular_core__WEBPACK_IMPORTED_MODULE_3__.nI1(1,"async")),2&rf){let tmp_3_0;_angular_core__WEBPACK_IMPORTED_MODULE_3__.BMQ("data-callback","dataCallback")("data-expired-callback","expiredCallback")("data-error-callback","errorCallback")("data-sitekey",null==(tmp_3_0=_angular_core__WEBPACK_IMPORTED_MODULE_3__.bMT(1,5,ctx.recaptchaKey$))?null:tmp_3_0.values[0])("data-size","invisible"===ctx.captchaMode?"invisible":null)}},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_5__.Jj]})}}return GoogleRecaptchaComponent2})()},23219:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>HasNoValuePipe});var _empty_util__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2794),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25376);let HasNoValuePipe=(()=>{class HasNoValuePipe2{transform(value){return(0,_empty_util__WEBPACK_IMPORTED_MODULE_0__.Tn)(value)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||HasNoValuePipe2)}}static{this.\u0275pipe=_angular_core__WEBPACK_IMPORTED_MODULE_1__.EJ8({name:"dsHasNoValue",type:HasNoValuePipe2,pure:!0,standalone:!0})}}return HasNoValuePipe2})()},53359:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>UiSwitchComponent,z:()=>UiSwitchModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25376),_angular_forms__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(13054),_angular_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(87514);const _c0=["*"];function UiSwitchComponent_label_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"label",2)(1,"span",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(3,"span",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("color",ctx_r0.getColor("checkedTextColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",ctx_r0.checkedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(ctx_r0.checkedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("color",ctx_r0.getColor("uncheckedTextColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",ctx_r0.uncheckedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(ctx_r0.uncheckedLabel)}}const UI_SWITCH_OPTIONS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.nKC("UI_SWITCH_OPTIONS"),UI_SWITCH_CONTROL_VALUE_ACCESSOR={provide:_angular_forms__WEBPACK_IMPORTED_MODULE_1__.kq,useExisting:(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.Rfq)(()=>UiSwitchComponent),multi:!0};let UiSwitchComponent=(()=>{class UiSwitchComponent2{cdr;_checked;_disabled;_reverse;_loading;_beforeChange;size;color;switchOffColor;switchColor;defaultBgColor;defaultBoColor;checkedLabel;uncheckedLabel;checkedTextColor;uncheckedTextColor;beforeChange;ariaLabel;set checked(v){this._checked=!1!==v}get checked(){return this._checked}set disabled(v){this._disabled=!1!==v}get disabled(){return this._disabled}set reverse(v){this._reverse=!1!==v}get reverse(){return this._reverse}set loading(v){this._loading=!1!==v}get loading(){return this._loading}change=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB;changeEvent=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB;valueChange=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB;constructor(config={},cdr){this.cdr=cdr,this.size=config&&config.size||"medium",this.color=config&&config.color,this.switchOffColor=config&&config.switchOffColor,this.switchColor=config&&config.switchColor,this.defaultBgColor=config&&config.defaultBgColor,this.defaultBoColor=config&&config.defaultBoColor,this.checkedLabel=config&&config.checkedLabel,this.uncheckedLabel=config&&config.uncheckedLabel,this.checkedTextColor=config&&config.checkedTextColor,this.uncheckedTextColor=config&&config.uncheckedTextColor}getColor(flag=""){return"borderColor"===flag?this.defaultBoColor:"switchColor"===flag?this.reverse?this.checked&&this.switchOffColor||this.switchColor:this.checked?this.switchColor:this.switchOffColor||this.switchColor:"checkedTextColor"===flag?this.reverse?this.uncheckedTextColor:this.checkedTextColor:"uncheckedTextColor"===flag?this.reverse?this.checkedTextColor:this.uncheckedTextColor:this.reverse?this.checked?this.defaultBgColor:this.color:this.checked?this.color:this.defaultBgColor}onClick(event){this.disabled||(this.checked=!this.checked,this.change.emit(this.checked),this.valueChange.emit(this.checked),this.changeEvent.emit(event),this.onChangeCallback(this.checked),this.onTouchedCallback(this.checked),this.cdr.markForCheck())}onToggle(event){this.disabled||(this.beforeChange?this._beforeChange=this.beforeChange.subscribe(confirm=>{confirm&&this.onClick(event)}):this.onClick(event))}writeValue(obj){obj!==this.checked&&(this.checked=!!obj),this.onChangeCallback(this.checked),this.cdr&&this.cdr.markForCheck()}registerOnChange(fn){this.onChangeCallback=fn}registerOnTouched(fn){this.onTouchedCallback=fn}setDisabledState(isDisabled){this.disabled=isDisabled}onTouchedCallback=v=>{};onChangeCallback=v=>{};ngOnDestroy(){this._beforeChange&&this._beforeChange.unsubscribe()}static \u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||UiSwitchComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.rXU(UI_SWITCH_OPTIONS,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.rXU(_angular_core__WEBPACK_IMPORTED_MODULE_0__.gRc))};static \u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:UiSwitchComponent2,selectors:[["ui-switch"]],hostBindings:function(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__.bIt("click",function($event){return ctx.onToggle($event)})},inputs:{size:"size",color:"color",switchOffColor:"switchOffColor",switchColor:"switchColor",defaultBgColor:"defaultBgColor",defaultBoColor:"defaultBoColor",checkedLabel:"checkedLabel",uncheckedLabel:"uncheckedLabel",checkedTextColor:"checkedTextColor",uncheckedTextColor:"uncheckedTextColor",beforeChange:"beforeChange",ariaLabel:"ariaLabel",checked:"checked",disabled:"disabled",reverse:"reverse",loading:"loading"},outputs:{change:"change",changeEvent:"changeEvent",valueChange:"valueChange"},features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.Jv_([UI_SWITCH_CONTROL_VALUE_ACCESSOR])],ngContentSelectors:_c0,decls:4,vars:21,consts:[["type","button","role","switch",1,"switch"],["class","switch-pane",4,"ngIf"],[1,"switch-pane"],[1,"switch-label-checked"],[1,"switch-label-unchecked"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.NAR(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"button",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.DNE(1,UiSwitchComponent_label_1_Template,5,8,"label",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(2,"small"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SdG(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("background-color",ctx.getColor())("border-color",ctx.getColor("borderColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.AVh("checked",ctx.checked)("disabled",ctx.disabled)("loading",ctx.loading)("switch-large","large"===ctx.size)("switch-medium","medium"===ctx.size)("switch-small","small"===ctx.size),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-checked",ctx.checked)("aria-label",ctx.ariaLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("ngIf",ctx.checkedLabel||ctx.uncheckedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("background",ctx.getColor("switchColor")))},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_2__.bT],encapsulation:2})}return UiSwitchComponent2})(),UiSwitchModule=(()=>{class UiSwitchModule2{static forRoot(config){return{ngModule:UiSwitchModule2,providers:[{provide:UI_SWITCH_OPTIONS,useValue:config||{}}]}}static \u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||UiSwitchModule2)};static \u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.$C({type:UiSwitchModule2});static \u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.G2t({imports:[_angular_common__WEBPACK_IMPORTED_MODULE_2__.MD,_angular_forms__WEBPACK_IMPORTED_MODULE_1__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_1__.YN]})}return UiSwitchModule2})()}};