"use strict";exports.id=1219,exports.ids=[1219,7871,6196],exports.modules={31219:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ROUTES:()=>ROUTES});var i18n_breadcrumb_resolver=__webpack_require__(12213),common=__webpack_require__(87514),ng_bootstrap=__webpack_require__(87969),ngx_translate_core=__webpack_require__(2385),rest_request_method=__webpack_require__(73094),dspace_rest_service=__webpack_require__(231),environment=__webpack_require__(64369),fesm2022_forms=__webpack_require__(13054);class Filter{constructor(id,hasTooltip=!1){this.id=id,this.hasTooltip=hasTooltip}}class FilterGroup{constructor(id,filters){this.filters=filters,this.id=id,this.key="admin.reports.commons.filters."+id,filters.forEach(filter=>{filter.key=this.key+"."+filter.id,filter.hasTooltip&&(filter.tooltipKey=filter.key+".tooltip")})}}var core=__webpack_require__(25376);function FiltersComponent_For_19_For_6_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",7),core.nrm(1,"input",8),core.j41(2,"label",9),core.nI1(3,"translate"),core.EFF(4),core.nI1(5,"translate"),core.k0s()()),2&rf){const filter_r1=ctx.$implicit;core.R7$(),core.Mz_("id","flt-",filter_r1.id,""),core.FS9("value",filter_r1.id),core.FS9("formControlName",filter_r1.id),core.R7$(),core.Mz_("for","flt-",filter_r1.id,""),core.FS9("title",core.bMT(3,8,filter_r1.tooltipKey)),core.R7$(2),core.JRh(core.bMT(5,10,filter_r1.key))}}function FiltersComponent_For_19_Template(rf,ctx){if(1&rf&&(core.j41(0,"fieldset",0)(1,"legend"),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.qex(4,6),core.Z7z(5,FiltersComponent_For_19_For_6_Template,6,12,"div",7,core.fX1),core.bVm(),core.k0s()),2&rf){const group_r2=ctx.$implicit,ctx_r2=core.XpG();core.R7$(2),core.JRh(core.bMT(3,2,group_r2.key)),core.R7$(2),core.Y8G("formGroup",ctx_r2.filtersForm),core.R7$(),core.Dyx(group_r2.filters)}}class FiltersComponent{static{this.FILTERS=[new FilterGroup("property",[new Filter("is_item"),new Filter("is_withdrawn"),new Filter("is_not_withdrawn"),new Filter("is_discoverable"),new Filter("is_not_discoverable")]),new FilterGroup("bitstream",[new Filter("has_multiple_originals"),new Filter("has_no_originals"),new Filter("has_one_original")]),new FilterGroup("bitstream_mime",[new Filter("has_doc_original"),new Filter("has_image_original"),new Filter("has_unsupp_type"),new Filter("has_mixed_original"),new Filter("has_pdf_original"),new Filter("has_jpg_original"),new Filter("has_small_pdf"),new Filter("has_large_pdf"),new Filter("has_doc_without_text")]),new FilterGroup("mime",[new Filter("has_only_supp_image_type"),new Filter("has_unsupp_image_type"),new Filter("has_only_supp_doc_type"),new Filter("has_unsupp_doc_type")]),new FilterGroup("bundle",[new Filter("has_unsupported_bundle"),new Filter("has_small_thumbnail"),new Filter("has_original_without_thumbnail"),new Filter("has_invalid_thumbnail_name"),new Filter("has_non_generated_thumb"),new Filter("no_license"),new Filter("has_license_documentation")]),new FilterGroup("permission",[new Filter("has_restricted_original",!0),new Filter("has_restricted_thumbnail",!0),new Filter("has_restricted_metadata",!0)])]}static formGroup(formBuilder){const fields={},allFilters=FiltersComponent.FILTERS;for(let i=0;i<allFilters.length;i++){const group=allFilters[i];for(let j=0;j<group.filters.length;j++)fields[group.filters[j].id]=new fesm2022_forms.MJ(!1)}return formBuilder.group(fields)}static getFilter(filterId){const allFilters=FiltersComponent.FILTERS;for(let i=0;i<allFilters.length;i++){const group=allFilters[i];for(let j=0;j<group.filters.length;j++){const filter=group.filters[j];if(filter.id===filterId)return filter}}}static getGroup(filterId){const allFilters=FiltersComponent.FILTERS;for(let i=0;i<allFilters.length;i++){const group=allFilters[i];for(let j=0;j<group.filters.length;j++)if(group.filters[j].id===filterId)return group}}static toQueryString(filters){let params="",first=!0;for(const key in filters)filters[key]&&(first?first=!1:params+="&",params+=`filters=${key}`);return params}allFilters(){return FiltersComponent.FILTERS}setAllFilters(value){const fields={},allFilters=FiltersComponent.FILTERS;for(let i=0;i<allFilters.length;i++){const group=allFilters[i];for(let j=0;j<group.filters.length;j++)fields[group.filters[j].id]=value}this.filtersForm.setValue(fields)}selectAll(){this.setAllFilters(!0)}deselectAll(){this.setAllFilters(!1)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||FiltersComponent)}}static{this.\u0275cmp=core.VBU({type:FiltersComponent,selectors:[["ds-filters"]],inputs:{filtersForm:"filtersForm"},standalone:!0,features:[core.aNF],decls:20,vars:6,consts:[[1,"row","row-cols-2"],[1,"col-12"],[1,"col-1"],["id","btnSelectAllFilters",1,"btn","btn-light","mt-1","col-4",3,"click"],[1,"col-2"],["id","btnDeselectAllFilters",1,"btn","btn-light","mt-1","col-4",3,"click"],[3,"formGroup"],[1,"col-6"],["type","checkbox",1,"form-check-input","col-1",3,"id","value","formControlName"],[1,"col-11","align-middle",3,"for","title"]],template:function(rf,ctx){1&rf&&(core.j41(0,"fieldset",0),core.qex(1),core.j41(2,"span",1),core.EFF(3,"\xa0"),core.k0s(),core.j41(4,"span",2),core.EFF(5,"\xa0"),core.k0s(),core.j41(6,"button",3),core.bIt("click",function(){return ctx.selectAll()}),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.j41(9,"span",4),core.EFF(10,"\xa0"),core.k0s(),core.j41(11,"button",5),core.bIt("click",function(){return ctx.deselectAll()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"span",2),core.EFF(15,"\xa0"),core.k0s(),core.j41(16,"span",1),core.EFF(17,"\xa0"),core.k0s(),core.bVm(),core.k0s(),core.Z7z(18,FiltersComponent_For_19_Template,7,4,"fieldset",0,core.fX1)),2&rf&&(core.R7$(7),core.JRh(core.bMT(8,2,"admin.reports.commons.filters.select_all")),core.R7$(5),core.JRh(core.bMT(13,4,"admin.reports.commons.filters.deselect_all")),core.R7$(6),core.Dyx(ctx.allFilters()))},dependencies:[fesm2022_forms.X1,fesm2022_forms.Zm,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,ngx_translate_core.h,ngx_translate_core.D9],styles:[".col-6[_ngcontent-%COMP%] > label.col-11.align-middle[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}fieldset.row-cols-2[_ngcontent-%COMP%] > legend[_ngcontent-%COMP%]{float:none!important}"]})}}class FilteredCollection{constructor(){this.values={}}clear(){this.label="",this.handle="",this.communityLabel="",this.communityHandle="",this.nbTotalItems=0,this.values={},this.allFiltersValue=0}deserialize(object){this.clear(),this.label=object.label,this.handle=object.handle,this.communityLabel=object.community_label,this.communityHandle=object.community_handle,this.nbTotalItems=object.nb_total_items;const valuesPerFilter=object.values;for(const filter in valuesPerFilter)valuesPerFilter.hasOwnProperty(filter)&&(this.values[filter]=valuesPerFilter[filter]);this.allFiltersValue=object.all_filters_value}}class FilteredCollections{constructor(){this.collections=[],this.summary=new FilteredCollection}clear(){this.collections.splice(0,this.collections.length),this.summary.clear()}deserialize(object){this.clear(),this.summary.deserialize(object.summary);const collections=object.collections;for(let i=0;i<collections.length;i++){const collection=collections[i],coll=new FilteredCollection;coll.deserialize(collection),this.collections.push(coll)}}}const _c0=["acc"];function FilteredCollectionsComponent_ng_template_10_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"admin.reports.commons.filters")," ")}function FilteredCollectionsComponent_ng_template_11_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",1)(1,"div",11),core.nrm(2,"span",12),core.j41(3,"button",13),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.EFF(4),core.nI1(5,"translate"),core.k0s()(),core.nrm(6,"ds-filters",14),core.j41(7,"div",11),core.nrm(8,"span",12),core.j41(9,"button",13),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.EFF(10),core.nI1(11,"translate"),core.k0s()()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(4),core.JRh(core.bMT(5,3,"admin.reports.button.show-collections")),core.R7$(2),core.Y8G("filtersForm",ctx_r1.filtersFormGroup()),core.R7$(4),core.JRh(core.bMT(11,5,"admin.reports.button.show-collections"))}}function FilteredCollectionsComponent_ng_template_13_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"admin.reports.collections.collections-report")," ")}function FilteredCollectionsComponent_ng_template_14_For_16_Template(rf,ctx){if(1&rf&&(core.j41(0,"th"),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const filter_r3=ctx.$implicit,ctx_r1=core.XpG(2);core.R7$(),core.JRh(core.bMT(2,1,"admin.reports.commons.filters."+ctx_r1.getGroup(filter_r3.key)+"."+filter_r3.key))}}function FilteredCollectionsComponent_ng_template_14_For_24_Template(rf,ctx){if(1&rf&&(core.j41(0,"th",18),core.EFF(1),core.k0s()),2&rf){const filter_r4=ctx.$implicit;core.R7$(),core.JRh(filter_r4.value)}}function FilteredCollectionsComponent_ng_template_14_For_28_For_12_Template(rf,ctx){if(1&rf&&(core.j41(0,"td",18),core.EFF(1),core.k0s()),2&rf){const filter_r5=ctx.$implicit,coll_r6=core.XpG().$implicit;core.R7$(),core.JRh(coll_r6.values[filter_r5.key]||0)}}function FilteredCollectionsComponent_ng_template_14_For_28_Template(rf,ctx){if(1&rf&&(core.j41(0,"tr")(1,"td")(2,"a",19),core.EFF(3),core.k0s()(),core.j41(4,"td")(5,"a",19),core.EFF(6),core.k0s()(),core.j41(7,"td",18),core.EFF(8),core.k0s(),core.j41(9,"td",18),core.EFF(10),core.k0s(),core.Z7z(11,FilteredCollectionsComponent_ng_template_14_For_28_For_12_Template,2,1,"td",18,core.fX1),core.nI1(13,"keyvalue"),core.k0s()),2&rf){const coll_r6=ctx.$implicit,ctx_r1=core.XpG(2);core.R7$(2),core.Mz_("href","/handle/",coll_r6.communityHandle,"",core.B4B),core.R7$(),core.JRh(coll_r6.communityLabel),core.R7$(2),core.Mz_("href","/handle/",coll_r6.handle,"",core.B4B),core.R7$(),core.JRh(coll_r6.label),core.R7$(2),core.JRh(coll_r6.nbTotalItems),core.R7$(2),core.JRh(coll_r6.allFiltersValue),core.R7$(),core.Dyx(core.bMT(13,8,ctx_r1.results.summary.values))}}function FilteredCollectionsComponent_ng_template_14_Template(rf,ctx){if(1&rf&&(core.j41(0,"table",15)(1,"thead")(2,"tr",16)(3,"th",17),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"th",17),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.j41(9,"th"),core.EFF(10),core.nI1(11,"translate"),core.k0s(),core.j41(12,"th"),core.EFF(13),core.nI1(14,"translate"),core.k0s(),core.Z7z(15,FilteredCollectionsComponent_ng_template_14_For_16_Template,3,3,"th",null,core.fX1),core.nI1(17,"keyvalue"),core.k0s(),core.j41(18,"tr",16)(19,"th",18),core.EFF(20),core.k0s(),core.j41(21,"th",18),core.EFF(22),core.k0s(),core.Z7z(23,FilteredCollectionsComponent_ng_template_14_For_24_Template,2,1,"th",18,core.fX1),core.nI1(25,"keyvalue"),core.k0s()(),core.j41(26,"tbody"),core.Z7z(27,FilteredCollectionsComponent_ng_template_14_For_28_Template,14,10,"tr",null,core.fX1),core.k0s()()),2&rf){const ctx_r1=core.XpG();core.R7$(4),core.JRh(core.bMT(5,6,"admin.reports.collections.community")),core.R7$(3),core.JRh(core.bMT(8,8,"admin.reports.collections.collection")),core.R7$(3),core.JRh(core.bMT(11,10,"admin.reports.collections.nb_items")),core.R7$(3),core.JRh(core.bMT(14,12,"admin.reports.collections.match_all_selected_filters")),core.R7$(2),core.Dyx(core.bMT(17,14,ctx_r1.results.summary.values)),core.R7$(5),core.JRh(ctx_r1.results.summary.nbTotalItems),core.R7$(2),core.JRh(ctx_r1.results.summary.allFiltersValue),core.R7$(),core.Dyx(core.bMT(25,16,ctx_r1.results.summary.values)),core.R7$(4),core.Dyx(ctx_r1.results.collections)}}let FilteredCollectionsComponent=(()=>{class FilteredCollectionsComponent2{constructor(formBuilder,restService){this.formBuilder=formBuilder,this.restService=restService,this.results=new FilteredCollections}ngOnInit(){this.queryForm=this.formBuilder.group({filters:FiltersComponent.formGroup(this.formBuilder)})}filtersFormGroup(){return this.queryForm.get("filters")}getGroup(filterId){return FiltersComponent.getGroup(filterId).id}submit(){this.getFilteredCollections().subscribe(response=>{this.results.deserialize(response.payload),this.accordionComponent.expand("collections")})}getFilteredCollections(){let params=this.toQueryString();return params.length>0&&(params=`?${params}`),this.restService.request(rest_request_method.D.GET,`${environment.c.rest.ssl?"https":"http"}://${environment.c.rest.host}:${environment.c.rest.port}${environment.c.rest.nameSpace}/api/contentreport/filteredcollections${params}`)}toQueryString(){return FiltersComponent.toQueryString(this.queryForm.value.filters)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||FilteredCollectionsComponent2)(core.rXU(fesm2022_forms.ok),core.rXU(dspace_rest_service.Y))}}static{this.\u0275cmp=core.VBU({type:FilteredCollectionsComponent2,selectors:[["ds-report-filtered-collections"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(_c0,5),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.accordionComponent=_t.first)}},standalone:!0,features:[core.aNF],decls:15,vars:4,consts:[["acc","ngbAccordion"],[1,"container"],[1,"metadata-registry","row"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","metadatadiv"],["activeIds","filters",3,"closeOthers"],["id","filters"],["ngbPanelTitle",""],["ngbPanelContent",""],["id","collections"],[1,"row"],[1,"col-3"],[1,"btn","btn-primary","mt-1","col-6",3,"click"],[3,"filtersForm"],["id","table",1,"table","table-striped"],[1,"header"],["rowspan","2"],[1,"num"],["rel","noopener noreferrer","target","_blank",3,"href"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1",4),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"div",5)(7,"ngb-accordion",6,0)(9,"ngb-panel",7),core.DNE(10,FilteredCollectionsComponent_ng_template_10_Template,2,3,"ng-template",8)(11,FilteredCollectionsComponent_ng_template_11_Template,12,7,"ng-template",9),core.k0s(),core.j41(12,"ngb-panel",10),core.DNE(13,FilteredCollectionsComponent_ng_template_13_Template,2,3,"ng-template",8)(14,FilteredCollectionsComponent_ng_template_14_Template,29,18,"ng-template",9),core.k0s()()()()()()),2&rf&&(core.R7$(4),core.JRh(core.bMT(5,2,"admin.reports.collections.head")),core.R7$(3),core.Y8G("closeOthers",!0))},dependencies:[FiltersComponent,common.lG,ng_bootstrap._f,ng_bootstrap.W1,ng_bootstrap.CT,ng_bootstrap.sb,ng_bootstrap.t3,ngx_translate_core.h,ngx_translate_core.D9],styles:[".num[_ngcontent-%COMP%]{text-align:center}"]})}}return FilteredCollectionsComponent2})();var cjs=__webpack_require__(9238),collection_data_service=__webpack_require__(8108),community_data_service=__webpack_require__(42349),authorization_data_service=__webpack_require__(76509),metadata_field_data_service=__webpack_require__(46196),metadata_schema_data_service=__webpack_require__(97871),script_data_service=__webpack_require__(83183),operators=__webpack_require__(39022),empty_util=__webpack_require__(2794),themed_loading_component=__webpack_require__(18869),btn_disabled_directive=__webpack_require__(69919),cjs_operators=__webpack_require__(60444),feature_id=__webpack_require__(86583),process_page_routing_paths=__webpack_require__(54663),notifications_service=__webpack_require__(76623);class OptionVO{constructor(){this.disabled=!1}static collection(id,name,disabled=!1){const opt=new OptionVO;return opt.id=id,opt.name$=OptionVO.toObservable(name),opt.disabled=disabled,opt}static collectionLoc(id,name$,disabled=!1){const opt=new OptionVO;return opt.id=id,opt.name$=name$,opt.disabled=disabled,opt}static item(id,name){const opt=new OptionVO;return opt.id=id,opt.name$=OptionVO.toObservable(name),opt}static itemLoc(id,name$){const opt=new OptionVO;return opt.id=id,opt.name$=name$,opt}static toObservable(value){return new cjs.Observable(subscriber=>{subscriber.next(value),subscriber.complete()})}static toString(obj){return obj?obj instanceof OptionVO&&obj.id?obj.id:obj:""}}let QueryPredicate=(()=>{class QueryPredicate2{constructor(){this.field="*"}static{this.EXISTS="exists"}static{this.DOES_NOT_EXIST="doesnt_exist"}static{this.EQUALS="equals"}static{this.DOES_NOT_EQUAL="not_equals"}static{this.LIKE="like"}static{this.NOT_LIKE="not_like"}static{this.CONTAINS="contains"}static{this.DOES_NOT_CONTAIN="doesnt_contain"}static{this.MATCHES="matches"}static{this.DOES_NOT_MATCH="doesnt_match"}static of(field,operator,value=""){const pred=new QueryPredicate2;return pred.field=field,pred.operator=operator,pred.value=value,pred}static toString(pred){return pred.value?`${pred.field}:${pred.operator}:${pred.value}`:`${pred.field}:${pred.operator}`}toFormGroup(formBuilder){return formBuilder.group({field:new fesm2022_forms.MJ(this.field),operator:new fesm2022_forms.MJ(this.operator),value:new fesm2022_forms.MJ(this.value)})}}return QueryPredicate2})();var router=__webpack_require__(18134);function FilteredItemsExportCsvComponent_Conditional_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"button",1),core.nI1(1,"translate"),core.nI1(2,"translate"),core.nI1(3,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.export())}),core.nrm(4,"i",2),core.k0s()}if(2&rf){const ctx_r1=core.XpG();core.Y8G("ngbTooltip",core.bMT(1,3,ctx_r1.tooltipMsg))("title",core.bMT(2,5,ctx_r1.tooltipMsg)),core.BMQ("aria-label",core.bMT(3,7,ctx_r1.tooltipMsg))}}let FilteredItemsExportCsvComponent=(()=>{class FilteredItemsExportCsvComponent2{constructor(scriptDataService,authorizationDataService,notificationsService,translateService,router2){this.scriptDataService=scriptDataService,this.authorizationDataService=authorizationDataService,this.notificationsService=notificationsService,this.translateService=translateService,this.router=router2,this.tooltipMsg="metadata-export-filtered-items.tooltip"}static csvExportEnabled(scriptDataService,authorizationDataService){const scriptExists$=scriptDataService.findById("metadata-export-filtered-items-report").pipe((0,operators.qD)(),(0,cjs_operators.Tj)(rd=>rd.isSuccess&&(0,empty_util.a4)(rd.payload))),isAuthorized$=authorizationDataService.isAuthorized(feature_id._.AdministratorOf);return(0,cjs.combineLatest)([scriptExists$,isAuthorized$]).pipe((0,cjs_operators.Tj)(([scriptExists,isAuthorized])=>scriptExists&&isAuthorized))}ngOnInit(){this.shouldShowButton$=FilteredItemsExportCsvComponent2.csvExportEnabled(this.scriptDataService,this.authorizationDataService)}export(){const parameters=[],colls=this.reportParams.value.collections||[];for(let i=0;i<colls.length;i++)colls[i]&&parameters.push({name:"-c",value:OptionVO.toString(colls[i])});const preds=this.reportParams.value.queryPredicates||[];for(let i=0;i<preds.length;i++)preds[i].field&&preds[i].operator&&parameters.push({name:"-qp",value:QueryPredicate.toString(preds[i])});const filters=FiltersComponent.toQueryString(this.reportParams.value.filters)||[];filters.length>0&&parameters.push({name:"-f",value:filters}),this.scriptDataService.invoke("metadata-export-filtered-items-report",parameters,[]).pipe((0,operators.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get("metadata-export-filtered-items.submit.success")),this.router.navigateByUrl((0,process_page_routing_paths.yJ)(rd.payload.processId))):this.notificationsService.error(this.translateService.get("metadata-export-filtered-items.submit.error"))})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||FilteredItemsExportCsvComponent2)(core.rXU(script_data_service.ScriptDataService),core.rXU(authorization_data_service.AuthorizationDataService),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(router.Ix))}}static{this.\u0275cmp=core.VBU({type:FilteredItemsExportCsvComponent2,selectors:[["ds-filtered-items-export-csv"]],inputs:{reportParams:"reportParams"},standalone:!0,features:[core.aNF],decls:2,vars:3,consts:[[1,"export-button","btn","btn-dark","btn-sm",3,"ngbTooltip","title"],[1,"export-button","btn","btn-dark","btn-sm",3,"click","ngbTooltip","title"],[1,"fas","fa-file-export","fa-fw"]],template:function(rf,ctx){1&rf&&(core.DNE(0,FilteredItemsExportCsvComponent_Conditional_0_Template,5,9,"button",0),core.nI1(1,"async")),2&rf&&core.vxM(core.bMT(1,1,ctx.shouldShowButton$)?0:-1)},dependencies:[common.Jj,ng_bootstrap.n8,ng_bootstrap.md,ngx_translate_core.h,ngx_translate_core.D9],styles:[".export-button[_ngcontent-%COMP%]{background:var(--ds-admin-sidebar-bg);border-color:var(--ds-admin-sidebar-bg)}"]})}}return FilteredItemsExportCsvComponent2})();class FilteredItems{constructor(){this.items=[]}clear(){this.items.splice(0,this.items.length)}deserialize(object,offset=0){this.clear(),this.itemCount=object.itemCount;const items=object.items;for(let i=0;i<items.length;i++){const item=items[i];item.index=this.items.length+offset+1,this.items.push(item)}}}class PresetQuery{static of(id,label,predicates){const query=new PresetQuery;return query.id=id,query.label=label,query.predicates=predicates,query}}const filtered_items_component_c0=["acc"],_forTrack0=($index,$item)=>$item.id;function FilteredItemsComponent_ng_template_10_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"admin.reports.items.section.collectionSelector")," ")}function FilteredItemsComponent_ng_template_11_Conditional_0_Template(rf,ctx){1&rf&&core.nrm(0,"ds-loading")}function FilteredItemsComponent_ng_template_11_Conditional_2_For_2_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",19),core.EFF(1),core.nI1(2,"async"),core.k0s()),2&rf){const item_r2=ctx.$implicit;core.Y8G("value",item_r2.id)("disabled",item_r2.disabled),core.R7$(),core.JRh(core.bMT(2,3,item_r2.name$))}}function FilteredItemsComponent_ng_template_11_Conditional_2_Template(rf,ctx){if(1&rf&&(core.j41(0,"select",15),core.Z7z(1,FilteredItemsComponent_ng_template_11_Conditional_2_For_2_Template,3,5,"option",19,core.fX1),core.k0s()),2&rf){const ctx_r2=core.XpG(2);core.R7$(),core.Dyx(ctx_r2.collections)}}function FilteredItemsComponent_ng_template_11_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.DNE(0,FilteredItemsComponent_ng_template_11_Conditional_0_Template,1,0,"ds-loading"),core.nI1(1,"async"),core.DNE(2,FilteredItemsComponent_ng_template_11_Conditional_2_Template,3,0,"select",15),core.nI1(3,"async"),core.j41(4,"div",16),core.nrm(5,"span",17),core.j41(6,"button",18),core.bIt("click",function(){core.eBV(_r1);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.EFF(7),core.nI1(8,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG();core.vxM(core.bMT(1,3,ctx_r2.loadingCollections$)?0:-1),core.R7$(2),core.vxM(!0!==core.bMT(3,5,ctx_r2.loadingCollections$)?2:-1),core.R7$(5),core.JRh(core.bMT(8,7,"admin.reports.items.run"))}}function FilteredItemsComponent_ng_template_13_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"admin.reports.items.section.metadataFieldQueries")," ")}function FilteredItemsComponent_ng_template_14_For_6_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",22),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const item_r5=ctx.$implicit;core.Y8G("value",item_r5.id)("selected",item_r5.isDefault),core.R7$(),core.JRh(core.bMT(2,3,item_r5.label))}}function FilteredItemsComponent_ng_template_14_For_11_For_6_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",28),core.EFF(1),core.nI1(2,"async"),core.k0s()),2&rf){const item_r7=ctx.$implicit;core.Y8G("value",item_r7.id),core.R7$(),core.JRh(core.bMT(2,2,item_r7.name$))}}function FilteredItemsComponent_ng_template_14_For_11_For_10_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",28),core.EFF(1),core.nI1(2,"async"),core.nI1(3,"translate"),core.k0s()),2&rf){const item_r8=ctx.$implicit;core.Y8G("value",item_r8.id),core.R7$(),core.JRh(core.bMT(3,4,core.bMT(2,2,item_r8.name$)))}}function FilteredItemsComponent_ng_template_14_For_11_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",24)(1,"div",25)(2,"div",16)(3,"div",26)(4,"select",27),core.Z7z(5,FilteredItemsComponent_ng_template_14_For_11_For_6_Template,3,4,"option",28,core.fX1),core.k0s()(),core.j41(7,"div",29)(8,"select",30),core.Z7z(9,FilteredItemsComponent_ng_template_14_For_11_For_10_Template,4,6,"option",28,core.fX1),core.k0s()(),core.j41(11,"div",31),core.nrm(12,"input",32),core.k0s(),core.j41(13,"div",29)(14,"button",33),core.bIt("click",function(){core.eBV(_r6);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.addQueryPredicate())}),core.EFF(15,"+"),core.k0s(),core.EFF(16," \xa0 "),core.j41(17,"button",34),core.bIt("click",function(){const \u0275$index_70_r9=core.eBV(_r6).$index,ctx_r2=core.XpG(2);return core.Njj(ctx_r2.deleteQueryPredicate(\u0275$index_70_r9))}),core.EFF(18,"\u2013"),core.k0s()()()()()}if(2&rf){const pred_r10=ctx.$implicit,ctx_r2=core.XpG(2);core.R7$(),core.Y8G("formGroup",pred_r10),core.R7$(4),core.Dyx(ctx_r2.metadataFieldsWithAny),core.R7$(4),core.Dyx(ctx_r2.predicates),core.R7$(8),core.Y8G("dsBtnDisabled",ctx_r2.deleteQueryPredicateDisabled())}}function FilteredItemsComponent_ng_template_14_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"fieldset",20)(1,"label"),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"select",21),core.bIt("change",function(){core.eBV(_r4);const ctx_r2=core.XpG();return core.Njj(ctx_r2.setPresetQuery())}),core.Z7z(5,FilteredItemsComponent_ng_template_14_For_6_Template,3,5,"option",22,_forTrack0),core.k0s()(),core.j41(7,"div",16),core.EFF(8,"\xa0"),core.k0s(),core.j41(9,"div",23),core.Z7z(10,FilteredItemsComponent_ng_template_14_For_11_Template,19,2,"div",24,core.fX1),core.k0s(),core.j41(12,"div",16),core.nrm(13,"span",17),core.j41(14,"button",18),core.bIt("click",function(){core.eBV(_r4);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.EFF(15),core.nI1(16,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG();core.R7$(2),core.SpI(" ",core.bMT(3,2,"admin.reports.items.predefinedQueries")," "),core.R7$(3),core.Dyx(ctx_r2.presetQueries),core.R7$(5),core.Dyx(ctx_r2.queryPredicatesArray().controls),core.R7$(5),core.JRh(core.bMT(16,4,"admin.reports.items.run"))}}function FilteredItemsComponent_ng_template_16_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"admin.reports.items.section.limitPaginateQueries")," ")}function FilteredItemsComponent_ng_template_17_For_7_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",22),core.EFF(1),core.nI1(2,"async"),core.k0s()),2&rf){const item_r12=ctx.$implicit;core.FS9("value",item_r12.id),core.Y8G("selected",item_r12.isDefault),core.R7$(),core.JRh(core.bMT(2,3,item_r12.name$))}}function FilteredItemsComponent_ng_template_17_Template(rf,ctx){if(1&rf){const _r11=core.RV6();core.j41(0,"div",35)(1,"label",36),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",37)(5,"select",38),core.Z7z(6,FilteredItemsComponent_ng_template_17_For_7_Template,3,5,"option",22,core.fX1),core.k0s()()(),core.j41(8,"div",35)(9,"label",39),core.EFF(10),core.nI1(11,"translate"),core.k0s(),core.j41(12,"div",37),core.nrm(13,"input",40),core.k0s()(),core.j41(14,"div",16),core.nrm(15,"span",17),core.j41(16,"button",41),core.bIt("click",function(){core.eBV(_r11);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.EFF(17),core.nI1(18,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG();core.R7$(2),core.SpI("",core.bMT(3,3,"admin.reports.items.limit"),":"),core.R7$(4),core.Dyx(ctx_r2.pageLimits),core.R7$(4),core.SpI("",core.bMT(11,5,"admin.reports.items.offset"),":"),core.R7$(7),core.JRh(core.bMT(18,7,"admin.reports.items.run"))}}function FilteredItemsComponent_ng_template_19_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"admin.reports.commons.filters")," ")}function FilteredItemsComponent_ng_template_20_Template(rf,ctx){if(1&rf){const _r13=core.RV6();core.j41(0,"div",16),core.nrm(1,"span",17),core.j41(2,"button",18),core.bIt("click",function(){core.eBV(_r13);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.EFF(3),core.nI1(4,"translate"),core.k0s()(),core.nrm(5,"ds-filters",42),core.j41(6,"div",16),core.nrm(7,"span",17),core.j41(8,"button",18),core.bIt("click",function(){core.eBV(_r13);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.EFF(9),core.nI1(10,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG();core.R7$(3),core.JRh(core.bMT(4,3,"admin.reports.items.run")),core.R7$(2),core.Y8G("filtersForm",ctx_r2.filtersFormGroup()),core.R7$(4),core.JRh(core.bMT(10,5,"admin.reports.items.run"))}}function FilteredItemsComponent_ng_template_22_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"admin.reports.commons.additional-data")," ")}function FilteredItemsComponent_ng_template_23_For_3_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",28),core.EFF(1),core.nI1(2,"async"),core.k0s()),2&rf){const item_r15=ctx.$implicit;core.Y8G("value",item_r15.id),core.R7$(),core.JRh(core.bMT(2,2,item_r15.name$))}}function FilteredItemsComponent_ng_template_23_Conditional_5_Template(rf,ctx){1&rf&&(core.nrm(0,"span",17),core.j41(1,"div",45),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.JRh(core.bMT(3,1,"metadata-export-filtered-items.columns.warning")))}function FilteredItemsComponent_ng_template_23_Template(rf,ctx){if(1&rf){const _r14=core.RV6();core.j41(0,"div",43)(1,"select",44),core.Z7z(2,FilteredItemsComponent_ng_template_23_For_3_Template,3,4,"option",28,core.fX1),core.k0s()(),core.j41(4,"div",16),core.DNE(5,FilteredItemsComponent_ng_template_23_Conditional_5_Template,4,3),core.nI1(6,"async"),core.nrm(7,"span",17),core.j41(8,"button",18),core.bIt("click",function(){core.eBV(_r14);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.EFF(9),core.nI1(10,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG();core.R7$(2),core.Dyx(ctx_r2.metadataFields),core.R7$(3),core.vxM(core.bMT(6,2,ctx_r2.csvExportEnabled$)?5:-1),core.R7$(4),core.JRh(core.bMT(10,4,"admin.reports.items.run"))}}function FilteredItemsComponent_ng_template_25_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"admin.reports.collections.item-results")," ")}function FilteredItemsComponent_ng_template_26_For_19_Template(rf,ctx){if(1&rf&&(core.j41(0,"th"),core.EFF(1),core.k0s()),2&rf){const field_r17=ctx.$implicit;core.R7$(),core.JRh(field_r17)}}function FilteredItemsComponent_ng_template_26_For_22_Conditional_6_Template(rf,ctx){if(1&rf&&(core.j41(0,"a",54),core.EFF(1),core.k0s()),2&rf){const item_r18=core.XpG().$implicit;core.Mz_("href","/handle/",item_r18.owningCollection.handle,"",core.B4B),core.R7$(),core.JRh(item_r18.owningCollection.name)}}function FilteredItemsComponent_ng_template_26_For_22_Conditional_8_Template(rf,ctx){if(1&rf&&(core.j41(0,"a",54),core.EFF(1),core.k0s()),2&rf){const item_r18=core.XpG().$implicit;core.Mz_("href","/handle/",item_r18.handle,"",core.B4B),core.R7$(),core.JRh(item_r18.handle)}}function FilteredItemsComponent_ng_template_26_For_22_For_12_For_2_Template(rf,ctx){if(1&rf&&(core.j41(0,"span"),core.EFF(1),core.k0s()),2&rf){const mdvalue_r19=ctx.$implicit;core.R7$(),core.SpI(" ",mdvalue_r19.value||""," ")}}function FilteredItemsComponent_ng_template_26_For_22_For_12_Template(rf,ctx){if(1&rf&&(core.j41(0,"td",53),core.Z7z(1,FilteredItemsComponent_ng_template_26_For_22_For_12_For_2_Template,2,1,"span",null,core.fX1),core.k0s()),2&rf){const field_r20=ctx.$implicit,item_r18=core.XpG().$implicit;core.R7$(),core.Dyx(item_r18.metadata[field_r20])}}function FilteredItemsComponent_ng_template_26_For_22_Template(rf,ctx){if(1&rf&&(core.j41(0,"tr")(1,"td",53),core.EFF(2),core.k0s(),core.j41(3,"td"),core.EFF(4),core.k0s(),core.j41(5,"td"),core.DNE(6,FilteredItemsComponent_ng_template_26_For_22_Conditional_6_Template,2,3,"a",54),core.k0s(),core.j41(7,"td"),core.DNE(8,FilteredItemsComponent_ng_template_26_For_22_Conditional_8_Template,2,3,"a",54),core.k0s(),core.j41(9,"td"),core.EFF(10),core.k0s(),core.Z7z(11,FilteredItemsComponent_ng_template_26_For_22_For_12_Template,3,0,"td",53,core.fX1),core.k0s()),2&rf){const item_r18=ctx.$implicit,ctx_r2=core.XpG(2);core.R7$(2),core.JRh(item_r18.index),core.R7$(2),core.JRh(item_r18.uuid),core.R7$(2),core.vxM(item_r18.owningCollection?6:-1),core.R7$(2),core.vxM(item_r18.handle?8:-1),core.R7$(2),core.JRh(item_r18.name),core.R7$(),core.Dyx(ctx_r2.queryForm.value.additionalFields)}}function FilteredItemsComponent_ng_template_26_Template(rf,ctx){if(1&rf){const _r16=core.RV6();core.j41(0,"table",46)(1,"thead")(2,"tr",47)(3,"th"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"th"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.j41(9,"th"),core.EFF(10),core.nI1(11,"translate"),core.k0s(),core.j41(12,"th"),core.EFF(13),core.nI1(14,"translate"),core.k0s(),core.j41(15,"th"),core.EFF(16),core.nI1(17,"translate"),core.k0s(),core.Z7z(18,FilteredItemsComponent_ng_template_26_For_19_Template,2,1,"th",null,core.fX1),core.k0s()(),core.j41(20,"tbody"),core.Z7z(21,FilteredItemsComponent_ng_template_26_For_22_Template,13,5,"tr",null,core.fX1),core.nI1(23,"async"),core.k0s()(),core.j41(24,"div"),core.EFF(25),core.nI1(26,"translate"),core.nI1(27,"translate"),core.k0s(),core.j41(28,"div")(29,"button",48),core.bIt("click",function(){core.eBV(_r16);const ctx_r2=core.XpG();return core.Njj(ctx_r2.prevPage())}),core.EFF(30),core.nI1(31,"translate"),core.k0s(),core.j41(32,"button",49),core.bIt("click",function(){core.eBV(_r16);const ctx_r2=core.XpG();return core.Njj(ctx_r2.nextPage())}),core.EFF(33),core.nI1(34,"translate"),core.k0s(),core.j41(35,"div",50),core.nrm(36,"ds-filtered-items-export-csv",51),core.k0s()(),core.nrm(37,"table",52)}if(2&rf){const ctx_r2=core.XpG();core.R7$(4),core.JRh(core.bMT(5,14,"admin.reports.items.number")),core.R7$(3),core.JRh(core.bMT(8,16,"admin.reports.items.id")),core.R7$(3),core.JRh(core.bMT(11,18,"admin.reports.items.collection")),core.R7$(3),core.JRh(core.bMT(14,20,"admin.reports.items.handle")),core.R7$(3),core.JRh(core.bMT(17,22,"admin.reports.items.title")),core.R7$(2),core.Dyx(ctx_r2.queryForm.value.additionalFields),core.R7$(3),core.Dyx(core.bMT(23,24,ctx_r2.results$)),core.R7$(4),core.LHq(" ",core.bMT(26,26,"admin.reports.commons.page")," ",ctx_r2.currentPage+1," ",core.bMT(27,28,"admin.reports.commons.of")," ",ctx_r2.pageCount()," "),core.R7$(4),core.Y8G("dsBtnDisabled",!ctx_r2.canNavigatePrevious()),core.R7$(),core.JRh(core.bMT(31,30,"admin.reports.commons.previous-page")),core.R7$(2),core.Y8G("dsBtnDisabled",!ctx_r2.canNavigateNext()),core.R7$(),core.JRh(core.bMT(34,32,"admin.reports.commons.next-page")),core.R7$(3),core.Y8G("reportParams",ctx_r2.queryForm)}}const ROUTES=[{path:"collections",resolve:{breadcrumb:i18n_breadcrumb_resolver.S},data:{title:"admin.reports.collections.title",breadcrumbKey:"admin.reports.collections"},children:[{path:"",component:FilteredCollectionsComponent}]},{path:"queries",resolve:{breadcrumb:i18n_breadcrumb_resolver.S},data:{title:"admin.reports.items.title",breadcrumbKey:"admin.reports.items"},children:[{path:"",component:(()=>{class FilteredItemsComponent2{constructor(communityService,collectionService,metadataSchemaService,metadataFieldService,translateService,scriptDataService,authorizationDataService,formBuilder,restService){this.communityService=communityService,this.collectionService=collectionService,this.metadataSchemaService=metadataSchemaService,this.metadataFieldService=metadataFieldService,this.translateService=translateService,this.scriptDataService=scriptDataService,this.authorizationDataService=authorizationDataService,this.formBuilder=formBuilder,this.restService=restService,this.loadingCollections$=new cjs.BehaviorSubject(!1),this.currentPage=0,this.results=new FilteredItems}ngOnInit(){this.loadCollections(),this.loadPresetQueries(),this.loadMetadataFields(),this.loadPredicates(),this.loadPageLimits();const formQueryPredicates=[(new QueryPredicate).toFormGroup(this.formBuilder)];this.csvExportEnabled$=FilteredItemsExportCsvComponent.csvExportEnabled(this.scriptDataService,this.authorizationDataService),this.queryForm=this.formBuilder.group({collections:this.formBuilder.control([""],[]),presetQuery:this.formBuilder.control("new",[]),queryPredicates:this.formBuilder.array(formQueryPredicates),pageLimit:this.formBuilder.control("10",[]),filters:FiltersComponent.formGroup(this.formBuilder),additionalFields:this.formBuilder.control([],[])})}loadCollections(){this.loadingCollections$.next(!0),this.collections=[];const wholeRepo$=this.translateService.stream("admin.reports.items.wholeRepo");this.collections.push(OptionVO.collectionLoc("",wholeRepo$)),this.communityService.findAll({elementsPerPage:1e4,currentPage:1}).pipe((0,operators.Ar)()).subscribe(communitiesRest=>{communitiesRest.forEach(community=>{const commVO=OptionVO.collection(community.uuid,community.name,!0);this.collections.push(commVO),this.collectionService.findByParent(community.uuid,{elementsPerPage:1e4,currentPage:1}).pipe((0,operators.Ar)()).subscribe(collectionsRest=>{collectionsRest.filter(collection=>"Publication"===collection.firstMetadataValue("dspace.entity.type")).forEach(collection=>{const collVO=OptionVO.collection(collection.uuid,"\u2013"+collection.name);this.collections.push(collVO)}),this.loadingCollections$.next(!1)})})})}loadPresetQueries(){this.presetQueries=[PresetQuery.of("new","admin.reports.items.preset.new",[]),PresetQuery.of("q1","admin.reports.items.preset.hasNoTitle",[QueryPredicate.of("dc.title",QueryPredicate.DOES_NOT_EXIST)]),PresetQuery.of("q2","admin.reports.items.preset.hasNoIdentifierUri",[QueryPredicate.of("dc.identifier.uri",QueryPredicate.DOES_NOT_EXIST)]),PresetQuery.of("q3","admin.reports.items.preset.hasCompoundSubject",[QueryPredicate.of("dc.subject.*",QueryPredicate.LIKE,"%;%")]),PresetQuery.of("q4","admin.reports.items.preset.hasCompoundAuthor",[QueryPredicate.of("dc.contributor.author",QueryPredicate.LIKE,"% and %")]),PresetQuery.of("q5","admin.reports.items.preset.hasCompoundCreator",[QueryPredicate.of("dc.creator",QueryPredicate.LIKE,"% and %")]),PresetQuery.of("q6","admin.reports.items.preset.hasUrlInDescription",[QueryPredicate.of("dc.description",QueryPredicate.MATCHES,"^.*(http://|https://|mailto:).*$")]),PresetQuery.of("q7","admin.reports.items.preset.hasFullTextInProvenance",[QueryPredicate.of("dc.description.provenance",QueryPredicate.MATCHES,"^.*No. of bitstreams(.|\r|\n|\r\n)*.(PDF|pdf|DOC|doc|PPT|ppt|DOCX|docx|PPTX|pptx).*$")]),PresetQuery.of("q8","admin.reports.items.preset.hasNonFullTextInProvenance",[QueryPredicate.of("dc.description.provenance",QueryPredicate.DOES_NOT_MATCH,"^.*No. of bitstreams(.|\r|\n|\r\n)*.(PDF|pdf|DOC|doc|PPT|ppt|DOCX|docx|PPTX|pptx).*$")]),PresetQuery.of("q9","admin.reports.items.preset.hasEmptyMetadata",[QueryPredicate.of("*",QueryPredicate.MATCHES,"^\\s*$")]),PresetQuery.of("q10","admin.reports.items.preset.hasUnbreakingDataInDescription",[QueryPredicate.of("dc.description.*",QueryPredicate.MATCHES,"^.*(\\S){50,}.*$")]),PresetQuery.of("q12","admin.reports.items.preset.hasXmlEntityInMetadata",[QueryPredicate.of("*",QueryPredicate.MATCHES,"^.*&#.*$")]),PresetQuery.of("q13","admin.reports.items.preset.hasNonAsciiCharInMetadata",[QueryPredicate.of("*",QueryPredicate.MATCHES,"^.*[^[:ascii:]].*$")])]}loadMetadataFields(){this.metadataFields=[],this.metadataFieldsWithAny=[];const anyField$=this.translateService.stream("admin.reports.items.anyField");this.metadataFieldsWithAny.push(OptionVO.itemLoc("*",anyField$)),this.metadataSchemaService.findAll({elementsPerPage:1e4,currentPage:1}).pipe((0,operators.Ar)()).subscribe(schemasRest=>{schemasRest.forEach(schema=>{this.metadataFieldService.findBySchema(schema,{elementsPerPage:1e4,currentPage:1}).pipe((0,operators.Ar)()).subscribe(fieldsRest=>{fieldsRest.forEach(field=>{let fieldName=schema.prefix+"."+field.toString(),fieldVO=OptionVO.item(fieldName,fieldName);this.metadataFields.push(fieldVO),this.metadataFieldsWithAny.push(fieldVO),(0,empty_util.Im)(field.qualifier)&&(fieldName=schema.prefix+"."+field.element+".*",fieldVO=OptionVO.item(fieldName,fieldName),this.metadataFieldsWithAny.push(fieldVO))})})})})}loadPredicates(){this.predicates=[OptionVO.item(QueryPredicate.EXISTS,"admin.reports.items.predicate.exists"),OptionVO.item(QueryPredicate.DOES_NOT_EXIST,"admin.reports.items.predicate.doesNotExist"),OptionVO.item(QueryPredicate.EQUALS,"admin.reports.items.predicate.equals"),OptionVO.item(QueryPredicate.DOES_NOT_EQUAL,"admin.reports.items.predicate.doesNotEqual"),OptionVO.item(QueryPredicate.LIKE,"admin.reports.items.predicate.like"),OptionVO.item(QueryPredicate.NOT_LIKE,"admin.reports.items.predicate.notLike"),OptionVO.item(QueryPredicate.CONTAINS,"admin.reports.items.predicate.contains"),OptionVO.item(QueryPredicate.DOES_NOT_CONTAIN,"admin.reports.items.predicate.doesNotContain"),OptionVO.item(QueryPredicate.MATCHES,"admin.reports.items.predicate.matches"),OptionVO.item(QueryPredicate.DOES_NOT_MATCH,"admin.reports.items.predicate.doesNotMatch")]}loadPageLimits(){this.pageLimits=[OptionVO.item("10","10"),OptionVO.item("25","25"),OptionVO.item("50","50"),OptionVO.item("100","100")]}queryPredicatesArray(){return this.queryForm.get("queryPredicates")}addQueryPredicate(newItem=(new QueryPredicate).toFormGroup(this.formBuilder)){this.queryPredicatesArray().push(newItem)}deleteQueryPredicateDisabled(){return this.queryPredicatesArray().length<2}deleteQueryPredicate(index,nbToDelete=1){index>-1&&this.queryPredicatesArray().removeAt(index)}setPresetQuery(){const value=this.queryForm.controls.presetQuery.value,query=this.presetQueries.find(q=>q.id===value);void 0!==query&&(this.queryPredicatesArray().clear(),query.predicates.map(qp=>qp.toFormGroup(this.formBuilder)).forEach(qp=>this.addQueryPredicate(qp)),0===query.predicates.length&&this.addQueryPredicate((new QueryPredicate).toFormGroup(this.formBuilder)))}filtersFormGroup(){return this.queryForm.get("filters")}pageSize(){return this.queryForm.value.pageLimit}canNavigatePrevious(){return this.currentPage>0}prevPage(){this.canNavigatePrevious()&&(this.currentPage--,this.resubmit())}pageCount(){return Math.ceil((this.results.itemCount||0)/this.pageSize())}canNavigateNext(){return this.currentPage+1<this.pageCount()}nextPage(){this.canNavigateNext()&&(this.currentPage++,this.resubmit())}submit(){this.accordionComponent.expand("itemResults"),this.currentPage=0,this.resubmit()}resubmit(){this.results$=this.getFilteredItems().pipe((0,cjs.map)(response=>{const offset=this.currentPage*this.pageSize();return this.results.deserialize(response.payload,offset),this.results.items}))}getFilteredItems(){let params=this.toQueryString();return params.length>0&&(params=`?${params}`),this.restService.request(rest_request_method.D.GET,`${environment.c.rest.ssl?"https":"http"}://${environment.c.rest.host}:${environment.c.rest.port}${environment.c.rest.nameSpace}/api/contentreport/filtereditems${params}`)}toQueryString(){let params=`pageNumber=${this.currentPage}&pageLimit=${this.pageSize()}`;const colls=this.queryForm.value.collections;for(let i=0;i<colls.length;i++)params+=`&collections=${colls[i]}`;const preds=this.queryForm.value.queryPredicates;for(let i=0;i<preds.length;i++)params+=`&queryPredicates=${encodeURIComponent(QueryPredicate.toString(preds[i]))}`;const filters=FiltersComponent.toQueryString(this.queryForm.value.filters);filters.length>0&&(params+=`&${filters}`);const addFlds=this.queryForm.value.additionalFields;for(let i=0;i<addFlds.length;i++)params+=`&additionalFields=${addFlds[i]}`;return params}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||FilteredItemsComponent2)(core.rXU(community_data_service.CommunityDataService),core.rXU(collection_data_service.CollectionDataService),core.rXU(metadata_schema_data_service.MetadataSchemaDataService),core.rXU(metadata_field_data_service.MetadataFieldDataService),core.rXU(ngx_translate_core.c$),core.rXU(script_data_service.ScriptDataService),core.rXU(authorization_data_service.AuthorizationDataService),core.rXU(fesm2022_forms.ok),core.rXU(dspace_rest_service.Y))}}static{this.\u0275cmp=core.VBU({type:FilteredItemsComponent2,selectors:[["ds-report-filtered-items"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(filtered_items_component_c0,5),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.accordionComponent=_t.first)}},standalone:!0,features:[core.aNF],decls:27,vars:5,consts:[["acc","ngbAccordion"],[1,"container"],[1,"metadata-registry","row"],[1,"col-12"],["id","header",1,"border-bottom","pb-2"],["id","querydiv",3,"formGroup"],["activeIds","collectionSelector",3,"closeOthers"],["id","collectionSelector"],["ngbPanelTitle",""],["ngbPanelContent",""],["id","metadataFieldQueries"],["id","limitPaginateQueries"],["id","filters"],["id","additionalData"],["id","itemResults"],["id","collSel","name","collSel","multiple","multiple","size","10","formControlName","collections",1,"form-select"],[1,"row"],[1,"col-3"],[1,"btn","btn-primary","mt-1","col-6",3,"click"],[3,"value","disabled"],["id","predefqueries",1,"mb-3"],["id","predefselect","formControlName","presetQuery",1,"form-select",3,"change"],[3,"value","selected"],["id","queries"],[1,"metadata"],[1,"mb-3",3,"formGroup"],[1,"col-4"],["formControlName","field",1,"form-select"],[3,"value"],[1,"col-auto"],["formControlName","operator",1,"form-select"],[1,"col"],["formControlName","value",1,"form-control"],[1,"btn","btn-light",3,"click"],[1,"btn","btn-light",3,"click","dsBtnDisabled"],[1,"row","align-items-center","mb-3"],["for","limit",1,"col-sm-2","col-form-label"],[1,"col-6"],["id","limit","name","limit","formControlName","pageLimit",1,"form-select","col-6"],["for","offset",1,"col-sm-2","col-form-label"],["id","offset","name","offset","value","0",1,"form-control","col-6"],[1,"btn","btn-primary","col-6",3,"click"],[3,"filtersForm"],["id","show-fields"],["name","show_fields","multiple","multiple","size","8","formControlName","additionalFields",1,"form-select"],[1,"warning"],["id","table",1,"table","table-striped"],[1,"header"],["id","prev",1,"btn","btn-light",3,"click","dsBtnDisabled"],["id","next",1,"btn","btn-light",3,"click","dsBtnDisabled"],[2,"float","right","margin-right","60px"],[3,"reportParams"],["id","itemtable",1,"sortable"],[1,"num"],["rel","noopener noreferrer","target","_blank",3,"href"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1",4),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"div",5)(7,"ngb-accordion",6,0)(9,"ngb-panel",7),core.DNE(10,FilteredItemsComponent_ng_template_10_Template,2,3,"ng-template",8)(11,FilteredItemsComponent_ng_template_11_Template,9,9,"ng-template",9),core.k0s(),core.j41(12,"ngb-panel",10),core.DNE(13,FilteredItemsComponent_ng_template_13_Template,2,3,"ng-template",8)(14,FilteredItemsComponent_ng_template_14_Template,17,6,"ng-template",9),core.k0s(),core.j41(15,"ngb-panel",11),core.DNE(16,FilteredItemsComponent_ng_template_16_Template,2,3,"ng-template",8)(17,FilteredItemsComponent_ng_template_17_Template,19,9,"ng-template",9),core.k0s(),core.j41(18,"ngb-panel",12),core.DNE(19,FilteredItemsComponent_ng_template_19_Template,2,3,"ng-template",8)(20,FilteredItemsComponent_ng_template_20_Template,11,7,"ng-template",9),core.k0s(),core.j41(21,"ngb-panel",13),core.DNE(22,FilteredItemsComponent_ng_template_22_Template,2,3,"ng-template",8)(23,FilteredItemsComponent_ng_template_23_Template,11,6,"ng-template",9),core.k0s(),core.j41(24,"ngb-panel",14),core.DNE(25,FilteredItemsComponent_ng_template_25_Template,2,3,"ng-template",8)(26,FilteredItemsComponent_ng_template_26_Template,38,34,"ng-template",9),core.k0s()()()()()()),2&rf&&(core.R7$(4),core.JRh(core.bMT(5,3,"admin.reports.items.head")),core.R7$(2),core.Y8G("formGroup",ctx.queryForm),core.R7$(),core.Y8G("closeOthers",!0))},dependencies:[common.Jj,btn_disabled_directive.A,FilteredItemsExportCsvComponent,FiltersComponent,ng_bootstrap._f,ng_bootstrap.W1,ng_bootstrap.CT,ng_bootstrap.sb,ng_bootstrap.t3,fesm2022_forms.X1,fesm2022_forms.xH,fesm2022_forms.y7,fesm2022_forms.me,fesm2022_forms.wz,fesm2022_forms.W0,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9],styles:[".num[_ngcontent-%COMP%]{text-align:center}.warning[_ngcontent-%COMP%]{color:red;font-style:italic;text-align:center;width:100%}"]})}}return FilteredItemsComponent2})()}]}]},46196:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MetadataFieldDataService:()=>MetadataFieldDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(60444),_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(2794),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(76623),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(80996),_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(99629),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(63311),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26139),_base_create_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(95985),_base_delete_data__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(92788),_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(61640),_base_put_data__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9752),_base_search_data__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(98861),_find_list_options_model__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(72248),_request_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(64806),_angular_core__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(25376);let MetadataFieldDataService=(()=>{class MetadataFieldDataService2 extends _base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_6__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService){super("metadatafields",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.searchBySchemaLinkPath="bySchema",this.searchByFieldNameLinkPath="byFieldName",this.createData=new _base_create_data__WEBPACK_IMPORTED_MODULE_4__.V(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive),this.searchData=new _base_search_data__WEBPACK_IMPORTED_MODULE_8__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.putData=new _base_put_data__WEBPACK_IMPORTED_MODULE_7__.W(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.deleteData=new _base_delete_data__WEBPACK_IMPORTED_MODULE_5__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint)}findBySchema(schema,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const optionsWithSchema=Object.assign(new _find_list_options_model__WEBPACK_IMPORTED_MODULE_10__._,options,{searchParams:[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("schema",schema.prefix)]});return this.searchBy(this.searchBySchemaLinkPath,optionsWithSchema,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}searchByFieldNameParams(schema,element,qualifier,query,exactName,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const optionParams=Object.assign(new _find_list_options_model__WEBPACK_IMPORTED_MODULE_10__._,options,{searchParams:[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("schema",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(schema)?schema:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("element",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(element)?element:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("qualifier",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(qualifier)?qualifier:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("query",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(query)?query:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("exactName",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(exactName)?exactName:"")]});return this.searchBy(this.searchByFieldNameLinkPath,optionParams,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}findByExactFieldName(exactFieldName){return this.searchByFieldNameParams(null,null,null,null,exactFieldName,null)}clearRequests(){this.getBrowseEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.s)(1)).subscribe(href=>{this.requestService.setStaleByHrefSubstring(href)})}delete(objectId,copyVirtualMetadata){return this.deleteData.delete(objectId,copyVirtualMetadata)}deleteByHref(href,copyVirtualMetadata){return this.deleteData.deleteByHref(href,copyVirtualMetadata)}put(object){return this.putData.put(object)}create(object,...params){return this.createData.create(object,...params)}searchBy(searchMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow){return this.searchData.searchBy(searchMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||MetadataFieldDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_9__.B),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_14__.jDH({token:MetadataFieldDataService2,factory:MetadataFieldDataService2.\u0275fac,providedIn:"root"})}}return MetadataFieldDataService2})()},97871:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MetadataSchemaDataService:()=>MetadataSchemaDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(60444),_shared_empty_util__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2794),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(76623),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(80996),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(63311),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26139),_base_create_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(95985),_base_delete_data__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(92788),_base_find_all_data__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(27554),_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(61640),_base_put_data__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9752),_request_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(64806),_angular_core__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(25376);let MetadataSchemaDataService=(()=>{class MetadataSchemaDataService2 extends _base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_7__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService){super("metadataschemas",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.createData=new _base_create_data__WEBPACK_IMPORTED_MODULE_4__.V(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive),this.putData=new _base_put_data__WEBPACK_IMPORTED_MODULE_8__.W(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.deleteData=new _base_delete_data__WEBPACK_IMPORTED_MODULE_5__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint),this.findAllData=new _base_find_all_data__WEBPACK_IMPORTED_MODULE_6__.H(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive)}createOrUpdateMetadataSchema(schema){return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_10__.a4)(schema.id)?this.putData.put(schema):this.createData.create(schema)}clearRequests(){return this.getBrowseEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.Mi)(href=>this.requestService.removeByHrefSubstring(href)))}findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow){return this.findAllData.findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}delete(objectId,copyVirtualMetadata){return this.deleteData.delete(objectId,copyVirtualMetadata)}deleteByHref(href,copyVirtualMetadata){return this.deleteData.deleteByHref(href,copyVirtualMetadata)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||MetadataSchemaDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_9__.B),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_12__.jDH({token:MetadataSchemaDataService2,factory:MetadataSchemaDataService2.\u0275fac,providedIn:"root"})}}return MetadataSchemaDataService2})()}};