exports.id=4592,exports.ids=[4592,748,7871,3390,6196,1309],exports.modules={12213:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{S:()=>i18nBreadcrumbResolver});var core=__webpack_require__(25376),empty_util=__webpack_require__(2794),route_utils=__webpack_require__(93359),cjs=__webpack_require__(9238),breadcrumb_model=__webpack_require__(48020);let I18nBreadcrumbsService=(()=>{class I18nBreadcrumbsService2{getBreadcrumbs(key,url){return(0,cjs.of)([new breadcrumb_model.Q(key+".breadcrumbs",url)])}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||I18nBreadcrumbsService2)}}static{this.\u0275prov=core.jDH({token:I18nBreadcrumbsService2,factory:I18nBreadcrumbsService2.\u0275fac,providedIn:"root"})}}return I18nBreadcrumbsService2})();const i18nBreadcrumbResolver=(route,state,breadcrumbService=(0,core.WQX)(I18nBreadcrumbsService))=>{const key=route.data.breadcrumbKey;if((0,empty_util.Tn)(key))throw new Error('You provided an i18nBreadcrumbResolver for url "'+route.url+"\" but no breadcrumbKey in the route's data");return{provider:breadcrumbService,key,url:(0,route_utils.F)(route)}}},30748:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BulkAccessConfigDataService:()=>BulkAccessConfigDataService});var _cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(80996),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(63311),_data_request_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(64806),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26139),_config_data_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(72684),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(25376);let BulkAccessConfigDataService=(()=>{class BulkAccessConfigDataService2 extends _config_data_service__WEBPACK_IMPORTED_MODULE_4__.O{constructor(requestService,rdbService,objectCache,halService){super("bulkaccessconditionoptions",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||BulkAccessConfigDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_data_request_service__WEBPACK_IMPORTED_MODULE_2__.B),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_0__.o),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_1__.$),_angular_core__WEBPACK_IMPORTED_MODULE_5__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_5__.jDH({token:BulkAccessConfigDataService2,factory:BulkAccessConfigDataService2.\u0275fac,providedIn:"root"})}}return BulkAccessConfigDataService2})()},72684:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{O:()=>ConfigDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(60444),_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(61640),_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39022);class ConfigDataService extends _data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_0__.W{findByHref(href,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return super.findByHref(href,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_2__.Tj)(rd=>{if(rd.hasFailed)throw new Error("Couldn't retrieve the config");return rd}))}findByName(name,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return super.findById(name,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}}},71309:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IdentifierDataService:()=>IdentifierDataService});var _angular_common_http__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(98465),rxjs_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(60444),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(76623),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(80996),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(63311),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26139),_shared_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(39022),_shared_request_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(40413),_base_base_data_service__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(99983),_configuration_data_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(93876),_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(59041),_request_models__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(99381),_request_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(64806),_angular_core__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(25376),_ngrx_store__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(22609);let IdentifierDataService=(()=>{class IdentifierDataService2 extends _base_base_data_service__WEBPACK_IMPORTED_MODULE_5__.L{constructor(comparator,halService,http,notificationsService,objectCache,rdbService,requestService,store,configurationService){super("identifiers",requestService,rdbService,objectCache,halService),this.comparator=comparator,this.halService=halService,this.http=http,this.notificationsService=notificationsService,this.objectCache=objectCache,this.rdbService=rdbService,this.requestService=requestService,this.store=store,this.configurationService=configurationService}getIdentifierDataFor(item){return this.findByHref(item._links.identifiers.href,!1,!0)}getIdentifierRegistrationConfiguration(){return this.configurationService.findByPropertyName("identifiers.item-status.register-doi").pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.Tj)(propertyRD=>propertyRD.hasSucceeded?propertyRD.payload.values:[]))}registerIdentifier(item,type){const requestId=this.requestService.generateRequestId();return this.getEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.Tj)(endpointURL=>{const options=Object.create({});let headers=new _angular_common_http__WEBPACK_IMPORTED_MODULE_11__.Lr;headers=headers.append("Content-Type","text/uri-list"),options.headers=headers;let params=new _angular_common_http__WEBPACK_IMPORTED_MODULE_11__.Nl;return params=params.append("type",type),options.params=params,new _request_models__WEBPACK_IMPORTED_MODULE_8__.Qf(requestId,endpointURL,item._links.self.href,options)}),(0,_shared_request_operators__WEBPACK_IMPORTED_MODULE_12__.w$)(this.requestService),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.nx)(request=>this.rdbService.buildFromRequestUUID(request.uuid)))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||IdentifierDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_7__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_angular_common_http__WEBPACK_IMPORTED_MODULE_11__.Qq),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_9__.B),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_ngrx_store__WEBPACK_IMPORTED_MODULE_14__.il),_angular_core__WEBPACK_IMPORTED_MODULE_13__.KVO(_configuration_data_service__WEBPACK_IMPORTED_MODULE_6__.ConfigurationDataService))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_13__.jDH({token:IdentifierDataService2,factory:IdentifierDataService2.\u0275fac,providedIn:"root"})}}return IdentifierDataService2})()},46196:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MetadataFieldDataService:()=>MetadataFieldDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(60444),_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(2794),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(76623),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(80996),_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(99629),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(63311),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26139),_base_create_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(95985),_base_delete_data__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(92788),_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(61640),_base_put_data__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9752),_base_search_data__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(98861),_find_list_options_model__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(72248),_request_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(64806),_angular_core__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(25376);let MetadataFieldDataService=(()=>{class MetadataFieldDataService2 extends _base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_6__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService){super("metadatafields",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.searchBySchemaLinkPath="bySchema",this.searchByFieldNameLinkPath="byFieldName",this.createData=new _base_create_data__WEBPACK_IMPORTED_MODULE_4__.V(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive),this.searchData=new _base_search_data__WEBPACK_IMPORTED_MODULE_8__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.putData=new _base_put_data__WEBPACK_IMPORTED_MODULE_7__.W(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.deleteData=new _base_delete_data__WEBPACK_IMPORTED_MODULE_5__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint)}findBySchema(schema,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const optionsWithSchema=Object.assign(new _find_list_options_model__WEBPACK_IMPORTED_MODULE_10__._,options,{searchParams:[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("schema",schema.prefix)]});return this.searchBy(this.searchBySchemaLinkPath,optionsWithSchema,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}searchByFieldNameParams(schema,element,qualifier,query,exactName,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const optionParams=Object.assign(new _find_list_options_model__WEBPACK_IMPORTED_MODULE_10__._,options,{searchParams:[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("schema",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(schema)?schema:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("element",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(element)?element:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("qualifier",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(qualifier)?qualifier:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("query",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(query)?query:""),new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_11__.x("exactName",(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_12__.a4)(exactName)?exactName:"")]});return this.searchBy(this.searchByFieldNameLinkPath,optionParams,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}findByExactFieldName(exactFieldName){return this.searchByFieldNameParams(null,null,null,null,exactFieldName,null)}clearRequests(){this.getBrowseEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.s)(1)).subscribe(href=>{this.requestService.setStaleByHrefSubstring(href)})}delete(objectId,copyVirtualMetadata){return this.deleteData.delete(objectId,copyVirtualMetadata)}deleteByHref(href,copyVirtualMetadata){return this.deleteData.deleteByHref(href,copyVirtualMetadata)}put(object){return this.putData.put(object)}create(object,...params){return this.createData.create(object,...params)}searchBy(searchMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow){return this.searchData.searchBy(searchMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||MetadataFieldDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_9__.B),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_14__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_14__.jDH({token:MetadataFieldDataService2,factory:MetadataFieldDataService2.\u0275fac,providedIn:"root"})}}return MetadataFieldDataService2})()},97871:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MetadataSchemaDataService:()=>MetadataSchemaDataService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(60444),_shared_empty_util__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2794),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(76623),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(80996),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(63311),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(26139),_base_create_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(95985),_base_delete_data__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(92788),_base_find_all_data__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(27554),_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(61640),_base_put_data__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9752),_request_service__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(64806),_angular_core__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(25376);let MetadataSchemaDataService=(()=>{class MetadataSchemaDataService2 extends _base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_7__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService){super("metadataschemas",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.createData=new _base_create_data__WEBPACK_IMPORTED_MODULE_4__.V(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive),this.putData=new _base_put_data__WEBPACK_IMPORTED_MODULE_8__.W(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.deleteData=new _base_delete_data__WEBPACK_IMPORTED_MODULE_5__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint),this.findAllData=new _base_find_all_data__WEBPACK_IMPORTED_MODULE_6__.H(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive)}createOrUpdateMetadataSchema(schema){return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_10__.a4)(schema.id)?this.putData.put(schema):this.createData.create(schema)}clearRequests(){return this.getBrowseEndpoint().pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_11__.Mi)(href=>this.requestService.removeByHrefSubstring(href)))}findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow){return this.findAllData.findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}delete(objectId,copyVirtualMetadata){return this.deleteData.delete(objectId,copyVirtualMetadata)}deleteByHref(href,copyVirtualMetadata){return this.deleteData.deleteByHref(href,copyVirtualMetadata)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||MetadataSchemaDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_request_service__WEBPACK_IMPORTED_MODULE_9__.B),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_3__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_12__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_12__.jDH({token:MetadataSchemaDataService2,factory:MetadataSchemaDataService2.\u0275fac,providedIn:"root"})}}return MetadataSchemaDataService2})()},55434:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{F:()=>ObjectUpdatesService});var _ngrx_store__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(22609),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(60444),_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2794),_core_selectors__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4770),_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(83070),_object_updates_actions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(67922),_object_updates_reducer__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(77029),_angular_core__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(25376);function filterByUrlObjectUpdatesStateSelector(url){return(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Mz)(function objectUpdatesStateSelector(){return(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Mz)(_core_selectors__WEBPACK_IMPORTED_MODULE_0__.N,state=>state["cache/object-updates"])}(),state=>state[url])}let ObjectUpdatesService=(()=>{class ObjectUpdatesService2{constructor(store,injector){this.store=store,this.injector=injector}initialize(url,fields,lastModified,patchOperationService){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.g$(url,fields,lastModified,patchOperationService))}saveFieldUpdate(url,field,changeType){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.XO(url,field,changeType))}getObjectEntry(url){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Lt)(filterByUrlObjectUpdatesStateSelector(url)))}getFieldState(url,uuid){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Lt)(function filterByUrlAndUUIDFieldStateSelector(url,uuid){return(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Mz)(filterByUrlObjectUpdatesStateSelector(url),state=>state.fieldStates[uuid])}(url,uuid)))}getFieldUpdates(url,initialFields,ignoreStates){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.nx)(objectEntry=>{const fieldUpdates={};return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(objectEntry)&&Object.keys(ignoreStates?objectEntry.fieldUpdates:objectEntry.fieldStates).forEach(uuid=>{fieldUpdates[uuid]=objectEntry.fieldUpdates[uuid]}),this.getFieldUpdatesExclusive(url,initialFields).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(fieldUpdatesExclusive=>(Object.keys(fieldUpdatesExclusive).forEach(uuid=>{fieldUpdates[uuid]=fieldUpdatesExclusive[uuid]}),fieldUpdates)))}))}getFieldUpdatesExclusive(url,initialFields){return this.getObjectEntry(url).pipe((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.Az)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(objectEntry=>{const fieldUpdates={};for(const object of initialFields){let fieldUpdate=objectEntry.fieldUpdates[object.uuid];(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.Im)(fieldUpdate)&&(fieldUpdate={field:object,changeType:void 0}),fieldUpdates[object.uuid]=fieldUpdate}return fieldUpdates}))}isEditable(url,uuid){return this.getFieldState(url,uuid).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.pb)(fieldState=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(fieldState)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(fieldState=>fieldState.editable),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.F)())}isValid(url,uuid){return this.getFieldState(url,uuid).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.pb)(fieldState=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(fieldState)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(fieldState=>fieldState.isValid),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.F)())}isValidPage(url){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(entry=>Object.values(entry.fieldStates).findIndex(state=>!state.isValid)<0),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.F)())}saveAddFieldUpdate(url,field){const update$=this.getFieldUpdatesExclusive(url,[field]).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.pb)(fieldUpdates=>fieldUpdates[field.uuid].changeType===_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.ADD),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(()=>!0));return this.saveFieldUpdate(url,field,_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.ADD),update$}saveRemoveFieldUpdate(url,field){const update$=this.getFieldUpdatesExclusive(url,[field]).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.pb)(fieldUpdates=>fieldUpdates[field.uuid].changeType===_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.REMOVE),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(()=>!0));return this.saveFieldUpdate(url,field,_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.REMOVE),update$}saveChangeFieldUpdate(url,field){this.saveFieldUpdate(url,field,_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.UPDATE)}isSelectedVirtualMetadata(url,relationship,item){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Lt)(function virtualMetadataSourceSelector(url,source){return(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.Mz)(filterByUrlObjectUpdatesStateSelector(url),state=>state.virtualMetadataSources[source])}(url,relationship)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(virtualMetadataSource=>virtualMetadataSource&&virtualMetadataSource[item]))}setSelectedVirtualMetadata(url,relationship,uuid,selected){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.nY(url,relationship,uuid,selected))}setEditableFieldUpdate(url,uuid,editable){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.KD(url,uuid,editable))}setValidFieldUpdate(url,uuid,valid){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.wS(url,uuid,valid))}discardFieldUpdates(url,undoNotification){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.Y8(url,undoNotification))}discardAllFieldUpdates(url,undoNotification){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.Y8(url,undoNotification,!0))}reinstateFieldUpdates(url){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.jX(url))}removeSingleFieldUpdate(url,uuid){this.store.dispatch(new _object_updates_actions__WEBPACK_IMPORTED_MODULE_2__.mW(url,uuid))}getUpdatedFields(url,initialFields){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(objectEntry=>{const fields=[];return Object.keys(objectEntry.fieldStates).forEach(uuid=>{const fieldUpdate=objectEntry.fieldUpdates[uuid];if((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.Tn)(fieldUpdate)||fieldUpdate.changeType!==_field_change_type_model__WEBPACK_IMPORTED_MODULE_1__.B.REMOVE){let field;field=(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.hj)(fieldUpdate)?fieldUpdate.field:initialFields.find(object=>object.uuid===uuid),fields.push(field)}}),fields}))}hasUpdates(url){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(objectEntry=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(objectEntry)&&(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.hj)(objectEntry.fieldUpdates)))}isReinstatable(url){return this.hasUpdates(url+_object_updates_reducer__WEBPACK_IMPORTED_MODULE_3__.U)}getLastModified(url){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(entry=>entry.lastModified))}createPatch(url){return this.getObjectEntry(url).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.Tj)(entry=>{let patch=[];return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_6__.a4)(entry.patchOperationService)&&(patch=this.injector.get(entry.patchOperationService).fieldUpdatesToPatchOperations(entry.fieldUpdates)),patch}))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ObjectUpdatesService2)(_angular_core__WEBPACK_IMPORTED_MODULE_7__.KVO(_ngrx_store__WEBPACK_IMPORTED_MODULE_4__.il),_angular_core__WEBPACK_IMPORTED_MODULE_7__.KVO(_angular_core__WEBPACK_IMPORTED_MODULE_7__.zZn))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_7__.jDH({token:ObjectUpdatesService2,factory:ObjectUpdatesService2.\u0275fac,providedIn:"root"})}}return ObjectUpdatesService2})()},69911:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{x:()=>RegistryService});var _ngrx_store__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(22609),rxjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(9238),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(60444),_admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(18981),_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2794),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(76623),_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(99629),_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(72248),_data_metadata_field_data_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(46196),_data_metadata_schema_data_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(97871),_shared_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(39022),_angular_core__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(25376),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(2385);const metadataRegistryStateSelector=state=>state.metadataRegistry,editMetadataSchemaSelector=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Mz)(metadataRegistryStateSelector,metadataState=>metadataState.editSchema),selectedMetadataSchemasSelector=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Mz)(metadataRegistryStateSelector,metadataState=>metadataState.selectedSchemas),editMetadataFieldSelector=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Mz)(metadataRegistryStateSelector,metadataState=>metadataState.editField),selectedMetadataFieldsSelector=(0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Mz)(metadataRegistryStateSelector,metadataState=>metadataState.selectedFields);let RegistryService=(()=>{class RegistryService2{constructor(store,notificationsService,translateService,metadataSchemaService,metadataFieldService){this.store=store,this.notificationsService=notificationsService,this.translateService=translateService,this.metadataSchemaService=metadataSchemaService,this.metadataFieldService=metadataFieldService}getMetadataSchemas(options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return this.metadataSchemaService.findAll(options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}getMetadataSchemaByPrefix(prefix,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const options=Object.assign(new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_6__._,{elementsPerPage:1e4});return this.getMetadataSchemas(options).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Tj)(schemas=>schemas.page),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.VT)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Tj)(schemas=>schemas.filter(schema=>schema.prefix===prefix)[0]),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.ZZ)(schema=>this.metadataSchemaService.findById(`${schema.id}`,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)))}getMetadataFieldsBySchema(schema,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return this.metadataFieldService.findBySchema(schema,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}editMetadataSchema(schema){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.w2(schema))}cancelEditMetadataSchema(){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.Wi)}getActiveMetadataSchema(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Lt)(editMetadataSchemaSelector))}selectMetadataSchema(schema){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.Q6(schema))}deselectMetadataSchema(schema){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.zn(schema))}deselectAllMetadataSchema(){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.Gr)}getSelectedMetadataSchemas(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Lt)(selectedMetadataSchemasSelector))}editMetadataField(field){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.dF(field))}cancelEditMetadataField(){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.Tf)}getActiveMetadataField(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Lt)(editMetadataFieldSelector))}selectMetadataField(field){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.jC(field))}deselectMetadataField(field){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.yb(field))}deselectAllMetadataField(){this.store.dispatch(new _admin_admin_registries_metadata_registry_metadata_registry_actions__WEBPACK_IMPORTED_MODULE_0__.TE)}getSelectedMetadataFields(){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Lt)(selectedMetadataFieldsSelector))}createOrUpdateMetadataSchema(schema){const isUpdate=(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.a4)(schema.id);return this.metadataSchemaService.createOrUpdateMetadataSchema(schema).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.Az)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Mi)(()=>{this.showNotifications(!0,isUpdate,!1,{prefix:schema.prefix})}))}deleteMetadataSchema(id){return this.metadataSchemaService.delete(`${id}`)}clearMetadataSchemaRequests(){return this.metadataSchemaService.clearRequests()}createMetadataField(field,schema){return field.qualifier||(field.qualifier=null),this.metadataFieldService.create(field,new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_9__.x("schemaId",schema.id)).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.Az)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Mi)(()=>{this.showNotifications(!0,!1,!0,{field:field.toString()})}))}updateMetadataField(field){return field.qualifier||(field.qualifier=null),this.metadataFieldService.put(field).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_4__.ak)(),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_8__.Az)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.Mi)(()=>{this.showNotifications(!0,!0,!0,{field:field.toString()})}))}deleteMetadataField(id){return this.metadataFieldService.delete(`${id}`)}clearMetadataFieldRequests(){this.metadataFieldService.clearRequests()}showNotifications(success,edited,isField,options){const prefix="admin.registries.schema.notification",editedString=edited?"edited":"created";(0,rxjs__WEBPACK_IMPORTED_MODULE_10__.combineLatest)(this.translateService.get(`${prefix}.${success?"success":"failure"}`),this.translateService.get(`${prefix}${isField?".field":""}.${editedString}`,options)).subscribe(([head,content])=>{success?this.notificationsService.success(head,content):this.notificationsService.error(head,content)})}queryMetadataFields(query,options={},useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){return this.metadataFieldService.searchByFieldNameParams(null,null,null,query,null,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||RegistryService2)(_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.il),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__.I),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_12__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_data_metadata_schema_data_service__WEBPACK_IMPORTED_MODULE_3__.MetadataSchemaDataService),_angular_core__WEBPACK_IMPORTED_MODULE_11__.KVO(_data_metadata_field_data_service__WEBPACK_IMPORTED_MODULE_2__.MetadataFieldDataService))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_11__.jDH({token:RegistryService2,factory:RegistryService2.\u0275fac,providedIn:"root"})}}return RegistryService2})()},23390:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ResourcePolicyDataService:()=>ResourcePolicyDataService});var _angular_common_http__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(98465),rxjs_operators__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(60444),_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(2794),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(76623),_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(80996),_cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(99629),_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(63311),_data_base_create_data__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(95985),_data_base_delete_data__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(92788),_data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(61640),_data_base_patch_data__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(41373),_data_base_search_data__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(98861),_data_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(59041),_data_find_list_options_model__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(72248),_data_request_models__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(99381),_data_request_service__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(64806),_data_status_code_only_response_parsing_service__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(5641),_eperson_eperson_data_service__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(15318),_eperson_group_data_service__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(14557),_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(26139),_shared_operators__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(39022),_angular_core__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(25376);let ResourcePolicyDataService=(()=>{class ResourcePolicyDataService2 extends _data_base_identifiable_data_service__WEBPACK_IMPORTED_MODULE_5__.W{constructor(requestService,rdbService,objectCache,halService,notificationsService,comparator,ePersonService,groupService){super("resourcepolicies",requestService,rdbService,objectCache,halService),this.requestService=requestService,this.rdbService=rdbService,this.objectCache=objectCache,this.halService=halService,this.notificationsService=notificationsService,this.comparator=comparator,this.ePersonService=ePersonService,this.groupService=groupService,this.searchByEPersonMethod="eperson",this.searchByGroupMethod="group",this.searchByResourceMethod="resource",this.createData=new _data_base_create_data__WEBPACK_IMPORTED_MODULE_3__.V(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive),this.searchData=new _data_base_search_data__WEBPACK_IMPORTED_MODULE_7__.X(this.linkPath,requestService,rdbService,objectCache,halService,this.responseMsToLive),this.patchData=new _data_base_patch_data__WEBPACK_IMPORTED_MODULE_6__.n(this.linkPath,requestService,rdbService,objectCache,halService,comparator,this.responseMsToLive,this.constructIdEndpoint),this.deleteData=new _data_base_delete_data__WEBPACK_IMPORTED_MODULE_4__.I(this.linkPath,requestService,rdbService,objectCache,halService,notificationsService,this.responseMsToLive,this.constructIdEndpoint)}create(resourcePolicy,resourceUUID,epersonUUID,groupUUID){const params=[];return params.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("resource",resourceUUID)),(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(epersonUUID)?params.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("eperson",epersonUUID)):(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(groupUUID)&&params.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("group",groupUUID)),this.createData.create(resourcePolicy,...params)}delete(resourcePolicyID){return this.deleteData.delete(resourcePolicyID).pipe((0,_shared_operators__WEBPACK_IMPORTED_MODULE_15__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.Tj)(response=>response.hasSucceeded))}update(object){return this.patchData.update(object)}getDefaultAccessConditionsFor(collection,findListOptions){return this.findListByHref(collection._links.defaultAccessConditions.href,findListOptions)}searchByEPerson(UUID,resourceUUID,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const options=new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_19__._;return options.searchParams=[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("uuid",UUID)],(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(resourceUUID)&&options.searchParams.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("resource",resourceUUID)),this.searchData.searchBy(this.searchByEPersonMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}searchByGroup(UUID,resourceUUID,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const options=new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_19__._;return options.searchParams=[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("uuid",UUID)],(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(resourceUUID)&&options.searchParams.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("resource",resourceUUID)),this.searchData.searchBy(this.searchByGroupMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}searchByResource(UUID,action,useCachedVersionIfAvailable=!0,reRequestOnStale=!0,...linksToFollow){const options=new _data_find_list_options_model__WEBPACK_IMPORTED_MODULE_19__._;return options.searchParams=[new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("uuid",UUID)],(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_17__.hj)(action)&&options.searchParams.push(new _cache_models_request_param_model__WEBPACK_IMPORTED_MODULE_16__.x("action",action)),this.searchData.searchBy(this.searchByResourceMethod,options,useCachedVersionIfAvailable,reRequestOnStale,...linksToFollow)}updateTarget(resourcePolicyId,resourcePolicyHref,targetUUID,targetType){const targetEndpoint$=("eperson"===targetType?this.ePersonService:this.groupService).getIDHrefObs(targetUUID),options=Object.create({});let headers=new _angular_common_http__WEBPACK_IMPORTED_MODULE_20__.Lr;headers=headers.append("Content-Type","text/uri-list"),options.headers=headers;const requestId=this.requestService.generateRequestId();return targetEndpoint$.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_18__.$1)()).subscribe(targetEndpoint=>{const request=new _data_request_models__WEBPACK_IMPORTED_MODULE_9__.v_(requestId,resourcePolicyHref+"/"+targetType,targetEndpoint,options);Object.assign(request,{getResponseParser:()=>_data_status_code_only_response_parsing_service__WEBPACK_IMPORTED_MODULE_11__.M}),this.requestService.send(request)}),this.rdbService.buildFromRequestUUIDAndAwait(requestId,()=>this.invalidateByHref(resourcePolicyHref))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ResourcePolicyDataService2)(_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_data_request_service__WEBPACK_IMPORTED_MODULE_10__.B),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_cache_builders_remote_data_build_service__WEBPACK_IMPORTED_MODULE_1__.o),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_cache_object_cache_service__WEBPACK_IMPORTED_MODULE_2__.$),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_shared_hal_endpoint_service__WEBPACK_IMPORTED_MODULE_14__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_0__.I),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_data_default_change_analyzer_service__WEBPACK_IMPORTED_MODULE_8__.Y),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_eperson_eperson_data_service__WEBPACK_IMPORTED_MODULE_12__.EPersonDataService),_angular_core__WEBPACK_IMPORTED_MODULE_21__.KVO(_eperson_group_data_service__WEBPACK_IMPORTED_MODULE_13__.GroupDataService))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_21__.jDH({token:ResourcePolicyDataService2,factory:ResourcePolicyDataService2.\u0275fac,providedIn:"root"})}}return ResourcePolicyDataService2})()},80607:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{X:()=>CurationFormComponent});var _angular_forms__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(13054),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2385),rxjs_operators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(60444),_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(93876),_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(83183),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(39022),_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(54663),_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(2794),_shared_handle_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10576),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(76623),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(25376),_angular_router__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(18134);function CurationFormComponent_For_9_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"option",6),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()),2&rf){const task_r1=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("value",task_r1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(2,2,"curation-task.task."+task_r1+".label")," ")}}function CurationFormComponent_Conditional_10_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"div",3)(1,"label",8),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nrm(4,"input",9),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(5,"small",10),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(6),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(7,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(3,2,"curation.form.handle.label")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_5__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(7,4,"curation.form.handle.hint")))}let CurationFormComponent=(()=>{class CurationFormComponent2{constructor(scriptDataService,configurationDataService,notificationsService,translateService,handleService,router,cdr){this.scriptDataService=scriptDataService,this.configurationDataService=configurationDataService,this.notificationsService=notificationsService,this.translateService=translateService,this.handleService=handleService,this.router=router,this.cdr=cdr,this.subs=[]}ngOnDestroy(){this.subs.forEach(sub=>sub.unsubscribe())}ngOnInit(){this.form=new _angular_forms__WEBPACK_IMPORTED_MODULE_6__.J3({task:new _angular_forms__WEBPACK_IMPORTED_MODULE_6__.hs(""),handle:new _angular_forms__WEBPACK_IMPORTED_MODULE_6__.hs("")}),this.config=this.configurationDataService.findByPropertyName("plugin.named.org.dspace.curate.CurationTask"),this.subs.push(this.config.pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.ak)()).subscribe(configProperties=>{this.tasks=configProperties.values.filter(value=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.hj)(value)&&value.includes("=")).map(value=>value.split("=")[1].trim()),this.form.get("task").patchValue(this.tasks[0]),this.cdr.detectChanges()}))}hasHandleValue(){return(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.a4)(this.dsoHandle)}submit(){const taskName=this.form.get("task").value;let handle$;handle$=this.hasHandleValue()?this.handleService.normalizeHandle(this.dsoHandle).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.Tj)(handle=>((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.Im)(handle)&&this.notificationsService.error(this.translateService.get("curation.form.submit.error.head"),this.translateService.get("curation.form.submit.error.invalid-handle")),handle))):this.handleService.normalizeHandle(this.form.get("handle").value).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.Tj)(handle=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.Im)(handle)?"all":handle)),this.subs.push(handle$.subscribe(handle=>{(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_7__.a4)(handle)&&this.subs.push(this.scriptDataService.invoke("curate",[{name:"-t",value:taskName},{name:"-i",value:handle}],[]).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)()).subscribe(rd=>{rd.hasSucceeded?(this.notificationsService.success(this.translateService.get("curation.form.submit.success.head"),this.translateService.get("curation.form.submit.success.content")),this.router.navigateByUrl((0,_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_9__.yJ)(rd.payload.processId))):this.notificationsService.error(this.translateService.get("curation.form.submit.error.head"),this.translateService.get("curation.form.submit.error.content"))}))}))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||CurationFormComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_1__.ScriptDataService),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_core_data_configuration_data_service__WEBPACK_IMPORTED_MODULE_0__.ConfigurationDataService),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_4__.I),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_shared_handle_service__WEBPACK_IMPORTED_MODULE_3__.e),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_11__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_angular_core__WEBPACK_IMPORTED_MODULE_5__.gRc))}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_5__.VBU({type:CurationFormComponent2,selectors:[["ds-curation-form"]],inputs:{dsoHandle:"dsoHandle"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_5__.aNF],decls:14,vars:8,consts:[[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"row","mb-2"],[1,"col-12","col-sm-6"],["for","task",1,"fw-bold","form-label"],["id","task","formControlName","task",1,"form-select"],[3,"value"],["type","submit",1,"btn","btn-default","btn-primary"],["for","handle",1,"fw-bold","form-label"],["id","handle","formControlName","handle",1,"form-control"],[1,"text-muted"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"form",0),_angular_core__WEBPACK_IMPORTED_MODULE_5__.bIt("ngSubmit",function(){return ctx.submit()}),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(5),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(6,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(7,"select",5),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Z7z(8,CurationFormComponent_For_9_Template,3,4,"option",6,_angular_core__WEBPACK_IMPORTED_MODULE_5__.fX1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.DNE(10,CurationFormComponent_Conditional_10_Template,8,6,"div",3),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(11,"button",7),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(12),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(13,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("formGroup",ctx.form),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(5),_angular_core__WEBPACK_IMPORTED_MODULE_5__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(6,4,"curation.form.task-select.label")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Dyx(ctx.tasks),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.vxM(ctx.hasHandleValue()?-1:10),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(13,6,"curation.form.submit")))},dependencies:[_angular_forms__WEBPACK_IMPORTED_MODULE_6__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.qT,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.xH,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.y7,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.me,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.wz,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.BC,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.cb,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.X1,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.j4,_angular_forms__WEBPACK_IMPORTED_MODULE_6__.JD,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.D9],encapsulation:2})}}return CurationFormComponent2})()},68838:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{t:()=>DsoEditMetadataFieldValuesComponent});var _angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(53647),_angular_common__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(87514),_angular_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(25376),_core_shared_context_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(21571),_dso_edit_metadata_form__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(27434),__webpack_require__(42489)),_dso_edit_metadata_value_dso_edit_metadata_value_component__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10992),_dso_edit_metadata_value_headers_dso_edit_metadata_value_headers_component__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(82);function DsoEditMetadataFieldValuesComponent_For_5_Template(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_4__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_4__.j41(0,"ds-dso-edit-metadata-value",3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.bIt("edit",function(){const mdValue_r2=_angular_core__WEBPACK_IMPORTED_MODULE_4__.eBV(_r1).$implicit;return _angular_core__WEBPACK_IMPORTED_MODULE_4__.Njj(mdValue_r2.editing=!0)})("confirm",function($event){const mdValue_r2=_angular_core__WEBPACK_IMPORTED_MODULE_4__.eBV(_r1).$implicit,ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_4__.XpG();return mdValue_r2.confirmChanges($event),ctx_r2.form.resetReinstatable(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Njj(ctx_r2.valueSaved.emit())})("remove",function(){const ctx_r3=_angular_core__WEBPACK_IMPORTED_MODULE_4__.eBV(_r1),mdValue_r2=ctx_r3.$implicit,\u0275$index_7_r5=ctx_r3.$index,ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_4__.XpG();return mdValue_r2.change===ctx_r2.DsoEditMetadataChangeTypeEnum.ADD?ctx_r2.form.remove(ctx_r2.mdField,\u0275$index_7_r5):mdValue_r2.change=ctx_r2.DsoEditMetadataChangeTypeEnum.REMOVE,ctx_r2.form.resetReinstatable(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Njj(ctx_r2.valueSaved.emit())})("undo",function(){const ctx_r5=_angular_core__WEBPACK_IMPORTED_MODULE_4__.eBV(_r1),mdValue_r2=ctx_r5.$implicit,\u0275$index_7_r5=ctx_r5.$index,ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_4__.XpG();return mdValue_r2.change===ctx_r2.DsoEditMetadataChangeTypeEnum.ADD?ctx_r2.form.remove(ctx_r2.mdField,\u0275$index_7_r5):mdValue_r2.discard(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Njj(ctx_r2.valueSaved.emit())})("dragging",function($event){_angular_core__WEBPACK_IMPORTED_MODULE_4__.eBV(_r1);const ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_4__.XpG();return _angular_core__WEBPACK_IMPORTED_MODULE_4__.Njj(ctx_r2.draggingMdField$.next($event?ctx_r2.mdField:null))}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.k0s()}if(2&rf){const mdValue_r2=ctx.$implicit,ctx_r2=_angular_core__WEBPACK_IMPORTED_MODULE_4__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_4__.Y8G("dso",ctx_r2.dso)("context",ctx_r2.Context.EditMetadata)("mdValue",mdValue_r2)("mdField",ctx_r2.mdField)("dsoType",ctx_r2.dsoType)("saving$",ctx_r2.saving$)("isOnlyValue",1===ctx_r2.form.fields[ctx_r2.mdField].length)}}let DsoEditMetadataFieldValuesComponent=(()=>{class DsoEditMetadataFieldValuesComponent2{constructor(){this.valueSaved=new _angular_core__WEBPACK_IMPORTED_MODULE_4__.bkB,this.DsoEditMetadataChangeTypeEnum=_dso_edit_metadata_form__WEBPACK_IMPORTED_MODULE_2__.QR,this.Context=_core_shared_context_model__WEBPACK_IMPORTED_MODULE_0__.o}drop(event){(0,_angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_5__.HD)(this.form.fields[this.mdField],event.previousIndex,event.currentIndex),this.form.fields[this.mdField].forEach((value,index)=>{value.newValue.place=index,value.confirmChanges()}),this.form.resetReinstatable(),this.valueSaved.emit()}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||DsoEditMetadataFieldValuesComponent2)}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_4__.VBU({type:DsoEditMetadataFieldValuesComponent2,selectors:[["ds-dso-edit-metadata-field-values"]],inputs:{dso:"dso",form:"form",mdField:"mdField",dsoType:"dsoType",saving$:"saving$",draggingMdField$:"draggingMdField$"},outputs:{valueSaved:"valueSaved"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_4__.aNF],decls:6,vars:7,consts:[["cdkDropList","","role","table",1,"flex-grow-1","ds-drop-list","h-100",3,"cdkDropListDropped"],["role","presentation",3,"dsoType"],["role","presentation",3,"dso","context","mdValue","mdField","dsoType","saving$","isOnlyValue"],["role","presentation",3,"edit","confirm","remove","undo","dragging","dso","context","mdValue","mdField","dsoType","saving$","isOnlyValue"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.j41(0,"div",0),_angular_core__WEBPACK_IMPORTED_MODULE_4__.nI1(1,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.nI1(2,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_4__.bIt("cdkDropListDropped",function($event){return ctx.drop($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_4__.nrm(3,"ds-dso-edit-metadata-value-headers",1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Z7z(4,DsoEditMetadataFieldValuesComponent_For_5_Template,1,7,"ds-dso-edit-metadata-value",2,_angular_core__WEBPACK_IMPORTED_MODULE_4__.fX1),_angular_core__WEBPACK_IMPORTED_MODULE_4__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_4__.AVh("disabled",_angular_core__WEBPACK_IMPORTED_MODULE_4__.bMT(1,3,ctx.draggingMdField$)&&_angular_core__WEBPACK_IMPORTED_MODULE_4__.bMT(2,5,ctx.draggingMdField$)!==ctx.mdField),_angular_core__WEBPACK_IMPORTED_MODULE_4__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Y8G("dsoType",ctx.dsoType),_angular_core__WEBPACK_IMPORTED_MODULE_4__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_4__.Dyx(ctx.form.fields[ctx.mdField]))},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_6__.Jj,_angular_cdk_drag_drop__WEBPACK_IMPORTED_MODULE_5__.O7,_dso_edit_metadata_value_dso_edit_metadata_value_component__WEBPACK_IMPORTED_MODULE_3__.o,_dso_edit_metadata_value_headers_dso_edit_metadata_value_headers_component__WEBPACK_IMPORTED_MODULE_7__.c],styles:[".ds-drop-list[_ngcontent-%COMP%]{background-color:var(--bs-gray-500)}.ds-drop-list.disabled[_ngcontent-%COMP%]{opacity:.3}"]})}}return DsoEditMetadataFieldValuesComponent2})()},42489:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{QR:()=>DsoEditMetadataChangeType,qf:()=>DsoEditMetadataForm});class MetadataPatchOperation{constructor(op,field){this.op=op,this.field=field}}let MetadataPatchAddOperation=(()=>{class MetadataPatchAddOperation2 extends MetadataPatchOperation{static{this.operationType="add"}constructor(field,value){super(MetadataPatchAddOperation2.operationType,field),this.value=value}toOperation(){return{op:this.op,path:`/metadata/${this.field}/-`,value:this.value}}}return MetadataPatchAddOperation2})(),MetadataPatchMoveOperation=(()=>{class MetadataPatchMoveOperation2 extends MetadataPatchOperation{static{this.operationType="move"}constructor(field,from,to){super(MetadataPatchMoveOperation2.operationType,field),this.from=from,this.to=to}toOperation(){return{op:this.op,from:`/metadata/${this.field}/${this.from}`,path:`/metadata/${this.field}/${this.to}`}}}return MetadataPatchMoveOperation2})(),MetadataPatchRemoveOperation=(()=>{class MetadataPatchRemoveOperation2 extends MetadataPatchOperation{static{this.operationType="remove"}constructor(field,place){super(MetadataPatchRemoveOperation2.operationType,field),this.place=place}toOperation(){return{op:this.op,path:`/metadata/${this.field}/${this.place}`}}}return MetadataPatchRemoveOperation2})(),MetadataPatchReplaceOperation=(()=>{class MetadataPatchReplaceOperation2 extends MetadataPatchOperation{static{this.operationType="replace"}constructor(field,place,value){super(MetadataPatchReplaceOperation2.operationType,field),this.place=place,this.value=value}toOperation(){return{op:this.op,path:`/metadata/${this.field}/${this.place}`,value:this.value}}}return MetadataPatchReplaceOperation2})();var metadata_models=__webpack_require__(32084),empty_util=__webpack_require__(2794),DsoEditMetadataChangeType=function(DsoEditMetadataChangeType2){return DsoEditMetadataChangeType2[DsoEditMetadataChangeType2.UPDATE=1]="UPDATE",DsoEditMetadataChangeType2[DsoEditMetadataChangeType2.ADD=2]="ADD",DsoEditMetadataChangeType2[DsoEditMetadataChangeType2.REMOVE=3]="REMOVE",DsoEditMetadataChangeType2}(DsoEditMetadataChangeType||{});class DsoEditMetadataValue{constructor(value,added=!1){this.editing=!1,this.reordered=!1,this.originalValue=value,this.newValue=Object.assign(new metadata_models.vD,value),added&&(this.change=DsoEditMetadataChangeType.ADD,this.editing=!0)}confirmChanges(finishEditing=!1){this.reordered=this.originalValue.place!==this.newValue.place,((0,empty_util.Tn)(this.change)||this.change===DsoEditMetadataChangeType.UPDATE)&&(this.change=this.originalValue.value!==this.newValue.value||this.originalValue.language!==this.newValue.language||this.originalValue.authority!==this.newValue.authority||this.originalValue.confidence!==this.newValue.confidence?DsoEditMetadataChangeType.UPDATE:void 0),finishEditing&&(this.editing=!1)}hasChanges(){return(0,empty_util.a4)(this.change)||this.reordered}discardAndMarkReinstatable(){(this.change===DsoEditMetadataChangeType.UPDATE||this.reordered)&&(this.reinstatableValue=this.newValue),this.reinstatableChange=this.change,this.discard(!1)}discard(keepPlace=!0){this.change=void 0;const place=this.newValue.place;this.newValue=Object.assign(new metadata_models.vD,this.originalValue),keepPlace&&(this.newValue.place=place),this.confirmChanges(!0)}reinstate(){(0,empty_util.a4)(this.reinstatableValue)&&(this.newValue=this.reinstatableValue,this.reinstatableValue=void 0),(0,empty_util.a4)(this.reinstatableChange)&&(this.change=this.reinstatableChange,this.reinstatableChange=void 0),this.confirmChanges()}isReinstatable(){return(0,empty_util.a4)(this.reinstatableValue)||(0,empty_util.a4)(this.reinstatableChange)}resetReinstatable(){this.reinstatableValue=void 0,this.reinstatableChange=void 0}}class DsoEditMetadataForm{constructor(metadata){this.originalFieldKeys=[],this.fieldKeys=[],this.fields={},this.reinstatableNewValues={},Object.entries(metadata).forEach(([mdField,values])=>{this.originalFieldKeys.push(mdField),this.fieldKeys.push(mdField),this.setValuesForFieldSorted(mdField,values.map(value=>new DsoEditMetadataValue(value)))}),this.sortFieldKeys()}add(){(0,empty_util.Tn)(this.newValue)&&(this.newValue=new DsoEditMetadataValue(new metadata_models.vD,!0))}setMetadataField(mdField){this.newValue.editing=!1,this.addValueToField(this.newValue,mdField);const place=this.fields[mdField].length-1;this.fields[mdField][place].originalValue.place=place,this.fields[mdField][place].newValue.place=place,this.newValue=void 0}addValueToField(value,mdField){(0,empty_util.Im)(this.fields[mdField])&&(this.fieldKeys.push(mdField),this.sortFieldKeys(),this.fields[mdField]=[]),this.fields[mdField].push(value)}remove(mdField,index){(0,empty_util.hj)(this.fields[mdField])&&(this.fields[mdField].splice(index,1),0===this.fields[mdField].length&&(this.fieldKeys.splice(this.fieldKeys.indexOf(mdField),1),delete this.fields[mdField]))}hasChanges(){return Object.values(this.fields).some(values=>values.some(value=>value.hasChanges()))}hasOrderChanges(mdField){return this.fields[mdField].some(value=>value.originalValue.place!==value.newValue.place)}discard(){this.resetReinstatable(),Object.entries(this.fields).forEach(([field,values])=>{let removeFromIndex=-1;values.forEach((value,index)=>{value.change===DsoEditMetadataChangeType.ADD?((0,empty_util.Im)(this.reinstatableNewValues[field])&&(this.reinstatableNewValues[field]=[]),this.reinstatableNewValues[field].push(value),-1===removeFromIndex&&(removeFromIndex=index)):value.discardAndMarkReinstatable()}),removeFromIndex>-1&&this.fields[field].splice(removeFromIndex,this.fields[field].length-removeFromIndex)}),this.fieldKeys.forEach(field=>{this.originalFieldKeys.indexOf(field)<0&&delete this.fields[field]}),this.fieldKeys=[...this.originalFieldKeys],this.sortFieldKeys(),this.fieldKeys.forEach(field=>{this.setValuesForFieldSorted(field,this.fields[field])})}resetOrder(mdField){this.fields[mdField].forEach(value=>{value.newValue.place=value.originalValue.place,value.confirmChanges()}),this.setValuesForFieldSorted(mdField,this.fields[mdField])}sortFieldKeys(){this.fieldKeys.sort((a,b)=>a.localeCompare(b))}reinstate(){Object.values(this.fields).forEach(values=>{values.forEach(value=>{value.reinstate()})}),Object.entries(this.reinstatableNewValues).forEach(([field,values])=>{values.forEach(value=>{this.addValueToField(value,field)})}),this.fieldKeys.forEach(field=>{this.setValuesForFieldSorted(field,this.fields[field])}),this.reinstatableNewValues={}}isReinstatable(){return(0,empty_util.hj)(this.reinstatableNewValues)||Object.values(this.fields).some(values=>values.some(value=>value.isReinstatable()))}resetReinstatable(){this.reinstatableNewValues={},Object.values(this.fields).forEach(values=>{values.forEach(value=>{value.resetReinstatable()})})}setValuesForFieldSorted(mdField,values){this.fields[mdField]=values.sort((a,b)=>a.newValue.place-b.newValue.place)}getOperations(moveAnalyser){const operations=[];return Object.entries(this.fields).forEach(([field,values])=>{const replaceOperations=[],removeOperations=[],addOperations=[];[...values].sort((a,b)=>a.originalValue.place-b.originalValue.place).forEach(value=>{(0,empty_util.a4)(value.change)&&(value.change===DsoEditMetadataChangeType.UPDATE?(value.originalValue.value!==value.newValue.value||value.originalValue.language!==value.newValue.language||value.originalValue.authority!==value.newValue.authority||value.originalValue.confidence!==value.newValue.confidence)&&replaceOperations.push(new MetadataPatchReplaceOperation(field,value.originalValue.place,{value:value.newValue.value,language:value.newValue.language,authority:value.newValue.authority,confidence:value.newValue.confidence})):value.change===DsoEditMetadataChangeType.REMOVE?removeOperations.push(new MetadataPatchRemoveOperation(field,value.originalValue.place)):value.change===DsoEditMetadataChangeType.ADD?addOperations.push(new MetadataPatchAddOperation(field,{value:value.newValue.value,language:value.newValue.language,authority:value.newValue.authority,confidence:value.newValue.confidence})):console.warn("Illegal metadata change state detected for",value))}),operations.push(...replaceOperations.map(operation=>operation.toOperation())),operations.push(...removeOperations.sort((a,b)=>b.place-a.place).map(operation=>operation.toOperation())),operations.push(...addOperations.map(operation=>operation.toOperation()))}),Object.entries(this.fields).forEach(([field,values])=>{const valuesWithoutRemoved=values.filter(value=>value.change!==DsoEditMetadataChangeType.REMOVE),moveOperations=moveAnalyser.diff([...valuesWithoutRemoved].sort((a,b)=>a.originalValue.place-b.originalValue.place).map(value=>value.originalValue.place),[...valuesWithoutRemoved].sort((a,b)=>a.newValue.place-b.newValue.place).map(value=>value.originalValue.place)).map(operation=>new MetadataPatchMoveOperation(field,+operation.from.substr(1),+operation.path.substr(1)).toOperation());operations.push(...moveOperations)}),operations}}},36482:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{L:()=>DsoEditMetadataHeadersComponent});var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2385),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25376);let DsoEditMetadataHeadersComponent=(()=>{class DsoEditMetadataHeadersComponent2{static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||DsoEditMetadataHeadersComponent2)}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:DsoEditMetadataHeadersComponent2,selectors:[["ds-dso-edit-metadata-headers"]],inputs:{dsoType:"dsoType"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.aNF],decls:18,vars:12,consts:[[1,"d-flex","flex-row","ds-field-row","ds-header-row"],[1,"lbl-cell"],[1,"flex-grow-1"],[1,"d-flex","flex-row"],[1,"flex-grow-1","ds-flex-cell","ds-value-cell"],[1,"dont-break-out","preserve-line-breaks"],[1,"ds-flex-cell","ds-lang-cell"],[1,"text-center","ds-flex-cell","ds-edit-cell"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"div",0)(1,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(4,"div",2)(5,"div",3)(6,"div",4)(7,"b",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(9,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(10,"div",6)(11,"b"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(12),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(13,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(14,"div",7)(15,"b"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(16),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(17,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()()()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(3,4,ctx.dsoType+".edit.metadata.headers.field")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(6),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(9,6,ctx.dsoType+".edit.metadata.headers.value")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(13,8,ctx.dsoType+".edit.metadata.headers.language")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(17,10,ctx.dsoType+".edit.metadata.headers.edit")))},dependencies:[_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.D9],styles:[".lbl-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-field-width);max-width:var(--ds-dso-edit-field-width);background-color:var(--bs-gray-100);font-weight:700;padding:1rem;border:1px solid var(--bs-gray-200)}.ds-header-row[_ngcontent-%COMP%]{background-color:var(--bs-gray-100)}",".ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.ds-flex-cell[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--bs-gray-200)}.ds-lang-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-lang-width);max-width:var(--ds-dso-edit-lang-width)}.ds-edit-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-actions-width)}.ds-value-row[_ngcontent-%COMP%]{background-color:#fff}.ds-value-row[_ngcontent-%COMP%]:active{cursor:grabbing}.ds-value-row.ds-warning[_ngcontent-%COMP%]{background-color:var(--ds-warning-bg-subtle)}.ds-value-row.ds-warning[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-warning-border-subtle)}.ds-value-row.ds-danger[_ngcontent-%COMP%]{background-color:var(--ds-danger-bg-subtle)}.ds-value-row.ds-danger[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-danger-border-subtle)}.ds-value-row.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg-subtle)}.ds-value-row.ds-success[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-success-border-subtle)}"]})}}return DsoEditMetadataHeadersComponent2})()},82:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>DsoEditMetadataValueHeadersComponent});var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2385),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25376);let DsoEditMetadataValueHeadersComponent=(()=>{class DsoEditMetadataValueHeadersComponent2{static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||DsoEditMetadataValueHeadersComponent2)}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:DsoEditMetadataValueHeadersComponent2,selectors:[["ds-dso-edit-metadata-value-headers"]],inputs:{dsoType:"dsoType"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.aNF],decls:10,vars:9,consts:[["role","row",1,"visually-hidden"],["role","columnheader"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"div",0)(1,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(4,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(5),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(6,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(7,"div",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(9,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(3,3,ctx.dsoType+".edit.metadata.headers.value")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(6,5,ctx.dsoType+".edit.metadata.headers.language")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(9,7,ctx.dsoType+".edit.metadata.headers.edit")))},dependencies:[_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_1__.D9],styles:[".ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.ds-flex-cell[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--bs-gray-200)}.ds-lang-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-lang-width);max-width:var(--ds-dso-edit-lang-width)}.ds-edit-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-actions-width)}.ds-value-row[_ngcontent-%COMP%]{background-color:#fff}.ds-value-row[_ngcontent-%COMP%]:active{cursor:grabbing}.ds-value-row.ds-warning[_ngcontent-%COMP%]{background-color:var(--ds-warning-bg-subtle)}.ds-value-row.ds-warning[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-warning-border-subtle)}.ds-value-row.ds-danger[_ngcontent-%COMP%]{background-color:var(--ds-danger-bg-subtle)}.ds-value-row.ds-danger[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-danger-border-subtle)}.ds-value-row.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg-subtle)}.ds-value-row.ds-success[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-success-border-subtle)}"]})}}return DsoEditMetadataValueHeadersComponent2})()},10992:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{o:()=>DsoEditMetadataValueComponent});var drag_drop=__webpack_require__(53647),common=__webpack_require__(87514),core=__webpack_require__(25376),fesm2022_forms=__webpack_require__(13054),router=__webpack_require__(18134),ng_bootstrap=__webpack_require__(87969),ngx_translate_core=__webpack_require__(2385),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),dso_name_service=__webpack_require__(11481),relationship_data_service=__webpack_require__(31158),metadata_service=__webpack_require__(28067),confidence_type=__webpack_require__(77480),metadata_representation_model=(__webpack_require__(21571),__webpack_require__(27434),__webpack_require__(87919)),item_page_routing_paths=__webpack_require__(88292),btn_disabled_directive=__webpack_require__(69919),empty_util=__webpack_require__(2794),authority_confidence_state_directive=__webpack_require__(37850),themed_type_badge_component=__webpack_require__(88395),debounce_directive=__webpack_require__(91041),dso_edit_metadata_form=__webpack_require__(42489),item_data_service=__webpack_require__(94149),shared_operators=__webpack_require__(39022),vocabulary_service=__webpack_require__(99508),follow_link_config_model=__webpack_require__(76715);let DsoEditMetadataFieldService=(()=>{class DsoEditMetadataFieldService2{constructor(itemService,vocabularyService){this.itemService=itemService,this.vocabularyService=vocabularyService}findDsoFieldVocabulary(dso,mdField){return(0,empty_util.hj)(mdField)?this.itemService.findByHref(dso._links.self.href,!0,!0,(0,follow_link_config_model.s)("owningCollection")).pipe((0,shared_operators.ak)(),(0,operators.nx)(item=>item.owningCollection),(0,shared_operators.ak)()).pipe((0,operators.nx)(c=>this.vocabularyService.getVocabularyByMetadataAndCollection(mdField,c.uuid).pipe((0,shared_operators.ak)()))):(0,cjs.of)(void 0)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||DsoEditMetadataFieldService2)(core.KVO(item_data_service.ItemDataService),core.KVO(vocabulary_service.g))}}static{this.\u0275prov=core.jDH({token:DsoEditMetadataFieldService2,factory:DsoEditMetadataFieldService2.\u0275fac,providedIn:"root"})}}return DsoEditMetadataFieldService2})();var EditMetadataValueFieldType=function(EditMetadataValueFieldType2){return EditMetadataValueFieldType2.PLAIN_TEXT="PLAIN_TEXT",EditMetadataValueFieldType2.ENTITY_TYPE="ENTITY_TYPE",EditMetadataValueFieldType2.AUTHORITY="AUTHORITY",EditMetadataValueFieldType2}(EditMetadataValueFieldType||{}),abstract_component_loader_component=__webpack_require__(36021),dynamic_component_loader_directive=__webpack_require__(48872),listable_object_decorator=__webpack_require__(10102),registry_service=__webpack_require__(69911),dynamic_onebox_component=__webpack_require__(74009),dynamic_onebox_model=__webpack_require__(25067),dynamic_scrollable_dropdown_component=__webpack_require__(87293),dynamic_scrollable_dropdown_model=__webpack_require__(83935),form_field_metadata_value_model=__webpack_require__(77493),notifications_service=__webpack_require__(76623);let AbstractDsoEditMetadataValueFieldComponent=(()=>{class AbstractDsoEditMetadataValueFieldComponent2{constructor(){this.confirm=new core.bkB}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||AbstractDsoEditMetadataValueFieldComponent2)}}static{this.\u0275cmp=core.VBU({type:AbstractDsoEditMetadataValueFieldComponent2,selectors:[["ds-abstract-dso-edit-metadata-value-field"]],inputs:{context:"context",dso:"dso",dsoType:"dsoType",type:"type",mdField:"mdField",mdValue:"mdValue"},outputs:{confirm:"confirm"},standalone:!0,features:[core.aNF],decls:0,vars:0,template:function(rf,ctx){},encapsulation:2})}}return AbstractDsoEditMetadataValueFieldComponent2})();function DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"textarea",5),core.nI1(1,"translate"),core.mxI("ngModelChange",function($event){core.eBV(_r1);const ctx_r1=core.XpG(2);return core.DH7(ctx_r1.mdValue.newValue.value,$event)||(ctx_r1.mdValue.newValue.value=$event),core.Njj($event)}),core.bIt("onDebounce",function(){core.eBV(_r1);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.confirm.emit(!1))}),core.EFF(2,"    "),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.R50("ngModel",ctx_r1.mdValue.newValue.value),core.Y8G("dsDebounce",300),core.BMQ("aria-label",core.bMT(1,3,ctx_r1.dsoType+".edit.metadata.edit.value"))}}function DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_3_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"ds-dynamic-scrollable-dropdown",6),core.bIt("change",function($event){core.eBV(_r3);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.onChangeAuthorityField($event))}),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("bindId",ctx_r1.mdField)("group",ctx_r1.group)("model",ctx_r1.getModel())}}function DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_5_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"ds-dynamic-onebox",7),core.bIt("change",function($event){core.eBV(_r4);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.onChangeAuthorityField($event))}),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("group",ctx_r1.group)("model",ctx_r1.getModel())}}function DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_8_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"button",8),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r5);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.toggleFreeTextEdition())}),core.nrm(2,"i",9),core.EFF(3),core.nI1(4,"translate"),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("title",ctx_r1.enabledFreeTextEditing?ctx_r1.dsoType+".edit.metadata.edit.buttons.disable-free-text-editing":core.bMT(1,3,ctx_r1.dsoType+".edit.metadata.edit.buttons.enable-free-text-editing")),core.R7$(2),core.Y8G("ngClass",ctx_r1.enabledFreeTextEditing?"fa-lock":"fa-unlock"),core.R7$(),core.SpI(" ",core.bMT(4,5,ctx_r1.enabledFreeTextEditing?ctx_r1.dsoType+".edit.metadata.edit.buttons.disable-free-text-editing":ctx_r1.dsoType+".edit.metadata.edit.buttons.enable-free-text-editing")," ")}}function DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_11_Conditional_5_Template(rf,ctx){if(1&rf){const _r7=core.RV6();core.j41(0,"button",15),core.nI1(1,"translate"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r7);const ctx_r1=core.XpG(3);return core.Njj(ctx_r1.onChangeEditingAuthorityStatus(!1))}),core.nrm(3,"i",16),core.k0s()}if(2&rf){const ctx_r1=core.XpG(3);core.FS9("ngbTooltip",core.bMT(1,2,ctx_r1.dsoType+".edit.metadata.edit.buttons.close-authority-edition")),core.Y8G("title",core.bMT(2,4,ctx_r1.dsoType+".edit.metadata.edit.buttons.close-authority-edition"))}}function DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_11_Conditional_6_Template(rf,ctx){if(1&rf){const _r8=core.RV6();core.j41(0,"button",17),core.nI1(1,"translate"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r8);const ctx_r1=core.XpG(3);return core.Njj(ctx_r1.onChangeEditingAuthorityStatus(!0))}),core.nrm(3,"i",18),core.k0s()}if(2&rf){const ctx_r1=core.XpG(3);core.FS9("ngbTooltip",core.bMT(1,2,ctx_r1.dsoType+".edit.metadata.edit.buttons.open-authority-edition")),core.Y8G("title",core.bMT(2,4,ctx_r1.dsoType+".edit.metadata.edit.buttons.open-authority-edition"))}}function DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_11_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",4)(1,"div",10),core.nrm(2,"i",11),core.j41(3,"input",12),core.nI1(4,"translate"),core.mxI("ngModelChange",function($event){core.eBV(_r6);const ctx_r1=core.XpG(2);return core.DH7(ctx_r1.mdValue.newValue.authority,$event)||(ctx_r1.mdValue.newValue.authority=$event),core.Njj($event)}),core.bIt("change",function(){core.eBV(_r6);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.onChangeAuthorityKey())}),core.k0s(),core.DNE(5,DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_11_Conditional_5_Template,4,6,"button",13)(6,DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_11_Conditional_6_Template,4,6,"button",14),core.k0s()()}if(2&rf){const ctx_r1=core.XpG(2);core.R7$(2),core.Y8G("authorityValue",ctx_r1.mdValue.newValue.confidence)("iconMode",!0),core.R7$(),core.R50("ngModel",ctx_r1.mdValue.newValue.authority),core.Y8G("disabled",!ctx_r1.editingAuthority),core.BMQ("aria-label",core.bMT(4,6,ctx_r1.dsoType+".edit.metadata.edit.authority.key")),core.R7$(2),core.vxM(ctx_r1.editingAuthority?5:6)}}function DsoEditMetadataAuthorityFieldComponent_Conditional_0_Template(rf,ctx){if(1&rf&&(core.DNE(0,DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_0_Template,3,5,"textarea",0),core.nI1(1,"async"),core.nI1(2,"async"),core.DNE(3,DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_3_Template,1,3,"ds-dynamic-scrollable-dropdown",1),core.nI1(4,"async"),core.DNE(5,DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_5_Template,1,2,"ds-dynamic-onebox",2),core.nI1(6,"async"),core.nI1(7,"async"),core.DNE(8,DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_8_Template,5,7,"button",3),core.nI1(9,"async"),core.nI1(10,"async"),core.DNE(11,DsoEditMetadataAuthorityFieldComponent_Conditional_0_Conditional_11_Template,7,8,"div",4),core.nI1(12,"async"),core.nI1(13,"async")),2&rf){const ctx_r1=core.XpG();core.vxM(!0!==core.bMT(1,5,ctx_r1.isAuthorityControlled$)||ctx_r1.enabledFreeTextEditing&&!0!==core.bMT(2,7,ctx_r1.isSuggesterVocabulary$)?0:-1),core.R7$(3),core.vxM(core.bMT(4,9,ctx_r1.isScrollableVocabulary$)&&!ctx_r1.enabledFreeTextEditing?3:-1),core.R7$(2),core.vxM(core.bMT(6,11,ctx_r1.isHierarchicalVocabulary$)&&!ctx_r1.enabledFreeTextEditing||core.bMT(7,13,ctx_r1.isSuggesterVocabulary$)?5:-1),core.R7$(3),core.vxM(core.bMT(9,15,ctx_r1.isHierarchicalVocabulary$)||core.bMT(10,17,ctx_r1.isScrollableVocabulary$)?8:-1),core.R7$(3),core.vxM(core.bMT(12,19,ctx_r1.isAuthorityControlled$)&&core.bMT(13,21,ctx_r1.isSuggesterVocabulary$)?11:-1)}}let DsoEditMetadataAuthorityFieldComponent=(()=>{class DsoEditMetadataAuthorityFieldComponent2 extends AbstractDsoEditMetadataValueFieldComponent{constructor(cdr,dsoEditMetadataFieldService,itemService,notificationsService,registryService,translate){super(),this.cdr=cdr,this.dsoEditMetadataFieldService=dsoEditMetadataFieldService,this.itemService=itemService,this.notificationsService=notificationsService,this.registryService=registryService,this.translate=translate,this.editingAuthority=!1,this.enabledFreeTextEditing=!1,this.group=new fesm2022_forms.J3({authorityField:new fesm2022_forms.hs}),this.model$=new cjs.BehaviorSubject(null)}ngOnInit(){this.initAuthorityProperties()}initAuthorityProperties(){this.vocabulary$=this.dsoEditMetadataFieldService.findDsoFieldVocabulary(this.dso,this.mdField),this.isAuthorityControlled$=this.vocabulary$.pipe((0,operators.Mi)(v=>this.model$.next(this.createModel(v))),(0,operators.Tj)(result=>(0,empty_util.hj)(result))),this.isHierarchicalVocabulary$=this.vocabulary$.pipe((0,operators.Tj)(result=>(0,empty_util.hj)(result)&&result.hierarchical)),this.isScrollableVocabulary$=this.vocabulary$.pipe((0,operators.Tj)(result=>(0,empty_util.hj)(result)&&result.scrollable)),this.isSuggesterVocabulary$=this.vocabulary$.pipe((0,operators.Tj)(result=>(0,empty_util.hj)(result)&&!result.hierarchical&&!result.scrollable))}createModel(vocabulary){if((0,empty_util.hj)(vocabulary)){let formFieldValue;(0,empty_util.hj)(this.mdValue.newValue.value)?(formFieldValue=new form_field_metadata_value_model.e,formFieldValue.value=this.mdValue.newValue.value,formFieldValue.display=this.mdValue.newValue.value,this.mdValue.newValue.authority&&(formFieldValue.authority=this.mdValue.newValue.authority,formFieldValue.confidence=this.mdValue.newValue.confidence)):formFieldValue=this.mdValue.newValue.value;const vocabularyOptions=vocabulary?{closed:!1,name:vocabulary.name}:null;return vocabulary.scrollable?new dynamic_scrollable_dropdown_model.j({id:"authorityField",label:`${this.dsoType}.edit.metadata.edit.value`,placeholder:`${this.dsoType}.edit.metadata.edit.value`,vocabularyOptions,metadataFields:[this.mdField],value:formFieldValue,repeatable:!1,submissionId:"edit-metadata",hasSelectableMetadata:!1,maxOptions:10}):new dynamic_onebox_model.K({id:"authorityField",label:`${this.dsoType}.edit.metadata.edit.value`,vocabularyOptions,metadataFields:[this.mdField],value:formFieldValue,repeatable:!1,submissionId:"edit-metadata",hasSelectableMetadata:!1})}return null}ngOnChanges(changes){(0,empty_util.hj)(changes.mdField)&&!changes.mdField.firstChange&&(0,empty_util.hj)(changes.mdField.currentValue)&&((0,empty_util.hj)(changes.mdField.previousValue)&&changes.mdField.previousValue!==changes.mdField.currentValue&&(this.mdValue.newValue.authority=null,this.mdValue.newValue.confidence=confidence_type.l.CF_UNSET),changes.mdField.currentValue.includes(".")&&this.validateMetadataField().subscribe(isValid=>{isValid&&(this.initAuthorityProperties(),this.cdr.detectChanges())}))}validateMetadataField(){return this.registryService.queryMetadataFields(this.mdField,null,!0,!1,(0,follow_link_config_model.s)("schema")).pipe((0,shared_operators.qD)(),(0,operators.nx)(rd=>rd.hasSucceeded?(0,cjs.of)(rd).pipe((0,shared_operators.LB)(),(0,operators.s)(1),(0,operators.Tj)(fields=>fields.indexOf(this.mdField)>-1)):(this.notificationsService.error(this.translate.instant(`${this.dsoType}.edit.metadata.metadatafield.error`),rd.errorMessage),[!1])))}onChangeAuthorityField(event){event?(this.mdValue.newValue.value=event.value,event.authority?(this.mdValue.newValue.authority=event.authority,this.mdValue.newValue.confidence=confidence_type.l.CF_ACCEPTED):(this.mdValue.newValue.authority=null,this.mdValue.newValue.confidence=confidence_type.l.CF_UNSET),this.confirm.emit(!1)):(this.mdValue.newValue.value="",this.mdValue.newValue.authority=null,this.mdValue.newValue.confidence=confidence_type.l.CF_UNSET,this.confirm.emit(!1))}getModel(){return this.model$.value}onChangeEditingAuthorityStatus(status){this.editingAuthority=status}onChangeAuthorityKey(){""===this.mdValue.newValue.authority?(this.mdValue.newValue.confidence=confidence_type.l.CF_NOVALUE,this.confirm.emit(!1)):this.mdValue.newValue.authority!==this.mdValue.originalValue.authority&&(this.mdValue.newValue.confidence=confidence_type.l.CF_ACCEPTED,this.confirm.emit(!1))}toggleFreeTextEdition(){this.enabledFreeTextEditing&&this.getModel().value!==this.mdValue.newValue.value&&this.initAuthorityProperties(),this.enabledFreeTextEditing=!this.enabledFreeTextEditing}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||DsoEditMetadataAuthorityFieldComponent2)(core.rXU(core.gRc),core.rXU(DsoEditMetadataFieldService),core.rXU(item_data_service.ItemDataService),core.rXU(notifications_service.I),core.rXU(registry_service.x),core.rXU(ngx_translate_core.c$))}}static{this.\u0275cmp=core.VBU({type:DsoEditMetadataAuthorityFieldComponent2,selectors:[["ds-dso-edit-metadata-authority-field"]],standalone:!0,features:[core.Vt3,core.OA$,core.aNF],decls:1,vars:1,consts:[["rows","5",1,"form-control",3,"ngModel","dsDebounce"],[3,"bindId","group","model"],[3,"group","model"],[1,"btn","btn-secondary","w-100","mt-2",3,"title"],[1,"mt-2"],["rows","5",1,"form-control",3,"ngModelChange","onDebounce","ngModel","dsDebounce"],[3,"change","bindId","group","model"],[3,"change","group","model"],[1,"btn","btn-secondary","w-100","mt-2",3,"click","title"],[1,"fas","fa-fw",3,"ngClass"],[1,"btn-group","w-75"],["dsAuthorityConfidenceState","","aria-hidden","true",1,"fas","fa-fw","p-0","me-1","mt-auto","mb-auto",3,"authorityValue","iconMode"],["data-test","authority-input",1,"form-control","form-outline",3,"ngModelChange","change","ngModel","disabled"],["id","metadata-confirm-btn",1,"btn","btn-outline-success","btn-sm","ng-star-inserted",3,"title","ngbTooltip"],["id","metadata-confirm-btn",1,"btn","btn-outline-secondary","btn-sm","ng-star-inserted",3,"title","ngbTooltip"],["id","metadata-confirm-btn",1,"btn","btn-outline-success","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip"],[1,"fas","fa-lock-open","fa-fw"],["id","metadata-confirm-btn",1,"btn","btn-outline-secondary","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip"],[1,"fas","fa-lock","fa-fw"]],template:function(rf,ctx){1&rf&&core.DNE(0,DsoEditMetadataAuthorityFieldComponent_Conditional_0_Template,14,23),2&rf&&core.vxM(ctx.mdValue.editing?0:-1)},dependencies:[common.Jj,authority_confidence_state_directive.K,debounce_directive.R,dynamic_onebox_component.d,dynamic_scrollable_dropdown_component.s,fesm2022_forms.YN,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.vS,ng_bootstrap.n8,ng_bootstrap.md,common.YU,ngx_translate_core.h,ngx_translate_core.D9]})}}return DsoEditMetadataAuthorityFieldComponent2})();var entity_type_data_service=__webpack_require__(62744);const _forTrack0=($index,$item)=>$item.label;function DsoEditMetadataEntityFieldComponent_For_3_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",1),core.EFF(1),core.k0s()),2&rf){const entity_r1=ctx.$implicit;core.Y8G("value","none"===entity_r1.label?void 0:entity_r1.label),core.R7$(),core.SpI(" ",entity_r1.label," ")}}let DsoEditMetadataEntityFieldComponent=(()=>{class DsoEditMetadataEntityFieldComponent2 extends AbstractDsoEditMetadataValueFieldComponent{constructor(entityTypeService){super(),this.entityTypeService=entityTypeService}ngOnInit(){this.entities$=this.entityTypeService.findAll({elementsPerPage:100,currentPage:1}).pipe((0,shared_operators.Ar)())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||DsoEditMetadataEntityFieldComponent2)(core.rXU(entity_type_data_service.f))}}static{this.\u0275cmp=core.VBU({type:DsoEditMetadataEntityFieldComponent2,selectors:[["ds-dso-edit-metadata-entity-field"]],standalone:!0,features:[core.Vt3,core.aNF],decls:5,vars:6,consts:[[1,"form-select",3,"ngModelChange","ngModel"],[3,"value"]],template:function(rf,ctx){1&rf&&(core.j41(0,"select",0),core.nI1(1,"translate"),core.mxI("ngModelChange",function($event){return core.DH7(null==ctx.mdValue?null:ctx.mdValue.newValue.value,$event)||((null==ctx.mdValue?null:ctx.mdValue.newValue).value=$event),$event}),core.bIt("ngModelChange",function(){return ctx.confirm.emit(!1)}),core.Z7z(2,DsoEditMetadataEntityFieldComponent_For_3_Template,2,2,"option",1,_forTrack0),core.nI1(4,"async"),core.k0s()),2&rf&&(core.R50("ngModel",null==ctx.mdValue?null:ctx.mdValue.newValue.value),core.BMQ("aria-label",core.bMT(1,2,ctx.dsoType+".edit.metadata.edit.value")),core.R7$(2),core.Dyx(core.bMT(4,4,ctx.entities$)))},dependencies:[common.Jj,fesm2022_forms.YN,fesm2022_forms.xH,fesm2022_forms.y7,fesm2022_forms.wz,fesm2022_forms.BC,fesm2022_forms.vS,ngx_translate_core.h,ngx_translate_core.D9]})}}return DsoEditMetadataEntityFieldComponent2})();const map=new Map([[EditMetadataValueFieldType.PLAIN_TEXT,new Map([[listable_object_decorator.A2,new Map([[listable_object_decorator.SS,(()=>{class DsoEditMetadataTextFieldComponent2 extends AbstractDsoEditMetadataValueFieldComponent{static{this.\u0275fac=(()=>{let \u0275DsoEditMetadataTextFieldComponent_BaseFactory;return function(__ngFactoryType__){return(\u0275DsoEditMetadataTextFieldComponent_BaseFactory||(\u0275DsoEditMetadataTextFieldComponent_BaseFactory=core.xGo(DsoEditMetadataTextFieldComponent2)))(__ngFactoryType__||DsoEditMetadataTextFieldComponent2)}})()}static{this.\u0275cmp=core.VBU({type:DsoEditMetadataTextFieldComponent2,selectors:[["ds-dso-edit-metadata-text-field"]],standalone:!0,features:[core.Vt3,core.aNF],decls:2,vars:5,consts:[["rows","5",1,"form-control",3,"ngModelChange","onDebounce","ngModel","dsDebounce"]],template:function(rf,ctx){1&rf&&(core.j41(0,"textarea",0),core.nI1(1,"translate"),core.mxI("ngModelChange",function($event){return core.DH7(null==ctx.mdValue?null:ctx.mdValue.newValue.value,$event)||((null==ctx.mdValue?null:ctx.mdValue.newValue).value=$event),$event}),core.bIt("onDebounce",function(){return ctx.confirm.emit(!1)}),core.k0s()),2&rf&&(core.R50("ngModel",null==ctx.mdValue?null:ctx.mdValue.newValue.value),core.Y8G("dsDebounce",300),core.BMQ("aria-label",core.bMT(1,3,ctx.dsoType+".edit.metadata.edit.value")))},dependencies:[debounce_directive.R,fesm2022_forms.YN,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.vS,ngx_translate_core.h,ngx_translate_core.D9]})}}return DsoEditMetadataTextFieldComponent2})()]])]])],[EditMetadataValueFieldType.ENTITY_TYPE,new Map([[listable_object_decorator.A2,new Map([[listable_object_decorator.SS,DsoEditMetadataEntityFieldComponent]])]])],[EditMetadataValueFieldType.AUTHORITY,new Map([[listable_object_decorator.A2,new Map([[listable_object_decorator.SS,DsoEditMetadataAuthorityFieldComponent]])]])]]),DEFAULT_EDIT_METADATA_FIELD_TYPE=EditMetadataValueFieldType.PLAIN_TEXT;function DsoEditMetadataValueFieldLoaderComponent_ng_template_0_Template(rf,ctx){}let DsoEditMetadataValueFieldLoaderComponent=(()=>{class DsoEditMetadataValueFieldLoaderComponent2 extends abstract_component_loader_component.e{constructor(){super(...arguments),this.confirm=new core.bkB,this.inputNamesDependentForComponent=["context","type"],this.inputNames=["context","dso","dsoType","type","mdField","mdValue"],this.outputNames=["confirm"]}getComponent(){return function getDsoEditMetadataValueFieldComponent(type,context=listable_object_decorator.A2,theme=listable_object_decorator.SS){if(type){const mapForEntity=map.get(type);if((0,empty_util.a4)(mapForEntity)){const contextMap=mapForEntity.get(context);if((0,empty_util.a4)(contextMap)){const match=(0,listable_object_decorator.eW)(contextMap,theme);if((0,empty_util.a4)(match))return match;if((0,empty_util.a4)(contextMap.get(listable_object_decorator.SS)))return contextMap.get(listable_object_decorator.SS)}if((0,empty_util.a4)(mapForEntity.get(listable_object_decorator.A2))&&(0,empty_util.a4)(mapForEntity.get(listable_object_decorator.A2).get(listable_object_decorator.SS)))return mapForEntity.get(listable_object_decorator.A2).get(listable_object_decorator.SS)}}return map.get(DEFAULT_EDIT_METADATA_FIELD_TYPE).get(listable_object_decorator.A2).get(listable_object_decorator.SS)}(this.type,this.context,this.themeService.getThemeName())}static{this.\u0275fac=(()=>{let \u0275DsoEditMetadataValueFieldLoaderComponent_BaseFactory;return function(__ngFactoryType__){return(\u0275DsoEditMetadataValueFieldLoaderComponent_BaseFactory||(\u0275DsoEditMetadataValueFieldLoaderComponent_BaseFactory=core.xGo(DsoEditMetadataValueFieldLoaderComponent2)))(__ngFactoryType__||DsoEditMetadataValueFieldLoaderComponent2)}})()}static{this.\u0275cmp=core.VBU({type:DsoEditMetadataValueFieldLoaderComponent2,selectors:[["ds-dso-edit-metadata-value-field-loader"]],inputs:{context:"context",dso:"dso",dsoType:"dsoType",type:"type",mdField:"mdField",mdValue:"mdValue"},outputs:{confirm:"confirm"},standalone:!0,features:[core.Vt3,core.aNF],decls:2,vars:0,consts:[["DynamicComponentLoader",""],["dsDynamicComponentLoader",""]],template:function(rf,ctx){1&rf&&core.DNE(0,DsoEditMetadataValueFieldLoaderComponent_ng_template_0_Template,0,0,"ng-template",1,0,core.C5r)},dependencies:[dynamic_component_loader_directive.z],encapsulation:2})}}return DsoEditMetadataValueFieldLoaderComponent2})();const _c0=(a0,a1,a2,a3)=>({"ds-warning":a0,"ds-danger":a1,"ds-success":a2,"h-100":a3});function DsoEditMetadataValueComponent_Conditional_5_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",2),core.EFF(1),core.k0s()),2&rf){const ctx_r1=core.XpG();core.R7$(),core.JRh(ctx_r1.mdValue.newValue.value)}}function DsoEditMetadataValueComponent_Conditional_6_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"ds-dso-edit-metadata-value-field-loader",19),core.nI1(1,"async"),core.bIt("confirm",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.Njj(ctx_r1.confirm.emit($event))}),core.k0s()}if(2&rf){const ctx_r1=core.XpG();core.Y8G("context",ctx_r1.context)("dso",ctx_r1.dso)("dsoType",ctx_r1.dsoType)("mdField",ctx_r1.mdField)("mdValue",ctx_r1.mdValue)("type",core.bMT(1,6,ctx_r1.fieldType$))}}function DsoEditMetadataValueComponent_Conditional_7_Template(rf,ctx){if(1&rf&&(core.j41(0,"div")(1,"span",20),core.nrm(2,"i",21),core.EFF(3),core.nI1(4,"translate"),core.k0s()()),2&rf){const ctx_r1=core.XpG();core.R7$(2),core.Y8G("authorityValue",ctx_r1.mdValue.newValue)("iconMode",!0),core.R7$(),core.Lme(" ",core.bMT(4,4,ctx_r1.dsoType+".edit.metadata.authority.label")," ",ctx_r1.mdValue.newValue.authority," ")}}function DsoEditMetadataValueComponent_Conditional_8_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",4)(1,"a",22),core.nI1(2,"async"),core.EFF(3),core.nI1(4,"async"),core.k0s(),core.nrm(5,"ds-type-badge",23),core.k0s()),2&rf){const ctx_r1=core.XpG(),mdRepresentation_r4=core.r8f(2);core.R7$(),core.Y8G("routerLink",core.bMT(2,3,ctx_r1.mdRepresentationItemRoute$)),core.R7$(2),core.JRh(core.bMT(4,5,ctx_r1.mdRepresentationName$)),core.R7$(2),core.Y8G("object",mdRepresentation_r4)}}function DsoEditMetadataValueComponent_Conditional_10_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"input",24),core.nI1(1,"translate"),core.mxI("ngModelChange",function($event){core.eBV(_r5);const ctx_r1=core.XpG();return core.DH7(ctx_r1.mdValue.newValue.language,$event)||(ctx_r1.mdValue.newValue.language=$event),core.Njj($event)}),core.bIt("onDebounce",function(){core.eBV(_r5);const ctx_r1=core.XpG();return core.Njj(ctx_r1.confirm.emit(!1))}),core.k0s()}if(2&rf){const ctx_r1=core.XpG();core.R50("ngModel",ctx_r1.mdValue.newValue.language),core.Y8G("dsDebounce",300),core.BMQ("aria-label",core.bMT(1,3,ctx_r1.dsoType+".edit.metadata.edit.language"))}}function DsoEditMetadataValueComponent_Conditional_11_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",2),core.EFF(1),core.k0s()),2&rf){const ctx_r1=core.XpG();core.R7$(),core.JRh(ctx_r1.mdValue.newValue.language)}}function DsoEditMetadataValueComponent_Conditional_19_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"button",25),core.nI1(1,"translate"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r6);const ctx_r1=core.XpG();return core.Njj(ctx_r1.confirm.emit(!0))}),core.nrm(3,"i",26),core.k0s()}if(2&rf){const ctx_r1=core.XpG(),isVirtual_r7=core.r8f(0),saving_r8=core.r8f(17);core.FS9("ngbTooltip",core.bMT(1,3,ctx_r1.dsoType+".edit.metadata.edit.buttons.confirm")),core.Y8G("title",core.bMT(2,5,ctx_r1.dsoType+".edit.metadata.edit.buttons.confirm"))("dsBtnDisabled",isVirtual_r7||saving_r8)}}function DsoEditMetadataValueComponent_Conditional_20_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"button",27),core.nI1(1,"translate"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r9);const ctx_r1=core.XpG();return core.Njj(ctx_r1.edit.emit())}),core.nrm(3,"i",28),core.k0s()}if(2&rf){const ctx_r1=core.XpG(),isVirtual_r7=core.r8f(0),saving_r8=core.r8f(17);core.FS9("ngbTooltip",core.bMT(1,3,ctx_r1.dsoType+".edit.metadata.edit.buttons.edit")),core.Y8G("title",core.bMT(2,5,ctx_r1.dsoType+".edit.metadata.edit.buttons.edit"))("dsBtnDisabled",isVirtual_r7||ctx_r1.mdValue.change===ctx_r1.DsoEditMetadataChangeTypeEnum.REMOVE||saving_r8)}}let DsoEditMetadataValueComponent=(()=>{class DsoEditMetadataValueComponent2{constructor(relationshipService,dsoNameService,metadataService,dsoEditMetadataFieldService){this.relationshipService=relationshipService,this.dsoNameService=dsoNameService,this.metadataService=metadataService,this.dsoEditMetadataFieldService=dsoEditMetadataFieldService,this.isOnlyValue=!1,this.edit=new core.bkB,this.confirm=new core.bkB,this.remove=new core.bkB,this.undo=new core.bkB,this.dragging=new core.bkB,this.DsoEditMetadataChangeTypeEnum=dso_edit_metadata_form.QR,this.ConfidenceTypeEnum=confidence_type.l}ngOnInit(){this.initVirtualProperties()}ngOnChanges(changes){changes.mdField&&(this.fieldType$=this.getFieldType())}initVirtualProperties(){this.mdRepresentation$=this.metadataService.isVirtual(this.mdValue.newValue)?this.relationshipService.resolveMetadataRepresentation(this.mdValue.newValue,this.dso,"Item").pipe((0,operators.Tj)(mdRepresentation=>mdRepresentation.representationType===metadata_representation_model.d.Item?mdRepresentation:null)):cjs.EMPTY,this.mdRepresentationItemRoute$=this.mdRepresentation$.pipe((0,operators.Tj)(mdRepresentation=>mdRepresentation?(0,item_page_routing_paths._o)(mdRepresentation):null)),this.mdRepresentationName$=this.mdRepresentation$.pipe((0,operators.Tj)(mdRepresentation=>mdRepresentation?this.dsoNameService.getName(mdRepresentation):null))}getFieldType(){return this.dsoEditMetadataFieldService.findDsoFieldVocabulary(this.dso,this.mdField).pipe((0,operators.Tj)(vocabulary=>(0,empty_util.a4)(vocabulary)?EditMetadataValueFieldType.AUTHORITY:"dspace.entity.type"===this.mdField?EditMetadataValueFieldType.ENTITY_TYPE:EditMetadataValueFieldType.PLAIN_TEXT))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||DsoEditMetadataValueComponent2)(core.rXU(relationship_data_service.RelationshipDataService),core.rXU(dso_name_service.f),core.rXU(metadata_service.T),core.rXU(DsoEditMetadataFieldService))}}static{this.\u0275cmp=core.VBU({type:DsoEditMetadataValueComponent2,selectors:[["ds-dso-edit-metadata-value"]],inputs:{context:"context",dso:"dso",mdField:"mdField",mdValue:"mdValue",dsoType:"dsoType",saving$:"saving$",isOnlyValue:"isOnlyValue"},outputs:{edit:"edit",confirm:"confirm",remove:"remove",undo:"undo",dragging:"dragging"},standalone:!0,features:[core.OA$,core.aNF],decls:33,vars:46,consts:[["role","row","cdkDrag","",1,"d-flex","flex-row","ds-value-row",3,"cdkDragStarted","cdkDragEnded","ngClass"],["role","cell",1,"flex-grow-1","ds-flex-cell","ds-value-cell","d-flex","flex-column"],[1,"dont-break-out","preserve-line-breaks"],[1,"w-100",3,"context","dso","dsoType","mdField","mdValue","type"],[1,"d-flex"],["role","cell",1,"ds-flex-cell","ds-lang-cell"],["type","text",1,"form-control",3,"ngModel","dsDebounce"],["role","cell",1,"text-center","ds-flex-cell","ds-edit-cell"],[1,"btn-group"],[1,"edit-field"],[1,"btn-group","edit-buttons",3,"ngbTooltip"],["data-test","metadata-confirm-btn",1,"btn","btn-outline-success","btn-sm","ng-star-inserted",3,"title","ngbTooltip","dsBtnDisabled"],["data-test","metadata-edit-btn",1,"btn","btn-outline-primary","btn-sm","ng-star-inserted",3,"title","ngbTooltip","dsBtnDisabled"],["data-test","metadata-remove-btn",1,"btn","btn-outline-danger","btn-sm",3,"click","title","ngbTooltip","dsBtnDisabled"],[1,"fas","fa-trash-alt","fa-fw"],["data-test","metadata-undo-btn",1,"btn","btn-outline-warning","btn-sm",3,"click","title","ngbTooltip","dsBtnDisabled"],[1,"fas","fa-undo-alt","fa-fw"],["data-test","metadata-drag-btn","cdkDragHandle","",1,"btn","btn-outline-secondary","ds-drag-handle","btn-sm",3,"cdkDragHandleDisabled","dsBtnDisabled","title","ngbTooltip"],[1,"fas","fa-grip-vertical","fa-fw"],[1,"w-100",3,"confirm","context","dso","dsoType","mdField","mdValue","type"],[1,"badge","bg-light","border"],["dsAuthorityConfidenceState","","aria-hidden","true",1,"fas","fa-fw","p-0",3,"authorityValue","iconMode"],["target","_blank",1,"me-2",3,"routerLink"],[3,"object"],["type","text",1,"form-control",3,"ngModelChange","onDebounce","ngModel","dsDebounce"],["data-test","metadata-confirm-btn",1,"btn","btn-outline-success","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip","dsBtnDisabled"],[1,"fas","fa-check","fa-fw"],["data-test","metadata-edit-btn",1,"btn","btn-outline-primary","btn-sm","ng-star-inserted",3,"click","title","ngbTooltip","dsBtnDisabled"],[1,"fas","fa-edit","fa-fw"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.SS7(0),core.j41(1,"div",0),core.bIt("cdkDragStarted",function(){return core.eBV(_r1),core.Njj(ctx.dragging.emit(!0))})("cdkDragEnded",function(){return core.eBV(_r1),core.Njj(ctx.dragging.emit(!1))}),core.SS7(2),core.nI1(3,"async"),core.j41(4,"div",1),core.DNE(5,DsoEditMetadataValueComponent_Conditional_5_Template,2,1,"div",2)(6,DsoEditMetadataValueComponent_Conditional_6_Template,2,8,"ds-dso-edit-metadata-value-field-loader",3)(7,DsoEditMetadataValueComponent_Conditional_7_Template,5,6,"div")(8,DsoEditMetadataValueComponent_Conditional_8_Template,6,7,"div",4),core.k0s(),core.j41(9,"div",5),core.DNE(10,DsoEditMetadataValueComponent_Conditional_10_Template,2,5,"input",6)(11,DsoEditMetadataValueComponent_Conditional_11_Template,2,1,"div",2),core.k0s(),core.j41(12,"div",7)(13,"div",8)(14,"div",9)(15,"div",10),core.nI1(16,"translate"),core.SS7(17),core.nI1(18,"async"),core.DNE(19,DsoEditMetadataValueComponent_Conditional_19_Template,4,7,"button",11)(20,DsoEditMetadataValueComponent_Conditional_20_Template,4,7,"button",12),core.j41(21,"button",13),core.nI1(22,"translate"),core.nI1(23,"translate"),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.remove.emit())}),core.nrm(24,"i",14),core.k0s(),core.j41(25,"button",15),core.nI1(26,"translate"),core.nI1(27,"translate"),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.undo.emit())}),core.nrm(28,"i",16),core.k0s(),core.j41(29,"button",17),core.nI1(30,"translate"),core.nI1(31,"translate"),core.nrm(32,"i",18),core.k0s()()()()()()}if(2&rf){const isVirtual_r10=core.bH3(ctx.metadataService.isVirtual(ctx.mdValue.newValue));core.R7$(),core.Y8G("ngClass",core.ziG(41,_c0,ctx.mdValue.reordered||ctx.mdValue.change===ctx.DsoEditMetadataChangeTypeEnum.UPDATE,ctx.mdValue.change===ctx.DsoEditMetadataChangeTypeEnum.REMOVE,ctx.mdValue.change===ctx.DsoEditMetadataChangeTypeEnum.ADD,ctx.isOnlyValue)),core.R7$();const mdRepresentation_r11=core.bH3(core.bMT(3,21,ctx.mdRepresentation$));core.R7$(3),core.vxM(ctx.mdValue.editing||mdRepresentation_r11?-1:5),core.R7$(),core.vxM(ctx.mdValue.editing&&!mdRepresentation_r11?6:-1),core.R7$(),core.vxM(isVirtual_r10||ctx.mdValue.editing||!ctx.mdValue.newValue.authority||ctx.mdValue.newValue.confidence===ctx.ConfidenceTypeEnum.CF_UNSET||ctx.mdValue.newValue.confidence===ctx.ConfidenceTypeEnum.CF_NOVALUE?-1:7),core.R7$(),core.vxM(mdRepresentation_r11?8:-1),core.R7$(2),core.vxM(ctx.mdValue.editing?10:11),core.R7$(5),core.Y8G("ngbTooltip",isVirtual_r10?core.bMT(16,24,ctx.dsoType+".edit.metadata.edit.buttons.virtual"):null),core.R7$(2);const saving_r12=core.bH3(core.bMT(18,26,ctx.saving$));core.R7$(2),core.vxM(ctx.mdValue.editing?19:20),core.R7$(2),core.FS9("ngbTooltip",core.bMT(22,29,ctx.dsoType+".edit.metadata.edit.buttons.remove")),core.Y8G("title",core.bMT(23,31,ctx.dsoType+".edit.metadata.edit.buttons.remove"))("dsBtnDisabled",isVirtual_r10||ctx.mdValue.change&&ctx.mdValue.change!==ctx.DsoEditMetadataChangeTypeEnum.ADD||ctx.mdValue.editing||saving_r12),core.R7$(4),core.FS9("ngbTooltip",core.bMT(26,33,ctx.dsoType+".edit.metadata.edit.buttons.undo")),core.Y8G("title",core.bMT(27,35,ctx.dsoType+".edit.metadata.edit.buttons.undo"))("dsBtnDisabled",isVirtual_r10||!ctx.mdValue.change&&ctx.mdValue.reordered||!ctx.mdValue.change&&!ctx.mdValue.editing||saving_r12),core.R7$(4),core.AVh("disabled",ctx.isOnlyValue||saving_r12),core.FS9("ngbTooltip",core.bMT(30,37,ctx.dsoType+".edit.metadata.edit.buttons.drag")),core.Y8G("cdkDragHandleDisabled",ctx.isOnlyValue||saving_r12)("dsBtnDisabled",ctx.isOnlyValue||saving_r12)("title",core.bMT(31,39,ctx.dsoType+".edit.metadata.edit.buttons.drag"))}},dependencies:[common.Jj,authority_confidence_state_directive.K,btn_disabled_directive.A,drag_drop.T1,drag_drop.Fb,debounce_directive.R,DsoEditMetadataValueFieldLoaderComponent,fesm2022_forms.YN,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.vS,ng_bootstrap.n8,ng_bootstrap.md,common.YU,router.Wk,themed_type_badge_component.C,ngx_translate_core.h,ngx_translate_core.D9],styles:[".ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg);border:1px solid var(--bs-success)}.ds-drag-handle[_ngcontent-%COMP%]:not(.disabled){cursor:grab}  .edit-field>ngb-tooltip-window .tooltip-inner{min-width:var(--ds-dso-edit-virtual-tooltip-min-width)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.badge.bg-light[_ngcontent-%COMP%]{color:var(--bs-gray-900)}",".ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.ds-flex-cell[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--bs-gray-200)}.ds-lang-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-lang-width);max-width:var(--ds-dso-edit-lang-width)}.ds-edit-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-actions-width)}.ds-value-row[_ngcontent-%COMP%]{background-color:#fff}.ds-value-row[_ngcontent-%COMP%]:active{cursor:grabbing}.ds-value-row.ds-warning[_ngcontent-%COMP%]{background-color:var(--ds-warning-bg-subtle)}.ds-value-row.ds-warning[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-warning-border-subtle)}.ds-value-row.ds-danger[_ngcontent-%COMP%]{background-color:var(--ds-danger-bg-subtle)}.ds-value-row.ds-danger[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-danger-border-subtle)}.ds-value-row.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg-subtle)}.ds-value-row.ds-success[_ngcontent-%COMP%]   .ds-flex-cell[_ngcontent-%COMP%]{border:1px solid var(--bs-success-border-subtle)}"]})}}return DsoEditMetadataValueComponent2})()},42395:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DsoEditMetadataComponent:()=>DsoEditMetadataComponent});var common=__webpack_require__(87514),ngx_translate_core=__webpack_require__(2385),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),app_config_interface=__webpack_require__(3339),lazy_data_service=__webpack_require__(78658),context_model=__webpack_require__(21571),shared_operators=(__webpack_require__(27434),__webpack_require__(39022)),resource_type=__webpack_require__(87456),alert_component=__webpack_require__(6213),alert_type=__webpack_require__(83113),btn_disabled_directive=__webpack_require__(69919),empty_util=__webpack_require__(2794),themed_loading_component=__webpack_require__(18869),notifications_service=__webpack_require__(76623),dso_edit_metadata_field_values_component=__webpack_require__(68838),dso_edit_metadata_form=__webpack_require__(42489),dso_edit_metadata_headers_component=__webpack_require__(36482),dso_edit_metadata_value_component=__webpack_require__(10992),dso_edit_metadata_value_headers_component=__webpack_require__(82),metadata_field_selector_component=__webpack_require__(52842),core=__webpack_require__(25376),router=__webpack_require__(18134),drag_drop=__webpack_require__(53647);let ArrayMoveChangeAnalyzer=(()=>{class ArrayMoveChangeAnalyzer2{diff(array1,array2){return this.getMoves(array1,array2).map(move=>Object.assign({op:"move",from:"/"+move[0],path:"/"+move[1]}))}getMoves(array1,array2){const moved=[...array2];return array1.reduce((moves,item,index)=>{if((0,empty_util.a4)(item)&&item!==moved[index]){const last=moved.lastIndexOf(item);(0,drag_drop.HD)(moved,last,index),moves.unshift([index,last])}return moves},[])}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ArrayMoveChangeAnalyzer2)}}static{this.\u0275prov=core.jDH({token:ArrayMoveChangeAnalyzer2,factory:ArrayMoveChangeAnalyzer2.\u0275fac,providedIn:"root"})}}return ArrayMoveChangeAnalyzer2})();function DsoEditMetadataComponent_Conditional_0_Conditional_10_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"button",17),core.nI1(1,"async"),core.nI1(2,"translate"),core.nI1(3,"translate"),core.bIt("click",function(){core.eBV(_r3);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.reinstate())}),core.nrm(4,"i",18),core.j41(5,"span",4),core.EFF(6),core.nI1(7,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("dsBtnDisabled",core.bMT(1,4,ctx_r1.saving$))("title",core.bMT(2,6,ctx_r1.dsoType+".edit.metadata.reinstate-button")),core.BMQ("aria-label",core.bMT(3,8,ctx_r1.dsoType+".edit.metadata.reinstate-button")),core.R7$(6),core.SpI("\xa0",core.bMT(7,10,ctx_r1.dsoType+".edit.metadata.reinstate-button"),"")}}function DsoEditMetadataComponent_Conditional_0_Conditional_19_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"button",19),core.nI1(1,"translate"),core.nI1(2,"async"),core.nI1(3,"translate"),core.bIt("click",function(){core.eBV(_r4);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.discard())}),core.nrm(4,"i",20),core.j41(5,"span",4),core.EFF(6),core.nI1(7,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("title",core.bMT(1,4,ctx_r1.dsoType+".edit.metadata.discard-button"))("dsBtnDisabled",!ctx_r1.hasChanges||core.bMT(2,6,ctx_r1.saving$)),core.BMQ("aria-label",core.bMT(3,8,ctx_r1.dsoType+".edit.metadata.discard-button")),core.R7$(6),core.SpI("\xa0",core.bMT(7,10,ctx_r1.dsoType+".edit.metadata.discard-button"),"")}}function DsoEditMetadataComponent_Conditional_0_Conditional_23_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",11)(1,"div",21)(2,"ds-metadata-field-selector",22),core.mxI("mdFieldChange",function($event){core.eBV(_r5);const ctx_r1=core.XpG(2);return core.DH7(ctx_r1.newMdField,$event)||(ctx_r1.newMdField=$event),core.Njj($event)}),core.k0s()(),core.j41(3,"div",23)(4,"div",9),core.nrm(5,"ds-dso-edit-metadata-value-headers",24),core.j41(6,"ds-dso-edit-metadata-value",25),core.bIt("confirm",function($event){core.eBV(_r5);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.confirmNewValue($event))})("remove",function(){core.eBV(_r5);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.form.newValue=void 0)})("undo",function(){core.eBV(_r5);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.form.newValue=void 0)}),core.k0s()()()()}if(2&rf){const ctx_r1=core.XpG(2);core.R7$(2),core.Y8G("dsoType",ctx_r1.dsoType),core.R50("mdField",ctx_r1.newMdField),core.Y8G("autofocus",!0),core.R7$(3),core.Y8G("dsoType",ctx_r1.dsoType),core.R7$(),core.Y8G("dso",ctx_r1.dso)("context",ctx_r1.Context.AddMetadata)("mdValue",ctx_r1.form.newValue)("dsoType",ctx_r1.dsoType)("saving$",ctx_r1.savingOrLoadingFieldValidation$)("isOnlyValue",!0)("mdField",ctx_r1.newMdField)}}function DsoEditMetadataComponent_Conditional_0_For_25_Conditional_4_Template(rf,ctx){if(1&rf){const _r7=core.RV6();core.j41(0,"div",30),core.bIt("click",function(){core.eBV(_r7);const mdField_r8=core.XpG().$implicit,ctx_r1=core.XpG(2);return ctx_r1.form.resetOrder(mdField_r8),core.Njj(ctx_r1.onValueSaved())}),core.EFF(1),core.nI1(2,"translate"),core.k0s()}if(2&rf){const ctx_r1=core.XpG(3);core.R7$(),core.SpI(" ",core.bMT(2,1,ctx_r1.dsoType+".edit.metadata.reset-order-button")," ")}}function DsoEditMetadataComponent_Conditional_0_For_25_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",11)(1,"div",26)(2,"span",27),core.EFF(3),core.k0s(),core.DNE(4,DsoEditMetadataComponent_Conditional_0_For_25_Conditional_4_Template,3,3,"div",28),core.k0s(),core.j41(5,"ds-dso-edit-metadata-field-values",29),core.bIt("valueSaved",function(){core.eBV(_r6);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.onValueSaved())}),core.k0s()()}if(2&rf){const mdField_r8=ctx.$implicit,ctx_r1=core.XpG(2);core.R7$(3),core.JRh(mdField_r8),core.R7$(),core.vxM(ctx_r1.form.hasOrderChanges(mdField_r8)?4:-1),core.R7$(),core.Y8G("dso",ctx_r1.dso)("form",ctx_r1.form)("dsoType",ctx_r1.dsoType)("saving$",ctx_r1.saving$)("draggingMdField$",ctx_r1.draggingMdField$)("mdField",mdField_r8)}}function DsoEditMetadataComponent_Conditional_0_Conditional_26_Template(rf,ctx){if(1&rf&&(core.j41(0,"div"),core.nrm(1,"ds-alert",31),core.k0s()),2&rf){const ctx_r1=core.XpG(2);core.R7$(),core.Y8G("content",ctx_r1.dsoType+".edit.metadata.empty")("type",ctx_r1.AlertTypeEnum.Info)}}function DsoEditMetadataComponent_Conditional_0_Conditional_29_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"button",32),core.nI1(1,"async"),core.nI1(2,"translate"),core.nI1(3,"translate"),core.bIt("click",function(){core.eBV(_r9);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.reinstate())}),core.nrm(4,"i",18),core.EFF(5),core.nI1(6,"translate"),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("dsBtnDisabled",core.bMT(1,4,ctx_r1.saving$))("title",core.bMT(2,6,ctx_r1.dsoType+".edit.metadata.reinstate-button")),core.BMQ("aria-label",core.bMT(3,8,ctx_r1.dsoType+".edit.metadata.reinstate-button")),core.R7$(5),core.SpI(" ",core.bMT(6,10,ctx_r1.dsoType+".edit.metadata.reinstate-button")," ")}}function DsoEditMetadataComponent_Conditional_0_Conditional_37_Template(rf,ctx){if(1&rf){const _r10=core.RV6();core.j41(0,"button",33),core.nI1(1,"translate"),core.nI1(2,"async"),core.nI1(3,"translate"),core.bIt("click",function(){core.eBV(_r10);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.discard())}),core.nrm(4,"i",20),core.EFF(5),core.nI1(6,"translate"),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("title",core.bMT(1,4,ctx_r1.dsoType+".edit.metadata.discard-button"))("dsBtnDisabled",!ctx_r1.hasChanges||core.bMT(2,6,ctx_r1.saving$)),core.BMQ("aria-label",core.bMT(3,8,ctx_r1.dsoType+".edit.metadata.discard-button")),core.R7$(5),core.SpI(" ",core.bMT(6,10,ctx_r1.dsoType+".edit.metadata.discard-button")," ")}}function DsoEditMetadataComponent_Conditional_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",0)(1,"div",1)(2,"button",2),core.nI1(3,"async"),core.nI1(4,"translate"),core.nI1(5,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.add())}),core.nrm(6,"i",3),core.j41(7,"span",4),core.EFF(8),core.nI1(9,"translate"),core.k0s()(),core.DNE(10,DsoEditMetadataComponent_Conditional_0_Conditional_10_Template,8,12,"button",5),core.j41(11,"button",6),core.nI1(12,"async"),core.nI1(13,"translate"),core.nI1(14,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.nrm(15,"i",7),core.j41(16,"span",4),core.EFF(17),core.nI1(18,"translate"),core.k0s()(),core.DNE(19,DsoEditMetadataComponent_Conditional_0_Conditional_19_Template,8,12,"button",8),core.k0s(),core.j41(20,"div",9),core.nI1(21,"translate"),core.nrm(22,"ds-dso-edit-metadata-headers",10),core.DNE(23,DsoEditMetadataComponent_Conditional_0_Conditional_23_Template,7,11,"div",11),core.Z7z(24,DsoEditMetadataComponent_Conditional_0_For_25_Template,6,8,"div",11,core.fX1),core.k0s(),core.DNE(26,DsoEditMetadataComponent_Conditional_0_Conditional_26_Template,2,2,"div"),core.j41(27,"div",12)(28,"div",13),core.DNE(29,DsoEditMetadataComponent_Conditional_0_Conditional_29_Template,7,12,"button",14),core.j41(30,"button",15),core.nI1(31,"async"),core.nI1(32,"translate"),core.nI1(33,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.nrm(34,"i",7),core.EFF(35),core.nI1(36,"translate"),core.k0s(),core.DNE(37,DsoEditMetadataComponent_Conditional_0_Conditional_37_Template,7,12,"button",16),core.k0s()()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.Y8G("dsBtnDisabled",ctx_r1.form.newValue||core.bMT(3,20,ctx_r1.saving$))("title",core.bMT(4,22,ctx_r1.dsoType+".edit.metadata.add-button")),core.BMQ("aria-label",core.bMT(5,24,ctx_r1.dsoType+".edit.metadata.add-button")),core.R7$(6),core.SpI("\xa0",core.bMT(9,26,ctx_r1.dsoType+".edit.metadata.add-button"),""),core.R7$(2),core.vxM(ctx_r1.isReinstatable?10:-1),core.R7$(),core.Y8G("dsBtnDisabled",!ctx_r1.hasChanges||core.bMT(12,28,ctx_r1.saving$))("title",core.bMT(13,30,ctx_r1.dsoType+".edit.metadata.save-button")),core.BMQ("aria-label",core.bMT(14,32,ctx_r1.dsoType+".edit.metadata.save-button")),core.R7$(6),core.SpI("\xa0",core.bMT(18,34,ctx_r1.dsoType+".edit.metadata.save-button"),""),core.R7$(2),core.vxM(ctx_r1.isReinstatable?-1:19),core.R7$(),core.BMQ("aria-label",core.bMT(21,36,"item.edit.head")),core.R7$(2),core.Y8G("dsoType",ctx_r1.dsoType),core.R7$(),core.vxM(ctx_r1.form.newValue?23:-1),core.R7$(),core.Dyx(ctx_r1.form.fieldKeys),core.R7$(2),core.vxM(ctx_r1.isEmpty&&!ctx_r1.form.newValue?26:-1),core.R7$(3),core.vxM(ctx_r1.isReinstatable?29:-1),core.R7$(),core.Y8G("dsBtnDisabled",!ctx_r1.hasChanges||core.bMT(31,38,ctx_r1.saving$))("title",core.bMT(32,40,ctx_r1.dsoType+".edit.metadata.save-button")),core.BMQ("aria-label",core.bMT(33,42,ctx_r1.dsoType+".edit.metadata.save-button")),core.R7$(5),core.SpI(" ",core.bMT(36,44,ctx_r1.dsoType+".edit.metadata.save-button")," "),core.R7$(2),core.vxM(ctx_r1.isReinstatable?-1:37)}}function DsoEditMetadataComponent_Conditional_1_Template(rf,ctx){1&rf&&core.nrm(0,"ds-loading")}let DsoEditMetadataComponent=(()=>{class DsoEditMetadataComponent2{constructor(route,notificationsService,translateService,parentInjector,arrayMoveChangeAnalyser,cdr,dataServiceMap){this.route=route,this.notificationsService=notificationsService,this.translateService=translateService,this.parentInjector=parentInjector,this.arrayMoveChangeAnalyser=arrayMoveChangeAnalyser,this.cdr=cdr,this.dataServiceMap=dataServiceMap,this.saving$=new cjs.BehaviorSubject(!1),this.draggingMdField$=new cjs.BehaviorSubject(null),this.loadingFieldValidation$=new cjs.BehaviorSubject(!1),this.AlertTypeEnum=alert_type.v,this.Context=context_model.o}ngOnInit(){(0,empty_util.Tn)(this.dso)?this.dsoUpdateSubscription=(0,cjs.combineLatest)([this.route.data,this.route.parent.data]).pipe((0,operators.Tj)(([data,parentData])=>Object.assign({},data,parentData)),(0,operators.Mi)(data=>this.initDSO(data.dso.payload)),(0,operators.ZZ)(()=>this.retrieveDataService())).subscribe(dataService=>{this.initDataService(dataService),this.initForm()}):(this.initDSOType(this.dso),this.retrieveDataService().subscribe(dataService=>{this.initDataService(dataService),this.initForm()})),this.savingOrLoadingFieldValidation$=(0,cjs.combineLatest)([this.saving$,this.loadingFieldValidation$]).pipe((0,operators.Tj)(([saving,loading])=>saving||loading))}retrieveDataService(){return(0,empty_util.Tn)(this.updateDataService)?(0,lazy_data_service.M)(this.dataServiceMap,this.dsoType,this.parentInjector):(0,cjs.of)(this.updateDataService)}initDSO(object){this.dso=object,this.initDSOType(object)}initDSOType(object){let type;type="string"==typeof object.type?new resource_type.v(object.type):object.type,this.dsoType=type.value}initDataService(dataService){(0,empty_util.hj)(dataService)&&(this.updateDataService=dataService)}initForm(){this.form=new dso_edit_metadata_form.qf(this.dso.metadata),this.onValueSaved(),this.cdr.detectChanges()}onValueSaved(){this.hasChanges=this.form.hasChanges(),this.isReinstatable=this.form.isReinstatable(),this.isEmpty=0===Object.keys(this.form.fields).length}submit(){this.saving$.next(!0),this.updateDataService.patch(this.dso,this.form.getOperations(this.arrayMoveChangeAnalyser)).pipe((0,shared_operators.qD)()).subscribe(rd=>{this.saving$.next(!1),rd.hasFailed?this.notificationsService.error(this.translateService.instant(`${this.dsoType}.edit.metadata.notifications.error.title`),rd.errorMessage):(this.notificationsService.success(this.translateService.instant(`${this.dsoType}.edit.metadata.notifications.saved.title`),this.translateService.instant(`${this.dsoType}.edit.metadata.notifications.saved.content`)),this.dso=rd.payload,this.initForm())})}confirmNewValue(saved){saved&&this.setMetadataField()}setMetadataField(){this.form.resetReinstatable(),this.loadingFieldValidation$.next(!0),this.metadataFieldSelectorComponent.validate().subscribe(valid=>{this.loadingFieldValidation$.next(!1),valid&&(this.form.setMetadataField(this.newMdField),this.onValueSaved())})}add(){this.newMdField=void 0,this.form.add()}discard(){this.form.discard(),this.onValueSaved()}reinstate(){this.form.reinstate(),this.onValueSaved()}ngOnDestroy(){(0,empty_util.a4)(this.dsoUpdateSubscription)&&this.dsoUpdateSubscription.unsubscribe()}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||DsoEditMetadataComponent2)(core.rXU(router.nX),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(core.zZn),core.rXU(ArrayMoveChangeAnalyzer),core.rXU(core.gRc),core.rXU(app_config_interface.l9))}}static{this.\u0275cmp=core.VBU({type:DsoEditMetadataComponent2,selectors:[["ds-base-dso-edit-metadata"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(metadata_field_selector_component.g,5),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.metadataFieldSelectorComponent=_t.first)}},inputs:{dso:"dso",updateDataService:"updateDataService"},standalone:!0,features:[core.aNF],decls:2,vars:2,consts:[[1,"item-metadata"],[1,"button-row","top","d-flex","my-2","space-children-mr","ms-gap"],["id","dso-add-btn",1,"me-auto","btn","btn-success",3,"click","dsBtnDisabled","title"],["aria-hidden","true",1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],["id","dso-reinstate-btn",1,"btn","btn-warning","ms-1",3,"dsBtnDisabled","title"],["id","dso-save-btn",1,"btn","btn-primary","ms-1",3,"click","dsBtnDisabled","title"],["aria-hidden","true",1,"fas","fa-save"],["id","dso-discard-btn",1,"btn","btn-danger","ms-1",3,"title","dsBtnDisabled"],["role","table"],[3,"dsoType"],["role","row",1,"d-flex","flex-row","ds-field-row"],[1,"button-row","bottom","d-inline-block","w-100"],[1,"mt-2","float-end","space-children-mr","ms-gap"],[1,"btn","btn-warning",3,"dsBtnDisabled","title"],[1,"btn","btn-primary",3,"click","dsBtnDisabled","title"],[1,"btn","btn-danger",3,"title","dsBtnDisabled"],["id","dso-reinstate-btn",1,"btn","btn-warning","ms-1",3,"click","dsBtnDisabled","title"],["aria-hidden","true",1,"fas","fa-undo-alt"],["id","dso-discard-btn",1,"btn","btn-danger","ms-1",3,"click","title","dsBtnDisabled"],["aria-hidden","true",1,"fas","fa-times"],["role","rowheader",1,"lbl-cell","ds-success"],[3,"mdFieldChange","dsoType","mdField","autofocus"],["role","cell",1,"flex-grow-1","ds-drop-list"],["role","presentation",3,"dsoType"],[3,"confirm","remove","undo","dso","context","mdValue","dsoType","saving$","isOnlyValue","mdField"],["role","rowheader",1,"lbl-cell"],[1,"dont-break-out","preserve-line-breaks"],[1,"btn","btn-warning","reset-order-button","mt-2","w-100"],["role","cell",1,"flex-grow-1",3,"valueSaved","dso","form","dsoType","saving$","draggingMdField$","mdField"],[1,"btn","btn-warning","reset-order-button","mt-2","w-100",3,"click"],[3,"content","type"],[1,"btn","btn-warning",3,"click","dsBtnDisabled","title"],[1,"btn","btn-danger",3,"click","title","dsBtnDisabled"]],template:function(rf,ctx){1&rf&&core.DNE(0,DsoEditMetadataComponent_Conditional_0_Template,38,46,"div",0)(1,DsoEditMetadataComponent_Conditional_1_Template,1,0,"ds-loading"),2&rf&&(core.vxM(ctx.form?0:-1),core.R7$(),core.vxM(ctx.form?-1:1))},dependencies:[alert_component.C,common.Jj,btn_disabled_directive.A,dso_edit_metadata_field_values_component.t,dso_edit_metadata_headers_component.L,dso_edit_metadata_value_component.o,dso_edit_metadata_value_headers_component.c,metadata_field_selector_component.g,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9],styles:[".lbl-cell[_ngcontent-%COMP%]{min-width:var(--ds-dso-edit-field-width);max-width:var(--ds-dso-edit-field-width);background-color:var(--bs-gray-100);font-weight:700;padding:1rem;border:1px solid var(--bs-gray-200)}.lbl-cell.ds-success[_ngcontent-%COMP%]{background-color:var(--ds-success-bg);border:1px solid var(--bs-success)}.ds-field-row[_ngcontent-%COMP%]{border:1px solid var(--bs-gray-400)}.reset-order-button[_ngcontent-%COMP%]:hover{cursor:pointer}"]})}}return DsoEditMetadataComponent2})()},52842:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{g:()=>MetadataFieldSelectorComponent});var _angular_common__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(87514),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(25376),_angular_forms__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(13054),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(2385),ngx_infinite_scroll__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(68109),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9238),rxjs_operators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(60444),_core_cache_models_sort_options_model__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(60795),_core_registry_registry_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(69911),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(39022),_shared_empty_util__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2794),_shared_loading_themed_loading_component__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(18869),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(76623),_shared_utils_click_outside_directive__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(70092),_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(76715);const _c0=["mdFieldInput"],_c1=a0=>({"is-invalid":a0}),_c2=a0=>({show:a0});function MetadataFieldSelectorComponent_Conditional_4_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_5__.EFF(1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_5__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.JRh(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(2,1,ctx_r1.dsoType+".edit.metadata.metadatafield.invalid"))}}function MetadataFieldSelectorComponent_Conditional_9_For_1_Template(rf,ctx){if(1&rf){const _r3=_angular_core__WEBPACK_IMPORTED_MODULE_5__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"button",10,1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.bIt("click",function(){const listEntry_r4=_angular_core__WEBPACK_IMPORTED_MODULE_5__.eBV(_r3).$implicit,ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_5__.XpG(2);return _angular_core__WEBPACK_IMPORTED_MODULE_5__.Njj(ctx_r1.select(listEntry_r4))}),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nrm(2,"span",11),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()}if(2&rf){const listEntry_r4=ctx.$implicit;_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("innerHTML",listEntry_r4,_angular_core__WEBPACK_IMPORTED_MODULE_5__.npT)}}function MetadataFieldSelectorComponent_Conditional_9_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.Z7z(0,MetadataFieldSelectorComponent_Conditional_9_For_1_Template,3,1,"button",9,_angular_core__WEBPACK_IMPORTED_MODULE_5__.fX1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(2,"async")),2&rf){const ctx_r1=_angular_core__WEBPACK_IMPORTED_MODULE_5__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_5__.Dyx(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(2,0,ctx_r1.mdFieldOptions$))}}function MetadataFieldSelectorComponent_Conditional_11_Template(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"button",8),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nrm(1,"ds-loading",12),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("showMessage",!1))}let MetadataFieldSelectorComponent=(()=>{class MetadataFieldSelectorComponent2{constructor(registryService,notificationsService,translate){this.registryService=registryService,this.notificationsService=notificationsService,this.translate=translate,this.autofocus=!1,this.mdFieldChange=new _angular_core__WEBPACK_IMPORTED_MODULE_5__.bkB,this.mdFieldOptions$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.BehaviorSubject([]),this.input=new _angular_forms__WEBPACK_IMPORTED_MODULE_7__.hs,this.query$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.BehaviorSubject(null),this.debounceTime=300,this.selectedValueLoading=!1,this.showInvalid=!1,this.subs=[],this.currentPage$=new rxjs__WEBPACK_IMPORTED_MODULE_6__.BehaviorSubject(1),this.hasNextPage=!1,this.loading=!1,this.pageOptions={elementsPerPage:20,sort:new _core_cache_models_sort_options_model__WEBPACK_IMPORTED_MODULE_0__.z("fieldName",_core_cache_models_sort_options_model__WEBPACK_IMPORTED_MODULE_0__.U.ASC)}}ngOnInit(){this.subs.push(this.input.valueChanges.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.BL)(this.debounceTime),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.ql)("")).subscribe(valueChange=>{this.currentPage$.next(1),this.selectedValueLoading||this.query$.next(valueChange),this.mdField=valueChange,this.mdFieldChange.emit(this.mdField)})),this.subs.push((0,rxjs__WEBPACK_IMPORTED_MODULE_6__.combineLatest)(this.query$,this.currentPage$).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.nx)(([query,page])=>(this.loading=!0,1===page&&this.mdFieldOptions$.next([]),this.search(query,page)))).subscribe(rd=>{this.selectedValueLoading||this.updateList(rd)}))}ngAfterViewInit(){this.autofocus&&this.mdFieldInput.nativeElement.focus()}validate(){return this.registryService.queryMetadataFields(this.mdField,Object.assign({},this.pageOptions,{currentPage:1}),!0,!1,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_9__.s)("schema")).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.nx)(rd=>rd.hasSucceeded?(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)(rd).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.LB)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.s)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.Tj)(fields=>fields.indexOf(this.mdField)>-1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.Mi)(exists=>this.showInvalid=!exists)):(this.notificationsService.error(this.translate.instant(`${this.dsoType}.edit.metadata.metadatafield.error`),rd.errorMessage),[!1])))}select(mdFieldOption){this.selectedValueLoading=!0,this.input.setValue(mdFieldOption)}onScrollDown(){this.hasNextPage&&!this.loading&&this.currentPage$.next(this.currentPage$.value+1)}updateList(list){this.loading=!1,this.hasNextPage=list.length>0;const currentEntries=this.mdFieldOptions$.getValue();this.mdFieldOptions$.next([...currentEntries,...list]),this.selectedValueLoading=!1}search(query,page,useCache=!0){return this.registryService.queryMetadataFields(query,Object.assign({},this.pageOptions,{currentPage:page}),useCache,!1,(0,_shared_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_9__.s)("schema")).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.v7)(),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.LB)())}ngOnDestroy(){this.subs.filter(sub=>(0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_10__.a4)(sub)).forEach(sub=>sub.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||MetadataFieldSelectorComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_core_registry_registry_service__WEBPACK_IMPORTED_MODULE_1__.x),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_4__.I),_angular_core__WEBPACK_IMPORTED_MODULE_5__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_11__.c$))}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_5__.VBU({type:MetadataFieldSelectorComponent2,selectors:[["ds-metadata-field-selector"]],viewQuery:function(rf,ctx){if(1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_5__.GBs(_c0,7),2&rf){let _t;_angular_core__WEBPACK_IMPORTED_MODULE_5__.mGM(_t=_angular_core__WEBPACK_IMPORTED_MODULE_5__.lsd())&&(ctx.mdFieldInput=_t.first)}},inputs:{dsoType:"dsoType",mdField:"mdField",autofocus:"autofocus"},outputs:{mdFieldChange:"mdFieldChange"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_5__.aNF],decls:12,vars:22,consts:[["mdFieldInput",""],["listEntryElement",""],[1,"w-100","position-relative"],["type","text",1,"form-control",3,"focusin","dsClickOutside","click","keyup","ngClass","value","formControl"],[1,"invalid-feedback","show-feedback"],["id","scrollable-metadata-field-selector",1,"dropdown-menu","scrollable-menu",3,"ngClass"],[1,"dropdown-list"],["infiniteScroll","",3,"scrolled","infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollContainer","fromRoot"],[1,"list-group-item","list-group-item-action","border-0","list-entry"],["dsHoverClass","ds-hover",1,"d-block","dropdown-item"],["dsHoverClass","ds-hover",1,"d-block","dropdown-item",3,"click"],[3,"innerHTML"],[3,"showMessage"]],template:function(rf,ctx){if(1&rf){const _r1=_angular_core__WEBPACK_IMPORTED_MODULE_5__.RV6();_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(0,"div",2)(1,"input",3,0),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.bIt("focusin",function(){return _angular_core__WEBPACK_IMPORTED_MODULE_5__.eBV(_r1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Njj(ctx.query$.next(ctx.mdField))})("dsClickOutside",function(){return _angular_core__WEBPACK_IMPORTED_MODULE_5__.eBV(_r1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Njj(ctx.query$.next(null))})("click",function($event){return _angular_core__WEBPACK_IMPORTED_MODULE_5__.eBV(_r1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Njj($event.stopPropagation())})("keyup",function(){return _angular_core__WEBPACK_IMPORTED_MODULE_5__.eBV(_r1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Njj(ctx.selectedValueLoading=!1)}),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.DNE(4,MetadataFieldSelectorComponent_Conditional_4_Template,3,3,"div",4),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(5,"div",5),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(6,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.j41(7,"div",6)(8,"div",7),_angular_core__WEBPACK_IMPORTED_MODULE_5__.bIt("scrolled",function(){return _angular_core__WEBPACK_IMPORTED_MODULE_5__.eBV(_r1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Njj(ctx.onScrollDown())}),_angular_core__WEBPACK_IMPORTED_MODULE_5__.DNE(9,MetadataFieldSelectorComponent_Conditional_9_Template,3,2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.nI1(10,"async"),_angular_core__WEBPACK_IMPORTED_MODULE_5__.DNE(11,MetadataFieldSelectorComponent_Conditional_11_Template,2,1,"button",8),_angular_core__WEBPACK_IMPORTED_MODULE_5__.k0s()()()()}if(2&rf){let tmp_6_0;_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("ngClass",_angular_core__WEBPACK_IMPORTED_MODULE_5__.eq3(18,_c1,ctx.showInvalid))("value",ctx.mdField)("formControl",ctx.input),_angular_core__WEBPACK_IMPORTED_MODULE_5__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(3,12,ctx.dsoType+".edit.metadata.metadatafield")),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_5__.vxM(ctx.showInvalid?4:-1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("ngClass",_angular_core__WEBPACK_IMPORTED_MODULE_5__.eq3(20,_c2,(null==(tmp_6_0=_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(6,14,ctx.mdFieldOptions$))?null:tmp_6_0.length)>0)),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_5__.Y8G("infiniteScrollDistance",1)("infiniteScrollThrottle",0)("infiniteScrollContainer","#scrollable-metadata-field-selector")("fromRoot",!0),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_5__.vxM(_angular_core__WEBPACK_IMPORTED_MODULE_5__.bMT(10,16,ctx.mdFieldOptions$)?9:-1),_angular_core__WEBPACK_IMPORTED_MODULE_5__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_5__.vxM(ctx.loading?11:-1)}},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_12__.Jj,_shared_utils_click_outside_directive__WEBPACK_IMPORTED_MODULE_13__.z,_angular_forms__WEBPACK_IMPORTED_MODULE_7__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_7__.me,_angular_forms__WEBPACK_IMPORTED_MODULE_7__.BC,ngx_infinite_scroll__WEBPACK_IMPORTED_MODULE_14__.e,ngx_infinite_scroll__WEBPACK_IMPORTED_MODULE_14__.D,_angular_common__WEBPACK_IMPORTED_MODULE_12__.YU,_angular_forms__WEBPACK_IMPORTED_MODULE_7__.X1,_angular_forms__WEBPACK_IMPORTED_MODULE_7__.l_,_shared_loading_themed_loading_component__WEBPACK_IMPORTED_MODULE_3__.v,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_11__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_11__.D9],styles:[".scrollable-menu[_ngcontent-%COMP%]{height:auto;max-height:var(--ds-dso-selector-list-max-height);overflow:scroll}"]})}}return MetadataFieldSelectorComponent2})()},7012:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>ThemedDsoEditMetadataComponent}),__webpack_require__(27434);var _shared_theme_support_themed_component__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(79241),_angular_core__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(42395),__webpack_require__(25376));const _c0=["*"];function ThemedDsoEditMetadataComponent_ng_template_0_Template(rf,ctx){}let ThemedDsoEditMetadataComponent=(()=>{class ThemedDsoEditMetadataComponent2 extends _shared_theme_support_themed_component__WEBPACK_IMPORTED_MODULE_1__.J{constructor(){super(...arguments),this.inAndOutputNames=["dso","updateDataService"]}getComponentName(){return"DsoEditMetadataComponent"}importThemedComponent(themeName){return __webpack_require__(30207)(`./${themeName}/app/dso-shared/dso-edit-metadata/dso-edit-metadata.component`)}importUnthemedComponent(){return Promise.resolve().then(__webpack_require__.bind(__webpack_require__,42395))}static{this.\u0275fac=(()=>{let \u0275ThemedDsoEditMetadataComponent_BaseFactory;return function(__ngFactoryType__){return(\u0275ThemedDsoEditMetadataComponent_BaseFactory||(\u0275ThemedDsoEditMetadataComponent_BaseFactory=_angular_core__WEBPACK_IMPORTED_MODULE_3__.xGo(ThemedDsoEditMetadataComponent2)))(__ngFactoryType__||ThemedDsoEditMetadataComponent2)}})()}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_3__.VBU({type:ThemedDsoEditMetadataComponent2,selectors:[["ds-dso-edit-metadata"]],inputs:{dso:"dso",updateDataService:"updateDataService"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_3__.Vt3,_angular_core__WEBPACK_IMPORTED_MODULE_3__.aNF],ngContentSelectors:_c0,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_3__.NAR(),_angular_core__WEBPACK_IMPORTED_MODULE_3__.DNE(0,ThemedDsoEditMetadataComponent_ng_template_0_Template,0,0,"ng-template",null,0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.C5r),_angular_core__WEBPACK_IMPORTED_MODULE_3__.j41(2,"div",null,1),_angular_core__WEBPACK_IMPORTED_MODULE_3__.SdG(4),_angular_core__WEBPACK_IMPORTED_MODULE_3__.k0s())},encapsulation:2})}}return ThemedDsoEditMetadataComponent2})()},44592:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ROUTES:()=>ROUTES});var i18n_breadcrumb_resolver=__webpack_require__(12213),themed_dso_edit_metadata_component=__webpack_require__(7012),resource_policy_create_component=__webpack_require__(67149),resource_policy_edit_component=__webpack_require__(79537),resource_policy_resolver=__webpack_require__(59278),resource_policy_target_resolver=__webpack_require__(23250),common=__webpack_require__(87514),core=__webpack_require__(25376),router=__webpack_require__(18134),ng_bootstrap=__webpack_require__(87969),ngx_translate_core=__webpack_require__(2385),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),fade=__webpack_require__(67441),empty_util=__webpack_require__(2794),item_page_routing_paths=__webpack_require__(88292);const _c0=a0=>({active:a0}),_c1=a0=>[a0];function EditItemPageComponent_Conditional_7_For_2_Conditional_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"a",13),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const page_r1=core.XpG().$implicit,ctx_r1=core.XpG(2);core.Y8G("ngClass",core.eq3(7,_c0,page_r1.page===ctx_r1.currentPage))("routerLink",core.eq3(9,_c1,"./"+page_r1.page)),core.BMQ("aria-selected",page_r1.page===ctx_r1.currentPage)("data-test",page_r1.page),core.R7$(),core.SpI(" ",core.bMT(2,5,"item.edit.tabs."+page_r1.page+".head")," ")}}function EditItemPageComponent_Conditional_7_For_2_Conditional_5_Template(rf,ctx){if(1&rf&&(core.j41(0,"button",15),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const page_r1=core.XpG().$implicit;core.R7$(),core.SpI(" ",core.bMT(2,1,"item.edit.tabs."+page_r1.page+".head")," ")}}function EditItemPageComponent_Conditional_7_For_2_Template(rf,ctx){if(1&rf&&(core.j41(0,"li",12),core.DNE(1,EditItemPageComponent_Conditional_7_For_2_Conditional_1_Template,3,11,"a",13),core.nI1(2,"async"),core.j41(3,"span",14),core.nI1(4,"translate"),core.DNE(5,EditItemPageComponent_Conditional_7_For_2_Conditional_5_Template,3,3,"button",15),core.nI1(6,"async"),core.k0s()()),2&rf){const page_r1=ctx.$implicit;core.R7$(),core.vxM(core.bMT(2,3,page_r1.enabled)?1:-1),core.R7$(2),core.Y8G("ngbTooltip",core.bMT(4,5,"item.edit.tabs.disabled.tooltip")),core.R7$(2),core.vxM(!0!==core.bMT(6,7,page_r1.enabled)?5:-1)}}function EditItemPageComponent_Conditional_7_Template(rf,ctx){if(1&rf&&(core.j41(0,"ul",5),core.Z7z(1,EditItemPageComponent_Conditional_7_For_2_Template,7,9,"li",12,core.fX1),core.k0s()),2&rf){const ctx_r1=core.XpG();core.R7$(),core.Dyx(ctx_r1.pages)}}let EditItemPageComponent=(()=>{class EditItemPageComponent2{constructor(route,router2,injector){this.route=route,this.router=router2,this.injector=injector,this.router.events.subscribe(()=>this.initPageParamsByRoute())}ngOnInit(){this.initPageParamsByRoute(),this.pages=this.route.routeConfig.children.filter(child=>(0,empty_util.hj)(child.path)).map(child=>{let enabled=(0,cjs.of)(!0);return(0,empty_util.hj)(child.canActivate)&&(enabled=(0,cjs.combineLatest)(child.canActivate.map(guardFn=>(0,core.N4e)(this.injector,()=>guardFn(this.route.snapshot,this.router.routerState.snapshot)))).pipe((0,operators.Tj)(canActivateOutcomes=>canActivateOutcomes.every(e=>!0===e)))),{page:child.path,enabled}}),this.itemRD$=this.route.data.pipe((0,operators.Tj)(data=>data.dso))}getItemPage(item){return(0,item_page_routing_paths._o)(item)}initPageParamsByRoute(){this.currentPage=this.route.snapshot.firstChild.routeConfig.path}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EditItemPageComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(core.zZn))}}static{this.\u0275cmp=core.VBU({type:EditItemPageComponent2,selectors:[["ds-edit-item-page"]],standalone:!0,features:[core.aNF],decls:18,vars:10,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"border-bottom"],[1,"pt-2"],["role","tablist",1,"nav","nav-tabs","justify-content-start"],[1,"tab-pane","active"],[1,"mb-4"],[1,"button-row","bottom"],[1,"text-end"],["role","button",1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left"],["role","presentation",1,"nav-item"],["role","tab",1,"nav-link",3,"ngClass","routerLink"],[3,"ngbTooltip"],[1,"nav-link","disabled"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"div",4),core.DNE(7,EditItemPageComponent_Conditional_7_Template,3,0,"ul",5),core.j41(8,"div",6)(9,"div",7),core.nrm(10,"router-outlet"),core.k0s(),core.j41(11,"div",8)(12,"div",9)(13,"a",10),core.nI1(14,"async"),core.nrm(15,"i",11),core.EFF(16),core.nI1(17,"translate"),core.k0s()()()()()()()()),2&rf){let tmp_2_0;core.R7$(4),core.JRh(core.bMT(5,4,"item.edit.head")),core.R7$(3),core.vxM(ctx.pages.length>0?7:-1),core.R7$(6),core.Y8G("routerLink",ctx.getItemPage(null==(tmp_2_0=core.bMT(14,6,ctx.itemRD$))?null:tmp_2_0.payload)),core.R7$(3),core.SpI(" ",core.bMT(17,8,"item.edit.return"),"")}},dependencies:[common.Jj,ng_bootstrap.n8,ng_bootstrap.md,common.YU,router.Wk,router.n3,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2,data:{animation:[fade.qG,fade.Ws]},changeDetection:0})}}return EditItemPageComponent2})();var edit_item_page_routing_paths=__webpack_require__(55567),shared_operators=__webpack_require__(39022),access_control_form_container_component=__webpack_require__(58840);function ItemAccessControlComponent_Conditional_0_Template(rf,ctx){1&rf&&core.nrm(0,"ds-access-control-form-container",0),2&rf&&core.Y8G("itemRD",ctx)("showLimitToSpecificBitstreams",!0)}let ItemAccessControlComponent=(()=>{class ItemAccessControlComponent2{constructor(route){this.route=route}ngOnInit(){this.itemRD$=this.route.parent.parent.data.pipe((0,operators.Tj)(data=>data.dso)).pipe((0,shared_operators.yd)())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemAccessControlComponent2)(core.rXU(router.nX))}}static{this.\u0275cmp=core.VBU({type:ItemAccessControlComponent2,selectors:[["ds-item-access-control"]],standalone:!0,features:[core.aNF],decls:2,vars:3,consts:[["titleMessage","item-access-control-title",3,"itemRD","showLimitToSpecificBitstreams"]],template:function(rf,ctx){if(1&rf&&(core.DNE(0,ItemAccessControlComponent_Conditional_0_Template,1,2,"ds-access-control-form-container",0),core.nI1(1,"async")),2&rf){let tmp_0_0;core.vxM((tmp_0_0=core.bMT(1,1,ctx.itemRD$))?0:-1,tmp_0_0)}},dependencies:[access_control_form_container_component.o,common.Jj]})}}return ItemAccessControlComponent2})();var isEqual=__webpack_require__(90326),isEqual_default=__webpack_require__.n(isEqual),dso_name_service=__webpack_require__(11481),link_service=__webpack_require__(14160),paginated_list_model=__webpack_require__(29481),alert_component=__webpack_require__(6213),alert_type=__webpack_require__(83113),resource_policies_component=__webpack_require__(61249),follow_link_config_model=__webpack_require__(76715);function ItemAuthorizationsComponent_For_6_Conditional_1_For_7_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-resource-policies",4),2&rf){const bitstream_r4=ctx.$implicit;core.Y8G("resourceType","bitstream")("resourceUUID",bitstream_r4.id)("resourceName",bitstream_r4.name)}}function ItemAuthorizationsComponent_For_6_Conditional_1_Conditional_9_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",3)(1,"button",9),core.bIt("click",function(){core.eBV(_r5);const bundle_r2=core.XpG(2).$implicit,ctx_r2=core.XpG();return core.Njj(ctx_r2.onBitstreamsLoad(bundle_r2))}),core.EFF(2),core.nI1(3,"translate"),core.k0s()()}2&rf&&(core.R7$(2),core.JRh(core.bMT(3,1,"collection.edit.item.authorizations.load-more-button")))}function ItemAuthorizationsComponent_For_6_Conditional_1_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",5)(1,"div",6)(2,"button",7),core.bIt("click",function(){core.eBV(_r1);const bundle_r2=core.XpG().$implicit,ctx_r2=core.XpG();return core.Njj(ctx_r2.collapseArea(bundle_r2.id))}),core.EFF(3),core.nI1(4,"translate"),core.k0s()(),core.j41(5,"div",8),core.Z7z(6,ItemAuthorizationsComponent_For_6_Conditional_1_For_7_Template,1,3,"ds-resource-policies",4,core.fX1),core.nI1(8,"async"),core.DNE(9,ItemAuthorizationsComponent_For_6_Conditional_1_Conditional_9_Template,4,3,"div",3),core.k0s()()}if(2&rf){const bundle_r2=core.XpG().$implicit,ctx_r2=core.XpG();core.R7$(2),core.BMQ("aria-expanded",!1)("aria-controls",bundle_r2.id),core.R7$(),core.Lme(" ",core.bMT(4,7,"collection.edit.item.authorizations.show-bitstreams-button")," ",ctx_r2.nameService.getName(bundle_r2)," "),core.R7$(2),core.Y8G("id",bundle_r2.id)("ngbCollapse",ctx_r2.bundleBitstreamsMap.get(bundle_r2.id).isCollapsed),core.R7$(),core.Dyx(core.bMT(8,9,ctx_r2.bundleBitstreamsMap.get(bundle_r2.id).bitstreams)),core.R7$(3),core.vxM(ctx_r2.bundleBitstreamsMap.get(bundle_r2.id).allBitstreamsLoaded?-1:9)}}function ItemAuthorizationsComponent_For_6_Template(rf,ctx){if(1&rf&&(core.nrm(0,"ds-resource-policies",4),core.DNE(1,ItemAuthorizationsComponent_For_6_Conditional_1_Template,10,11,"div",5),core.nI1(2,"async")),2&rf){let tmp_13_0;const bundle_r2=ctx.$implicit,ctx_r2=core.XpG();core.Y8G("resourceType","bundle")("resourceUUID",bundle_r2.id)("resourceName",bundle_r2.name),core.R7$(),core.vxM((null==(tmp_13_0=core.bMT(2,4,null==(tmp_13_0=ctx_r2.bundleBitstreamsMap.get(bundle_r2.id))?null:tmp_13_0.bitstreams))?null:tmp_13_0.length)>0?1:-1)}}function ItemAuthorizationsComponent_Conditional_8_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",3)(1,"button",9),core.bIt("click",function(){core.eBV(_r6);const ctx_r2=core.XpG();return core.Njj(ctx_r2.onBundleLoad())}),core.EFF(2),core.nI1(3,"translate"),core.k0s()()}2&rf&&(core.R7$(2),core.JRh(core.bMT(3,1,"collection.edit.item.authorizations.load-bundle-button")))}let ItemAuthorizationsComponent=(()=>{class ItemAuthorizationsComponent2{constructor(linkService,route,nameService){this.linkService=linkService,this.route=route,this.nameService=nameService,this.bundleBitstreamsMap=new Map,this.bundles$=new cjs.BehaviorSubject([]),this.subs=[],this.bundlesPerPage=6,this.bundlesPageSize=1,this.allBundlesLoaded=!1,this.bitstreamSize=4,this.bitstreamPageSize=4,this.AlertType=alert_type.v}ngOnInit(){this.getBundlesPerItem(),this.itemName$=this.getItemName()}getItemName(){return this.item$.pipe((0,operators.Tj)(item=>this.nameService.getName(item)))}getBundlesPerItem(page=1){this.item$=this.route.data.pipe((0,operators.Tj)(data=>data.dso),(0,shared_operators.QQ)(),(0,operators.Tj)(item=>this.linkService.resolveLink(item,(0,follow_link_config_model.s)("bundles",{findListOptions:{currentPage:page,elementsPerPage:this.bundlesPerPage}},(0,follow_link_config_model.s)("bitstreams")))));const bundles$=this.item$.pipe((0,operators.pb)(item=>(0,empty_util.hj)(item.bundles)),(0,operators.ZZ)(item=>item.bundles),(0,shared_operators.QQ)(),(0,operators.WL)(error=>(console.error(error),(0,cjs.of)((0,paginated_list_model.g)(null,[])))));this.subs.push(bundles$.pipe((0,operators.s)(1),(0,operators.Tj)(list=>list.page)).subscribe(bundles=>{(isEqual_default()(bundles.length,0)||bundles.length<this.bundlesPerPage)&&(this.allBundlesLoaded=!0),isEqual_default()(page,1)?this.bundles$.next(bundles):this.bundles$.next(this.bundles$.getValue().concat(bundles))}),bundles$.pipe((0,operators.s)(1),(0,operators.ZZ)(list=>list.page),(0,operators.Tj)(bundle=>({id:bundle.id,bitstreams:this.getBundleBitstreams(bundle)}))).subscribe(entry=>{const bitstreamMapValues={isCollapsed:!0,allBitstreamsLoaded:!1,bitstreams:null};bitstreamMapValues.bitstreams=entry.bitstreams.pipe((0,operators.Tj)(b=>(bitstreamMapValues.allBitstreamsLoaded=b?.page.length<this.bitstreamSize,[...b.page.slice(0,this.bitstreamSize)]))),this.bundleBitstreamsMap.set(entry.id,bitstreamMapValues)}))}getBundleBitstreams(bundle){return bundle.bitstreams.pipe((0,shared_operators.ak)(),(0,operators.WL)(error=>(console.error(error),(0,cjs.of)((0,paginated_list_model.g)(null,[])))))}collapseArea(bundleId){this.bundleBitstreamsMap.get(bundleId).isCollapsed=!this.bundleBitstreamsMap.get(bundleId).isCollapsed}onBundleLoad(){this.bundlesPageSize++,this.getBundlesPerItem(this.bundlesPageSize)}onBitstreamsLoad(bundle){return this.getBundleBitstreams(bundle).subscribe(res=>{const nextBitstreams=res?.page.slice(this.bitstreamPageSize,this.bitstreamPageSize+this.bitstreamSize),bitstreamsToShow=this.bundleBitstreamsMap.get(bundle.id).bitstreams.pipe((0,operators.Tj)(existingBits=>[...existingBits,...nextBitstreams]));this.bitstreamPageSize=this.bitstreamPageSize+this.bitstreamSize;const bitstreamMapValues={bitstreams:bitstreamsToShow,isCollapsed:this.bundleBitstreamsMap.get(bundle.id).isCollapsed,allBitstreamsLoaded:res?.page.length<=this.bitstreamPageSize};this.bundleBitstreamsMap.set(bundle.id,bitstreamMapValues)})}ngOnDestroy(){this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemAuthorizationsComponent2)(core.rXU(link_service._),core.rXU(router.nX),core.rXU(dso_name_service.f))}}static{this.\u0275cmp=core.VBU({type:ItemAuthorizationsComponent2,selectors:[["ds-item-authorizations"]],standalone:!0,features:[core.aNF],decls:9,vars:12,consts:[[1,"container"],[3,"type","content"],[3,"resourceType","resourceName","resourceUUID"],[1,"row","justify-content-center"],[3,"resourceType","resourceUUID","resourceName"],[1,"card","auth-bitstream-container"],[1,"card-header"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"card-body",3,"id","ngbCollapse"],["type","button",1,"btn","btn-link",3,"click"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",0),core.nrm(1,"ds-alert",1)(2,"ds-resource-policies",2),core.nI1(3,"async"),core.nI1(4,"async"),core.Z7z(5,ItemAuthorizationsComponent_For_6_Template,3,6,null,null,core.fX1),core.nI1(7,"async"),core.DNE(8,ItemAuthorizationsComponent_Conditional_8_Template,4,3,"div",3),core.k0s()),2&rf){let tmp_4_0;core.R7$(),core.Y8G("type",ctx.AlertType.Info)("content","item.edit.authorizations.heading"),core.R7$(),core.Y8G("resourceType","item")("resourceName",core.bMT(3,6,ctx.itemName$))("resourceUUID",null==(tmp_4_0=core.bMT(4,8,ctx.item$))?null:tmp_4_0.id),core.R7$(3),core.Dyx(core.bMT(7,10,ctx.bundles$)),core.R7$(3),core.vxM(ctx.allBundlesLoaded?-1:8)}},dependencies:[alert_component.C,common.Jj,ng_bootstrap.HC,ng_bootstrap.$G,resource_policies_component.e,ngx_translate_core.h,ngx_translate_core.D9],styles:[".auth-bitstream-container[_ngcontent-%COMP%]{margin-top:-1em;margin-bottom:1.5em}"]})}}return ItemAuthorizationsComponent2})();var object_cache_service=__webpack_require__(63311),bitstream_data_service=__webpack_require__(94999),bundle_data_service=__webpack_require__(51024),item_data_service=__webpack_require__(94149),object_updates_service=__webpack_require__(55434),request_service=__webpack_require__(64806),btn_disabled_directive=__webpack_require__(69919),themed_loading_component=__webpack_require__(18869),notifications_service=__webpack_require__(76623),pagination_component_options_model=__webpack_require__(54396),paginated_search_options_model=__webpack_require__(86577);let ObjectValuesPipe=(()=>{class ObjectValuesPipe2{transform(value){const values=[];return(0,empty_util.hj)(value)&&Object.values(value).forEach(v=>values.push(v)),values}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ObjectValuesPipe2)}}static{this.\u0275pipe=core.EJ8({name:"dsObjectValues",type:ObjectValuesPipe2,pure:!0,standalone:!0})}}return ObjectValuesPipe2})();var var_directive=__webpack_require__(17543),environment=__webpack_require__(64369),abstract_trackable_component=(__webpack_require__(43575),__webpack_require__(77998)),item_resolver=__webpack_require__(53046);let AbstractItemUpdateComponent=(()=>{class AbstractItemUpdateComponent2 extends abstract_trackable_component.F{constructor(itemService,objectUpdatesService,router2,notificationsService,translateService,route){super(objectUpdatesService,notificationsService,translateService,router2),this.itemService=itemService,this.objectUpdatesService=objectUpdatesService,this.router=router2,this.notificationsService=notificationsService,this.translateService=translateService,this.route=route}ngOnInit(){(0,empty_util.a4)(this.item)?this.setItem(this.item):this.itemUpdateSubscription=(0,cjs.combineLatest)([this.route.data,this.route.parent.data]).pipe((0,operators.Tj)(([data,parentData])=>Object.assign({},data,parentData)),(0,operators.Tj)(data=>data.dso),(0,operators.Mi)(rd=>{this.item=rd.payload}),(0,operators.nx)(rd=>this.itemService.findByHref(rd.payload._links.self.href,!0,!0,...(0,item_resolver.U)())),(0,shared_operators.v7)()).subscribe(rd=>{this.setItem(rd.payload)}),super.ngOnInit(),this.discardTimeOut=environment.c.item.edit.undoTimeout,this.hasChanges().pipe((0,operators.s)(1)).subscribe(hasChanges=>{hasChanges?this.checkLastModified():this.initializeOriginalFields()}),this.initializeNotificationsPrefix(),this.initializeUpdates()}setItem(item){this.item=item,this.itemPageRoute=(0,item_page_routing_paths._o)(this.item),this.postItemInit(),this.initializeUpdates()}ngOnDestroy(){(0,empty_util.a4)(this.itemUpdateSubscription)&&this.itemUpdateSubscription.unsubscribe()}postItemInit(){}initializeUpdates(){}initializeNotificationsPrefix(){}initializeOriginalFields(){}submit(){}trackUpdate(index,update){return update&&update.field?update.field.uuid:void 0}isValid(){return this.objectUpdatesService.isValidPage(this.url)}checkLastModified(){const currentVersion=this.item.lastModified;this.objectUpdatesService.getLastModified(this.url).pipe((0,operators.s)(1)).subscribe(updateVersion=>{updateVersion.getDate()!==currentVersion.getDate()&&(this.notificationsService.warning(this.getNotificationTitle("outdated"),this.getNotificationContent("outdated")),this.initializeOriginalFields())})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||AbstractItemUpdateComponent2)(core.rXU(item_data_service.ItemDataService),core.rXU(object_updates_service.F),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(router.nX))}}static{this.\u0275cmp=core.VBU({type:AbstractItemUpdateComponent2,selectors:[["ds-abstract-item-update"]],inputs:{item:"item"},standalone:!0,features:[core.Vt3,core.aNF],decls:0,vars:0,template:function(rf,ctx){},encapsulation:2})}}return AbstractItemUpdateComponent2})();var app_routing_paths=__webpack_require__(31788),field_change_type_model=__webpack_require__(83070),live_region_service=__webpack_require__(89717);class ResponsiveColumnSizes{constructor(xs,sm,md,lg,xl){this.xs=xs,this.sm=sm,this.md=md,this.lg=lg,this.xl=xl}buildClasses(){return`col-${this.xs} col-sm-${this.sm} col-md-${this.md} col-lg-${this.lg} col-xl-${this.xl}`}}class ResponsiveTableSizes{constructor(columns){this.columns=columns}combineColumns(start,end){if(start<end&&(0,empty_util.a4)(this.columns[start])&&(0,empty_util.a4)(this.columns[end])){let xs=this.columns[start].xs,sm=this.columns[start].sm,md=this.columns[start].md,lg=this.columns[start].lg,xl=this.columns[start].xl;for(let i=start+1;i<end+1;i++)xs+=this.columns[i].xs,sm+=this.columns[i].sm,md+=this.columns[i].md,lg+=this.columns[i].lg,xl+=this.columns[i].xl;return new ResponsiveColumnSizes(xs,sm,md,lg,xl)}}}const MOVE_KEY="item.edit.bitstreams.notifications.move";let ItemBitstreamsService=(()=>{class ItemBitstreamsService2{constructor(notificationsService,translateService,objectUpdatesService,bitstreamService,bundleService,dsoNameService,requestService,liveRegionService){this.notificationsService=notificationsService,this.translateService=translateService,this.objectUpdatesService=objectUpdatesService,this.bitstreamService=bitstreamService,this.bundleService=bundleService,this.dsoNameService=dsoNameService,this.requestService=requestService,this.liveRegionService=liveRegionService,this.selectionAction$=new cjs.BehaviorSubject(null),this.isPerformingMoveRequest=new cjs.BehaviorSubject(!1)}getSelectionAction$(){return this.selectionAction$}getSelectionAction(){const action=this.selectionAction$.value;return(0,empty_util.Tn)(action)?null:Object.assign({},action)}hasSelectedBitstream(){const selectionAction=this.getSelectionAction();if((0,empty_util.Tn)(selectionAction))return!1;const action=selectionAction.action;return"Selected"===action||"Moved"===action}getSelectedBitstream(){if(!this.hasSelectedBitstream())return null;const selectionAction=this.getSelectionAction();return Object.assign({},selectionAction.selectedEntry)}selectBitstreamEntry(entry){(0,empty_util.a4)(entry)&&entry.bitstream!==this.getSelectedBitstream()?.bitstream&&(this.announceSelect(entry.bitstream.name),this.updateSelectionAction({action:"Selected",selectedEntry:entry}))}updateSelectionAction(action){this.selectionAction$.next(action)}clearSelection(){const selected=this.getSelectedBitstream();(0,empty_util.a4)(selected)&&(this.updateSelectionAction({action:"Cleared",selectedEntry:selected}),this.announceClear(selected.bitstream.name),selected.currentPosition!==selected.originalPosition&&this.displaySuccessNotification(MOVE_KEY))}cancelSelection(){const selected=this.getSelectedBitstream();if((0,empty_util.Tn)(selected)||this.getPerformingMoveRequest())return;const originalPosition=selected.originalPosition,currentPosition=selected.currentPosition;currentPosition===originalPosition?(this.announceClear(selected.bitstream.name),this.updateSelectionAction({action:"Cleared",selectedEntry:selected})):(this.announceCancel(selected.bitstream.name,originalPosition),this.performBitstreamMoveRequest(selected.bundle,currentPosition,originalPosition),this.updateSelectionAction({action:"Cancelled",selectedEntry:selected}))}moveSelectedBitstreamUp(){const selected=this.getSelectedBitstream();if((0,empty_util.Tn)(selected)||this.getPerformingMoveRequest())return;const originalPosition=selected.currentPosition;if(originalPosition>0){const newPosition=originalPosition-1;selected.currentPosition=newPosition,this.performBitstreamMoveRequest(selected.bundle,originalPosition,newPosition,()=>{this.announceMove(selected.bitstream.name,newPosition)}),this.updateSelectionAction({action:"Moved",selectedEntry:selected})}}moveSelectedBitstreamDown(){const selected=this.getSelectedBitstream();if((0,empty_util.Tn)(selected)||this.getPerformingMoveRequest())return;const originalPosition=selected.currentPosition;if(originalPosition<selected.bundleSize-1){const newPosition=originalPosition+1;selected.currentPosition=newPosition,this.performBitstreamMoveRequest(selected.bundle,originalPosition,newPosition,()=>{this.announceMove(selected.bitstream.name,newPosition)}),this.updateSelectionAction({action:"Moved",selectedEntry:selected})}}performBitstreamMoveRequest(bundle,fromIndex,toIndex,finish){if(this.getPerformingMoveRequest())return void console.warn("Attempted to perform move request while previous request has not completed yet");const moveOperation={op:"move",from:`/_links/bitstreams/${fromIndex}/href`,path:`/_links/bitstreams/${toIndex}/href`};this.announceLoading(),this.isPerformingMoveRequest.next(!0),this.bundleService.patch(bundle,[moveOperation]).pipe((0,shared_operators.qD)(),(0,operators.Mi)(response=>this.displayFailedResponseNotifications(MOVE_KEY,[response])),(0,operators.nx)(()=>this.requestService.setStaleByHrefSubstring(bundle.self)),(0,operators.s)(1)).subscribe(()=>{this.isPerformingMoveRequest.next(!1),finish?.()})}getPerformingMoveRequest(){return this.isPerformingMoveRequest.value}getPerformingMoveRequest$(){return this.isPerformingMoveRequest}getInitialBundlesPaginationOptions(){return Object.assign(new pagination_component_options_model.W,{id:"bundles-pagination-options",currentPage:1,pageSize:9999})}getInitialBitstreamsPaginationOptions(bundleName){return Object.assign(new pagination_component_options_model.W,{id:bundleName,currentPage:1,pageSize:10})}getColumnSizes(){return new ResponsiveTableSizes([new ResponsiveColumnSizes(2,2,3,4,4),new ResponsiveColumnSizes(2,3,3,3,3),new ResponsiveColumnSizes(2,2,2,2,2),new ResponsiveColumnSizes(6,5,4,3,3)])}displayNotifications(key,responses){this.displayFailedResponseNotifications(key,responses),this.displaySuccessFulResponseNotifications(key,responses)}displayFailedResponseNotifications(key,responses){responses.filter(response=>(0,empty_util.a4)(response)&&response.hasFailed).forEach(response=>{this.displayErrorNotification(key,response.errorMessage)})}displayErrorNotification(key,errorMessage){this.notificationsService.error(this.translateService.instant(`${key}.failed.title`),errorMessage)}displaySuccessFulResponseNotifications(key,responses){responses.filter(response=>(0,empty_util.a4)(response)&&response.hasSucceeded).length>0&&this.displaySuccessNotification(key)}displaySuccessNotification(key){this.notificationsService.success(this.translateService.instant(`${key}.saved.title`),this.translateService.instant(`${key}.saved.content`))}removeMarkedBitstreams(bundles$){return bundles$.pipe((0,operators.s)(1)).pipe((0,operators.nx)(bundles=>(0,cjs.zip)(...bundles.map(bundle=>this.objectUpdatesService.getFieldUpdates(bundle.self,[],!0)))),(0,operators.Tj)(fieldUpdates=>[].concat(...fieldUpdates.map(updates=>Object.values(updates).filter(fieldUpdate=>fieldUpdate.changeType===field_change_type_model.B.REMOVE)))),(0,operators.Tj)(fieldUpdates=>fieldUpdates.map(fieldUpdate=>fieldUpdate.field))).pipe((0,operators.s)(1),(0,operators.nx)(removedBitstreams=>this.bitstreamService.removeMultiple(removedBitstreams)))}mapBitstreamsToTableEntries(bitstreams){return bitstreams.map(bitstream=>{const name=this.dsoNameService.getName(bitstream);return{bitstream,id:bitstream.uuid,name,nameStripped:this.nameToHeader(name),description:bitstream.firstMetadataValue("dc.description"),format:bitstream.format.pipe((0,shared_operators.ak)()),downloadUrl:(0,app_routing_paths.hV)(bitstream)}})}nameToHeader(name){return this.stripWhiteSpace(name)}stripWhiteSpace(str){return str.replace(/\s+/g,"")}announceSelect(bitstreamName){const message=this.translateService.instant("item.edit.bitstreams.edit.live.select",{bitstream:bitstreamName});this.liveRegionService.addMessage(message)}announceMove(bitstreamName,toPosition){const message=this.translateService.instant("item.edit.bitstreams.edit.live.move",{bitstream:bitstreamName,toIndex:toPosition+1});this.liveRegionService.addMessage(message)}announceCancel(bitstreamName,toPosition){const message=this.translateService.instant("item.edit.bitstreams.edit.live.cancel",{bitstream:bitstreamName,toIndex:toPosition+1});this.liveRegionService.addMessage(message)}announceClear(bitstreamName){const message=this.translateService.instant("item.edit.bitstreams.edit.live.clear",{bitstream:bitstreamName});this.liveRegionService.addMessage(message)}announceLoading(){const message=this.translateService.instant("item.edit.bitstreams.edit.live.loading");this.liveRegionService.addMessage(message)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemBitstreamsService2)(core.KVO(notifications_service.I),core.KVO(ngx_translate_core.c$),core.KVO(object_updates_service.F),core.KVO(bitstream_data_service.BitstreamDataService),core.KVO(bundle_data_service.BundleDataService),core.KVO(dso_name_service.f),core.KVO(request_service.B),core.KVO(live_region_service.A))}}static{this.\u0275prov=core.jDH({token:ItemBitstreamsService2,factory:ItemBitstreamsService2.\u0275fac,providedIn:"root"})}}return ItemBitstreamsService2})();var drag_drop=__webpack_require__(53647),pagination_service=__webpack_require__(31903),pagination_component=(__webpack_require__(89172),__webpack_require__(42191)),browser_only_pipe=__webpack_require__(96340);const item_edit_bitstream_bundle_component_c0=["bundleView"],item_edit_bitstream_bundle_component_c1=["dragTooltip"],_c2=a0=>({bundle:a0}),_c3=a0=>({name:a0}),_c4=a0=>[a0,"bitstreams","new"],_c5=a0=>({invisible:a0}),_c6=a0=>["/bitstreams/",a0,"edit"];function ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Conditional_3_For_40_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"li",25),core.nI1(1,"async"),core.j41(2,"button",26),core.bIt("click",function(){const size_r4=core.eBV(_r3).$implicit,ctx_r1=core.XpG(4);return core.Njj(ctx_r1.doPageSizeChange(size_r4))}),core.nrm(3,"i",27),core.nI1(4,"async"),core.EFF(5),core.k0s()()}if(2&rf){const size_r4=ctx.$implicit,ctx_r1=core.XpG(4);core.BMQ("aria-selected",size_r4===core.bMT(1,3,ctx_r1.pageSize$)),core.R7$(3),core.Y8G("ngClass",core.eq3(7,_c5,size_r4!==core.bMT(4,5,ctx_r1.pageSize$))),core.R7$(2),core.SpI(" ",size_r4," ")}}function ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Conditional_3_For_42_Conditional_0_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"tr",29),core.bIt("cdkDragStarted",function(){core.eBV(_r5);const ctx_r1=core.XpG(5);return core.Njj(ctx_r1.dragStart())})("cdkDragEnded",function(){core.eBV(_r5);const ctx_r1=core.XpG(5);return core.Njj(ctx_r1.dragEnd())}),core.j41(1,"th",30)(2,"div",31),core.bIt("keydown.enter",function($event){core.eBV(_r5);const entry_r6=core.XpG().$implicit,ctx_r1=core.XpG(4);return core.Njj(ctx_r1.select($event,entry_r6))})("keydown.space",function($event){core.eBV(_r5);const entry_r6=core.XpG().$implicit,ctx_r1=core.XpG(4);return core.Njj(ctx_r1.select($event,entry_r6))})("click",function($event){core.eBV(_r5);const entry_r6=core.XpG().$implicit,ctx_r1=core.XpG(4);return core.Njj(ctx_r1.select($event,entry_r6))}),core.nrm(3,"i",32),core.nI1(4,"translate"),core.k0s(),core.j41(5,"span",33),core.EFF(6),core.k0s()(),core.j41(7,"td",34),core.EFF(8),core.k0s(),core.j41(9,"td",34),core.EFF(10),core.nI1(11,"async"),core.k0s(),core.j41(12,"td",34)(13,"div",35)(14,"div",36)(15,"a",37),core.nI1(16,"translate"),core.nI1(17,"translate"),core.nI1(18,"dsBrowserOnly"),core.nrm(19,"i",38),core.k0s(),core.j41(20,"button",39),core.nI1(21,"translate"),core.nI1(22,"translate"),core.nrm(23,"i",40),core.k0s(),core.j41(24,"button",41),core.nI1(25,"translate"),core.nI1(26,"translate"),core.bIt("click",function(){core.eBV(_r5);const entry_r6=core.XpG().$implicit,ctx_r1=core.XpG(4);return core.Njj(ctx_r1.remove(entry_r6.bitstream))}),core.nrm(27,"i",42),core.k0s(),core.j41(28,"button",43),core.nI1(29,"translate"),core.nI1(30,"translate"),core.bIt("click",function(){core.eBV(_r5);const entry_r6=core.XpG().$implicit,ctx_r1=core.XpG(4);return core.Njj(ctx_r1.undo(entry_r6.bitstream))}),core.nrm(31,"i",44),core.k0s()()()()()}if(2&rf){let tmp_31_0;const update_r7=ctx,entry_r6=core.XpG().$implicit,ctx_r1=core.XpG(4);core.Y8G("ngClass",ctx_r1.getRowClass(update_r7,entry_r6)),core.R7$(),core.ZvI("bitstream-name row-element ",ctx_r1.columnSizes.columns[0].buildClasses(),""),core.FS9("id",entry_r6.nameStripped),core.Mz_("headers","",ctx_r1.bundleName," name"),core.R7$(2),core.Y8G("title",core.bMT(4,42,"item.edit.bitstreams.edit.buttons.drag")),core.R7$(3),core.JRh(entry_r6.name),core.R7$(),core.ZvI("row-element ",ctx_r1.columnSizes.columns[1].buildClasses(),""),core.FCK("headers","",entry_r6.nameStripped," ",ctx_r1.bundleName," description"),core.R7$(),core.SpI(" ",entry_r6.description," "),core.R7$(),core.ZvI("row-element ",ctx_r1.columnSizes.columns[2].buildClasses(),""),core.FCK("headers","",entry_r6.nameStripped," ",ctx_r1.bundleName," format"),core.R7$(),core.SpI(" ",null==(tmp_31_0=core.bMT(11,44,entry_r6.format))?null:tmp_31_0.shortDescription," "),core.R7$(2),core.ZvI("row-element ",ctx_r1.columnSizes.columns[3].buildClasses(),""),core.FCK("headers","",entry_r6.nameStripped," ",ctx_r1.bundleName," actions"),core.R7$(3),core.FS9("title",core.bMT(16,46,"item.edit.bitstreams.edit.buttons.download")),core.Y8G("href",entry_r6.downloadUrl,core.B4B),core.BMQ("aria-label",core.bMT(17,48,"item.edit.bitstreams.edit.buttons.download"))("data-test",core.bMT(18,50,"download-button")),core.R7$(5),core.FS9("title",core.bMT(21,52,"item.edit.bitstreams.edit.buttons.edit")),core.Y8G("routerLink",core.eq3(64,_c6,entry_r6.id)),core.BMQ("aria-label",core.bMT(22,54,"item.edit.bitstreams.edit.buttons.edit")),core.R7$(4),core.FS9("title",core.bMT(25,56,"item.edit.bitstreams.edit.buttons.remove")),core.Y8G("dsBtnDisabled",!ctx_r1.canRemove(update_r7)),core.BMQ("aria-label",core.bMT(26,58,"item. edit bitstreams.edit.buttons.remove")),core.R7$(4),core.FS9("title",core.bMT(29,60,"item.edit.bitstreams.edit.buttons.undo")),core.Y8G("dsBtnDisabled",!ctx_r1.canUndo(update_r7)),core.BMQ("aria-label",core.bMT(30,62,"item.edit.bitstreams.edit.buttons.undo"))}}function ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Conditional_3_For_42_Template(rf,ctx){if(1&rf&&core.DNE(0,ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Conditional_3_For_42_Conditional_0_Template,32,66,"tr",28),2&rf){let tmp_18_0;const entry_r6=ctx.$implicit,updates_r8=core.XpG();core.vxM((tmp_18_0=updates_r8[entry_r6.id])?0:-1,tmp_18_0)}}function ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Conditional_3_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"table",5),core.nI1(1,"translate"),core.j41(2,"thead")(3,"tr",6)(4,"th",7),core.EFF(5),core.nI1(6,"translate"),core.k0s(),core.j41(7,"th",8),core.EFF(8),core.nI1(9,"translate"),core.k0s(),core.j41(10,"th",9),core.EFF(11),core.nI1(12,"translate"),core.k0s(),core.j41(13,"th",10),core.EFF(14),core.nI1(15,"translate"),core.k0s()()(),core.j41(16,"tbody",11),core.bIt("cdkDropListDropped",function($event){core.eBV(_r1);const ctx_r1=core.XpG(3);return core.Njj(ctx_r1.drop($event))}),core.j41(17,"tr",12)(18,"th",13),core.EFF(19),core.nI1(20,"translate"),core.k0s(),core.j41(21,"td",14)(22,"div",15)(23,"button",16),core.nI1(24,"translate"),core.nI1(25,"translate"),core.nrm(26,"i",17),core.k0s(),core.j41(27,"div",18,2)(29,"button",19),core.nI1(30,"translate"),core.nI1(31,"translate"),core.nrm(32,"i",20),core.k0s(),core.j41(33,"ul",21)(34,"li",22)(35,"span",23),core.EFF(36),core.nI1(37,"translate"),core.k0s(),core.j41(38,"ul",24),core.Z7z(39,ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Conditional_3_For_40_Template,6,9,"li",25,core.fX1),core.k0s()()()()()()(),core.Z7z(41,ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Conditional_3_For_42_Template,1,1,null,null,core.fX1),core.nI1(43,"async"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG(3);core.AVh("mt-n1",!ctx_r1.isFirstTable),core.BMQ("aria-label",core.i5U(1,30,"item.edit.bitstreams.bundle.table.aria-label",core.eq3(56,_c2,ctx_r1.bundleName))),core.R7$(2),core.AVh("visually-hidden",!ctx_r1.isFirstTable),core.R7$(2),core.HbH(ctx_r1.columnSizes.columns[0].buildClasses()),core.R7$(),core.SpI(" ",core.bMT(6,33,"item.edit.bitstreams.headers.name")," "),core.R7$(2),core.HbH(ctx_r1.columnSizes.columns[1].buildClasses()),core.R7$(),core.SpI(" ",core.bMT(9,35,"item.edit.bitstreams.headers.description")," "),core.R7$(2),core.HbH(ctx_r1.columnSizes.columns[2].buildClasses()),core.R7$(),core.SpI(" ",core.bMT(12,37,"item.edit.bitstreams.headers.format")," "),core.R7$(2),core.ZvI("",ctx_r1.columnSizes.columns[3].buildClasses()," text-center"),core.R7$(),core.SpI(" ",core.bMT(15,39,"item.edit.bitstreams.headers.actions")," "),core.R7$(4),core.FS9("id",ctx_r1.bundleName),core.R7$(),core.SpI(" ",core.i5U(20,41,"item.edit.bitstreams.bundle.name",core.eq3(58,_c3,ctx_r1.bundleName))," "),core.R7$(4),core.FS9("title",core.bMT(24,44,"item.edit.bitstreams.bundle.edit.buttons.upload")),core.Y8G("routerLink",core.eq3(60,_c4,ctx_r1.itemPageRoute))("queryParams",core.eq3(62,_c2,ctx_r1.bundle.id)),core.BMQ("aria-label",core.bMT(25,46,"item.edit.bitstreams.bundle.edit.buttons.upload")),core.R7$(6),core.Y8G("title",core.bMT(30,48,"pagination.options.description")),core.BMQ("aria-label",core.bMT(31,50,"pagination.options.description")),core.R7$(7),core.JRh(core.bMT(37,52,"pagination.results-per-page")),core.R7$(3),core.Dyx(ctx_r1.paginationOptions.pageSizeOptions),core.R7$(2),core.Dyx(core.bMT(43,54,ctx_r1.tableEntries$))}}function ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Template(rf,ctx){if(1&rf&&(core.j41(0,"ds-pagination",3,1),core.nI1(2,"translate"),core.DNE(3,ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Conditional_3_Template,44,64,"table",4),core.nI1(4,"async"),core.k0s()),2&rf){let tmp_13_0;const ctx_r1=core.XpG(2);core.Y8G("hideGear",!0)("hidePagerWhenSinglePage",!0)("hidePaginationDetail",!0)("paginationOptions",ctx_r1.paginationOptions)("collectionSize",ctx.totalElements)("retainScrollPosition",!0)("ngbTooltip",core.bMT(2,9,"item.edit.bitstreams.bundle.tooltip"))("autoClose",!1),core.R7$(3),core.vxM((tmp_13_0=core.bMT(4,11,ctx_r1.updates$))?3:-1,tmp_13_0)}}function ItemEditBitstreamBundleComponent_ng_template_0_Template(rf,ctx){if(1&rf&&(core.DNE(0,ItemEditBitstreamBundleComponent_ng_template_0_Conditional_0_Template,5,13,"ds-pagination",3),core.nI1(1,"async")),2&rf){let tmp_2_0;const ctx_r1=core.XpG();core.vxM((tmp_2_0=null==(tmp_2_0=core.bMT(1,1,ctx_r1.bitstreamsRD$))?null:tmp_2_0.payload)?0:-1,tmp_2_0)}}let ItemEditBitstreamBundleComponent=(()=>{class ItemEditBitstreamBundleComponent2{constructor(viewContainerRef,dsoNameService,bundleService,objectUpdatesService,paginationService,requestService,itemBitstreamsService){this.viewContainerRef=viewContainerRef,this.dsoNameService=dsoNameService,this.bundleService=bundleService,this.objectUpdatesService=objectUpdatesService,this.paginationService=paginationService,this.requestService=requestService,this.itemBitstreamsService=itemBitstreamsService,this.FieldChangeType=field_change_type_model.B,this.isFirstTable=!1,this.tableEntries$=new cjs.BehaviorSubject([]),this.updates$=new cjs.BehaviorSubject(null),this.subscriptions=[]}ngOnInit(){this.bundleNameColumn=this.columnSizes.combineColumns(0,2),this.viewContainerRef.createEmbeddedView(this.bundleView),this.itemPageRoute=(0,item_page_routing_paths._o)(this.item),this.bundleName=this.dsoNameService.getName(this.bundle),this.bundleUrl=this.bundle.self,this.initializePagination(),this.initializeBitstreams(),this.initializeSelectionActions()}ngOnDestroy(){this.viewContainerRef.clear(),this.subscriptions.forEach(sub=>sub?.unsubscribe())}initializePagination(){this.paginationOptions=this.itemBitstreamsService.getInitialBitstreamsPaginationOptions(this.bundleName),this.currentPaginationOptions$=new cjs.BehaviorSubject(this.paginationOptions),this.pageSize$=new cjs.BehaviorSubject(this.paginationOptions.pageSize),this.subscriptions.push(this.paginationService.getCurrentPagination(this.paginationOptions.id,this.paginationOptions).subscribe(pagination=>{this.currentPaginationOptions$.next(pagination),this.pageSize$.next(pagination.pageSize)}))}initializeBitstreams(){this.bitstreamsRD$=this.currentPaginationOptions$.pipe((0,cjs.switchMap)(page=>{const paginatedOptions=new paginated_search_options_model.C({pagination:Object.assign({},page)});return this.bundleService.getBitstreamsEndpoint(this.bundle.id,paginatedOptions).pipe((0,cjs.switchMap)(href=>this.requestService.hasByHref$(href)),(0,cjs.switchMap)(()=>this.bundleService.getBitstreams(this.bundle.id,paginatedOptions,(0,follow_link_config_model.s)("format"))))}),(0,shared_operators.v7)(),(0,cjs.shareReplay)({bufferSize:1,refCount:!0})),this.subscriptions.push(this.bitstreamsRD$.pipe((0,operators.s)(1),(0,operators.Mi)(bitstreamsRD=>this.bundleSize=bitstreamsRD.payload.totalElements),(0,shared_operators.qn)()).subscribe(bitstreams=>{this.objectUpdatesService.initialize(this.bundleUrl,bitstreams,new Date)}),this.bitstreamsRD$.pipe((0,shared_operators.qn)(),(0,cjs.switchMap)(bitstreams=>this.objectUpdatesService.getFieldUpdatesExclusive(this.bundleUrl,bitstreams))).subscribe(updates=>this.updates$.next(updates)),this.bitstreamsRD$.pipe((0,shared_operators.qn)(),(0,operators.Tj)(bitstreams=>this.itemBitstreamsService.mapBitstreamsToTableEntries(bitstreams))).subscribe(tableEntries=>this.tableEntries$.next(tableEntries)))}initializeSelectionActions(){this.subscriptions.push(this.itemBitstreamsService.getSelectionAction$().subscribe(selectionAction=>this.handleSelectionAction(selectionAction)))}handleSelectionAction(selectionAction){(0,empty_util.Tn)(selectionAction)||selectionAction.selectedEntry.bundle!==this.bundle||("Moved"===selectionAction.action&&this.redirectToCurrentPage(selectionAction.selectedEntry),"Cancelled"===selectionAction.action&&this.redirectToOriginalPage(selectionAction.selectedEntry),"Cleared"===selectionAction.action&&this.redirectToCurrentPage(selectionAction.selectedEntry))}redirectToCurrentPage(bitstreamEntry){const currentPage=this.getCurrentPage(),selectedEntryPage=this.bundleIndexToPage(bitstreamEntry.currentPosition);currentPage!==selectedEntryPage&&this.changeToPage(selectedEntryPage)}redirectToOriginalPage(bitstreamEntry){const currentPage=this.getCurrentPage(),originPage=this.bundleIndexToPage(bitstreamEntry.originalPosition);currentPage!==originPage&&this.changeToPage(originPage)}canRemove(fieldUpdate){return fieldUpdate.changeType!==field_change_type_model.B.REMOVE}canUndo(fieldUpdate){return fieldUpdate.changeType>=field_change_type_model.B.UPDATE}remove(bitstream){this.objectUpdatesService.saveRemoveFieldUpdate(this.bundleUrl,bitstream)}undo(bitstream){this.objectUpdatesService.removeSingleFieldUpdate(this.bundleUrl,bitstream.uuid)}getRowClass(update,bitstream){const selected=this.itemBitstreamsService.getSelectedBitstream();if((0,empty_util.a4)(selected)&&bitstream.id===selected.bitstream.id)return"table-info";switch(update.changeType){case field_change_type_model.B.UPDATE:return"table-warning";case field_change_type_model.B.ADD:return"table-success";case field_change_type_model.B.REMOVE:return"table-danger";default:return"bg-white"}}doPageSizeChange(pageSize){this.paginationComponent.doPageSizeChange(pageSize)}dragStart(){this.paginationComponent.shouldShowBottomPager.pipe((0,operators.s)(1),(0,operators.pb)(hasMultiplePages=>hasMultiplePages)).subscribe(()=>{this.dragTooltip.open()})}dragEnd(){this.dragTooltip.close()}drop(event){const dragIndex=event.previousIndex;let dropIndex=event.currentIndex;const dragPage=this.getCurrentPage();let dropPage=this.getCurrentPage();const droppedOnElement=document.elementFromPoint(event.dropPoint.x,event.dropPoint.y);if((0,empty_util.a4)(droppedOnElement)&&(0,empty_util.a4)(droppedOnElement.textContent)&&droppedOnElement.classList.contains("page-link")){let droppedPage=Number(droppedOnElement.textContent);(0,empty_util.a4)(droppedPage)&&!Number.isNaN(droppedPage)&&(droppedPage-=1,droppedPage!==dragPage&&(dropPage=droppedPage,dropIndex=dropPage>dragPage?0:this.getCurrentPageSize()-1))}const fromIndex=this.pageIndexToBundleIndex(dragIndex,dragPage),toIndex=this.pageIndexToBundleIndex(dropIndex,dropPage);if(fromIndex===toIndex)return;const selectedBitstream=this.tableEntries$.value[dragIndex];this.itemBitstreamsService.performBitstreamMoveRequest(this.bundle,fromIndex,toIndex,()=>{this.itemBitstreamsService.announceMove(selectedBitstream.name,toIndex),dropPage!==this.getCurrentPage()&&this.changeToPage(dropPage),this.itemBitstreamsService.displaySuccessNotification(MOVE_KEY)})}select(event,bitstream){if(event.preventDefault(),event instanceof KeyboardEvent&&event.repeat)return;const selectedBitstream=this.itemBitstreamsService.getSelectedBitstream();if((0,empty_util.a4)(selectedBitstream)&&selectedBitstream.bitstream===bitstream)this.itemBitstreamsService.cancelSelection();else{const selectionObject=this.createBitstreamSelectionObject(bitstream);if((0,empty_util.Tn)(selectionObject))return void console.warn("Failed to create selection object");this.itemBitstreamsService.selectBitstreamEntry(selectionObject)}}createBitstreamSelectionObject(bitstream){const pageIndex=this.findBitstreamPageIndex(bitstream);if(-1===pageIndex)return null;const position=this.pageIndexToBundleIndex(pageIndex,this.getCurrentPage());return{bitstream,bundle:this.bundle,bundleSize:this.bundleSize,currentPosition:position,originalPosition:position}}findBitstreamPageIndex(bitstream){return this.tableEntries$.value.findIndex(entry=>entry===bitstream)}getCurrentPage(){return this.currentPaginationOptions$.value.currentPage-1}getCurrentPageSize(){return this.currentPaginationOptions$.value.pageSize}pageIndexToBundleIndex(index,page){return page*this.getCurrentPageSize()+index}bundleIndexToPage(index){return Math.floor(index/this.getCurrentPageSize())}changeToPage(page){this.paginationComponent.doPageChange(page+1)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemEditBitstreamBundleComponent2)(core.rXU(core.c1b),core.rXU(dso_name_service.f),core.rXU(bundle_data_service.BundleDataService),core.rXU(object_updates_service.F),core.rXU(pagination_service.m),core.rXU(request_service.B),core.rXU(ItemBitstreamsService))}}static{this.\u0275cmp=core.VBU({type:ItemEditBitstreamBundleComponent2,selectors:[["ds-item-edit-bitstream-bundle"]],viewQuery:function(rf,ctx){if(1&rf&&(core.GBs(item_edit_bitstream_bundle_component_c0,7),core.GBs(pagination_component.e,5),core.GBs(item_edit_bitstream_bundle_component_c1,5)),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.bundleView=_t.first),core.mGM(_t=core.lsd())&&(ctx.paginationComponent=_t.first),core.mGM(_t=core.lsd())&&(ctx.dragTooltip=_t.first)}},inputs:{bundle:"bundle",item:"item",columnSizes:"columnSizes",isFirstTable:"isFirstTable"},standalone:!0,features:[core.aNF],decls:2,vars:0,consts:[["bundleView",""],["dragTooltip","ngbTooltip"],["paginationControls","ngbDropdown"],["placement","bottom","triggers","manual",3,"hideGear","hidePagerWhenSinglePage","hidePaginationDetail","paginationOptions","collectionSize","retainScrollPosition","ngbTooltip","autoClose"],[1,"table",3,"mt-n1"],[1,"table"],[1,"header-row","fw-bold"],["id","name","scope","col"],["id","description","scope","col"],["id","format","scope","col"],["id","actions","scope","col"],["cdkDropList","",3,"cdkDropListDropped"],[1,"bundle-row"],["colspan","3","scope","colgroup",1,"row-element",3,"id"],[1,"text-center","row-element"],[1,"btn-group"],[1,"btn","btn-outline-success","btn-sm",3,"routerLink","queryParams","title"],[1,"fas","fa-upload","fa-fw"],["ngbDropdown","","container","body","placement","bottom-right",1,"btn-group","float-end","p-0"],["id","paginationControls","ngbDropdownToggle","","aria-haspopup","true","aria-expanded","false",1,"btn","btn-outline-secondary","btn-sm",3,"title"],["aria-hidden","true",1,"fas","fa-cog"],["id","paginationControlsDropdownMenu","aria-labelledby","paginationControls","role","menu","ngbDropdownMenu",""],["role","menuitem"],["id","pagination-control_results-per-page","role","heading",1,"dropdown-header"],["aria-labelledby","pagination-control_results-per-page","role","listbox",1,"list-unstyled"],["role","option"],[1,"dropdown-item",3,"click"],["aria-hidden","true",1,"fas","fa-check",3,"ngClass"],["cdkDrag","",1,"bitstream-row",3,"ngClass"],["cdkDrag","",1,"bitstream-row",3,"cdkDragStarted","cdkDragEnded","ngClass"],["scope","row",3,"id","headers"],["tabindex","0","cdkDragHandle","",1,"drag-handle","text-muted","float-start","p-1","me-2","d-inline",3,"keydown.enter","keydown.space","click"],[1,"fas","fa-grip-vertical","fa-fw",3,"title"],[1,"dont-break-out"],[3,"headers"],[1,"text-center","w-100"],[1,"btn-group","relationship-action-buttons"],[1,"btn","btn-outline-primary","btn-sm",3,"href","title"],[1,"fas","fa-download","fa-fw"],[1,"btn","btn-outline-primary","btn-sm",3,"routerLink","title"],[1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-danger","btn-sm",3,"click","dsBtnDisabled","title"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"click","dsBtnDisabled","title"],[1,"fas","fa-undo-alt","fa-fw"]],template:function(rf,ctx){1&rf&&core.DNE(0,ItemEditBitstreamBundleComponent_ng_template_0_Template,2,3,"ng-template",null,0,core.C5r)},dependencies:[browser_only_pipe.L,btn_disabled_directive.A,drag_drop.T1,drag_drop.O7,common.MD,common.YU,common.Jj,ng_bootstrap.zH,ng_bootstrap.tg,ng_bootstrap.do,ng_bootstrap.U0,ng_bootstrap.n8,ng_bootstrap.md,pagination_component.e,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],styles:[".drag-handle[_ngcontent-%COMP%]:hover, .bitstream-row-drag-handle[_ngcontent-%COMP%]:hover{cursor:move}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;box-sizing:border-box;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]     .larger-tooltip .tooltip-inner{max-width:500px}.table-border[_ngcontent-%COMP%]{border:1px solid #dee2e6}[_nghost-%COMP%]     .pagination{padding-top:.5rem}.scrollable-table[_ngcontent-%COMP%]{overflow-x:auto}.disabled-overlay[_ngcontent-%COMP%]{opacity:.6}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%}",".header-row[_ngcontent-%COMP%]{--bs-table-bg: var(--bs-dark);--bs-table-bg-state: var(--bs-dark);--bs-table-color-state: var(--bs-light)}.header-row[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{padding:.75rem}.bundle-row[_ngcontent-%COMP%]{--bs-table-color-state: var(--bs-dark);--bs-table-bg: var(--bs-light-bg-subtle);--bs-table-bg-state: var(--bs-light-bg-subtle)}.row-element[_ngcontent-%COMP%]{padding:.75em;border-bottom:var(--bs-table-border-width) solid var(--bs-table-border-color)}.bitstream-name[_ngcontent-%COMP%]{font-weight:400}.table[_ngcontent-%COMP%]{margin-bottom:0}"]})}}return ItemEditBitstreamBundleComponent2})();const item_bitstreams_component_c0=a0=>[a0,"bitstreams","new"],item_bitstreams_component_c1=a0=>({"disabled-overlay":a0});function ItemBitstreamsComponent_div_0_Conditional_10_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"button",18),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r2);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.reinstate())}),core.nrm(2,"i",19),core.j41(3,"span",8),core.EFF(4),core.nI1(5,"translate"),core.k0s()()}2&rf&&(core.BMQ("aria-label",core.bMT(1,2,"item.edit.bitstreams.reinstate-button")),core.R7$(4),core.SpI("\xa0",core.bMT(5,4,"item.edit.bitstreams.reinstate-button"),""))}function ItemBitstreamsComponent_div_0_Conditional_19_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"button",20),core.nI1(1,"async"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r4);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.discard())}),core.nrm(3,"i",21),core.j41(4,"span",8),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG(2);core.Y8G("dsBtnDisabled",!0!==core.bMT(1,3,ctx_r2.hasChanges$)||ctx_r2.submitting),core.BMQ("aria-label",core.bMT(2,5,"item.edit.bitstreams.discard-button")),core.R7$(5),core.SpI("\xa0",core.bMT(6,7,"item.edit.bitstreams.discard-button"),"")}}function ItemBitstreamsComponent_div_0_Conditional_21_For_3_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-item-edit-bitstream-bundle",22),2&rf){const bundle_r5=ctx.$implicit,\u0275$index_58_r6=ctx.$index,ctx_r2=core.XpG(3);core.Y8G("bundle",bundle_r5)("item",ctx_r2.item)("columnSizes",ctx_r2.columnSizes)("isFirstTable",0===\u0275$index_58_r6)}}function ItemBitstreamsComponent_div_0_Conditional_21_Conditional_4_Template(rf,ctx){if(1&rf){const _r7=core.RV6();core.j41(0,"div",23)(1,"button",24),core.bIt("click",function(){core.eBV(_r7);const ctx_r2=core.XpG(3);return core.Njj(ctx_r2.loadBundles())}),core.EFF(2),core.nI1(3,"translate"),core.k0s()()}2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"item.edit.bitstreams.load-more.link"),""))}function ItemBitstreamsComponent_div_0_Conditional_21_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",13),core.nI1(1,"async"),core.Z7z(2,ItemBitstreamsComponent_div_0_Conditional_21_For_3_Template,1,4,"ds-item-edit-bitstream-bundle",22,core.fX1),core.DNE(4,ItemBitstreamsComponent_div_0_Conditional_21_Conditional_4_Template,4,3,"div",23),core.nI1(5,"async"),core.k0s()),2&rf){const bundles_r8=core.XpG().ngVar,ctx_r2=core.XpG();core.Y8G("ngClass",core.eq3(6,item_bitstreams_component_c1,core.bMT(1,2,ctx_r2.isProcessingMoveRequest))),core.R7$(2),core.Dyx(bundles_r8),core.R7$(2),core.vxM(core.bMT(5,4,ctx_r2.showLoadMoreLink$)?4:-1)}}function ItemBitstreamsComponent_div_0_Conditional_22_Template(rf,ctx){1&rf&&(core.j41(0,"div",14),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"item.edit.bitstreams.empty")," "))}function ItemBitstreamsComponent_div_0_Conditional_23_Template(rf,ctx){1&rf&&(core.nrm(0,"ds-loading",15),core.nI1(1,"translate")),2&rf&&core.FS9("message",core.bMT(1,1,"loading.bitstreams"))}function ItemBitstreamsComponent_div_0_Conditional_26_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"button",18),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r9);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.reinstate())}),core.nrm(2,"i",19),core.j41(3,"span",8),core.EFF(4),core.nI1(5,"translate"),core.k0s()()}2&rf&&(core.BMQ("aria-label",core.bMT(1,2,"item.edit.bitstreams.reinstate-button")),core.R7$(4),core.SpI("\xa0",core.bMT(5,4,"item.edit.bitstreams.reinstate-button"),""))}function ItemBitstreamsComponent_div_0_Conditional_35_Template(rf,ctx){if(1&rf){const _r10=core.RV6();core.j41(0,"button",20),core.nI1(1,"async"),core.nI1(2,"translate"),core.bIt("click",function(){core.eBV(_r10);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.discard())}),core.nrm(3,"i",21),core.j41(4,"span",8),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG(2);core.Y8G("dsBtnDisabled",!0!==core.bMT(1,3,ctx_r2.hasChanges$)||ctx_r2.submitting),core.BMQ("aria-label",core.bMT(2,5,"item.edit.bitstreams.discard-button")),core.R7$(5),core.SpI("\xa0",core.bMT(6,7,"item.edit.bitstreams.discard-button"),"")}}function ItemBitstreamsComponent_div_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",2)(1,"div",3),core.nrm(2,"ds-alert",4),core.k0s(),core.j41(3,"div",5)(4,"button",6),core.nI1(5,"translate"),core.nrm(6,"i",7),core.j41(7,"span",8),core.EFF(8),core.nI1(9,"translate"),core.k0s()(),core.DNE(10,ItemBitstreamsComponent_div_0_Conditional_10_Template,6,6,"button",9),core.nI1(11,"async"),core.j41(12,"button",10),core.nI1(13,"async"),core.nI1(14,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.nrm(15,"i",11),core.j41(16,"span",8),core.EFF(17),core.nI1(18,"translate"),core.k0s()(),core.DNE(19,ItemBitstreamsComponent_div_0_Conditional_19_Template,7,9,"button",12),core.nI1(20,"async"),core.k0s(),core.DNE(21,ItemBitstreamsComponent_div_0_Conditional_21_Template,6,8,"div",13)(22,ItemBitstreamsComponent_div_0_Conditional_22_Template,3,3,"div",14)(23,ItemBitstreamsComponent_div_0_Conditional_23_Template,2,3,"ds-loading",15),core.j41(24,"div",16)(25,"div",17),core.DNE(26,ItemBitstreamsComponent_div_0_Conditional_26_Template,6,6,"button",9),core.nI1(27,"async"),core.j41(28,"button",10),core.nI1(29,"async"),core.nI1(30,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.nrm(31,"i",11),core.j41(32,"span",8),core.EFF(33),core.nI1(34,"translate"),core.k0s()(),core.DNE(35,ItemBitstreamsComponent_div_0_Conditional_35_Template,7,9,"button",12),core.nI1(36,"async"),core.k0s()()()}if(2&rf){const bundles_r8=ctx.ngVar,ctx_r2=core.XpG();core.R7$(2),core.Y8G("content","item.edit.bitstreams.info-alert")("type",ctx_r2.AlertType.Info),core.R7$(2),core.Y8G("routerLink",core.eq3(42,item_bitstreams_component_c0,ctx_r2.itemPageRoute)),core.BMQ("aria-label",core.bMT(5,18,"item.edit.bitstreams.upload-button")),core.R7$(4),core.SpI("\xa0",core.bMT(9,20,"item.edit.bitstreams.upload-button"),""),core.R7$(2),core.vxM(core.bMT(11,22,ctx_r2.isReinstatable$)?10:-1),core.R7$(2),core.Y8G("dsBtnDisabled",!0!==core.bMT(13,24,ctx_r2.hasChanges$)||ctx_r2.submitting),core.BMQ("aria-label",core.bMT(14,26,"item.edit.bitstreams.save-button")),core.R7$(5),core.SpI("\xa0",core.bMT(18,28,"item.edit.bitstreams.save-button"),""),core.R7$(2),core.vxM(!0!==core.bMT(20,30,ctx_r2.isReinstatable$)?19:-1),core.R7$(2),core.vxM(ctx_r2.item&&(null==bundles_r8?null:bundles_r8.length)>0?21:-1),core.R7$(),core.vxM(0===(null==bundles_r8?null:bundles_r8.length)?22:-1),core.R7$(),core.vxM(bundles_r8?-1:23),core.R7$(3),core.vxM(core.bMT(27,32,ctx_r2.isReinstatable$)?26:-1),core.R7$(2),core.Y8G("dsBtnDisabled",!0!==core.bMT(29,34,ctx_r2.hasChanges$)||ctx_r2.submitting),core.BMQ("aria-label",core.bMT(30,36,"item.edit.bitstreams.save-button")),core.R7$(5),core.SpI("\xa0",core.bMT(34,38,"item.edit.bitstreams.save-button"),""),core.R7$(2),core.vxM(!0!==core.bMT(36,40,ctx_r2.isReinstatable$)?35:-1)}}function ItemBitstreamsComponent_Conditional_2_Template(rf,ctx){1&rf&&core.nrm(0,"ds-loading",1)}let ItemBitstreamsComponent=(()=>{class ItemBitstreamsComponent2 extends AbstractItemUpdateComponent{get bundles$(){return this.bundlesSubject.asObservable()}constructor(itemService,objectUpdatesService,router2,notificationsService,translateService,route,bitstreamService,objectCache,requestService,cdRef,bundleService,zone,itemBitstreamsService){super(itemService,objectUpdatesService,router2,notificationsService,translateService,route),this.itemService=itemService,this.objectUpdatesService=objectUpdatesService,this.router=router2,this.notificationsService=notificationsService,this.translateService=translateService,this.route=route,this.bitstreamService=bitstreamService,this.objectCache=objectCache,this.requestService=requestService,this.cdRef=cdRef,this.bundleService=bundleService,this.zone=zone,this.itemBitstreamsService=itemBitstreamsService,this.AlertType=alert_type.v,this.bundlesSubject=new cjs.BehaviorSubject([]),this.bundlesOptions=Object.assign(new pagination_component_options_model.W,{id:"bundles-pagination-options",currentPage:1,pageSize:10}),this.submitting=!1,this.showLoadMoreLink$=new cjs.BehaviorSubject(!0),this.columnSizes=this.itemBitstreamsService.getColumnSizes()}postItemInit(){this.loadBundles(1)}moveUp(event){this.itemBitstreamsService.hasSelectedBitstream()&&(event.preventDefault(),this.itemBitstreamsService.moveSelectedBitstreamUp())}moveDown(event){this.itemBitstreamsService.hasSelectedBitstream()&&(event.preventDefault(),this.itemBitstreamsService.moveSelectedBitstreamDown())}cancelSelection(event){this.itemBitstreamsService.hasSelectedBitstream()&&(event.preventDefault(),this.itemBitstreamsService.cancelSelection())}clearSelection(event){this.itemBitstreamsService.hasSelectedBitstream()&&event.target instanceof Element&&"BODY"===event.target.tagName&&(event.preventDefault(),this.itemBitstreamsService.clearSelection())}initializeNotificationsPrefix(){this.notificationsPrefix="item.edit.bitstreams.notifications."}loadBundles(currentPage){this.bundlesOptions=Object.assign(new pagination_component_options_model.W,this.bundlesOptions,{currentPage:currentPage||this.bundlesOptions.currentPage+1}),this.itemService.getBundles(this.item.id,new paginated_search_options_model.C({pagination:this.bundlesOptions})).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(bundles=>{this.updateBundles(bundles)})}updateBundles(newBundlesPL){const currentBundles=this.bundlesSubject.getValue(),bundlesToAdd=newBundlesPL.page.filter(bundleToAdd=>!currentBundles.some(currentBundle=>currentBundle.id===bundleToAdd.id)),updatedBundles=[...currentBundles,...bundlesToAdd];this.showLoadMoreLink$.next(updatedBundles.length<newBundlesPL.totalElements),this.bundlesSubject.next(updatedBundles)}submit(){this.submitting=!0,this.itemBitstreamsService.removeMarkedBitstreams(this.bundles$.pipe((0,operators.s)(1))).subscribe(responses=>{this.itemBitstreamsService.displayNotifications("item.edit.bitstreams.notifications.remove",[responses]),this.submitting=!1})}dropBitstream(bundle,event){this.zone.runOutsideAngular(()=>{(0,empty_util.a4)(event)&&(0,empty_util.a4)(event.fromIndex)&&(0,empty_util.a4)(event.toIndex)&&(0,empty_util.a4)(event.finish)&&this.bundleService.patch(bundle,[{op:"move",from:`/_links/bitstreams/${event.fromIndex}/href`,path:`/_links/bitstreams/${event.toIndex}/href`}]).pipe((0,operators.s)(1)).subscribe(response=>{this.zone.run(()=>{this.displayNotifications("item.edit.bitstreams.notifications.move",[response]),this.requestService.removeByHrefSubstring(bundle.self).pipe((0,operators.pb)(isCached=>isCached),(0,operators.s)(1)).subscribe(()=>event.finish())})})})}displayNotifications(key,responses){if((0,empty_util.hj)(responses)){const failedResponses=responses.filter(response=>(0,empty_util.a4)(response)&&response.hasFailed),successfulResponses=responses.filter(response=>(0,empty_util.a4)(response)&&response.hasSucceeded);failedResponses.forEach(response=>{this.notificationsService.error(this.translateService.instant(`${key}.failed.title`),response.errorMessage)}),successfulResponses.length>0&&this.notificationsService.success(this.translateService.instant(`${key}.saved.title`),this.translateService.instant(`${key}.saved.content`))}}discard(){const undoNotification=this.notificationsService.info(this.getNotificationTitle("discarded"),this.getNotificationContent("discarded"),{timeOut:this.discardTimeOut});this.objectUpdatesService.discardAllFieldUpdates(this.url,undoNotification)}reinstate(){this.bundles$.pipe((0,operators.s)(1)).subscribe(bundles=>{bundles.forEach(bundle=>{this.objectUpdatesService.reinstateFieldUpdates(bundle.self)})})}isReinstatable(){return this.bundles$.pipe((0,operators.nx)(bundles=>(0,cjs.combineLatest)(bundles.map(bundle=>this.objectUpdatesService.isReinstatable(bundle.self)))),(0,operators.Tj)(reinstatable=>reinstatable.includes(!0)))}hasChanges(){return this.bundles$.pipe((0,operators.nx)(bundles=>(0,cjs.combineLatest)(bundles.map(bundle=>this.objectUpdatesService.hasUpdates(bundle.self)))),(0,operators.Tj)(hasChanges=>hasChanges.includes(!0)))}ngOnDestroy(){this.itemUpdateSubscription&&this.itemUpdateSubscription.unsubscribe()}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemBitstreamsComponent2)(core.rXU(item_data_service.ItemDataService),core.rXU(object_updates_service.F),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(router.nX),core.rXU(bitstream_data_service.BitstreamDataService),core.rXU(object_cache_service.$),core.rXU(request_service.B),core.rXU(core.gRc),core.rXU(bundle_data_service.BundleDataService),core.rXU(core.SKi),core.rXU(ItemBitstreamsService))}}static{this.\u0275cmp=core.VBU({type:ItemBitstreamsComponent2,selectors:[["ds-item-bitstreams"]],hostBindings:function(rf,ctx){1&rf&&core.bIt("keydown.arrowUp",function($event){return ctx.moveUp($event)},!1,core.EBC)("keydown.arrowDown",function($event){return ctx.moveDown($event)},!1,core.EBC)("keyup.escape",function($event){return ctx.cancelSelection($event)},!1,core.EBC)("keydown.enter",function($event){return ctx.clearSelection($event)},!1,core.EBC)("keydown.space",function($event){return ctx.clearSelection($event)},!1,core.EBC)},standalone:!0,features:[core.Jv_([ObjectValuesPipe]),core.Vt3,core.aNF],decls:4,vars:6,consts:[["class","item-bitstreams",4,"ngVar"],[1,"loading-overlay"],[1,"item-bitstreams"],["id","reorder-description",1,"mt-2"],[3,"content","type"],[1,"button-row","top","d-flex","mt-2","space-children-mr"],[1,"me-auto","btn","btn-success",3,"routerLink"],[1,"fas","fa-upload"],[1,"d-none","d-sm-inline"],[1,"btn","btn-warning"],[1,"btn","btn-primary",3,"click","dsBtnDisabled"],[1,"fas","fa-save"],[1,"btn","btn-danger",3,"dsBtnDisabled"],[1,"mt-4","table-border","scrollable-table",3,"ngClass"],["role","alert",1,"alert","alert-info","w-100","d-inline-block","mt-4"],[3,"message"],[1,"button-row","bottom"],[1,"mt-4","float-end","space-children-mr","ms-gap"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-undo-alt"],[1,"btn","btn-danger",3,"click","dsBtnDisabled"],[1,"fas","fa-times"],["aria-describedby","reorder-description",3,"bundle","item","columnSizes","isFirstTable"],[1,"d-flex","justify-content-center"],[1,"btn","btn-link","my-3",3,"click"]],template:function(rf,ctx){1&rf&&(core.DNE(0,ItemBitstreamsComponent_div_0_Template,37,44,"div",0),core.nI1(1,"async"),core.DNE(2,ItemBitstreamsComponent_Conditional_2_Template,1,0,"ds-loading",1),core.nI1(3,"async")),2&rf&&(core.Y8G("ngVar",core.bMT(1,2,ctx.bundles$)),core.R7$(2),core.vxM(core.bMT(3,4,ctx.isProcessingMoveRequest)?2:-1))},dependencies:[alert_component.C,common.Jj,btn_disabled_directive.A,ItemEditBitstreamBundleComponent,common.YU,router.Wk,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9,var_directive.r],styles:[".drag-handle[_ngcontent-%COMP%]:hover, .bitstream-row-drag-handle[_ngcontent-%COMP%]:hover{cursor:move}.cdk-drag-preview[_ngcontent-%COMP%]{margin-left:0;box-sizing:border-box;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .bitstream-row-drag-handle[_ngcontent-%COMP%], .cdk-drop-list-dragging[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{cursor:grabbing}[_nghost-%COMP%]     .larger-tooltip .tooltip-inner{max-width:500px}.table-border[_ngcontent-%COMP%]{border:1px solid #dee2e6}[_nghost-%COMP%]     .pagination{padding-top:.5rem}.scrollable-table[_ngcontent-%COMP%]{overflow-x:auto}.disabled-overlay[_ngcontent-%COMP%]{opacity:.6}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%}"]})}}return ItemBitstreamsComponent2})();var collection_data_service=__webpack_require__(8108),dspace_object_type_model=__webpack_require__(59293),search_service=__webpack_require__(58807),search_configuration_service=__webpack_require__(11013),fesm2022_forms=__webpack_require__(13054),collection_page_routing_paths=__webpack_require__(35408),error_component=__webpack_require__(17561),object_select_model=__webpack_require__(72004),object_select_component=__webpack_require__(44631);const collection_select_component_c0=(a0,a1)=>({"btn-danger":a0,"btn-primary":a1});function CollectionSelectComponent_ng_container_0_Conditional_1_For_14_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"tr")(1,"td")(2,"input",10,0),core.nI1(4,"async"),core.nI1(5,"async"),core.nI1(6,"translate"),core.bIt("change",function(){const selectCollection_r2=core.eBV(_r1).$implicit,ctx_r2=core.XpG(3);return core.Njj(ctx_r2.switch(selectCollection_r2.dso.id))}),core.k0s()(),core.j41(7,"td")(8,"a",11),core.EFF(9),core.k0s()()()}if(2&rf){const selectCollection_r2=ctx.$implicit,selectCollectionBtn_r4=core.sdS(3),ctx_r2=core.XpG(3);core.R7$(2),core.FS9("name",selectCollection_r2.dso.id),core.Y8G("disabled",!1===core.bMT(4,6,selectCollection_r2.canSelect$))("ngModel",core.bMT(5,8,selectCollection_r2.selected$)),core.BMQ("aria-label",core.bMT(6,10,selectCollectionBtn_r4.checked?"collection.select.table.deselect":"collection.select.table.select")),core.R7$(6),core.Y8G("routerLink",selectCollection_r2.route),core.R7$(),core.JRh(ctx_r2.dsoNameService.getName(selectCollection_r2.dso))}}function CollectionSelectComponent_ng_container_0_Conditional_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"ds-pagination",2)(1,"div",6)(2,"table",7)(3,"thead")(4,"tr")(5,"th")(6,"span",8),core.EFF(7),core.nI1(8,"translate"),core.k0s()(),core.j41(9,"th",9),core.EFF(10),core.nI1(11,"translate"),core.k0s()()(),core.j41(12,"tbody"),core.Z7z(13,CollectionSelectComponent_ng_container_0_Conditional_1_For_14_Template,10,12,"tr",null,core.fX1),core.nI1(15,"async"),core.k0s()()()()),2&rf){const collectionsRD_r5=core.XpG().ngVar,ctx_r2=core.XpG();core.Y8G("paginationOptions",ctx_r2.paginationOptions)("sortOptions",ctx_r2.sortOptions)("collectionSize",null==collectionsRD_r5||null==collectionsRD_r5.payload?null:collectionsRD_r5.payload.totalElements)("hidePagerWhenSinglePage",!0)("hideGear",!0),core.R7$(7),core.JRh(core.bMT(8,7,"collection.select.table.selected")),core.R7$(3),core.JRh(core.bMT(11,9,"collection.select.table.title")),core.R7$(3),core.Dyx(core.bMT(15,11,ctx_r2.selectCollections$))}}function CollectionSelectComponent_ng_container_0_Conditional_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",3),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"collection.select.empty")," "))}function CollectionSelectComponent_ng_container_0_Conditional_3_Template(rf,ctx){1&rf&&(core.nrm(0,"ds-error",4),core.nI1(1,"translate")),2&rf&&core.FS9("message",core.bMT(1,1,"error.collections"))}function CollectionSelectComponent_ng_container_0_Conditional_4_Template(rf,ctx){1&rf&&(core.nrm(0,"ds-loading",4),core.nI1(1,"translate")),2&rf&&core.FS9("message",core.bMT(1,1,"loading.collections"))}function CollectionSelectComponent_ng_container_0_div_5_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",12)(1,"button",13),core.bIt("click",function(){core.eBV(_r6);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.onCancel())}),core.nrm(2,"i",14),core.EFF(3),core.nI1(4,"translate"),core.k0s(),core.j41(5,"button",15),core.bIt("click",function(){core.eBV(_r6);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.confirmSelected())}),core.nrm(6,"i",16),core.EFF(7),core.nI1(8,"translate"),core.k0s()()}if(2&rf){const selectedIds_r7=ctx.ngVar,ctx_r2=core.XpG(2);core.R7$(3),core.SpI(" ",core.bMT(4,4,ctx_r2.cancelButton)," "),core.R7$(2),core.Y8G("ngClass",core.l_i(8,collection_select_component_c0,ctx_r2.dangerConfirm,!ctx_r2.dangerConfirm))("dsBtnDisabled",0===(null==selectedIds_r7?null:selectedIds_r7.length)),core.R7$(2),core.SpI(" ",core.bMT(8,6,ctx_r2.confirmButton)," ")}}function CollectionSelectComponent_ng_container_0_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,CollectionSelectComponent_ng_container_0_Conditional_1_Template,16,13,"ds-pagination",2)(2,CollectionSelectComponent_ng_container_0_Conditional_2_Template,3,3,"div",3)(3,CollectionSelectComponent_ng_container_0_Conditional_3_Template,2,3,"ds-error",4)(4,CollectionSelectComponent_ng_container_0_Conditional_4_Template,2,3,"ds-loading",4)(5,CollectionSelectComponent_ng_container_0_div_5_Template,9,11,"div",5),core.nI1(6,"async"),core.bVm()),2&rf){const collectionsRD_r5=ctx.ngVar,ctx_r2=core.XpG();core.R7$(),core.vxM((null==collectionsRD_r5||null==collectionsRD_r5.payload?null:collectionsRD_r5.payload.totalElements)>0||(null==collectionsRD_r5||null==collectionsRD_r5.payload||null==collectionsRD_r5.payload.page?null:collectionsRD_r5.payload.page.length)>0?1:-1),core.R7$(),core.vxM(0===(null==collectionsRD_r5||null==collectionsRD_r5.payload?null:collectionsRD_r5.payload.totalElements)||0===(null==collectionsRD_r5||null==collectionsRD_r5.payload||null==collectionsRD_r5.payload.page?null:collectionsRD_r5.payload.page.length)?2:-1),core.R7$(),core.vxM(null!=collectionsRD_r5&&collectionsRD_r5.hasFailed?3:-1),core.R7$(),core.vxM(!collectionsRD_r5||null!=collectionsRD_r5&&collectionsRD_r5.isLoading?4:-1),core.R7$(),core.Y8G("ngVar",core.bMT(6,5,ctx_r2.selectedIds$))}}let CollectionSelectComponent=(()=>{class CollectionSelectComponent2 extends object_select_component.h{ngOnInit(){super.ngOnInit(),(0,empty_util.hj)(this.confirmButton)||(this.confirmButton="collection.select.confirm"),this.selectCollections$=this.dsoRD$.pipe((0,empty_util.Az)(),(0,shared_operators.Hz)(),(0,cjs.map)(collections=>collections.page.map(collection=>Object.assign(new object_select_model.A,{dso:collection,canSelect$:this.canSelect(collection),selected$:this.getSelected(collection.id),route:(0,collection_page_routing_paths.JW)(collection.id)}))))}static{this.\u0275fac=(()=>{let \u0275CollectionSelectComponent_BaseFactory;return function(__ngFactoryType__){return(\u0275CollectionSelectComponent_BaseFactory||(\u0275CollectionSelectComponent_BaseFactory=core.xGo(CollectionSelectComponent2)))(__ngFactoryType__||CollectionSelectComponent2)}})()}static{this.\u0275cmp=core.VBU({type:CollectionSelectComponent2,selectors:[["ds-collection-select"]],standalone:!0,features:[core.Vt3,core.aNF],decls:2,vars:3,consts:[["selectCollectionBtn",""],[4,"ngVar"],[3,"paginationOptions","sortOptions","collectionSize","hidePagerWhenSinglePage","hideGear"],["role","alert",1,"alert","alert-info","w-100"],[3,"message"],["class","space-children-mr float-end",4,"ngVar"],[1,"table-responsive","mt-2"],["id","collection-select",1,"table","table-striped","table-hover"],[1,"sr-only"],["scope","col"],["type","checkbox",1,"collection-checkbox",3,"change","disabled","ngModel","name"],[3,"routerLink"],[1,"space-children-mr","float-end"],[1,"btn","btn-outline-secondary","collection-cancel",3,"click"],[1,"fas","fa-times"],[1,"btn","collection-confirm",3,"click","ngClass","dsBtnDisabled"],[1,"fas","fa-trash"]],template:function(rf,ctx){1&rf&&(core.DNE(0,CollectionSelectComponent_ng_container_0_Template,7,7,"ng-container",1),core.nI1(1,"async")),2&rf&&core.Y8G("ngVar",core.bMT(1,1,ctx.dsoRD$))},dependencies:[common.Jj,btn_disabled_directive.A,error_component.A,fesm2022_forms.YN,fesm2022_forms.Zm,fesm2022_forms.BC,fesm2022_forms.vS,common.YU,pagination_component.e,router.Wk,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9,var_directive.r],styles:["table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-of-type, table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-of-type{width:1rem!important}"]})}}return CollectionSelectComponent2})();var themed_search_form_component=__webpack_require__(25667);const item_collection_mapper_component_c0=["tabs"],item_collection_mapper_component_c1=a0=>({name:a0});function ItemCollectionMapperComponent_ng_template_18_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"div",11)(1,"ds-collection-select",12),core.nI1(2,"async"),core.bIt("confirm",function($event){core.eBV(_r2);const ctx_r2=core.XpG();return core.Njj(ctx_r2.removeMappings($event))})("cancel",function(){core.eBV(_r2);const ctx_r2=core.XpG();return core.Njj(ctx_r2.onCancel())}),core.k0s()()}if(2&rf){let tmp_4_0;const ctx_r2=core.XpG();core.R7$(),core.Y8G("key","browse")("dsoRD$",ctx_r2.itemCollectionsRD$)("paginationOptions",null==(tmp_4_0=core.bMT(2,6,ctx_r2.searchOptions$))?null:tmp_4_0.pagination)("confirmButton","item.edit.item-mapper.buttons.remove")("cancelButton","item.edit.item-mapper.cancel")("dangerConfirm",!0)}}function ItemCollectionMapperComponent_ng_template_24_Conditional_5_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div")(1,"ds-collection-select",17),core.nI1(2,"async"),core.nI1(3,"async"),core.bIt("confirm",function($event){core.eBV(_r5);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.mapCollections($event))})("cancel",function(){core.eBV(_r5);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.onCancel())}),core.k0s()()}if(2&rf){let tmp_5_0,tmp_6_0;const ctx_r2=core.XpG(2);core.R7$(),core.Y8G("key","map")("dsoRD$",ctx_r2.mappedCollectionsRD$)("paginationOptions",null==(tmp_5_0=core.bMT(2,6,ctx_r2.searchOptions$))?null:tmp_5_0.pagination)("sortOptions",null==(tmp_6_0=core.bMT(3,8,ctx_r2.searchOptions$))?null:tmp_6_0.sort)("confirmButton","item.edit.item-mapper.buttons.add")("cancelButton","item.edit.item-mapper.cancel")}}function ItemCollectionMapperComponent_ng_template_24_Conditional_6_Template(rf,ctx){1&rf&&(core.j41(0,"div",16),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"item.edit.item-mapper.no-search")," "))}function ItemCollectionMapperComponent_ng_template_24_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"div",13)(1,"div",14)(2,"ds-search-form",15),core.nI1(3,"async"),core.nI1(4,"translate"),core.bIt("submitSearch",function(){core.eBV(_r4);const ctx_r2=core.XpG();return core.Njj(ctx_r2.performedSearch=!0)}),core.k0s()()(),core.DNE(5,ItemCollectionMapperComponent_ng_template_24_Conditional_5_Template,4,10,"div")(6,ItemCollectionMapperComponent_ng_template_24_Conditional_6_Template,3,3,"div",16)}if(2&rf){let tmp_2_0;const ctx_r2=core.XpG();core.R7$(2),core.Y8G("query",null==(tmp_2_0=core.bMT(3,6,ctx_r2.searchOptions$))?null:tmp_2_0.query)("currentUrl","./")("inPlaceSearch",!0)("searchPlaceholder",core.bMT(4,8,"item.edit.item-mapper.search-form.placeholder")),core.R7$(3),core.vxM(ctx_r2.performedSearch?5:-1),core.R7$(),core.vxM(ctx_r2.performedSearch?-1:6)}}let ItemCollectionMapperComponent=(()=>{class ItemCollectionMapperComponent2{constructor(route,router2,searchConfigService,searchService,notificationsService,itemDataService,collectionDataService,translateService,dsoNameService){this.route=route,this.router=router2,this.searchConfigService=searchConfigService,this.searchService=searchService,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.collectionDataService=collectionDataService,this.translateService=translateService,this.dsoNameService=dsoNameService,this.performedSearch=!1}ngOnInit(){this.itemRD$=this.route.parent.data.pipe((0,operators.s)(1),(0,operators.Tj)(data=>data.dso)),this.itemName$=this.itemRD$.pipe((0,operators.pb)(rd=>(0,empty_util.a4)(rd)),(0,operators.Tj)(rd=>this.dsoNameService.getName(rd.payload))),this.searchOptions$=this.searchConfigService.paginatedSearchOptions,this.loadCollectionLists()}loadCollectionLists(){this.shouldUpdate$=new cjs.BehaviorSubject(!0),this.itemCollectionsRD$=(0,cjs.combineLatest)(this.itemRD$.pipe((0,shared_operators.ak)()),this.shouldUpdate$).pipe((0,operators.nx)(([item,shouldUpdate])=>(!0===shouldUpdate&&this.shouldUpdate$.next(!1),this.collectionDataService.findListByHref(this.itemDataService.getMappedCollectionsEndpoint(item.id),void 0,!shouldUpdate,!1).pipe((0,shared_operators.v7)()))));const owningCollectionRD$=this.itemRD$.pipe((0,shared_operators.ak)(),(0,operators.nx)(item=>this.collectionDataService.findOwningCollectionFor(item)),(0,shared_operators.v7)()),itemCollectionsAndOptions$=(0,cjs.combineLatest)(this.itemCollectionsRD$,owningCollectionRD$,this.searchOptions$);this.mappedCollectionsRD$=itemCollectionsAndOptions$.pipe((0,operators.nx)(([itemCollectionsRD,owningCollectionRD,searchOptions])=>this.searchService.search(Object.assign(new paginated_search_options_model.C(searchOptions),{query:this.buildQuery([...itemCollectionsRD.payload.page,owningCollectionRD.payload],searchOptions.query),dsoTypes:[dspace_object_type_model.W.COLLECTION]}),1e4).pipe((0,shared_operators.jY)(),(0,operators.ql)(void 0))))}mapCollections(ids){const responses$=(0,cjs.combineLatest)([this.itemRD$.pipe((0,shared_operators.yd)(),(0,operators.Tj)(rd=>rd.payload),(0,operators.Tj)(item=>item.id)),this.itemCollectionsRD$.pipe((0,shared_operators.yd)(),(0,operators.Tj)(rd=>rd.payload.page),(0,operators.Tj)(collections=>collections.map(collection=>collection.id)))]).pipe((0,operators.nx)(([itemId,excludingIds])=>(0,cjs.combineLatest)(this.filterIds(ids,excludingIds).map(id=>this.itemDataService.mapToCollection(itemId,id).pipe((0,shared_operators.qD)())))));this.showNotifications(responses$,"item.edit.item-mapper.notifications.add")}removeMappings(ids){const responses$=this.itemRD$.pipe((0,shared_operators.yd)(),(0,operators.Tj)(itemRD=>itemRD.payload.id),(0,operators.nx)(itemId=>(0,cjs.combineLatest)(ids.map(id=>this.itemDataService.removeMappingFromCollection(itemId,id).pipe((0,shared_operators.qD)())))));this.showNotifications(responses$,"item.edit.item-mapper.notifications.remove")}filterIds(ids,excluding){return ids.filter(id=>excluding.indexOf(id)<0)}showNotifications(responses$,messagePrefix){responses$.subscribe(responses=>{const successful=responses.filter(response=>response.hasSucceeded),unsuccessful=responses.filter(response=>response.hasFailed);successful.length>0&&((0,cjs.combineLatest)([this.translateService.get(`${messagePrefix}.success.head`),this.translateService.get(`${messagePrefix}.success.content`,{amount:successful.length})]).subscribe(([head,content])=>{this.notificationsService.success(head,content)}),this.shouldUpdate$.next(!0)),unsuccessful.length>0&&(0,cjs.combineLatest)([this.translateService.get(`${messagePrefix}.error.head`),this.translateService.get(`${messagePrefix}.error.content`,{amount:unsuccessful.length})]).subscribe(([head,content])=>{this.notificationsService.error(head,content)}),this.switchToFirstTab()})}tabChange(event){this.performedSearch=!1,this.router.navigateByUrl(this.getCurrentUrl())}getCurrentUrl(){return this.router.url.indexOf("?")>-1?this.router.url.substring(0,this.router.url.indexOf("?")):this.router.url}buildQuery(collections,query){let result=query;for(const collection of collections)result=this.addExcludeCollection(collection.id,result);return result}addExcludeCollection(collectionId,query){const excludeQuery=`-search.resourceid:${collectionId}`;return(0,empty_util.hj)(query)?`${query} AND ${excludeQuery}`:excludeQuery}switchToFirstTab(){this.tabs.select("browseTab")}onCancel(){this.itemRD$.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.s)(1)).subscribe(item=>{this.router.navigate([(0,item_page_routing_paths._o)(item)])})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemCollectionMapperComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(search_configuration_service.g),core.rXU(search_service.S),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(collection_data_service.CollectionDataService),core.rXU(ngx_translate_core.c$),core.rXU(dso_name_service.f))}}static{this.\u0275cmp=core.VBU({type:ItemCollectionMapperComponent2,selectors:[["ds-item-collection-mapper"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(item_collection_mapper_component_c0,5),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.tabs=_t.first)}},standalone:!0,features:[core.aNF],decls:26,vars:26,consts:[["tabs","ngbNav"],[1,"container","mt-2"],[1,"row"],[1,"col-12"],["id","item-name",3,"innerHTML"],["ngbNav","",1,"nav-tabs",3,"navChange","destroyOnHide"],["role","presentation","data-test","browseTab",3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],["role","presentation","data-test","mapTab",3,"ngbNavItem"],[3,"ngbNavOutlet"],[1,"mt-2"],[1,"mt-2",3,"confirm","cancel","key","dsoRD$","paginationOptions","confirmButton","cancelButton","dangerConfirm"],[1,"row","mt-2"],[1,"col-12","col-lg-6"],["id","search-form",3,"submitSearch","query","currentUrl","inPlaceSearch","searchPlaceholder"],["role","alert",1,"alert","alert-info","w-100"],[1,"mt-2",3,"confirm","cancel","key","dsoRD$","paginationOptions","sortOptions","confirmButton","cancelButton"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.nrm(6,"p",4),core.nI1(7,"async"),core.nI1(8,"translate"),core.j41(9,"p"),core.EFF(10),core.nI1(11,"translate"),core.k0s(),core.j41(12,"ul",5,0),core.bIt("navChange",function($event){return core.eBV(_r1),core.Njj(ctx.tabChange($event))}),core.j41(14,"li",6)(15,"a",7),core.EFF(16),core.nI1(17,"translate"),core.k0s(),core.DNE(18,ItemCollectionMapperComponent_ng_template_18_Template,3,8,"ng-template",8),core.k0s(),core.j41(19,"li",9),core.nI1(20,"dsBrowserOnly"),core.j41(21,"a",7),core.EFF(22),core.nI1(23,"translate"),core.k0s(),core.DNE(24,ItemCollectionMapperComponent_ng_template_24_Template,7,10,"ng-template",8),core.k0s()(),core.nrm(25,"div",10),core.k0s()()()}if(2&rf){const tabs_r6=core.sdS(13);core.R7$(4),core.JRh(core.bMT(5,9,"item.edit.item-mapper.head")),core.R7$(2),core.Y8G("innerHTML",core.i5U(8,13,"item.edit.item-mapper.item",core.eq3(24,item_collection_mapper_component_c1,core.bMT(7,11,ctx.itemName$))),core.npT),core.R7$(4),core.JRh(core.bMT(11,16,"item.edit.item-mapper.description")),core.R7$(2),core.Y8G("destroyOnHide",!0),core.R7$(2),core.Y8G("ngbNavItem","browseTab"),core.R7$(2),core.JRh(core.bMT(17,18,"item.edit.item-mapper.tabs.browse")),core.R7$(3),core.Y8G("ngbNavItem",core.bMT(20,20,"mapTab")),core.R7$(3),core.JRh(core.bMT(23,22,"item.edit.item-mapper.tabs.map")),core.R7$(3),core.Y8G("ngbNavOutlet",tabs_r6)}},dependencies:[common.Jj,browser_only_pipe.L,CollectionSelectComponent,ng_bootstrap.Pv,ng_bootstrap.Um,ng_bootstrap.X9,ng_bootstrap.sy,ng_bootstrap.Ri,ng_bootstrap.m_,themed_search_form_component.d,ngx_translate_core.h,ngx_translate_core.D9],data:{animation:[fade.qG,fade.Ws]},changeDetection:0})}}return ItemCollectionMapperComponent2})();var curation_form_component=__webpack_require__(80607);const item_curate_component_c0=a0=>({item:a0});function ItemCurateComponent_Conditional_5_Template(rf,ctx){1&rf&&core.nrm(0,"ds-curation-form",1),2&rf&&core.Y8G("dsoHandle",null==ctx?null:ctx.payload.handle)}let ItemCurateComponent=(()=>{class ItemCurateComponent2{constructor(route,dsoNameService){this.route=route,this.dsoNameService=dsoNameService}ngOnInit(){this.dsoRD$=this.route.parent.data.pipe((0,operators.s)(1),(0,operators.Tj)(data=>data.dso)),this.itemName$=this.dsoRD$.pipe((0,operators.pb)(rd=>(0,empty_util.a4)(rd)),(0,operators.Tj)(rd=>this.dsoNameService.getName(rd.payload)))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemCurateComponent2)(core.rXU(router.nX),core.rXU(dso_name_service.f))}}static{this.\u0275cmp=core.VBU({type:ItemCurateComponent2,selectors:[["ds-item-curate"]],standalone:!0,features:[core.aNF],decls:7,vars:11,consts:[[1,"container","mt-3"],[3,"dsoHandle"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",0)(1,"h2"),core.EFF(2),core.nI1(3,"async"),core.nI1(4,"translate"),core.k0s(),core.DNE(5,ItemCurateComponent_Conditional_5_Template,1,1,"ds-curation-form",1),core.nI1(6,"async"),core.k0s()),2&rf){let tmp_1_0;core.R7$(2),core.JRh(core.i5U(4,4,"item.edit.curate.title",core.eq3(9,item_curate_component_c0,core.bMT(3,2,ctx.itemName$)))),core.R7$(3),core.vxM((tmp_1_0=core.bMT(6,7,ctx.dsoRD$))?5:-1,tmp_1_0)}},dependencies:[common.Jj,curation_form_component.X,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return ItemCurateComponent2})();var entity_type_data_service=__webpack_require__(62744),relationship_data_service=__webpack_require__(31158),view_mode_model=__webpack_require__(18839),listable_object_component_loader_component=__webpack_require__(90690),modify_item_overview_component=__webpack_require__(6324);const abstract_simple_item_action_component_c0=a0=>({id:a0}),abstract_simple_item_action_component_c1=a0=>[a0,"edit"];let AbstractSimpleItemActionComponent=(()=>{class AbstractSimpleItemActionComponent2{constructor(route,router2,notificationsService,itemDataService,translateService){this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService}ngOnInit(){this.itemRD$=this.route.data.pipe((0,operators.Tj)(data=>data.dso),(0,shared_operators.yd)()),this.itemRD$.pipe((0,operators.$1)()).subscribe(rd=>{this.item=rd.payload,this.itemPageRoute=(0,item_page_routing_paths._o)(this.item)}),this.confirmMessage="item.edit."+this.messageKey+".confirm",this.cancelMessage="item.edit."+this.messageKey+".cancel",this.headerMessage="item.edit."+this.messageKey+".header",this.descriptionMessage="item.edit."+this.messageKey+".description"}performAction(){}processRestResponse(response){var predicate;response.hasSucceeded?this.itemDataService.findById(this.item.id).pipe((predicate=itemRd=>this.predicate(itemRd),source=>source.pipe((0,shared_operators.v7)(),(0,operators.$1)(predicate)))).subscribe(()=>{this.notificationsService.success(this.translateService.get("item.edit."+this.messageKey+".success")),this.router.navigate([(0,item_page_routing_paths.$r)(this.item)])}):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([(0,item_page_routing_paths.$r)(this.item)]))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||AbstractSimpleItemActionComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))}}static{this.\u0275cmp=core.VBU({type:AbstractSimpleItemActionComponent2,selectors:[["ds-simple-action"]],standalone:!0,features:[core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,abstract_simple_item_action_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,abstract_simple_item_action_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return AbstractSimpleItemActionComponent2})();const _forTrack0=($index,$item)=>$item.relationship.id,item_delete_component_c0=a0=>({id:a0}),item_delete_component_c1=a0=>[a0,"edit"];function ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_Conditional_1_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-listable-object-component-loader",16),2&rf){const relatedItem_r6=core.XpG().ngVar,ctx_r3=core.XpG(5);core.Y8G("object",relatedItem_r6)("viewMode",ctx_r3.viewMode)}}function ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_ng_template_6_Conditional_6_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-listable-object-component-loader",16),2&rf){const relatedItem_r6=core.XpG(2).ngVar,ctx_r3=core.XpG(5);core.Y8G("object",relatedItem_r6)("viewMode",ctx_r3.viewMode)}}function ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_ng_template_6_For_8_Template(rf,ctx){if(1&rf&&(core.j41(0,"div")(1,"div")(2,"div",25),core.EFF(3),core.k0s(),core.j41(4,"div"),core.EFF(5),core.k0s()()()),2&rf){const metadata_r9=ctx.$implicit;core.R7$(3),core.SpI(" ",metadata_r9.metadataField," "),core.R7$(2),core.SpI(" ",metadata_r9.metadataValue.value," ")}}function ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_ng_template_6_Template(rf,ctx){if(1&rf){const _r8=core.RV6();core.j41(0,"div",21)(1,"div",22),core.EFF(2),core.nI1(3,"translate"),core.j41(4,"button",23),core.bIt("click",function(){core.eBV(_r8);const ctx_r3=core.XpG(6);return core.Njj(ctx_r3.closeVirtualMetadataModal())}),core.k0s()(),core.j41(5,"div",24),core.DNE(6,ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_ng_template_6_Conditional_6_Template,1,2,"ds-listable-object-component-loader",16),core.Z7z(7,ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_ng_template_6_For_8_Template,6,2,"div",null,core.fX1),core.nI1(9,"async"),core.k0s()()}if(2&rf){const relatedItem_r6=core.XpG().ngVar,relationshipDto_r10=core.XpG().$implicit;core.R7$(2),core.SpI(" ",core.bMT(3,2,"virtual-metadata.delete-item.modal-head")," "),core.R7$(4),core.vxM(relatedItem_r6?6:-1),core.R7$(),core.Dyx(core.bMT(9,4,relationshipDto_r10.virtualMetadata$))}}function ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.qex(0),core.DNE(1,ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_Conditional_1_Template,1,2,"ds-listable-object-component-loader",16),core.j41(2,"div",17)(3,"div",18)(4,"button",19),core.bIt("click",function(){core.eBV(_r5);const virtualMetadataModal_r7=core.sdS(7),ctx_r3=core.XpG(5);return core.Njj(ctx_r3.openVirtualMetadataModal(virtualMetadataModal_r7))}),core.nrm(5,"i",20),core.k0s()()(),core.DNE(6,ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_ng_template_6_Template,10,6,"ng-template",null,0,core.C5r),core.bVm()}if(2&rf){const relatedItem_r6=ctx.ngVar;core.R7$(),core.vxM(relatedItem_r6?1:-1)}}function ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",10),core.DNE(1,ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_ng_container_1_Template,8,1,"ng-container",15),core.nI1(2,"async"),core.k0s()),2&rf){const relationshipDto_r10=ctx.$implicit;core.R7$(),core.Y8G("ngVar",core.bMT(2,1,relationshipDto_r10.relatedItem$))}}function ItemDeleteComponent_Conditional_11_For_4_div_1_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",10)(1,"div",11),core.bIt("click",function(){const selected_r2=core.eBV(_r1).ngVar,typeDto_r3=core.XpG().$implicit,ctx_r3=core.XpG(2);return core.Njj(ctx_r3.setSelected(typeDto_r3.relationshipType,!selected_r2))}),core.j41(2,"label"),core.nrm(3,"input",12),core.nI1(4,"async"),core.k0s()(),core.j41(5,"div",13)(6,"h5",14),core.bIt("click",function(){const selected_r2=core.eBV(_r1).ngVar,typeDto_r3=core.XpG().$implicit,ctx_r3=core.XpG(2);return core.Njj(ctx_r3.setSelected(typeDto_r3.relationshipType,!selected_r2))}),core.EFF(7),core.nI1(8,"async"),core.nI1(9,"translate"),core.k0s(),core.Z7z(10,ItemDeleteComponent_Conditional_11_For_4_div_1_For_11_Template,3,3,"div",10,_forTrack0),core.nI1(12,"async"),core.k0s()()}if(2&rf){const selected_r2=ctx.ngVar,typeDto_r3=core.XpG().$implicit,ctx_r3=core.XpG(2);core.R7$(3),core.Y8G("checked",selected_r2)("disabled",core.bMT(4,3,ctx_r3.isDeleting$)),core.R7$(4),core.SpI(" ",core.bMT(9,7,ctx_r3.getRelationshipMessageKey(core.bMT(8,5,typeDto_r3.label$)))," "),core.R7$(3),core.Dyx(core.bMT(12,9,typeDto_r3.relationshipDTOs$))}}function ItemDeleteComponent_Conditional_11_For_4_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",5),core.DNE(1,ItemDeleteComponent_Conditional_11_For_4_div_1_Template,13,11,"div",9),core.nI1(2,"async"),core.k0s()),2&rf){const typeDto_r3=ctx.$implicit;core.R7$(),core.Y8G("ngVar",core.bMT(2,1,typeDto_r3.isSelected$))}}function ItemDeleteComponent_Conditional_11_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",5),core.EFF(1),core.nI1(2,"translate"),core.Z7z(3,ItemDeleteComponent_Conditional_11_For_4_Template,3,3,"div",5,core.fX1),core.nI1(5,"async"),core.k0s()),2&rf){const ctx_r3=core.XpG();core.R7$(),core.SpI(" ",core.bMT(2,1,"virtual-metadata.delete-item.info")," "),core.R7$(2),core.Dyx(core.bMT(5,3,ctx_r3.typeDTOs$))}}class RelationshipTypeDTO{}class RelationshipDTO{}let ItemDeleteComponent=(()=>{class ItemDeleteComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService,modalService,objectUpdatesService,relationshipService,entityTypeService,linkService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.modalService=modalService,this.objectUpdatesService=objectUpdatesService,this.relationshipService=relationshipService,this.entityTypeService=entityTypeService,this.linkService=linkService,this.messageKey="delete",this.viewMode=view_mode_model.n.ListElement,this.typeDTOs$=new cjs.BehaviorSubject([]),this.relationships$=new Map,this.relatedItems$=new Map,this.virtualMetadata$=new Map,this.subs=[],this.isDeleting$=new cjs.BehaviorSubject(!1)}ngOnInit(){super.ngOnInit(),this.url=this.router.url;const label=this.item.firstMetadataValue("dspace.entity.type");(0,empty_util.hj)(label)&&this.subs.push(this.entityTypeService.getEntityTypeByLabel(label).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.nx)(entityType=>this.entityTypeService.getEntityTypeRelationships(entityType.id)),(0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.Tj)(relationshipTypes=>relationshipTypes.page),(0,operators.nx)(types=>0===types.length?(0,cjs.of)(types):(0,cjs.combineLatest)(types.map(type=>this.getRelationships(type))).pipe((0,operators.Tj)(relationships=>types.reduce((includedTypes,type,index)=>includedTypes.some(includedType=>includedType.id===type.id)||0===relationships[index].length?includedTypes:[...includedTypes,type],[]))))).subscribe(types=>this.typeDTOs$.next(types.map(relationshipType=>Object.assign(new RelationshipTypeDTO,{relationshipType,isSelected$:this.isSelected(relationshipType),label$:this.getLabel(relationshipType),relationshipDTOs$:this.getRelationships(relationshipType).pipe((0,operators.Tj)(relationships=>relationships.map(relationship=>Object.assign(new RelationshipDTO,{relationship,relatedItem$:this.getRelatedItem(relationship),virtualMetadata$:this.getVirtualMetadata(relationship)}))))}))))),this.subs.push(this.typeDTOs$.pipe((0,operators.s)(1)).subscribe(types=>this.objectUpdatesService.initialize(this.url,types.map(relationshipTypeDto=>relationshipTypeDto.relationshipType),this.item.lastModified)))}openVirtualMetadataModal(content){this.modalRef=this.modalService.open(content)}closeVirtualMetadataModal(){this.modalRef.close()}getRelationshipMessageKey(label){return(0,empty_util.a4)(label)&&label.indexOf("Of")>-1?`relationships.${label.substring(0,label.indexOf("Of")+2)}`:label}getLabel(relationshipType){return this.getRelationships(relationshipType).pipe((0,operators.nx)(relationships=>this.isLeftItem(relationships[0]).pipe((0,operators.Tj)(isLeftItem=>isLeftItem?relationshipType.leftwardType:relationshipType.rightwardType))))}getRelationships(relationshipType){return this.relationships$.has(relationshipType)||this.relationships$.set(relationshipType,this.relationshipService.getItemRelationshipsArray(this.item).pipe((0,operators.nx)(relationships=>(0,cjs.combineLatest)(relationships.map(relationship=>this.getRelationshipType(relationship))).pipe((0,operators.US)([]),(0,operators.Tj)(types=>relationships.filter((relationship,index)=>relationshipType.id===types[index].id)))))),this.relationships$.get(relationshipType)}getRelationshipType(relationship){return this.linkService.resolveLinks(relationship,(0,follow_link_config_model.s)("relationshipType"),(0,follow_link_config_model.s)("leftItem",void 0,(0,follow_link_config_model.s)("accessStatus")),(0,follow_link_config_model.s)("rightItem",void 0,(0,follow_link_config_model.s)("accessStatus"))),relationship.relationshipType.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.pb)(relationshipType=>(0,empty_util.a4)(relationshipType)&&(0,empty_util.hj)(relationshipType.uuid)))}getRelatedItem(relationship){return this.relatedItems$.has(relationship)||this.relatedItems$.set(relationship,this.isLeftItem(relationship).pipe((0,operators.nx)(isLeftItem=>isLeftItem?relationship.rightItem:relationship.leftItem),(0,shared_operators.yd)(),(0,shared_operators.Bo)())),this.relatedItems$.get(relationship)}getVirtualMetadata(relationship){return this.virtualMetadata$.has(relationship)||this.virtualMetadata$.set(relationship,this.getRelatedItem(relationship).pipe((0,operators.Tj)(relatedItem=>Object.entries(relatedItem.metadata).map(([key,value])=>value.filter(metadata=>metadata.authority&&metadata.authority.endsWith(relationship.id)).map(metadata=>({metadataField:key,metadataValue:metadata}))).reduce((previous,current)=>previous.concat(current))))),this.virtualMetadata$.get(relationship)}isLeftItem(relationship){return relationship.leftItem.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.pb)(item=>(0,empty_util.a4)(item)&&(0,empty_util.hj)(item.uuid)),(0,operators.Tj)(leftItem=>leftItem.uuid===this.item.uuid))}isSelected(type){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.item.uuid,type.uuid)}setSelected(type,selected){!1===this.isDeleting$.value&&this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.item.uuid,type.uuid,selected)}performAction(){this.isDeleting$.next(!0),this.subs.push(this.typeDTOs$.pipe((0,operators.nx)(types=>(0,cjs.combineLatest)(types.map(type=>type.isSelected$)).pipe((0,operators.US)([]),(0,operators.Tj)(selection=>types.filter((type,index)=>selection[index])),(0,operators.Tj)(selectedDtoTypes=>selectedDtoTypes.map(typeDto=>typeDto.relationshipType.id)))),(0,operators.nx)(types=>this.itemDataService.delete(this.item.id,types)),(0,shared_operators.qD)()).subscribe(rd=>{this.notify(rd.hasSucceeded)}))}notify(succeeded){succeeded?(this.notificationsService.success(this.translateService.get("item.edit."+this.messageKey+".success")),this.router.navigate([""])):(this.notificationsService.error(this.translateService.get("item.edit."+this.messageKey+".error")),this.router.navigate([(0,item_page_routing_paths.$r)(this.item)]))}ngOnDestroy(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemDeleteComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$),core.rXU(ng_bootstrap.Bq),core.rXU(object_updates_service.F),core.rXU(relationship_data_service.RelationshipDataService),core.rXU(entity_type_data_service.f),core.rXU(link_service._))}}static{this.\u0275cmp=core.VBU({type:ItemDeleteComponent2,selectors:[["ds-item-delete"]],inputs:{url:"url"},standalone:!0,features:[core.Vt3,core.aNF],decls:23,vars:30,consts:[["virtualMetadataModal",""],[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"mb-4"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click","dsBtnDisabled"],[1,"btn","btn-outline-secondary","cancel",3,"dsBtnDisabled","routerLink"],["class","d-flex flex-row",4,"ngVar"],[1,"d-flex","flex-row"],[1,"m-2",3,"click"],["type","checkbox",3,"checked","disabled"],[1,"flex-column","flex-grow-1"],[3,"click"],[4,"ngVar"],[3,"object","viewMode"],[1,"ms-auto"],[1,"btn-group"],[1,"btn","btn-outline-info","btn-sm",3,"click"],[1,"fas","fa-info","fa-fw"],[1,"thumb-font-1"],[1,"modal-header"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"fw-bold"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",4),core.qex(10),core.DNE(11,ItemDeleteComponent_Conditional_11_Template,6,5,"div",5),core.nI1(12,"async"),core.nI1(13,"async"),core.bVm(),core.j41(14,"div",6)(15,"button",7),core.nI1(16,"async"),core.bIt("click",function(){return ctx.performAction()}),core.EFF(17),core.nI1(18,"translate"),core.k0s(),core.j41(19,"button",8),core.nI1(20,"async"),core.EFF(21),core.nI1(22,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,9,ctx.headerMessage,core.eq3(26,item_delete_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,12,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(2),core.vxM(core.bMT(12,14,ctx.typeDTOs$)&&core.bMT(13,16,ctx.typeDTOs$).length>0?11:-1),core.R7$(4),core.Y8G("dsBtnDisabled",core.bMT(16,18,ctx.isDeleting$)),core.R7$(2),core.SpI("",core.bMT(18,20,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("dsBtnDisabled",core.bMT(20,22,ctx.isDeleting$))("routerLink",core.eq3(28,item_delete_component_c1,ctx.itemPageRoute)),core.R7$(2),core.SpI(" ",core.bMT(22,24,ctx.cancelMessage)," "))},dependencies:[common.Jj,btn_disabled_directive.A,listable_object_component_loader_component.v,modify_item_overview_component.W,router.Wk,ngx_translate_core.h,ngx_translate_core.D9,var_directive.r],encapsulation:2})}}return ItemDeleteComponent2})();var authorized_collection_selector_component=__webpack_require__(26477);const item_move_component_c0=a0=>({id:a0}),item_move_component_c1=a0=>({type:a0}),item_move_component_c2=a0=>[a0,"edit"];function ItemMoveComponent_ng_template_24_Template(rf,ctx){1&rf&&(core.EFF(0),core.nI1(1,"translate")),2&rf&&core.SpI(" ",core.bMT(1,1,"item.edit.move.inheritpolicies.tooltip")," ")}function ItemMoveComponent_Conditional_40_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",17),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"item.edit.move.save-button")," "))}function ItemMoveComponent_Conditional_41_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",18),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"item.edit.move.processing")," "))}let ItemMoveComponent=(()=>{class ItemMoveComponent2{constructor(route,router2,notificationsService,itemDataService,searchService,translateService,requestService,dsoNameService){this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.searchService=searchService,this.translateService=translateService,this.requestService=requestService,this.dsoNameService=dsoNameService,this.selectorType=dspace_object_type_model.W.COLLECTION,this.inheritPolicies=!1,this.canSubmit=!1,this.processing=!1,this.COLLECTIONS=[dspace_object_type_model.W.COLLECTION]}ngOnInit(){this.itemRD$=this.route.data.pipe((0,operators.Tj)(data=>data.dso),(0,shared_operators.yd)()),this.itemPageRoute$=this.itemRD$.pipe((0,shared_operators.Hz)(),(0,operators.Tj)(item=>(0,item_page_routing_paths._o)(item))),this.itemRD$.subscribe(rd=>{this.item=rd.payload}),this.itemRD$.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.nx)(item=>item.owningCollection),(0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(collection=>{this.originalCollection=collection})}selectDso(data){this.selectedCollection=data,this.selectedCollectionName=this.dsoNameService.getName(data),this.canSubmit=!0}getCurrentUrl(){return this.router.url}moveToCollection(){this.processing=!0;const move$=this.itemDataService.moveToCollection(this.item.id,this.selectedCollection,this.inheritPolicies).pipe((0,shared_operators.qD)());move$.subscribe(response=>{response.hasSucceeded?this.notificationsService.success(this.translateService.get("item.edit.move.success")):this.notificationsService.error(this.translateService.get("item.edit.move.error"))}),move$.pipe((0,operators.nx)(()=>this.requestService.setStaleByHrefSubstring(this.item.id)),(0,operators.nx)(()=>this.itemDataService.findById(this.item.id,!1,!0,(0,follow_link_config_model.s)("owningCollection"))),(0,shared_operators.qD)()).subscribe(()=>{this.processing=!1,this.router.navigate([(0,item_page_routing_paths.$r)(this.item)])})}discard(){this.selectedCollection=null,this.canSubmit=!1}get canMove(){return this.canSubmit&&this.selectedCollection?.id!==this.originalCollection.id}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemMoveComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(search_service.S),core.rXU(ngx_translate_core.c$),core.rXU(request_service.B),core.rXU(dso_name_service.f))}}static{this.\u0275cmp=core.VBU({type:ItemMoveComponent2,selectors:[["ds-item-move"]],standalone:!0,features:[core.aNF],decls:46,vars:44,consts:[["tooltipContent",""],[1,"container"],[1,"row"],[1,"col-12"],[1,"card","mb-3"],[1,"card-header"],[1,"card-body"],[3,"onSelect","types","currentDSOId"],["for","inheritPoliciesCheckbox",1,"form-label"],["type","checkbox","name","tc","id","inheritPoliciesCheckbox",3,"ngModelChange","ngModel","ngbTooltip"],[1,"button-row","bottom"],[1,"float-end","space-children-mr"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left"],[1,"btn","btn-primary",3,"click","dsBtnDisabled"],[1,"btn","btn-danger",3,"click","dsBtnDisabled"],[1,"fas","fa-times"],[1,"fas","fa-save"],[1,"fas","fa-circle-notch","fa-spin"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1"),core.EFF(4),core.nI1(5,"async"),core.nI1(6,"translate"),core.k0s(),core.j41(7,"p"),core.EFF(8),core.nI1(9,"translate"),core.k0s(),core.j41(10,"div",2)(11,"div",3)(12,"div",4)(13,"div",5),core.EFF(14),core.nI1(15,"translate"),core.nI1(16,"translate"),core.k0s(),core.j41(17,"div",6)(18,"ds-authorized-collection-selector",7),core.bIt("onSelect",function($event){return core.eBV(_r1),core.Njj(ctx.selectDso($event))}),core.k0s()(),core.nrm(19,"div"),core.k0s()()(),core.j41(20,"div",2)(21,"div",3)(22,"p")(23,"label",8),core.DNE(24,ItemMoveComponent_ng_template_24_Template,2,3,"ng-template",null,0,core.C5r),core.j41(26,"input",9),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.inheritPolicies,$event)||(ctx.inheritPolicies=$event),core.Njj($event)}),core.k0s(),core.EFF(27),core.nI1(28,"translate"),core.k0s()(),core.j41(29,"p"),core.EFF(30),core.nI1(31,"translate"),core.k0s()()(),core.j41(32,"div",10)(33,"div",11)(34,"button",12),core.nI1(35,"async"),core.nrm(36,"i",13),core.EFF(37),core.nI1(38,"translate"),core.k0s(),core.j41(39,"button",14),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.moveToCollection())}),core.DNE(40,ItemMoveComponent_Conditional_40_Template,4,3,"span")(41,ItemMoveComponent_Conditional_41_Template,4,3,"span"),core.k0s(),core.j41(42,"button",15),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.discard())}),core.nrm(43,"i",16),core.EFF(44),core.nI1(45,"translate"),core.k0s()()()()()()}if(2&rf){let tmp_1_0;const tooltipContent_r2=core.sdS(25);core.R7$(4),core.JRh(core.i5U(6,18,"item.edit.move.head",core.eq3(38,item_move_component_c0,null==(tmp_1_0=core.bMT(5,16,ctx.itemRD$))||null==tmp_1_0.payload?null:tmp_1_0.payload.handle))),core.R7$(4),core.JRh(core.bMT(9,21,"item.edit.move.description")),core.R7$(6),core.JRh(core.i5U(16,25,"dso-selector.placeholder",core.eq3(40,item_move_component_c1,core.bMT(15,23,"dso-selector.placeholder.type.collection")))),core.R7$(4),core.Y8G("types",ctx.COLLECTIONS)("currentDSOId",ctx.selectedCollection?ctx.selectedCollection.id:ctx.originalCollection.id),core.R7$(8),core.R50("ngModel",ctx.inheritPolicies),core.Y8G("ngbTooltip",tooltipContent_r2),core.R7$(),core.SpI(" ",core.bMT(28,28,"item.edit.move.inheritpolicies.checkbox")," "),core.R7$(3),core.SpI(" ",core.bMT(31,30,"item.edit.move.inheritpolicies.description")," "),core.R7$(4),core.Y8G("routerLink",core.eq3(42,item_move_component_c2,core.bMT(35,32,ctx.itemPageRoute$))),core.R7$(3),core.SpI(" ",core.bMT(38,34,"item.edit.move.cancel")," "),core.R7$(2),core.Y8G("dsBtnDisabled",!ctx.canMove),core.R7$(),core.vxM(ctx.processing?-1:40),core.R7$(),core.vxM(ctx.processing?41:-1),core.R7$(),core.Y8G("dsBtnDisabled",!ctx.canSubmit),core.R7$(2),core.SpI(" ",core.bMT(45,36,"item.edit.move.discard-button")," ")}},dependencies:[common.Jj,authorized_collection_selector_component.e,btn_disabled_directive.A,fesm2022_forms.YN,fesm2022_forms.Zm,fesm2022_forms.BC,fesm2022_forms.vS,ng_bootstrap.UN,ng_bootstrap.md,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return ItemMoveComponent2})();var dso_page_single_feature_guard=__webpack_require__(47339),feature_id=__webpack_require__(86583),item_page_resolver=__webpack_require__(88136);const itemPageAccessControlGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.AdministratorOf)),itemPageBitstreamsGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManageBitstreamBundles)),itemPageCollectionMapperGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManageMappings)),itemPageCurateGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.AdministratorOf)),itemPageDeleteGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanDelete)),itemPageEditAuthorizationsGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManagePolicies)),itemPageMetadataGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanEditMetadata)),itemPageMoveGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanMove)),itemPagePrivateGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanMakePrivate)),itemPageRegisterDoiGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanRegisterDOI)),itemPageReinstateGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.ReinstateItem)),itemPageRelationshipsGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManageRelationships)),itemPageStatusGuard=(0,__webpack_require__(48827).FO)(()=>item_page_resolver.Z,()=>(0,cjs.of)([feature_id._.CanManageMappings,feature_id._.WithdrawItem,feature_id._.ReinstateItem,feature_id._.CanManagePolicies,feature_id._.CanMakePrivate,feature_id._.CanDelete,feature_id._.CanMove,feature_id._.CanRegisterDOI])),itemPageVersionHistoryGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.CanManageVersions)),itemPageWithdrawGuard=(0,dso_page_single_feature_guard.L)(()=>item_page_resolver.Z,()=>(0,cjs.of)(feature_id._.WithdrawItem)),item_private_component_c0=a0=>({id:a0}),item_private_component_c1=a0=>[a0,"edit"];let ItemPrivateComponent=(()=>{class ItemPrivateComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.messageKey="private",this.predicate=rd=>!rd.payload.isDiscoverable}performAction(){this.itemDataService.setDiscoverable(this.item,!1).pipe((0,shared_operators.qD)()).subscribe(rd=>{this.processRestResponse(rd)})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemPrivateComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))}}static{this.\u0275cmp=core.VBU({type:ItemPrivateComponent2,selectors:[["ds-item-private"]],standalone:!0,features:[core.Vt3,core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,item_private_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,item_private_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return ItemPrivateComponent2})();const item_public_component_c0=a0=>({id:a0}),item_public_component_c1=a0=>[a0,"edit"];let ItemPublicComponent=(()=>{class ItemPublicComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.messageKey="public",this.predicate=rd=>rd.payload.isDiscoverable}performAction(){this.itemDataService.setDiscoverable(this.item,!0).pipe((0,shared_operators.qD)()).subscribe(response=>{this.processRestResponse(response)})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemPublicComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))}}static{this.\u0275cmp=core.VBU({type:ItemPublicComponent2,selectors:[["ds-item-public"]],standalone:!0,features:[core.Vt3,core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,item_public_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,item_public_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return ItemPublicComponent2})();var identifier_data_service=__webpack_require__(71309);const item_register_doi_component_c0=a0=>({id:a0}),item_register_doi_component_c1=a0=>[a0,"edit"];function ItemRegisterDoiComponent_For_10_Conditional_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"div")(1,"p",8),core.EFF(2),core.nI1(3,"translate"),core.nI1(4,"translate"),core.k0s()()),2&rf){const identifier_r1=core.XpG().$implicit,ctx_r1=core.XpG();core.R7$(2),core.E5c("",core.bMT(3,3,ctx_r1.doiToUpdateMessage),": ",identifier_r1.value," (",core.bMT(4,5,"item.edit.identifiers.doi.status."+identifier_r1.identifierStatus),") ")}}function ItemRegisterDoiComponent_For_10_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",3),core.DNE(1,ItemRegisterDoiComponent_For_10_Conditional_1_Template,5,7,"div"),core.k0s()),2&rf){const identifier_r1=ctx.$implicit;core.R7$(),core.vxM("doi"===identifier_r1.identifierType?1:-1)}}let ItemRegisterDoiComponent=(()=>{class ItemRegisterDoiComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService,identifierDataService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.identifierDataService=identifierDataService,this.messageKey="register-doi",this.doiToUpdateMessage="item.edit."+this.messageKey+".to-update",this.processing=!1}ngOnInit(){this.itemRD$=this.route.data.pipe((0,operators.Tj)(data=>data.dso),(0,shared_operators.yd)()),this.itemRD$.pipe((0,operators.$1)()).subscribe(rd=>{this.item=rd.payload,this.itemPageRoute=(0,item_page_routing_paths._o)(this.item),this.identifiers$=this.identifierDataService.getIdentifierDataFor(this.item).pipe((0,operators.Tj)(identifierRD=>401!==identifierRD.statusCode&&(0,empty_util.a4)(identifierRD.payload)?identifierRD.payload.identifiers:null))}),this.confirmMessage="item.edit."+this.messageKey+".confirm",this.cancelMessage="item.edit."+this.messageKey+".cancel",this.headerMessage="item.edit."+this.messageKey+".header",this.descriptionMessage="item.edit."+this.messageKey+".description"}performAction(){this.registerDoi()}registerDoi(){this.processing=!0,this.identifierDataService.registerIdentifier(this.item,"doi").subscribe(response=>{response.hasCompleted&&(this.processing=!1,this.processRestResponse(response))})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemRegisterDoiComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$),core.rXU(identifier_data_service.IdentifierDataService))}}static{this.\u0275cmp=core.VBU({type:ItemRegisterDoiComponent2,selectors:[["ds-item-register-doi"]],standalone:!0,features:[core.Vt3,core.aNF],decls:20,vars:21,consts:[[1,"container"],[1,"row"],[1,"col-12"],[1,"w-100","p"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"],[1,"float-start"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.Z7z(9,ItemRegisterDoiComponent_For_10_Template,2,1,"div",3,core.fX1),core.nI1(11,"async"),core.nrm(12,"ds-modify-item-overview",4),core.j41(13,"div",5)(14,"button",6),core.bIt("click",function(){return ctx.performAction()}),core.EFF(15),core.nI1(16,"translate"),core.k0s(),core.j41(17,"button",7),core.EFF(18),core.nI1(19,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(17,item_register_doi_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Dyx(core.bMT(11,11,ctx.identifiers$)),core.R7$(3),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(16,13,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(19,item_register_doi_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(19,15,ctx.cancelMessage)," "))},dependencies:[common.Jj,modify_item_overview_component.W,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return ItemRegisterDoiComponent2})();const item_reinstate_component_c0=a0=>({id:a0}),item_reinstate_component_c1=a0=>[a0,"edit"];let ItemReinstateComponent=(()=>{class ItemReinstateComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.messageKey="reinstate",this.predicate=rd=>!rd.payload.isWithdrawn}performAction(){this.itemDataService.setWithDrawn(this.item,!1).pipe((0,shared_operators.qD)()).subscribe(response=>{this.processRestResponse(response)})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemReinstateComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))}}static{this.\u0275cmp=core.VBU({type:ItemReinstateComponent2,selectors:[["ds-item-reinstate"]],standalone:!0,features:[core.Vt3,core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,item_reinstate_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,item_reinstate_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return ItemReinstateComponent2})();var relationship_type_data_service=__webpack_require__(28769),item_relationships_utils=__webpack_require__(27059);let EditItemRelationshipsService=(()=>{class EditItemRelationshipsService2{constructor(itemService,objectUpdatesService,notificationsService,modalService,relationshipService,entityTypeService,translateService){this.itemService=itemService,this.objectUpdatesService=objectUpdatesService,this.notificationsService=notificationsService,this.modalService=modalService,this.relationshipService=relationshipService,this.entityTypeService=entityTypeService,this.translateService=translateService,this.notificationsPrefix="item.edit.relationships.notifications.",this.isSaving$=new cjs.BehaviorSubject(!1)}submit(item,url){this.isSaving$.next(!0),this.objectUpdatesService.getFieldUpdates(url,[],!0).pipe((0,operators.Tj)(fieldUpdates=>Object.values(fieldUpdates).filter(fieldUpdate=>(0,empty_util.a4)(fieldUpdate)).filter(fieldUpdate=>fieldUpdate.changeType===field_change_type_model.B.ADD||fieldUpdate.changeType===field_change_type_model.B.REMOVE)),(0,operators.s)(1),(0,operators.nx)(updates=>updates),(0,operators.Hh)(update=>update.changeType===field_change_type_model.B.REMOVE?this.deleteRelationship(update.field).pipe((0,operators.s)(1),(0,operators.nx)(deleteRD=>deleteRD.hasSucceeded?this.itemService.invalidateByHref(update.field.relatedItem._links.self.href).pipe((0,operators.Tj)(()=>deleteRD)):[deleteRD])):update.changeType===field_change_type_model.B.ADD?this.addRelationship(update.field).pipe((0,operators.s)(1),(0,operators.nx)(relationshipRD=>{if(relationshipRD.hasSucceeded){const{leftItem,rightItem}=relationshipRD.payload._links;return leftItem.href===item.self?this.itemService.invalidateByHref(rightItem.href).pipe((0,operators.Tj)(()=>relationshipRD)):this.itemService.invalidateByHref(leftItem.href).pipe((0,operators.Tj)(()=>relationshipRD))}return[relationshipRD]})):cjs.EMPTY),(0,operators.$r)(),(0,operators.nx)(responses=>this.itemService.invalidateByHref(item.self).pipe((0,operators.Tj)(()=>responses)))).subscribe(responses=>{responses.length>0&&(this.initializeOriginalFields(item,url),this.displayNotifications(responses),this.modalService.dismissAll(),this.isSaving$.next(!1))})}initializeOriginalFields(item,url){return this.relationshipService.getRelatedItems(item).pipe((0,operators.s)(1)).subscribe(items=>{this.objectUpdatesService.initialize(url,items,item.lastModified)})}deleteRelationship(deleteRelationship){let copyVirtualMetadata;return copyVirtualMetadata=deleteRelationship.keepLeftVirtualMetadata&&deleteRelationship.keepRightVirtualMetadata?"all":deleteRelationship.keepLeftVirtualMetadata?"left":deleteRelationship.keepRightVirtualMetadata?"right":"none",this.relationshipService.deleteRelationship(deleteRelationship.uuid,copyVirtualMetadata,!1)}addRelationship(addRelationship){let leftItem,rightItem,leftwardValue,rightwardValue;return addRelationship.originalIsLeft?(leftItem=addRelationship.originalItem,rightItem=addRelationship.relatedItem,leftwardValue=null,rightwardValue=addRelationship.nameVariant):(leftItem=addRelationship.relatedItem,rightItem=addRelationship.originalItem,leftwardValue=addRelationship.nameVariant,rightwardValue=null),this.relationshipService.addRelationship(addRelationship.type.id,leftItem,rightItem,leftwardValue,rightwardValue,!1)}displayNotifications(responses){const failedResponses=responses.filter(response=>response.hasFailed),successfulResponses=responses.filter(response=>response.hasSucceeded);failedResponses.forEach(response=>{this.notificationsService.error(this.getNotificationTitle("failed"),response.errorMessage)}),successfulResponses.length>0&&this.notificationsService.success(this.getNotificationTitle("saved"),this.getNotificationContent("saved"))}isProvidedItemTypeLeftType(relationshipType,itemType,item){return this.getRelationshipLeftAndRightType(relationshipType).pipe((0,operators.Tj)(([leftType,rightType])=>leftType.id===itemType.id||rightType.id!==itemType.id&&void console.warn(`The item ${item.uuid} is not on the right or the left side of relationship type ${relationshipType.uuid}`)))}shouldDisplayBothRelationshipSides(relationshipType,itemType){return this.getRelationshipLeftAndRightType(relationshipType).pipe((0,operators.Tj)(([leftType,rightType])=>leftType.id===itemType.id&&rightType.id===itemType.id&&relationshipType.leftwardType!==relationshipType.rightwardType))}getRelationshipLeftAndRightType(relationshipType){const leftType$=relationshipType.leftType.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()),rightType$=relationshipType.rightType.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)());return(0,cjs.combineLatest)([leftType$,rightType$])}getNotificationTitle(key){return this.translateService.instant(this.notificationsPrefix+key+".title")}getNotificationContent(key){return this.translateService.instant(this.notificationsPrefix+key+".content")}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EditItemRelationshipsService2)(core.KVO(item_data_service.ItemDataService),core.KVO(object_updates_service.F),core.KVO(notifications_service.I),core.KVO(ng_bootstrap.Bq),core.KVO(relationship_data_service.RelationshipDataService),core.KVO(entity_type_data_service.f),core.KVO(ngx_translate_core.c$))}}static{this.\u0275prov=core.jDH({token:EditItemRelationshipsService2,factory:EditItemRelationshipsService2.\u0275fac,providedIn:"root"})}}return EditItemRelationshipsService2})();__webpack_require__(65060),__webpack_require__(51171);var app_config_interface=__webpack_require__(3339),request_param_model=__webpack_require__(99629),dynamic_lookup_relation_modal_component=__webpack_require__(85983),relationship_options_model=__webpack_require__(25375),selectable_list_service=__webpack_require__(85984),relation_query_utils=__webpack_require__(65507);function VirtualMetadataComponent_For_7_div_0_For_7_Template(rf,ctx){if(1&rf&&(core.j41(0,"div")(1,"div",14),core.EFF(2),core.k0s(),core.j41(3,"div"),core.EFF(4),core.k0s()()),2&rf){const metadata_r5=ctx.$implicit;core.R7$(2),core.SpI(" ",metadata_r5.metadataField," "),core.R7$(2),core.SpI(" ",metadata_r5.metadataValue.value," ")}}function VirtualMetadataComponent_For_7_div_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",9),core.bIt("click",function(){const selected_r2=core.eBV(_r1).ngVar,itemDTO_r3=core.XpG().$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.setSelectedVirtualMetadataItem(itemDTO_r3.item,!selected_r2))}),core.j41(1,"div",10)(2,"label"),core.nrm(3,"input",11),core.k0s()(),core.j41(4,"div",12),core.nrm(5,"ds-listable-object-component-loader",13),core.Z7z(6,VirtualMetadataComponent_For_7_div_0_For_7_Template,5,2,"div",null,core.fX1),core.k0s()()}if(2&rf){const selected_r2=ctx.ngVar,itemDTO_r3=core.XpG().$implicit,ctx_r3=core.XpG();core.R7$(3),core.Y8G("checked",selected_r2),core.R7$(2),core.Y8G("object",itemDTO_r3.item),core.R7$(),core.Dyx(ctx_r3.virtualMetadata.get(itemDTO_r3.item.uuid))}}function VirtualMetadataComponent_For_7_Template(rf,ctx){1&rf&&(core.DNE(0,VirtualMetadataComponent_For_7_div_0_Template,8,2,"div",8),core.nI1(1,"async")),2&rf&&core.Y8G("ngVar",core.bMT(1,1,ctx.$implicit.isSelectedVirtualMetadataItem$))}let VirtualMetadataComponent=(()=>{class VirtualMetadataComponent2{constructor(objectUpdatesService,appConfig){this.objectUpdatesService=objectUpdatesService,this.appConfig=appConfig,this.close=new core.bkB,this.save=new core.bkB,this.itemDTOs$=new cjs.BehaviorSubject([]),this.subs=[],this.virtualMetadata=new Map,this.showThumbnails=this.appConfig.browseBy.showThumbnails}getVirtualMetadata(item){return Object.entries(item.metadata).map(([key,value])=>value.filter(metadata=>!key.startsWith("relation")&&metadata.authority&&metadata.authority.endsWith(this.relationshipId)).map(metadata=>({metadataField:key,metadataValue:metadata}))).reduce((previous,current)=>previous.concat(current),[])}setSelectedVirtualMetadataItem(item,selected){this.objectUpdatesService.setSelectedVirtualMetadata(this.url,this.relationshipId,item.uuid,selected)}isSelectedVirtualMetadataItem(item){return this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.relationshipId,item.uuid)}trackItemDTO(index,itemDTO){return itemDTO?.item?.uuid}ngOnInit(){this.subs.push(this.itemDTOs$.subscribe(itemDTOs=>{itemDTOs.forEach(itemDTO=>this.virtualMetadata.set(itemDTO.item.uuid,this.getVirtualMetadata(itemDTO.item)))}))}ngOnChanges(){(0,empty_util.a4)(this.leftItem)&&(0,empty_util.a4)(this.rightItem)&&this.itemDTOs$.next([{item:this.leftItem,isSelectedVirtualMetadataItem$:this.isSelectedVirtualMetadataItem(this.leftItem)},{item:this.rightItem,isSelectedVirtualMetadataItem$:this.isSelectedVirtualMetadataItem(this.rightItem)}])}ngOnDestroy(){this.subs.forEach(sub=>sub.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||VirtualMetadataComponent2)(core.rXU(object_updates_service.F),core.rXU(app_config_interface.vQ))}}static{this.\u0275cmp=core.VBU({type:VirtualMetadataComponent2,selectors:[["ds-virtual-metadata"]],inputs:{url:"url",relationshipId:"relationshipId",leftItem:"leftItem",rightItem:"rightItem"},outputs:{close:"close",save:"save"},standalone:!0,features:[core.OA$,core.aNF],decls:14,vars:9,consts:[[3,"ngClass"],[1,"modal-header"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"item","d-flex","flex-row"],[1,"d-flex","flex-row-reverse","m-2"],[1,"btn","btn-primary","save",3,"click"],["aria-hidden","true",1,"fas","fa-save"],["class","item d-flex flex-row",3,"click",4,"ngVar"],[1,"item","d-flex","flex-row",3,"click"],[1,"m-2"],["type","checkbox",1,"select",3,"checked"],[1,"flex-column"],[3,"object"],[1,"fw-bold"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1),core.EFF(2),core.nI1(3,"translate"),core.j41(4,"button",2),core.bIt("click",function(){return ctx.close.emit()}),core.k0s()(),core.j41(5,"div",3),core.Z7z(6,VirtualMetadataComponent_For_7_Template,2,3,"div",4,ctx.trackItemDTO,!0),core.nI1(8,"async"),core.j41(9,"div",5)(10,"button",6),core.bIt("click",function(){return ctx.save.emit()}),core.nrm(11,"i",7),core.EFF(12),core.nI1(13,"translate"),core.k0s()()()()),2&rf&&(core.Y8G("ngClass",ctx.showThumbnails?"hide-modal-thumbnail-column":""),core.R7$(2),core.SpI("",core.bMT(3,3,"virtual-metadata.delete-relationship.modal-head")," "),core.R7$(4),core.Dyx(core.bMT(8,5,ctx.itemDTOs$)),core.R7$(6),core.SpI(" ",core.bMT(13,7,"item.edit.metadata.save-button")," "))},dependencies:[common.Jj,listable_object_component_loader_component.v,common.YU,ngx_translate_core.h,ngx_translate_core.D9,var_directive.r],encapsulation:2})}}return VirtualMetadataComponent2})();function EditRelationshipComponent_Conditional_0_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",1)(1,"div",2),core.nrm(2,"ds-listable-object-component-loader",3),core.nI1(3,"async"),core.k0s(),core.j41(4,"div",4)(5,"div",5)(6,"button",6),core.nI1(7,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG(),virtualMetadataModal_r3=core.sdS(3);return core.Njj(ctx_r1.openVirtualMetadataModal(virtualMetadataModal_r3))}),core.nrm(8,"i",7),core.k0s(),core.j41(9,"button",8),core.nI1(10,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.undo())}),core.nrm(11,"i",9),core.k0s()()()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.Y8G("object",core.bMT(3,7,ctx_r1.relatedItem$))("viewMode",ctx_r1.viewMode)("value",ctx_r1.nameVariant),core.R7$(4),core.FS9("title",core.bMT(7,9,"item.edit.metadata.edit.buttons.remove")),core.Y8G("dsBtnDisabled",!ctx_r1.canRemove()),core.R7$(3),core.FS9("title",core.bMT(10,11,"item.edit.metadata.edit.buttons.undo")),core.Y8G("dsBtnDisabled",!ctx_r1.canUndo())}}function EditRelationshipComponent_ng_template_2_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"ds-virtual-metadata",10),core.nI1(1,"async"),core.nI1(2,"async"),core.bIt("close",function(){core.eBV(_r4);const ctx_r1=core.XpG();return core.Njj(ctx_r1.closeVirtualMetadataModal())})("save",function(){core.eBV(_r4);const ctx_r1=core.XpG();return core.Njj(ctx_r1.remove())}),core.k0s()}if(2&rf){const ctx_r1=core.XpG();core.Y8G("relationshipId",ctx_r1.relationship.id)("leftItem",core.bMT(1,4,ctx_r1.leftItem$))("rightItem",core.bMT(2,6,ctx_r1.rightItem$))("url",ctx_r1.url)}}let EditRelationshipComponent=(()=>{class EditRelationshipComponent2{get relationship(){return this.update.relationship}get update(){return this.fieldUpdate.field}get nameVariant(){return this.update.nameVariant}constructor(objectUpdatesService,modalService){this.objectUpdatesService=objectUpdatesService,this.modalService=modalService,this.relatedItem$=new cjs.BehaviorSubject(null),this.viewMode=view_mode_model.n.ListElement}ngOnChanges(){this.relationship&&(this.relationship.leftItem||this.relationship.rightItem)?(this.leftItem$=this.relationship.leftItem.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.pb)(item=>(0,empty_util.a4)(item)&&(0,empty_util.hj)(item.uuid))),this.rightItem$=this.relationship.rightItem.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.pb)(item=>(0,empty_util.a4)(item)&&(0,empty_util.hj)(item.uuid))),(0,cjs.combineLatest)([this.leftItem$,this.rightItem$]).pipe((0,operators.Tj)(([leftItem,rightItem])=>leftItem.uuid===this.editItem.uuid?rightItem:leftItem),(0,operators.s)(1)).subscribe(relatedItem=>{this.relatedItem$.next(relatedItem)})):this.relatedItem$.next(this.update.relatedItem)}remove(){this.closeVirtualMetadataModal(),(0,cjs.combineLatest)([this.leftItem$,this.rightItem$]).pipe((0,operators.Tj)(items=>items.map(item=>this.objectUpdatesService.isSelectedVirtualMetadata(this.url,this.relationship.id,item.uuid))),(0,operators.nx)(selection$=>(0,cjs.combineLatest)(selection$)),(0,operators.Tj)(selection=>Object.assign({},this.fieldUpdate.field,{keepLeftVirtualMetadata:!0===selection[0],keepRightVirtualMetadata:!0===selection[1]})),(0,operators.s)(1)).subscribe(deleteRelationship=>{this.objectUpdatesService.saveRemoveFieldUpdate(this.url,deleteRelationship)})}openVirtualMetadataModal(content){this.modalRef=this.modalService.open(content)}closeVirtualMetadataModal(){this.modalRef.close()}undo(){this.objectUpdatesService.removeSingleFieldUpdate(this.url,this.fieldUpdate.field.uuid)}canRemove(){return this.fieldUpdate.changeType!==field_change_type_model.B.REMOVE&&this.fieldUpdate.changeType!==field_change_type_model.B.ADD}canUndo(){return this.fieldUpdate.changeType?.valueOf()>=0}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EditRelationshipComponent2)(core.rXU(object_updates_service.F),core.rXU(ng_bootstrap.Bq))}}static{this.\u0275cmp=core.VBU({type:EditRelationshipComponent2,selectors:[["ds-edit-relationship"]],inputs:{fieldUpdate:"fieldUpdate",url:"url",editItem:"editItem"},standalone:!0,features:[core.OA$,core.aNF],decls:4,vars:3,consts:[["virtualMetadataModal",""],[1,"row"],[1,"col-10","relationship"],[3,"object","viewMode","value"],[1,"col-2","position-relative"],[1,"btn-group","relationship-action-buttons"],[1,"btn","btn-outline-danger","btn-sm",3,"click","dsBtnDisabled","title"],[1,"fas","fa-trash-alt","fa-fw"],[1,"btn","btn-outline-warning","btn-sm",3,"click","dsBtnDisabled","title"],[1,"fas","fa-undo-alt","fa-fw"],[3,"close","save","relationshipId","leftItem","rightItem","url"]],template:function(rf,ctx){1&rf&&(core.DNE(0,EditRelationshipComponent_Conditional_0_Template,12,13,"div",1),core.nI1(1,"async"),core.DNE(2,EditRelationshipComponent_ng_template_2_Template,3,8,"ng-template",null,0,core.C5r)),2&rf&&core.vxM(core.bMT(1,1,ctx.relatedItem$)?0:-1)},dependencies:[common.Jj,btn_disabled_directive.A,listable_object_component_loader_component.v,ngx_translate_core.h,ngx_translate_core.D9,VirtualMetadataComponent],styles:[".btn[disabled][_ngcontent-%COMP%]{color:var(--bs-gray-600);border-color:var(--bs-gray-600);z-index:0}.relationship-action-buttons[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]})}}return EditRelationshipComponent2})();const edit_relationship_list_component_c0=()=>({}),edit_relationship_list_component_c1=(a0,a1,a2)=>({"alert-success":a0,"alert-warning":a1,"alert-danger":a2});function EditRelationshipListComponent_ng_container_10_Conditional_1_ng_container_0_For_6_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-edit-relationship",7),2&rf){const updateValue_r1=ctx.$implicit,ctx_r1=core.XpG(4);core.Y8G("fieldUpdate",updateValue_r1||core.lJ4(4,edit_relationship_list_component_c0))("url",ctx_r1.url)("editItem",ctx_r1.item)("ngClass",core.sMw(5,edit_relationship_list_component_c1,1===updateValue_r1.changeType,0===updateValue_r1.changeType,2===updateValue_r1.changeType))}}function EditRelationshipListComponent_ng_container_10_Conditional_1_ng_container_0_Conditional_7_Template(rf,ctx){1&rf&&(core.j41(0,"div"),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.JRh(core.bMT(2,1,"item.edit.relationships.no-relationships")))}function EditRelationshipListComponent_ng_container_10_Conditional_1_ng_container_0_Template(rf,ctx){if(1&rf&&(core.qex(0),core.j41(1,"ds-pagination",5),core.nI1(2,"async"),core.nI1(3,"async"),core.j41(4,"div",6),core.Z7z(5,EditRelationshipListComponent_ng_container_10_Conditional_1_ng_container_0_For_6_Template,1,9,"ds-edit-relationship",7,core.BUC().trackUpdate,!0),core.k0s()(),core.DNE(7,EditRelationshipListComponent_ng_container_10_Conditional_1_ng_container_0_Conditional_7_Template,3,3,"div"),core.bVm()),2&rf){let tmp_6_0;const updateValues_r3=ctx.ngVar,ctx_r1=core.XpG(3);core.R7$(),core.Y8G("paginationOptions",ctx_r1.paginationConfig)("collectionSize",(null==(tmp_6_0=core.bMT(2,5,ctx_r1.relationshipsRd$))||null==tmp_6_0.payload?null:tmp_6_0.payload.totalElements)+core.bMT(3,7,ctx_r1.nbAddedFields$))("hideGear",!0)("hidePagerWhenSinglePage",!0),core.R7$(4),core.Dyx(updateValues_r3),core.R7$(2),core.vxM(0===updateValues_r3.length?7:-1)}}function EditRelationshipListComponent_ng_container_10_Conditional_1_Template(rf,ctx){if(1&rf&&(core.DNE(0,EditRelationshipListComponent_ng_container_10_Conditional_1_ng_container_0_Template,8,9,"ng-container",4),core.nI1(1,"dsObjectValues")),2&rf){const updates_r4=core.XpG().ngVar;core.Y8G("ngVar",core.bMT(1,1,updates_r4))}}function EditRelationshipListComponent_ng_container_10_Conditional_3_Template(rf,ctx){1&rf&&core.nrm(0,"ds-loading")}function EditRelationshipListComponent_ng_container_10_Template(rf,ctx){if(1&rf&&(core.qex(0),core.DNE(1,EditRelationshipListComponent_ng_container_10_Conditional_1_Template,2,3,"ng-container"),core.nI1(2,"async"),core.DNE(3,EditRelationshipListComponent_ng_container_10_Conditional_3_Template,1,0,"ds-loading"),core.nI1(4,"async"),core.bVm()),2&rf){const updates_r4=ctx.ngVar,ctx_r1=core.XpG();core.R7$(),core.vxM(updates_r4&&!0!==core.bMT(2,2,ctx_r1.loading$)?1:-1),core.R7$(2),core.vxM(core.bMT(4,4,ctx_r1.loading$)?3:-1)}}let EditRelationshipListComponent=(()=>{class EditRelationshipListComponent2{constructor(objectUpdatesService,linkService,relationshipService,modalService,paginationService,selectableListService,editItemRelationshipsService,appConfig){this.objectUpdatesService=objectUpdatesService,this.linkService=linkService,this.relationshipService=relationshipService,this.modalService=modalService,this.paginationService=paginationService,this.selectableListService=selectableListService,this.editItemRelationshipsService=editItemRelationshipsService,this.appConfig=appConfig,this.submitModal=new core.bkB,this.currentItemIsLeftItem$=new cjs.BehaviorSubject(void 0),this.updates$=new cjs.BehaviorSubject(void 0),this.relationshipsRd$=new cjs.BehaviorSubject(void 0),this.isLastPage$=new cjs.BehaviorSubject(!0),this.loading$=new cjs.BehaviorSubject(!0),this.nbAddedFields$=new cjs.BehaviorSubject(0),this.subs=[],this.fetchThumbnail=this.appConfig.browseBy.showThumbnails}getRelationshipMessageKey(){return(0,cjs.combineLatest)([this.currentEntityType$,this.getLabel(),this.relatedEntityType$]).pipe((0,operators.Tj)(([currentEntityType,label,relatedEntityType])=>`relationships.${currentEntityType.label}.${label}.${relatedEntityType.label}`))}getLabel(){return this.currentItemIsLeftItem$.pipe((0,operators.Tj)(currentItemIsLeftItem=>currentItemIsLeftItem?this.relationshipType.leftwardType:this.relationshipType.rightwardType))}trackUpdate(index,update){return update&&update.field?update.field.uuid:void 0}isRepeatable(){if(this.currentItemIsLeftItem$.getValue()){const leftMaxCardinality=this.relationshipType.leftMaxCardinality;return(0,empty_util.Tn)(leftMaxCardinality)||leftMaxCardinality>1}{const rightMaxCardinality=this.relationshipType.rightMaxCardinality;return(0,empty_util.Tn)(rightMaxCardinality)||rightMaxCardinality>1}}openLookup(){this.modalRef=this.modalService.open(dynamic_lookup_relation_modal_component.d,{size:"lg"});const modalComp=this.modalRef.componentInstance;modalComp.repeatable=!0,modalComp.isEditRelationship=!0,modalComp.listId=this.listId,modalComp.item=this.item,modalComp.relationshipType=this.relationshipType,modalComp.currentItemIsLeftItem$=this.currentItemIsLeftItem$,modalComp.toAdd=[],modalComp.toRemove=[],modalComp.isPending=!1,modalComp.repeatable=this.isRepeatable(),modalComp.hiddenQuery="-search.resourceid:"+this.item.uuid,this.item.owningCollection.pipe((0,shared_operators.ak)()).subscribe(collection=>{modalComp.collection=collection}),modalComp.select=(...selectableObjects)=>{selectableObjects.forEach(searchResult=>{const relatedItem=searchResult.indexableObject,foundIndex=modalComp.toRemove.findIndex(itemSearchResult=>itemSearchResult.indexableObject.uuid===relatedItem.uuid);-1!==foundIndex?modalComp.toRemove.splice(foundIndex,1):this.getRelationFromId(relatedItem).subscribe(relationship=>{if(relationship){const foundIndexRemove=modalComp.toRemove.findIndex(el=>el.indexableObject.uuid===relatedItem.uuid);-1!==foundIndexRemove&&modalComp.toRemove.splice(foundIndexRemove,1)}else modalComp.toAdd.push(searchResult);this.loading$.next((0,empty_util.hj)(modalComp.toAdd)||(0,empty_util.hj)(modalComp.toRemove)),this.relationshipsRd$.next(this.relationshipsRd$.getValue())})})},modalComp.deselect=(...selectableObjects)=>{selectableObjects.forEach(searchResult=>{const relatedItem=searchResult.indexableObject,foundIndex=modalComp.toAdd.findIndex(el=>el.indexableObject.uuid===relatedItem.uuid);-1!==foundIndex?modalComp.toAdd.splice(foundIndex,1):modalComp.toRemove.push(searchResult),this.loading$.next((0,empty_util.hj)(modalComp.toAdd)||(0,empty_util.hj)(modalComp.toRemove))})},modalComp.submitEv=()=>{modalComp.isPending=!0;const isLeft=this.currentItemIsLeftItem$.getValue(),addOperations=modalComp.toAdd.map(searchResult=>({type:"add",searchResult})),removeOperations=modalComp.toRemove.map(searchResult=>({type:"remove",searchResult}));(0,cjs.from)([...addOperations,...removeOperations]).pipe((0,operators.Hh)(({type,searchResult})=>{const relatedItem=searchResult.indexableObject;return"add"===type?this.relationshipService.getNameVariant(this.listId,relatedItem.uuid).pipe((0,operators.nx)(nameVariant=>this.objectUpdatesService.saveAddFieldUpdate(this.url,{uuid:`${this.relationshipType.id}-${relatedItem.uuid}`,nameVariant,type:this.relationshipType,originalIsLeft:isLeft,originalItem:this.item,relatedItem})),(0,operators.s)(1)):"remove"===type?this.relationshipService.getNameVariant(this.listId,relatedItem.uuid).pipe((0,operators.nx)(nameVariant=>this.getRelationFromId(searchResult.indexableObject).pipe((0,operators.Tj)(relationship=>this.objectUpdatesService.saveRemoveFieldUpdate(this.url,{uuid:relationship.id,nameVariant,type:this.relationshipType,originalIsLeft:isLeft,originalItem:this.item,relatedItem,relationship})))),(0,operators.s)(1)):cjs.EMPTY}),(0,operators.$r)()).subscribe({complete:()=>{this.editItemRelationshipsService.submit(this.item,this.url),this.submitModal.emit()}})},modalComp.discardEv=()=>{modalComp.toAdd.forEach(searchResult=>{this.selectableListService.deselectSingle(this.listId,searchResult)}),modalComp.toRemove.forEach(searchResult=>{this.selectableListService.selectSingle(this.listId,searchResult)}),modalComp.toAdd=[],modalComp.toRemove=[],this.loading$.next(!1)},modalComp.closeEv=()=>{this.loading$.next(!1)},this.relatedEntityType$.pipe((0,operators.s)(1)).subscribe(relatedEntityType=>{modalComp.relationshipOptions=Object.assign(new relationship_options_model.j,{relationshipType:relatedEntityType.label,searchConfiguration:relatedEntityType.label.toLowerCase(),nameVariants:"true"})}),this.selectableListService.deselectAll(this.listId)}getRelationFromId(relatedItem){const relationshipLabel=this.currentItemIsLeftItem$.getValue()?this.relationshipType.leftwardType:this.relationshipType.rightwardType;return this.relationshipService.searchByItemsAndType(this.relationshipType.id,this.item.uuid,relationshipLabel,[relatedItem.id]).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)(),(0,operators.Tj)(res=>res.page[0]))}ngOnInit(){this.relationshipLeftAndRightType$=(0,cjs.combineLatest)([this.relationshipType.leftType,this.relationshipType.rightType].map(type=>type.pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()))),this.relatedEntityType$=this.relationshipLeftAndRightType$.pipe((0,operators.Tj)(([leftType,rightType])=>leftType.uuid!==this.itemType.uuid?leftType:rightType),(0,empty_util.Az)()),this.currentEntityType$=this.relationshipLeftAndRightType$.pipe((0,operators.Tj)(([leftType,rightType])=>leftType.uuid===this.itemType.uuid?leftType:rightType),(0,empty_util.Az)()),this.relatedEntityType$.pipe((0,operators.s)(1)).subscribe(relatedEntityType=>this.listId=`edit-relationship-${this.itemType.id}-${relatedEntityType.id}`),this.relationshipMessageKey$=this.getRelationshipMessageKey(),this.paginationConfig=new pagination_component_options_model.W,this.paginationConfig.id=`er${this.relationshipType.id}`,this.paginationConfig.pageSize=5,this.paginationConfig.currentPage=1;const currentPagination$=this.paginationService.getCurrentPagination(this.paginationConfig.id,this.paginationConfig).pipe((0,operators.Mi)(()=>this.loading$.next(!0))),linksToFollow=(0,relation_query_utils.nW)(this.fetchThumbnail,this.appConfig.item.showAccessStatuses);this.subs.push((0,cjs.combineLatest)([currentPagination$,this.currentItemIsLeftItem$,this.relatedEntityType$]).pipe((0,operators.nx)(([currentPagination,currentItemIsLeftItem,relatedEntityType])=>this.relationshipService.getItemRelationshipsByLabel(this.item,currentItemIsLeftItem?this.relationshipType.leftwardType:this.relationshipType.rightwardType,{elementsPerPage:currentPagination.pageSize,currentPage:currentPagination.currentPage,searchParams:[new request_param_model.x("relatedEntityType",relatedEntityType.label)]},!0,!0,...linksToFollow)),(0,operators.Mi)(rd=>{this.relationshipsRd$.next(rd)}),(0,shared_operators.v7)(),(0,shared_operators.Bo)()).subscribe(relationshipPaginatedList=>{this.objectUpdatesService.initialize(this.url,relationshipPaginatedList.page,new Date)})),this.subs.push(this.relationshipsRd$.pipe((0,empty_util.Az)(),(0,shared_operators.v7)()).subscribe(rd=>{this.isLastPage$.next((0,empty_util.Tn)(rd.payload._links.next))})),this.subs.push(this.relationshipsRd$.pipe((0,empty_util.Az)(),(0,shared_operators.v7)(),(0,operators.nx)(rd=>(0,cjs.from)(rd.payload.page).pipe((0,operators.ZZ)(relationship=>this.relationshipService.isLeftItem(relationship,this.item).pipe((0,operators.nx)(isLeftItem=>isLeftItem?relationship.rightItem.pipe((0,shared_operators.qD)(),(0,shared_operators.Bo)(),(0,operators.Tj)(relatedItem=>[relationship,isLeftItem,relatedItem])):relationship.leftItem.pipe((0,shared_operators.qD)(),(0,shared_operators.Bo)(),(0,operators.Tj)(relatedItem=>[relationship,isLeftItem,relatedItem]))))),(0,operators.Tj)(([relationship,isLeftItem,relatedItem])=>({uuid:relationship.id,type:this.relationshipType,relationship,originalIsLeft:isLeftItem,originalItem:this.item,relatedItem,nameVariant:isLeftItem?relationship.rightwardValue:relationship.leftwardValue})),(0,operators.$r)(),(0,operators.US)([]))),(0,operators.nx)(nextFields=>this.objectUpdatesService.getFieldUpdates(this.url,nextFields).pipe((0,operators.Tj)(fieldUpdates=>{const fieldUpdatesFiltered={};return this.nbAddedFields$.next(0),Object.keys(fieldUpdates).forEach(uuid=>{(0,empty_util.a4)(fieldUpdates[uuid])&&fieldUpdates[uuid].field.type.id===this.relationshipType.id&&(fieldUpdates[uuid].changeType===field_change_type_model.B.ADD?(this.nbAddedFields$.next(this.nbAddedFields$.getValue()+1),!0===this.isLastPage$.getValue()&&(fieldUpdatesFiltered[uuid]=fieldUpdates[uuid])):fieldUpdatesFiltered[uuid]=fieldUpdates[uuid])}),fieldUpdatesFiltered}))),(0,operators.ql)({})).subscribe(updates=>{this.loading$.next(!1),this.updates$.next(updates)}))}ngOnDestroy(){this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EditRelationshipListComponent2)(core.rXU(object_updates_service.F),core.rXU(link_service._),core.rXU(relationship_data_service.RelationshipDataService),core.rXU(ng_bootstrap.Bq),core.rXU(pagination_service.m),core.rXU(selectable_list_service.K),core.rXU(EditItemRelationshipsService),core.rXU(app_config_interface.vQ))}}static{this.\u0275cmp=core.VBU({type:EditRelationshipListComponent2,selectors:[["ds-edit-relationship-list"]],inputs:{item:"item",itemType:"itemType",url:"url",relationshipType:"relationshipType",hasChanges:"hasChanges",currentItemIsLeftItem$:"currentItemIsLeftItem$"},outputs:{submitModal:"submitModal"},standalone:!0,features:[core.aNF],decls:12,vars:14,consts:[[1,"h4"],[1,"ms-2","btn","btn-success",3,"click","dsBtnDisabled"],[1,"fas","fa-plus"],[1,"d-none","d-sm-inline"],[4,"ngVar"],[3,"paginationOptions","collectionSize","hideGear","hidePagerWhenSinglePage"],[1,"my-2"],[1,"relationship-row","d-block","alert",3,"fieldUpdate","url","editItem","ngClass"]],template:function(rf,ctx){1&rf&&(core.j41(0,"h2",0),core.EFF(1),core.nI1(2,"async"),core.nI1(3,"translate"),core.j41(4,"button",1),core.nI1(5,"async"),core.bIt("click",function(){return ctx.openLookup()}),core.nrm(6,"i",2),core.j41(7,"span",3),core.EFF(8),core.nI1(9,"translate"),core.k0s()()(),core.DNE(10,EditRelationshipListComponent_ng_container_10_Template,5,6,"ng-container",4),core.nI1(11,"async")),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(3,6,core.bMT(2,4,ctx.relationshipMessageKey$))," "),core.R7$(3),core.Y8G("dsBtnDisabled",core.bMT(5,8,ctx.hasChanges)),core.R7$(4),core.SpI("\xa0",core.bMT(9,10,"item.edit.relationships.edit.buttons.add"),""),core.R7$(2),core.Y8G("ngVar",core.bMT(11,12,ctx.updates$)))},dependencies:[common.Jj,btn_disabled_directive.A,EditRelationshipComponent,common.YU,ObjectValuesPipe,pagination_component.e,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9,var_directive.r],styles:[".relationship-row[_ngcontent-%COMP%]:not(.alert){padding:var(--bs-alert-padding-y) 0}.relationship-row.alert[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-alert-padding-x));margin-right:calc(-1 * var(--bs-alert-padding-x));margin-top:-1px;margin-bottom:-1px}"]})}}return EditRelationshipListComponent2})();function EditRelationshipListWrapperComponent_Conditional_0_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-edit-relationship-list",1)(1,"ds-edit-relationship-list",0),2&rf){const ctx_r0=core.XpG();core.Y8G("url",ctx_r0.url)("item",ctx_r0.item)("itemType",ctx_r0.itemType)("relationshipType",ctx_r0.relationshipType)("hasChanges",ctx_r0.hasChanges)("currentItemIsLeftItem$",ctx_r0.isLeftItem$),core.R7$(),core.Y8G("url",ctx_r0.url)("item",ctx_r0.item)("itemType",ctx_r0.itemType)("relationshipType",ctx_r0.relationshipType)("hasChanges",ctx_r0.hasChanges)("currentItemIsLeftItem$",ctx_r0.isRightItem$)}}function EditRelationshipListWrapperComponent_Conditional_2_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-edit-relationship-list",0),2&rf){const ctx_r0=core.XpG();core.Y8G("url",ctx_r0.url)("item",ctx_r0.item)("itemType",ctx_r0.itemType)("relationshipType",ctx_r0.relationshipType)("hasChanges",ctx_r0.hasChanges)("currentItemIsLeftItem$",ctx_r0.currentItemIsLeftItem$)}}let EditRelationshipListWrapperComponent=(()=>{class EditRelationshipListWrapperComponent2{constructor(editItemRelationshipsService){this.editItemRelationshipsService=editItemRelationshipsService,this.submitModal=new core.bkB,this.currentItemIsLeftItem$=new cjs.BehaviorSubject(void 0),this.isLeftItem$=new cjs.BehaviorSubject(!0),this.isRightItem$=new cjs.BehaviorSubject(!1),this.subs=[]}ngOnInit(){this.subs.push(this.editItemRelationshipsService.isProvidedItemTypeLeftType(this.relationshipType,this.itemType,this.item).subscribe(nextValue=>{this.currentItemIsLeftItem$.next(nextValue)})),this.shouldDisplayBothRelationshipSides$=this.editItemRelationshipsService.shouldDisplayBothRelationshipSides(this.relationshipType,this.itemType)}ngOnDestroy(){this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EditRelationshipListWrapperComponent2)(core.rXU(EditItemRelationshipsService))}}static{this.\u0275cmp=core.VBU({type:EditRelationshipListWrapperComponent2,selectors:[["ds-edit-relationship-list-wrapper"]],inputs:{item:"item",itemType:"itemType",url:"url",relationshipType:"relationshipType",hasChanges:"hasChanges"},outputs:{submitModal:"submitModal"},standalone:!0,features:[core.aNF],decls:4,vars:6,consts:[[3,"url","item","itemType","relationshipType","hasChanges","currentItemIsLeftItem$"],[1,"d-block","mb-4",3,"url","item","itemType","relationshipType","hasChanges","currentItemIsLeftItem$"]],template:function(rf,ctx){1&rf&&(core.DNE(0,EditRelationshipListWrapperComponent_Conditional_0_Template,2,12),core.nI1(1,"async"),core.DNE(2,EditRelationshipListWrapperComponent_Conditional_2_Template,1,6,"ds-edit-relationship-list",0),core.nI1(3,"async")),2&rf&&(core.vxM(core.bMT(1,2,ctx.shouldDisplayBothRelationshipSides$)?0:-1),core.R7$(2),core.vxM(!1===core.bMT(3,4,ctx.shouldDisplayBothRelationshipSides$)?2:-1))},dependencies:[common.Jj,EditRelationshipListComponent]})}}return EditRelationshipListWrapperComponent2})();function ItemRelationshipsComponent_Conditional_1_ng_container_1_Template(rf,ctx){1&rf&&core.eu8(0)}function ItemRelationshipsComponent_Conditional_1_Conditional_2_For_2_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",5),core.nrm(1,"ds-edit-relationship-list-wrapper",8),core.k0s()),2&rf){const relationshipType_r1=ctx.$implicit,entityType_r2=core.XpG(2),ctx_r2=core.XpG();core.R7$(),core.Y8G("url",ctx_r2.url)("item",ctx_r2.item)("itemType",entityType_r2)("relationshipType",relationshipType_r1)("hasChanges",ctx_r2.hasChanges$)}}function ItemRelationshipsComponent_Conditional_1_Conditional_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",5),core.Z7z(1,ItemRelationshipsComponent_Conditional_1_Conditional_2_For_2_Template,2,5,"div",5,core.BUC().trackById,!0),core.k0s()),2&rf&&(core.R7$(),core.Dyx(ctx))}function ItemRelationshipsComponent_Conditional_1_Conditional_4_Template(rf,ctx){1&rf&&core.nrm(0,"ds-loading")}function ItemRelationshipsComponent_Conditional_1_ng_container_7_Template(rf,ctx){1&rf&&core.eu8(0)}function ItemRelationshipsComponent_Conditional_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",3),core.DNE(1,ItemRelationshipsComponent_Conditional_1_ng_container_1_Template,1,0,"ng-container",4),core.k0s(),core.DNE(2,ItemRelationshipsComponent_Conditional_1_Conditional_2_Template,3,0,"div",5),core.nI1(3,"async"),core.DNE(4,ItemRelationshipsComponent_Conditional_1_Conditional_4_Template,1,0,"ds-loading"),core.j41(5,"div",6)(6,"div",7),core.DNE(7,ItemRelationshipsComponent_Conditional_1_ng_container_7_Template,1,0,"ng-container",4),core.k0s()()),2&rf){let tmp_4_0;const ctx_r2=core.XpG(),buttons_r4=core.sdS(5);core.R7$(),core.Y8G("ngTemplateOutlet",buttons_r4),core.R7$(),core.vxM((tmp_4_0=core.bMT(3,3,ctx_r2.relationshipTypes$))?2:4,tmp_4_0),core.R7$(5),core.Y8G("ngTemplateOutlet",buttons_r4)}}function ItemRelationshipsComponent_Conditional_3_Template(rf,ctx){if(1&rf&&(core.j41(0,"ds-alert",2),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf){const ctx_r2=core.XpG();core.Y8G("type",ctx_r2.AlertType.Info),core.R7$(),core.SpI(" ",core.bMT(2,2,"item.edit.relationships.no-entity-type")," ")}}function ItemRelationshipsComponent_ng_template_4_Conditional_1_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"button",16),core.nI1(1,"async"),core.bIt("click",function(){core.eBV(_r6);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.discard())}),core.nrm(2,"i",17),core.j41(3,"span",15),core.EFF(4),core.nI1(5,"translate"),core.k0s()()}if(2&rf){const ctx_r2=core.XpG(2);core.Y8G("dsBtnDisabled",!0!==core.bMT(1,2,ctx_r2.hasChanges$)),core.R7$(4),core.SpI("\xa0",core.bMT(5,4,"item.edit.metadata.discard-button"),"")}}function ItemRelationshipsComponent_ng_template_4_Conditional_3_Template(rf,ctx){if(1&rf){const _r7=core.RV6();core.j41(0,"button",18),core.bIt("click",function(){core.eBV(_r7);const ctx_r2=core.XpG(2);return core.Njj(ctx_r2.reinstate())}),core.nrm(1,"i",19),core.j41(2,"span",15),core.EFF(3),core.nI1(4,"translate"),core.k0s()()}2&rf&&(core.R7$(3),core.SpI("\xa0",core.bMT(4,1,"item.edit.metadata.reinstate-button"),""))}function ItemRelationshipsComponent_ng_template_4_Conditional_8_Template(rf,ctx){1&rf&&core.nrm(0,"span",13)}function ItemRelationshipsComponent_ng_template_4_Conditional_10_Template(rf,ctx){1&rf&&core.nrm(0,"i",14)}function ItemRelationshipsComponent_ng_template_4_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",9),core.DNE(1,ItemRelationshipsComponent_ng_template_4_Conditional_1_Template,6,6,"button",10),core.nI1(2,"async"),core.DNE(3,ItemRelationshipsComponent_ng_template_4_Conditional_3_Template,5,3,"button",11),core.nI1(4,"async"),core.j41(5,"button",12),core.nI1(6,"async"),core.nI1(7,"async"),core.bIt("click",function(){core.eBV(_r5);const ctx_r2=core.XpG();return core.Njj(ctx_r2.submit())}),core.DNE(8,ItemRelationshipsComponent_ng_template_4_Conditional_8_Template,1,0,"span",13),core.nI1(9,"async"),core.DNE(10,ItemRelationshipsComponent_ng_template_4_Conditional_10_Template,1,0,"i",14),core.nI1(11,"async"),core.j41(12,"span",15),core.EFF(13),core.nI1(14,"translate"),core.k0s()()()}if(2&rf){const ctx_r2=core.XpG();core.R7$(),core.vxM(!0!==core.bMT(2,6,ctx_r2.isReinstatable$)?1:-1),core.R7$(2),core.vxM(core.bMT(4,8,ctx_r2.isReinstatable$)?3:-1),core.R7$(2),core.Y8G("dsBtnDisabled",!0!==core.bMT(6,10,ctx_r2.hasChanges$)||!0===core.bMT(7,12,ctx_r2.isSaving$)),core.R7$(3),core.vxM(core.bMT(9,14,ctx_r2.isSaving$)?8:-1),core.R7$(2),core.vxM(!0!==core.bMT(11,16,ctx_r2.isSaving$)?10:-1),core.R7$(3),core.SpI("\xa0",core.bMT(14,18,"item.edit.metadata.save-button"),"")}}let ItemRelationshipsComponent=(()=>{class ItemRelationshipsComponent2 extends AbstractItemUpdateComponent{get isSaving$(){return this.editItemRelationshipsService.isSaving$}constructor(itemService,objectUpdatesService,router2,notificationsService,translateService,route,relationshipService,objectCache,requestService,entityTypeService,relationshipTypeService,cdr,modalService,editItemRelationshipsService){super(itemService,objectUpdatesService,router2,notificationsService,translateService,route),this.itemService=itemService,this.objectUpdatesService=objectUpdatesService,this.router=router2,this.notificationsService=notificationsService,this.translateService=translateService,this.route=route,this.relationshipService=relationshipService,this.objectCache=objectCache,this.requestService=requestService,this.entityTypeService=entityTypeService,this.relationshipTypeService=relationshipTypeService,this.cdr=cdr,this.modalService=modalService,this.editItemRelationshipsService=editItemRelationshipsService,this.entityType$=new cjs.BehaviorSubject(void 0),this.AlertType=alert_type.v}initializeUpdates(){const label=this.item.firstMetadataValue("dspace.entity.type");void 0!==label?(this.relationshipTypes$=this.relationshipTypeService.searchByEntityType(label,!0,!0,...this.getRelationshipTypeFollowLinks()).pipe((0,operators.Tj)(relationshipTypes=>relationshipTypes.page),(0,operators.F)((0,item_relationships_utils.W2)())),this.entityTypeService.getEntityTypeByLabel(label).pipe((0,shared_operators.yd)(),(0,shared_operators.Bo)()).subscribe(type=>this.entityType$.next(type))):this.entityType$.next(void 0)}initializeNotificationsPrefix(){this.notificationsPrefix="item.edit.relationships.notifications."}submit(){this.editItemRelationshipsService.submit(this.item,this.url)}initializeOriginalFields(){return this.editItemRelationshipsService.initializeOriginalFields(this.item,this.url)}trackById(index,relationshipType){return relationshipType.id}getRelationshipTypeFollowLinks(){return[(0,follow_link_config_model.s)("leftType"),(0,follow_link_config_model.s)("rightType")]}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemRelationshipsComponent2)(core.rXU(item_data_service.ItemDataService),core.rXU(object_updates_service.F),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(router.nX),core.rXU(relationship_data_service.RelationshipDataService),core.rXU(object_cache_service.$),core.rXU(request_service.B),core.rXU(entity_type_data_service.f),core.rXU(relationship_type_data_service.RelationshipTypeDataService),core.rXU(core.gRc),core.rXU(ng_bootstrap.Bq),core.rXU(EditItemRelationshipsService))}}static{this.\u0275cmp=core.VBU({type:ItemRelationshipsComponent2,selectors:[["ds-item-relationships"]],standalone:!0,features:[core.Vt3,core.aNF],decls:6,vars:3,consts:[["buttons",""],[1,"item-relationships"],[1,"d-block","mt-2",3,"type"],[1,"button-row","top","d-flex","justify-content-end"],[4,"ngTemplateOutlet"],[1,"mb-4"],[1,"button-row","bottom"],[1,"float-end","ms-gap"],[3,"url","item","itemType","relationshipType","hasChanges"],[1,"d-flex","space-children-mr","justify-content-end"],[1,"btn","btn-danger",3,"dsBtnDisabled"],[1,"btn","btn-warning"],[1,"btn","btn-primary",3,"click","dsBtnDisabled"],["aria-hidden","true","role","status",1,"spinner-border","spinner-border-sm"],["aria-hidden","true",1,"fas","fa-save"],[1,"d-none","d-sm-inline"],[1,"btn","btn-danger",3,"click","dsBtnDisabled"],["aria-hidden","true",1,"fas","fa-times"],[1,"btn","btn-warning",3,"click"],["aria-hidden","true",1,"fas","fa-undo-alt"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",1),core.DNE(1,ItemRelationshipsComponent_Conditional_1_Template,8,5),core.nI1(2,"async"),core.DNE(3,ItemRelationshipsComponent_Conditional_3_Template,3,4,"ds-alert",2),core.k0s(),core.DNE(4,ItemRelationshipsComponent_ng_template_4_Template,15,20,"ng-template",null,0,core.C5r)),2&rf){let tmp_1_0;core.R7$(),core.vxM((tmp_1_0=core.bMT(2,1,ctx.entityType$))?1:3,tmp_1_0)}},dependencies:[alert_component.C,common.Jj,btn_disabled_directive.A,EditRelationshipListWrapperComponent,common.T3,themed_loading_component.v,ngx_translate_core.h,ngx_translate_core.D9],styles:[".button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:var(--ds-gap)}.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}@media screen and (min-width: 576px){.button-row[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:var(--ds-edit-item-button-min-width)}}.button-row.top[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-top:calc(var(--bs-spacer) / 2);margin-bottom:calc(var(--bs-spacer) / 2)}"]})}}return ItemRelationshipsComponent2})();var themed_component=__webpack_require__(79241);__webpack_require__(36024);const themed_item_status_component_c0=["*"];function ThemedItemStatusComponent_ng_template_0_Template(rf,ctx){}let ThemedItemStatusComponent=(()=>{class ThemedItemStatusComponent2 extends themed_component.J{getComponentName(){return"ItemStatusComponent"}importThemedComponent(themeName){return __webpack_require__(52529)(`./${themeName}/app/item-page/edit-item-page/item-status/item-status.component`)}importUnthemedComponent(){return Promise.resolve().then(__webpack_require__.bind(__webpack_require__,36024))}static{this.\u0275fac=(()=>{let \u0275ThemedItemStatusComponent_BaseFactory;return function(__ngFactoryType__){return(\u0275ThemedItemStatusComponent_BaseFactory||(\u0275ThemedItemStatusComponent_BaseFactory=core.xGo(ThemedItemStatusComponent2)))(__ngFactoryType__||ThemedItemStatusComponent2)}})()}static{this.\u0275cmp=core.VBU({type:ThemedItemStatusComponent2,selectors:[["ds-item-status"]],standalone:!0,features:[core.Vt3,core.aNF],ngContentSelectors:themed_item_status_component_c0,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(rf,ctx){1&rf&&(core.NAR(),core.DNE(0,ThemedItemStatusComponent_ng_template_0_Template,0,0,"ng-template",null,0,core.C5r),core.j41(2,"div",null,1),core.SdG(4),core.k0s())},encapsulation:2})}}return ThemedItemStatusComponent2})();var item_versions_component=__webpack_require__(99762);function ItemVersionHistoryComponent_div_0_Conditional_1_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-item-versions",2),2&rf){const item_r1=core.XpG().ngVar;core.Y8G("item",item_r1)("displayWhenEmpty",!0)("displayTitle",!1)("displayActions",!0)}}function ItemVersionHistoryComponent_div_0_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",1),core.DNE(1,ItemVersionHistoryComponent_div_0_Conditional_1_Template,1,4,"ds-item-versions",2),core.k0s()),2&rf){const item_r1=ctx.ngVar;core.R7$(),core.vxM(item_r1?1:-1)}}const item_withdraw_component_c0=a0=>({id:a0}),item_withdraw_component_c1=a0=>[a0,"edit"],ROUTES=[{path:"",resolve:{breadcrumb:i18n_breadcrumb_resolver.S},data:{breadcrumbKey:"item.edit"},children:[{path:"",component:EditItemPageComponent,children:[{path:"",redirectTo:"status",pathMatch:"full"},{path:"status",component:ThemedItemStatusComponent,data:{title:"item.edit.tabs.status.title",showBreadcrumbs:!0},canActivate:[itemPageStatusGuard]},{path:"bitstreams",component:ItemBitstreamsComponent,data:{title:"item.edit.tabs.bitstreams.title",showBreadcrumbs:!0},canActivate:[itemPageBitstreamsGuard]},{path:"metadata",component:themed_dso_edit_metadata_component.Q,data:{title:"item.edit.tabs.metadata.title",showBreadcrumbs:!0},canActivate:[itemPageMetadataGuard]},{path:"curate",component:ItemCurateComponent,data:{title:"item.edit.tabs.curate.title",showBreadcrumbs:!0},canActivate:[itemPageCurateGuard]},{path:"relationships",component:ItemRelationshipsComponent,data:{title:"item.edit.tabs.relationships.title",showBreadcrumbs:!0},canActivate:[itemPageRelationshipsGuard]},{path:"versionhistory",component:(()=>{class ItemVersionHistoryComponent2{constructor(route){this.route=route,this.AlertTypeEnum=alert_type.v}ngOnInit(){this.itemRD$=this.route.parent.parent.data.pipe((0,operators.Tj)(data=>data.dso)).pipe((0,shared_operators.yd)())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemVersionHistoryComponent2)(core.rXU(router.nX))}}static{this.\u0275cmp=core.VBU({type:ItemVersionHistoryComponent2,selectors:[["ds-item-version-history"]],standalone:!0,features:[core.aNF],decls:2,vars:3,consts:[["class","mt-2",4,"ngVar"],[1,"mt-2"],[3,"item","displayWhenEmpty","displayTitle","displayActions"]],template:function(rf,ctx){if(1&rf&&(core.DNE(0,ItemVersionHistoryComponent_div_0_Template,2,1,"div",0),core.nI1(1,"async")),2&rf){let tmp_0_0;core.Y8G("ngVar",null==(tmp_0_0=core.bMT(1,1,ctx.itemRD$))?null:tmp_0_0.payload)}},dependencies:[common.Jj,item_versions_component.I,var_directive.r],encapsulation:2})}}return ItemVersionHistoryComponent2})(),data:{title:"item.edit.tabs.versionhistory.title",showBreadcrumbs:!0},canActivate:[itemPageVersionHistoryGuard]},{path:"access-control",component:ItemAccessControlComponent,data:{title:"item.edit.tabs.access-control.title",showBreadcrumbs:!0},canActivate:[itemPageAccessControlGuard]},{path:"mapper",component:ItemCollectionMapperComponent,data:{title:"item.edit.tabs.item-mapper.title",showBreadcrumbs:!0},canActivate:[itemPageCollectionMapperGuard]}]},{path:"mapper",component:ItemCollectionMapperComponent},{path:edit_item_page_routing_paths.kH,component:(()=>{class ItemWithdrawComponent2 extends AbstractSimpleItemActionComponent{constructor(route,router2,notificationsService,itemDataService,translateService){super(route,router2,notificationsService,itemDataService,translateService),this.route=route,this.router=router2,this.notificationsService=notificationsService,this.itemDataService=itemDataService,this.translateService=translateService,this.messageKey="withdraw",this.predicate=rd=>rd.payload.isWithdrawn}performAction(){this.itemDataService.setWithDrawn(this.item,!0).pipe((0,shared_operators.qD)()).subscribe(response=>{this.processRestResponse(response)})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemWithdrawComponent2)(core.rXU(router.nX),core.rXU(router.Ix),core.rXU(notifications_service.I),core.rXU(item_data_service.ItemDataService),core.rXU(ngx_translate_core.c$))}}static{this.\u0275cmp=core.VBU({type:ItemWithdrawComponent2,selectors:[["ds-item-withdraw"]],standalone:!0,features:[core.Vt3,core.aNF],decls:17,vars:19,consts:[[1,"container"],[1,"row"],[1,"col-12"],[3,"item"],[1,"space-children-mr"],[1,"btn","btn-outline-secondary","perform-action",3,"click"],[1,"btn","btn-outline-secondary","cancel",3,"routerLink"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"p"),core.EFF(7),core.nI1(8,"translate"),core.k0s(),core.nrm(9,"ds-modify-item-overview",3),core.j41(10,"div",4)(11,"button",5),core.bIt("click",function(){return ctx.performAction()}),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.j41(14,"button",6),core.EFF(15),core.nI1(16,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(4),core.JRh(core.i5U(5,6,ctx.headerMessage,core.eq3(15,item_withdraw_component_c0,ctx.item.handle))),core.R7$(3),core.JRh(core.bMT(8,9,ctx.descriptionMessage)),core.R7$(2),core.Y8G("item",ctx.item),core.R7$(3),core.SpI("",core.bMT(13,11,ctx.confirmMessage)," "),core.R7$(2),core.Y8G("routerLink",core.eq3(17,item_withdraw_component_c1,ctx.itemPageRoute)),core.R7$(),core.SpI(" ",core.bMT(16,13,ctx.cancelMessage)," "))},dependencies:[modify_item_overview_component.W,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return ItemWithdrawComponent2})(),canActivate:[itemPageWithdrawGuard]},{path:edit_item_page_routing_paths.Pg,component:ItemReinstateComponent,canActivate:[itemPageReinstateGuard]},{path:edit_item_page_routing_paths.$2,component:ItemPrivateComponent,canActivate:[itemPagePrivateGuard]},{path:edit_item_page_routing_paths.RS,component:ItemPublicComponent},{path:edit_item_page_routing_paths.Jr,component:ItemDeleteComponent,canActivate:[itemPageDeleteGuard]},{path:edit_item_page_routing_paths.Bw,component:ItemMoveComponent,data:{title:"item.edit.move.title"},canActivate:[itemPageMoveGuard]},{path:edit_item_page_routing_paths.KY,component:ItemRegisterDoiComponent,canActivate:[itemPageRegisterDoiGuard],data:{title:"item.edit.register-doi.title"}},{path:edit_item_page_routing_paths.K4,children:[{path:"create",resolve:{resourcePolicyTarget:resource_policy_target_resolver.Q},component:resource_policy_create_component.m,data:{title:"resource-policies.create.page.title"}},{path:"edit",resolve:{resourcePolicy:resource_policy_resolver.n},component:resource_policy_edit_component._,data:{title:"resource-policies.edit.page.title"}},{path:"",component:ItemAuthorizationsComponent,data:{title:"item.edit.authorizations.title"}}],canActivate:[itemPageEditAuthorizationsGuard]}]}]},24614:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{k:()=>ItemOperationComponent});var _angular_router__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(18134),_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(87969),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2385),_shared_btn_disabled_directive__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(69919),_angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25376);function ItemOperationComponent_Conditional_5_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"span")(1,"button",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(2,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(4,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("dsBtnDisabled",ctx_r0.operation.disabled)("routerLink",ctx_r0.operation.operationUrl),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(2,4,"item.edit.tabs.status.buttons."+ctx_r0.operation.operationKey+".button")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(4,6,"item.edit.tabs.status.buttons."+ctx_r0.operation.operationKey+".button")," ")}}function ItemOperationComponent_Conditional_6_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"span",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(1,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(2,"button",5),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(5,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("ngbTooltip",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(1,4,"item.edit.tabs.status.buttons.unauthorized")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("dsBtnDisabled",!0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(3,6,"item.edit.tabs.status.buttons."+ctx_r0.operation.operationKey+".button")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(5,8,"item.edit.tabs.status.buttons."+ctx_r0.operation.operationKey+".button")," ")}}let ItemOperationComponent=(()=>{class ItemOperationComponent2{static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemOperationComponent2)}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:ItemOperationComponent2,selectors:[["ds-item-operation"]],inputs:{operation:"operation"},standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.aNF],decls:7,vars:5,consts:[[1,"col-12","col-md-3","h-auto","float-start","d-flex","action-label"],[1,"justify-content-center","align-self-center","fw-bold"],[1,"col-12","col-md-9","float-start","action-button"],[3,"ngbTooltip"],[1,"btn","btn-outline-primary",3,"dsBtnDisabled","routerLink"],[1,"btn","btn-outline-primary",3,"dsBtnDisabled"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"div",0)(1,"span",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(4,"div",2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.DNE(5,ItemOperationComponent_Conditional_5_Template,5,8,"span")(6,ItemOperationComponent_Conditional_6_Template,6,10,"span",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SpI(" ",_angular_core__WEBPACK_IMPORTED_MODULE_0__.bMT(3,3,"item.edit.tabs.status.buttons."+ctx.operation.operationKey+".label")," "),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.vxM(ctx.operation.authorized?5:-1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.vxM(ctx.operation.authorized?-1:6))},dependencies:[_shared_btn_disabled_directive__WEBPACK_IMPORTED_MODULE_1__.A,_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__.n8,_ng_bootstrap_ng_bootstrap__WEBPACK_IMPORTED_MODULE_2__.md,_angular_router__WEBPACK_IMPORTED_MODULE_3__.Wk,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_4__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_4__.D9],encapsulation:2})}}return ItemOperationComponent2})()},36024:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ItemStatusComponent:()=>ItemStatusComponent});var common=__webpack_require__(87514),router=__webpack_require__(18134),ngx_translate_core=__webpack_require__(2385),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),configuration_data_service=__webpack_require__(93876),authorization_data_service=__webpack_require__(76509),feature_id=__webpack_require__(86583),identifier_data_service=__webpack_require__(71309),orcid_auth_service=__webpack_require__(51852),shared_operators=__webpack_require__(39022),fade=__webpack_require__(67441),empty_util=__webpack_require__(2794),item_page_routing_paths=__webpack_require__(88292),item_operation_component=__webpack_require__(24614);class ItemOperation{constructor(operationKey,operationUrl,featureID,disabled=!1,authorized=!0){this.operationKey=operationKey,this.operationUrl=operationUrl,this.featureID=featureID,this.authorized=authorized,this.setDisabled(disabled)}setDisabled(disabled){this.disabled=disabled}setAuthorized(authorized){this.authorized=authorized}}var core=__webpack_require__(25376);const _c0=a0=>({"pt-3":a0});function ItemStatusComponent_For_5_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",2)(1,"div",3),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",7),core.EFF(5),core.k0s()()),2&rf){const statusKey_r1=ctx.$implicit,ctx_r1=core.XpG();core.R7$(2),core.SpI(" ",core.bMT(3,4,"item.edit.tabs.status.labels."+statusKey_r1),": "),core.R7$(2),core.Mz_("id","status-",statusKey_r1,""),core.R7$(),core.SpI(" ",ctx_r1.statusData[statusKey_r1]," ")}}function ItemStatusComponent_For_7_Conditional_1_Template(rf,ctx){if(1&rf&&(core.j41(0,"div")(1,"div",3),core.EFF(2),core.k0s(),core.j41(3,"div",8),core.EFF(4),core.nI1(5,"translate"),core.k0s()()),2&rf){const identifier_r3=core.XpG().$implicit;core.R7$(2),core.SpI(" ",identifier_r3.identifierType.toLocaleUpperCase()," "),core.R7$(2),core.Lme("",identifier_r3.value," (",core.bMT(5,3,"item.edit.identifiers.doi.status."+identifier_r3.identifierStatus),")")}}function ItemStatusComponent_For_7_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",2),core.DNE(1,ItemStatusComponent_For_7_Conditional_1_Template,6,5,"div"),core.k0s()),2&rf){const identifier_r3=ctx.$implicit;core.R7$(),core.vxM("doi"===identifier_r3.identifierType?1:-1)}}function ItemStatusComponent_For_18_Template(rf,ctx){if(1&rf&&(core.j41(0,"div",6),core.nrm(1,"ds-item-operation",9),core.k0s()),2&rf){const operation_r4=ctx.$implicit;core.Y8G("ngClass",core.eq3(2,_c0,operation_r4)),core.R7$(),core.Y8G("operation",operation_r4)}}let ItemStatusComponent=(()=>{class ItemStatusComponent2{constructor(route,authorizationService,identifierDataService,configurationService,orcidAuthService){this.route=route,this.authorizationService=authorizationService,this.identifierDataService=identifierDataService,this.configurationService=configurationService,this.orcidAuthService=orcidAuthService,this.operations$=new cjs.BehaviorSubject([]),this.subs=[]}ngOnInit(){this.itemRD$=this.route.parent.data.pipe((0,operators.Tj)(data=>data.dso)),this.itemRD$.pipe((0,operators.$1)(),(0,operators.Tj)(data=>data.payload)).pipe((0,operators.nx)(item=>{this.statusData=Object.assign({id:item.id,handle:item.handle,lastModified:item.lastModified}),this.statusDataKeys=Object.keys(this.statusData),this.identifiers$=this.identifierDataService.getIdentifierDataFor(item).pipe((0,operators.Tj)(identifierRD=>401!==identifierRD.statusCode&&(0,empty_util.a4)(identifierRD.payload)?identifierRD.payload.identifiers:null));const registerConfigEnabled$=this.configurationService.findByPropertyName("identifiers.item-status.register-doi").pipe((0,shared_operators.qD)(),(0,operators.Tj)(response=>{if(response.hasSucceeded){const payload=response.payload;return!!(payload.values.length>0&&(0,empty_util.a4)(payload.values[0]))&&"true"===payload.values[0]}return!1})),currentUrl=this.getCurrentUrl(item),initialOperations=[new ItemOperation("authorizations",`${currentUrl}/authorizations`,feature_id._.CanManagePolicies,!0),new ItemOperation("mappedCollections",`${currentUrl}/mapper`,feature_id._.CanManageMappings,!0),item.isWithdrawn?new ItemOperation("reinstate",`${currentUrl}/reinstate`,feature_id._.ReinstateItem,!0):new ItemOperation("withdraw",`${currentUrl}/withdraw`,feature_id._.WithdrawItem,!0),item.isDiscoverable?new ItemOperation("private",`${currentUrl}/private`,feature_id._.CanMakePrivate,!0):new ItemOperation("public",`${currentUrl}/public`,feature_id._.CanMakePrivate,!0),new ItemOperation("move",`${currentUrl}/move`,feature_id._.CanMove,!0),new ItemOperation("delete",`${currentUrl}/delete`,feature_id._.CanDelete,!0)];this.operations$.next(initialOperations);const ops$=this.identifierDataService.getIdentifierDataFor(item).pipe((0,shared_operators.qD)(),(0,operators.ZZ)(dataRD=>{if(dataRD.hasSucceeded){const identifiers=dataRD.payload.identifiers;let no_doi=!0,pending=!1;return identifiers?.forEach(identifier=>{(0,empty_util.a4)(identifier)&&"doi"===identifier.identifierType&&(no_doi=!1,["PENDING","MINTED",null].includes(identifier.identifierStatus)&&(pending=!0))}),registerConfigEnabled$.pipe((0,operators.Tj)(enabled=>enabled&&(pending||no_doi)))}return(0,cjs.of)(!1)}),(0,operators.nx)(showDoi=>{const ops=[...initialOperations];if(showDoi){const op=new ItemOperation("register-doi",`${currentUrl}/register-doi`,feature_id._.CanRegisterDOI,!0);ops.splice(ops.length-1,0,op)}return ops}),(0,operators.Hh)(op=>(0,empty_util.a4)(op.featureID)?this.authorizationService.isAuthorized(op.featureID,item.self).pipe((0,operators.F)(),(0,operators.Tj)(authorized=>(op.setDisabled(!authorized),op.setAuthorized(authorized),op))):[op]),(0,operators.$r)());let orcidOps$=(0,cjs.of)([]);return this.orcidAuthService.isLinkedToOrcid(item)&&(orcidOps$=this.orcidAuthService.onlyAdminCanDisconnectProfileFromOrcid().pipe((0,operators.Tj)(canDisconnect=>canDisconnect?[new ItemOperation("unlinkOrcid",`${currentUrl}/unlink-orcid`)]:[]))),(0,cjs.combineLatest)([ops$,orcidOps$])}),(0,operators.Tj)(([ops,orcidOps])=>[...ops,...orcidOps])).subscribe(ops=>this.operations$.next(ops)),this.itemPageRoute$=this.itemRD$.pipe((0,shared_operators.Hz)(),(0,operators.Tj)(item=>(0,item_page_routing_paths._o)(item)))}getCurrentUrl(item){return(0,item_page_routing_paths.$r)(item)}trackOperation(index,operation){return(0,empty_util.a4)(operation)?operation.operationKey:void 0}ngOnDestroy(){this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemStatusComponent2)(core.rXU(router.nX),core.rXU(authorization_data_service.AuthorizationDataService),core.rXU(identifier_data_service.IdentifierDataService),core.rXU(configuration_data_service.ConfigurationDataService),core.rXU(orcid_auth_service.r))}}static{this.\u0275cmp=core.VBU({type:ItemStatusComponent2,selectors:[["ds-base-item-status"]],standalone:!0,features:[core.aNF],decls:20,vars:16,consts:[[1,"mt-2"],[1,"row"],[1,"w-100","pt-1"],[1,"col-12","col-md-3","float-start","status-label","fw-bold"],["id","status-itemPage",1,"col-12","col-md-9","float-start","status-data"],[3,"routerLink"],[1,"w-100",3,"ngClass"],[1,"col-12","col-md-9","float-start","status-data",3,"id"],[1,"col-12","col-md-9","float-start","status-label","fw-bold"],[3,"operation"]],template:function(rf,ctx){1&rf&&(core.j41(0,"p",0),core.EFF(1),core.nI1(2,"translate"),core.k0s(),core.j41(3,"div",1),core.Z7z(4,ItemStatusComponent_For_5_Template,6,6,"div",2,core.fX1),core.Z7z(6,ItemStatusComponent_For_7_Template,2,1,"div",2,core.fX1),core.nI1(8,"async"),core.j41(9,"div",3),core.EFF(10),core.nI1(11,"translate"),core.k0s(),core.j41(12,"div",4)(13,"a",5),core.nI1(14,"async"),core.EFF(15),core.nI1(16,"async"),core.k0s()(),core.Z7z(17,ItemStatusComponent_For_18_Template,2,4,"div",6,core.fX1),core.nI1(19,"async"),core.k0s()),2&rf&&(core.R7$(),core.JRh(core.bMT(2,4,"item.edit.tabs.status.description")),core.R7$(3),core.Dyx(ctx.statusDataKeys),core.R7$(2),core.Dyx(core.bMT(8,6,ctx.identifiers$)),core.R7$(4),core.SpI(" ",core.bMT(11,8,"item.edit.tabs.status.labels.itemPage"),": "),core.R7$(3),core.Y8G("routerLink",core.bMT(14,10,ctx.itemPageRoute$)),core.R7$(2),core.JRh(core.bMT(16,12,ctx.itemPageRoute$)),core.R7$(2),core.Dyx(core.bMT(19,14,ctx.operations$)))},dependencies:[common.Jj,item_operation_component.k,common.YU,router.Wk,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2,data:{animation:[fade.qG,fade.Ws]}})}}return ItemStatusComponent2})()},58840:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{o:()=>AccessControlFormContainerComponent});var common=__webpack_require__(87514),fesm2022_forms=__webpack_require__(13054),ngx_translate_core=__webpack_require__(2385),ngx_ui_switch=__webpack_require__(53359),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),bulk_access_config_data_service=__webpack_require__(30748),shared_operators=(__webpack_require__(18683),__webpack_require__(39022)),alert_component=__webpack_require__(6213),alert_type=__webpack_require__(83113),btn_disabled_directive=__webpack_require__(69919),selectable_list_service=__webpack_require__(85984),ng_bootstrap=__webpack_require__(87969),date_util=__webpack_require__(13651),core=__webpack_require__(25376);let ToDatePipe=(()=>{class ToDatePipe2{transform(dateValue){if(!dateValue)return null;const date=new Date(dateValue);return{year:date.getFullYear(),month:date.getMonth()+1,day:date.getDate()}}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ToDatePipe2)}}static{this.\u0275pipe=core.EJ8({name:"toDate",type:ToDatePipe2,pure:!1,standalone:!0})}}return ToDatePipe2})();const _c0=["ngForm"];function AccessControlArrayFormComponent_Conditional_2_Template(rf,ctx){1&rf&&(core.j41(0,"div",3),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"access-control-no-access-conditions-warning-message")," "))}function AccessControlArrayFormComponent_For_4_For_9_Template(rf,ctx){if(1&rf&&(core.j41(0,"option",11),core.EFF(1),core.k0s()),2&rf){const option_r5=ctx.$implicit;core.Y8G("value",option_r5.name),core.R7$(),core.SpI(" ",option_r5.name," ")}}function AccessControlArrayFormComponent_For_4_Conditional_13_Template(rf,ctx){if(1&rf){const _r6=core.RV6();core.j41(0,"div",13)(1,"label",8),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",15)(5,"input",18,1),core.nI1(7,"toDate"),core.mxI("ngModelChange",function($event){core.eBV(_r6);const control_r3=core.XpG().$implicit;return core.DH7(control_r3.startDate,$event)||(control_r3.startDate=$event),core.Njj($event)}),core.k0s(),core.j41(8,"div",19)(9,"button",20),core.bIt("click",function(){core.eBV(_r6);const d_r7=core.sdS(6);return core.Njj(d_r7.toggle())}),core.k0s()()(),core.j41(10,"small",12),core.EFF(11),core.nI1(12,"translate"),core.k0s()()}if(2&rf){const control_r3=core.XpG().$implicit;core.XpG();const ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("for","accesscontrolstartdate-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(3,11,"access-control-option-start-date")," "),core.R7$(3),core.Mz_("id","accesscontrolstartdate-",control_r3.id,""),core.Mz_("name","startDate-",control_r3.id,""),core.R50("ngModel",control_r3.startDate),core.Y8G("maxDate",core.bMT(7,13,control_r3.maxStartDate)),core.R7$(4),core.Y8G("dsBtnDisabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(12,15,"access-control-option-start-date-note")," ")}}function AccessControlArrayFormComponent_For_4_Conditional_14_Template(rf,ctx){if(1&rf){const _r9=core.RV6();core.j41(0,"div",13)(1,"label",8),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"div",15)(5,"input",18,2),core.nI1(7,"toDate"),core.mxI("ngModelChange",function($event){core.eBV(_r9);const control_r3=core.XpG().$implicit;return core.DH7(control_r3.endDate,$event)||(control_r3.endDate=$event),core.Njj($event)}),core.k0s(),core.j41(8,"div",19)(9,"button",20),core.bIt("click",function(){core.eBV(_r9);const d1_r10=core.sdS(6);return core.Njj(d1_r10.toggle())}),core.k0s()()(),core.j41(10,"small",12),core.EFF(11),core.nI1(12,"translate"),core.k0s()()}if(2&rf){const control_r3=core.XpG().$implicit;core.XpG();const ngForm_r8=core.sdS(1);core.R7$(),core.Mz_("for","accesscontrolenddate-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(3,11,"access-control-option-end-date")," "),core.R7$(3),core.Mz_("id","accesscontrolenddate-",control_r3.id,""),core.Mz_("name","endDate-",control_r3.id,""),core.R50("ngModel",control_r3.endDate),core.Y8G("maxDate",core.bMT(7,13,control_r3.maxEndDate)),core.R7$(4),core.Y8G("dsBtnDisabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(12,15,"access-control-option-end-date-note")," ")}}function AccessControlArrayFormComponent_For_4_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"div",4)(1,"div",7)(2,"div")(3,"label",8),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.j41(6,"select",9),core.mxI("ngModelChange",function($event){const control_r3=core.eBV(_r2).$implicit;return core.DH7(control_r3.itemName,$event)||(control_r3.itemName=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){const control_r3=core.eBV(_r2).$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.accessControlChanged(control_r3,$event))}),core.nrm(7,"option",10),core.Z7z(8,AccessControlArrayFormComponent_For_4_For_9_Template,2,2,"option",11,core.fX1),core.k0s(),core.j41(10,"small",12),core.EFF(11),core.nI1(12,"translate"),core.k0s()(),core.DNE(13,AccessControlArrayFormComponent_For_4_Conditional_13_Template,13,17,"div",13)(14,AccessControlArrayFormComponent_For_4_Conditional_14_Template,13,17,"div",13),core.k0s(),core.j41(15,"div")(16,"span",14),core.EFF(17,"\xa0"),core.k0s(),core.j41(18,"div",15)(19,"button",16),core.nI1(20,"translate"),core.bIt("click",function(){const control_r3=core.eBV(_r2).$implicit,ctx_r3=core.XpG();return core.Njj(ctx_r3.removeAccessControlItem(control_r3.id))}),core.nrm(21,"i",17),core.k0s()()()()}if(2&rf){const control_r3=ctx.$implicit,ctx_r3=core.XpG(),ngForm_r8=core.sdS(1);core.Mz_("ngModelGroup","access-control-item-",control_r3.id,""),core.R7$(3),core.Mz_("for","accesscontroloption-",control_r3.id,""),core.R7$(),core.SpI(" ",core.bMT(5,16,"access-control-option-label")," "),core.R7$(2),core.Mz_("id","accesscontroloption-",control_r3.id,""),core.Mz_("name","itemName-",control_r3.id,""),core.Y8G("disabled",ngForm_r8.disabled),core.R50("ngModel",control_r3.itemName),core.R7$(2),core.Dyx(ctx_r3.dropdownOptions),core.R7$(3),core.SpI(" ",core.bMT(12,18,"access-control-option-note")," "),core.R7$(2),core.vxM(control_r3.hasStartDate?13:-1),core.R7$(),core.vxM(control_r3.hasEndDate?14:-1),core.R7$(5),core.Y8G("dsBtnDisabled",ngForm_r8.disabled||1===ctx_r3.form.accessControls.length),core.BMQ("aria-label",core.bMT(20,20,"access-control-remove"))}}let AccessControlArrayFormComponent=(()=>{class AccessControlArrayFormComponent2{constructor(){this.dropdownOptions=[],this.form={accessControls:[emptyAccessControlItem()]},this.formDisabled=!0,this.disable=()=>{this.ngForm.form.disable(),this.formDisabled=!0},this.enable=()=>{this.ngForm.form.enable(),this.formDisabled=!1}}ngOnInit(){this.disable()}get allControlsAreEmpty(){return this.form.accessControls.every(x=>null===x.itemName||""===x.itemName)}get showWarning(){return"replace"===this.mode&&this.allControlsAreEmpty&&!this.formDisabled}addAccessControlItem(itemName=null){this.form.accessControls=[...this.form.accessControls,{...emptyAccessControlItem(),itemName}]}removeAccessControlItem(id){this.form.accessControls=this.form.accessControls.filter(item=>item.id!==id)}getValue(){return this.form.accessControls.filter(x=>null!==x.itemName&&""!==x.itemName).map(x=>({name:x.itemName,startDate:x.startDate?(0,date_util.Sd)(x.startDate):null,endDate:x.endDate?(0,date_util.Sd)(x.endDate):null}))}reset(){this.form.accessControls=[],this.addAccessControlItem(),this.disable()}accessControlChanged(control,selectedItem){const item=this.dropdownOptions.find(x=>x.name===selectedItem);control.startDate=null,control.endDate=null,control.hasStartDate=item?.hasStartDate||!1,control.hasEndDate=item?.hasEndDate||!1,control.maxStartDate=item?.maxStartDate||null,control.maxEndDate=item?.maxEndDate||null}trackById(index,item){return item.id}isValid(){return this.ngForm.valid}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||AccessControlArrayFormComponent2)}}static{this.\u0275cmp=core.VBU({type:AccessControlArrayFormComponent2,selectors:[["ds-access-control-array-form"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(_c0,7),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.ngForm=_t.first)}},inputs:{dropdownOptions:"dropdownOptions",mode:"mode",type:"type"},exportAs:["accessControlArrayForm"],standalone:!0,features:[core.aNF],decls:9,vars:7,consts:[["ngForm","ngForm"],["d","ngbDatepicker"],["d1","ngbDatepicker"],[1,"alert","alert-warning"],[1,"access-control-item","mt-3",3,"ngModelGroup"],["type","button",1,"btn","btn-outline-primary","mt-3",3,"click","id","dsBtnDisabled"],[1,"fas","fa-plus"],[1,"d-flex","flex-column"],[1,"form-label",3,"for"],[1,"form-select",3,"ngModelChange","id","disabled","ngModel","name"],["value",""],[3,"value"],[1,"form-text","text-muted"],[1,"mt-3"],["aria-hidden","true",1,"mb-2","d-inline-block"],[1,"input-group"],["type","button",1,"btn","btn-outline-danger",3,"click","dsBtnDisabled"],[1,"fas","fa-trash"],["placeholder","yyyy-mm-dd","ngbDatepicker","","placement","top-start top-end bottom-start bottom-end",1,"form-control",3,"ngModelChange","id","ngModel","name","maxDate"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary","fas","fa-calendar",3,"click","dsBtnDisabled"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"form",null,0),core.DNE(2,AccessControlArrayFormComponent_Conditional_2_Template,3,3,"div",3),core.Z7z(3,AccessControlArrayFormComponent_For_4_Template,22,22,"div",4,ctx.trackById,!0),core.j41(5,"button",5),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.addAccessControlItem())}),core.nrm(6,"i",6),core.EFF(7),core.nI1(8,"translate"),core.k0s()()}if(2&rf){const ngForm_r8=core.sdS(1);core.R7$(2),core.vxM(ctx.showWarning?2:-1),core.R7$(),core.Dyx(ctx.form.accessControls),core.R7$(2),core.Mz_("id","add-btn-",ctx.type,""),core.Y8G("dsBtnDisabled",ngForm_r8.disabled),core.R7$(2),core.SpI(" ",core.bMT(8,5,"access-control-add-more")," ")}},dependencies:[btn_disabled_directive.A,fesm2022_forms.YN,fesm2022_forms.qT,fesm2022_forms.xH,fesm2022_forms.y7,fesm2022_forms.me,fesm2022_forms.wz,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.vS,fesm2022_forms.Y4,fesm2022_forms.cV,ng_bootstrap.IQ,ng_bootstrap.cw,ToDatePipe,ngx_translate_core.h,ngx_translate_core.D9],styles:[".access-control-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 50px;grid-gap:10px;padding-bottom:15px;border-bottom:2px dotted gray}"]})}}return AccessControlArrayFormComponent2})();const emptyAccessControlItem=()=>({id:randomID(),itemName:null,startDate:null,hasStartDate:!1,maxStartDate:null,endDate:null,hasEndDate:!1,maxEndDate:null}),randomID=()=>Math.floor(1e6*Math.random());var bulk_access_control_service=__webpack_require__(46549),context_model=__webpack_require__(21571),bitstream_data_service=__webpack_require__(94999),pagination_service=__webpack_require__(31903),object_collection_component=(__webpack_require__(43575),__webpack_require__(66613)),pagination_component_options_model=__webpack_require__(54396);const item_access_control_select_bitstreams_modal_component_c0=a0=>({repeatable:!0,listId:a0});function ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Conditional_0_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-viewable-collection",6),2&rf){const bitstreams_r1=core.XpG(),ctx_r1=core.XpG();core.Y8G("config",ctx_r1.paginationConfig)("context",ctx_r1.context)("objects",bitstreams_r1)("selectable",!0)("selectionConfig",core.eq3(6,item_access_control_select_bitstreams_modal_component_c0,ctx_r1.LIST_ID))("showPaginator",!0)}}function ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Conditional_1_Template(rf,ctx){1&rf&&(core.j41(0,"div",7),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"access-control-select-bitstreams-modal.no-items")," "))}function ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Template(rf,ctx){if(1&rf&&core.DNE(0,ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Conditional_0_Template,1,8,"ds-viewable-collection",6)(1,ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Conditional_1_Template,3,3,"div",7),2&rf){const bitstreams_r1=ctx;core.vxM(bitstreams_r1.payload.page.length>0?0:-1),core.R7$(),core.vxM(bitstreams_r1&&0===bitstreams_r1.payload.page.length?1:-1)}}let ItemAccessControlSelectBitstreamsModalComponent=(()=>{class ItemAccessControlSelectBitstreamsModalComponent2{constructor(bitstreamService,paginationService,translateService,activeModal){this.bitstreamService=bitstreamService,this.paginationService=paginationService,this.translateService=translateService,this.activeModal=activeModal,this.LIST_ID="item-access-control-select-bitstreams",this.selectedBitstreams=[],this.context=context_model.o.Bitstream,this.paginationConfig=Object.assign(new pagination_component_options_model.W,{id:"iacsbm",currentPage:1,pageSize:5})}ngOnInit(){this.bitstreams$=this.paginationService.getCurrentPagination(this.paginationConfig.id,this.paginationConfig).pipe((0,operators.nx)(options=>this.bitstreamService.findAllByItemAndBundleName(this.item,"ORIGINAL",{elementsPerPage:options.pageSize,currentPage:options.currentPage},!0,!0)))}ngOnDestroy(){this.paginationService.clearPagination(this.paginationConfig.id)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ItemAccessControlSelectBitstreamsModalComponent2)(core.rXU(bitstream_data_service.BitstreamDataService),core.rXU(pagination_service.m),core.rXU(ngx_translate_core.c$),core.rXU(ng_bootstrap.Lw))}}static{this.\u0275cmp=core.VBU({type:ItemAccessControlSelectBitstreamsModalComponent2,selectors:[["ds-item-access-control-select-bitstreams-modal"]],inputs:{item:"item",selectedBitstreams:"selectedBitstreams"},standalone:!0,features:[core.aNF],decls:12,vars:9,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark",3,"click"],[3,"config","context","objects","selectable","selectionConfig","showPaginator"],["role","alert",1,"alert","alert-info","w-100"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",0)(1,"h4",1),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",2),core.bIt("click",function(){return ctx.activeModal.dismiss("Cross click")}),core.k0s()(),core.j41(5,"div",3),core.DNE(6,ItemAccessControlSelectBitstreamsModalComponent_Conditional_6_Template,2,2),core.nI1(7,"async"),core.k0s(),core.j41(8,"div",4)(9,"button",5),core.bIt("click",function(){return ctx.activeModal.close("Close click")}),core.EFF(10),core.nI1(11,"translate"),core.k0s()()),2&rf){let tmp_1_0;core.R7$(2),core.SpI(" ",core.bMT(3,3,"access-control-select-bitstreams-modal.title")," "),core.R7$(4),core.vxM((tmp_1_0=core.bMT(7,5,ctx.bitstreams$))?6:-1,tmp_1_0),core.R7$(4),core.SpI(" ",core.bMT(11,7,"access-control-select-bitstreams-modal.close")," ")}},dependencies:[common.Jj,object_collection_component.h,ngx_translate_core.h,ngx_translate_core.D9]})}}return ItemAccessControlSelectBitstreamsModalComponent2})();const access_control_form_container_component_c0=["bitstreamAccessCmp"],_c1=["itemAccessCmp"],_c2=()=>[];function AccessControlFormContainerComponent_Conditional_3_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-alert",5),2&rf){const ctx_r1=core.XpG();core.Y8G("type",ctx_r1.AlertType.Info)("content",ctx_r1.titleMessage)}}function AccessControlFormContainerComponent_Conditional_43_Conditional_15_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"button",34),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r4);const ctx_r1=core.XpG(2);return core.Njj(ctx_r1.openSelectBitstreamsModal(ctx_r1.itemRD.payload))}),core.nrm(2,"i",35),core.k0s()}if(2&rf){const ctx_r1=core.XpG(2);core.Y8G("dsBtnDisabled",!ctx_r1.state.bitstream.toggleStatus||"selected"!==ctx_r1.state.bitstream.changesLimit),core.BMQ("aria-label",core.bMT(1,2,"access-control-bitstreams-select"))}}function AccessControlFormContainerComponent_Conditional_43_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"div",11)(1,"fieldset",27)(2,"legend",28),core.EFF(3),core.nI1(4,"translate"),core.k0s(),core.j41(5,"div",14)(6,"input",29),core.mxI("ngModelChange",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.DH7(ctx_r1.state.bitstream.changesLimit,$event)||(ctx_r1.state.bitstream.changesLimit=$event),core.Njj($event)}),core.k0s(),core.j41(7,"label",30),core.EFF(8),core.nI1(9,"translate"),core.k0s()(),core.j41(10,"div",14)(11,"input",31),core.mxI("ngModelChange",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.DH7(ctx_r1.state.bitstream.changesLimit,$event)||(ctx_r1.state.bitstream.changesLimit=$event),core.Njj($event)}),core.k0s(),core.j41(12,"label",32),core.EFF(13),core.nI1(14,"translate"),core.DNE(15,AccessControlFormContainerComponent_Conditional_43_Conditional_15_Template,3,4,"button",33),core.k0s()()()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(3),core.SpI(" ",core.bMT(4,9,"access-control-limit-to-specific")," "),core.R7$(3),core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus),core.R50("ngModel",ctx_r1.state.bitstream.changesLimit),core.R7$(2),core.SpI(" ",core.bMT(9,11,"access-control-process-all-bitstreams")," "),core.R7$(3),core.Y8G("disabled",!ctx_r1.state.bitstream.toggleStatus),core.R50("ngModel",ctx_r1.state.bitstream.changesLimit),core.R7$(2),core.Lme(" ",ctx_r1.state.bitstream.selectedBitstreams.length," ",core.bMT(14,13,"access-control-bitstreams-selected")," "),core.R7$(2),core.vxM(ctx_r1.itemRD?15:-1)}}function AccessControlFormContainerComponent_Conditional_66_Template(rf,ctx){1&rf&&core.nrm(0,"hr")}function AccessControlFormContainerComponent_Conditional_67_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",26)(1,"button",36),core.bIt("click",function(){core.eBV(_r5);const ctx_r1=core.XpG();return core.Njj(ctx_r1.reset())}),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",37),core.bIt("click",function(){core.eBV(_r5);const ctx_r1=core.XpG();return core.Njj(ctx_r1.submit())}),core.EFF(5),core.nI1(6,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.SpI(" ",core.bMT(3,3,"access-control-cancel")," "),core.R7$(2),core.Y8G("dsBtnDisabled",!ctx_r1.state.item.toggleStatus&&!ctx_r1.state.bitstream.toggleStatus),core.R7$(),core.SpI(" ",core.bMT(6,5,"access-control-execute")," ")}}let AccessControlFormContainerComponent=(()=>{class AccessControlFormContainerComponent2{constructor(bulkAccessConfigService,bulkAccessControlService,selectableListService,modalService,cdr){this.bulkAccessConfigService=bulkAccessConfigService,this.bulkAccessControlService=bulkAccessControlService,this.selectableListService=selectableListService,this.modalService=modalService,this.cdr=cdr,this.showLimitToSpecificBitstreams=!1,this.titleMessage="",this.showSubmit=!0,this.AlertType=alert_type.v,this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}},this.dropdownData$=this.bulkAccessConfigService.findByName("default").pipe((0,shared_operators.qD)(),(0,operators.Tj)(configRD=>configRD.hasSucceeded?configRD.payload:null),(0,cjs.shareReplay)({refCount:!1,bufferSize:1}))}getFormValue(){return console.log({bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}),{bitstream:this.bitstreamAccessCmp.getValue(),item:this.itemAccessCmp.getValue(),state:this.state}}reset(){this.bitstreamAccessCmp.reset(),this.itemAccessCmp.reset(),this.state={item:{toggleStatus:!1,accessMode:"replace"},bitstream:{toggleStatus:!1,accessMode:"replace",changesLimit:"all",selectedBitstreams:[]}}}submit(){const bitstreamAccess=this.bitstreamAccessCmp.getValue(),itemAccess=this.itemAccessCmp.getValue(),{file}=this.bulkAccessControlService.createPayloadFile({bitstreamAccess,itemAccess,state:this.state});this.bulkAccessControlService.executeScript([this.itemRD.payload.uuid],file).pipe((0,operators.s)(1)).subscribe(res=>{console.log("success",res)})}handleStatusChange(type,active){"bitstream"===type?active?this.bitstreamAccessCmp.enable():this.bitstreamAccessCmp.disable():"item"===type&&(active?this.itemAccessCmp.enable():this.itemAccessCmp.disable())}openSelectBitstreamsModal(item){const ref=this.modalService.open(ItemAccessControlSelectBitstreamsModalComponent);ref.componentInstance.selectedBitstreams=this.state.bitstream.selectedBitstreams,ref.componentInstance.item=item,ref.closed.pipe((0,cjs.concatMap)(()=>this.selectableListService.getSelectableList("item-access-control-select-bitstreams")),(0,operators.s)(1)).subscribe(list=>{this.state.bitstream.selectedBitstreams=list?.selection||[],this.cdr.detectChanges()})}ngOnDestroy(){this.selectableListService.deselectAll("item-access-control-select-bitstreams")}isValid(){return this.bitstreamAccessCmp.isValid()||this.itemAccessCmp.isValid()}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||AccessControlFormContainerComponent2)(core.rXU(bulk_access_config_data_service.BulkAccessConfigDataService),core.rXU(bulk_access_control_service.r),core.rXU(selectable_list_service.K),core.rXU(ng_bootstrap.Bq),core.rXU(core.gRc))}}static{this.\u0275cmp=core.VBU({type:AccessControlFormContainerComponent2,selectors:[["ds-access-control-form-container"]],viewQuery:function(rf,ctx){if(1&rf&&(core.GBs(access_control_form_container_component_c0,7),core.GBs(_c1,7)),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.bitstreamAccessCmp=_t.first),core.mGM(_t=core.lsd())&&(ctx.itemAccessCmp=_t.first)}},inputs:{showLimitToSpecificBitstreams:"showLimitToSpecificBitstreams",titleMessage:"titleMessage",itemRD:"itemRD",showSubmit:"showSubmit"},exportAs:["dsAccessControlForm"],standalone:!0,features:[core.aNF],decls:68,vars:62,consts:[["itemAccessCmp",""],["bitstreamAccessCmp",""],[1,"container"],[1,"card","border-0"],[1,"card-body"],[1,"d-block","pb-3",3,"type","content"],[1,"row","mt-5"],[1,"col-12","col-md-6","border-end","d-flex","flex-column","justify-content-between"],[1,"d-flex","align-items-center"],[1,"h3","mb-0","me-4"],[3,"ngModelChange","ariaLabel","ngModel"],[1,"row","mt-3"],[1,"h4","col-12","col-md-3"],[1,"col-12","col-md-8"],[1,"form-check"],["type","radio","name","itemMode","id","itemReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemReplace",1,"form-check-label"],["type","radio","name","itemMode","id","itemAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","itemAdd",1,"form-check-label"],[1,"h4","mt-3"],[3,"type","mode","dropdownOptions"],[1,"col-12","col-md-6","d-flex","flex-column","justify-content-between"],["type","radio","name","bitstreamMode","id","bitstreamReplace","value","replace",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamReplace",1,"form-check-label"],["type","radio","name","bitstreamMode","id","bitstreamAdd","value","add",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","bitstreamAdd",1,"form-check-label"],[1,"d-flex","justify-content-end"],[1,"col-12"],[1,"h4"],["type","radio","name","changesLimit","id","processAll","value","all",1,"form-check-input",3,"ngModelChange","disabled","ngModel"],["for","processAll",1,"form-check-label"],["type","radio","name","changesLimit","id","processSelected","value","selected",1,"form-check-input","mt-2",3,"ngModelChange","disabled","ngModel"],["for","processSelected",1,"form-check-label"],["type","button",1,"btn","btn-outline-dark","border-0",3,"dsBtnDisabled"],["type","button",1,"btn","btn-outline-dark","border-0",3,"click","dsBtnDisabled"],[1,"fa","fa-search"],["type","button",1,"btn","btn-outline-primary","me-3",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","dsBtnDisabled"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div",2)(1,"div",3)(2,"div",4),core.DNE(3,AccessControlFormContainerComponent_Conditional_3_Template,1,2,"ds-alert",5),core.j41(4,"div",6)(5,"div",7)(6,"div")(7,"div",8)(8,"h2",9),core.EFF(9),core.nI1(10,"translate"),core.k0s(),core.j41(11,"ui-switch",10),core.nI1(12,"translate"),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.toggleStatus,$event)||(ctx.state.item.toggleStatus=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){return core.eBV(_r1),core.Njj(ctx.handleStatusChange("item",$event))}),core.k0s()(),core.j41(13,"fieldset",11)(14,"legend",12),core.EFF(15),core.nI1(16,"translate"),core.k0s(),core.j41(17,"div",13)(18,"div",14)(19,"input",15),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.accessMode,$event)||(ctx.state.item.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(20,"label",16),core.EFF(21),core.nI1(22,"translate"),core.k0s()(),core.j41(23,"div",14)(24,"input",17),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.item.accessMode,$event)||(ctx.state.item.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(25,"label",18),core.EFF(26),core.nI1(27,"translate"),core.k0s()()()()(),core.j41(28,"div")(29,"h3",19),core.EFF(30),core.nI1(31,"translate"),core.k0s(),core.nrm(32,"ds-access-control-array-form",20,0),core.nI1(34,"async"),core.k0s()(),core.j41(35,"div",21)(36,"div")(37,"div",8)(38,"h2",9),core.EFF(39),core.nI1(40,"translate"),core.k0s(),core.j41(41,"ui-switch",10),core.nI1(42,"translate"),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.toggleStatus,$event)||(ctx.state.bitstream.toggleStatus=$event),core.Njj($event)}),core.bIt("ngModelChange",function($event){return core.eBV(_r1),core.Njj(ctx.handleStatusChange("bitstream",$event))}),core.k0s()(),core.DNE(43,AccessControlFormContainerComponent_Conditional_43_Template,16,15,"div",11),core.k0s(),core.j41(44,"fieldset",11)(45,"legend",12),core.EFF(46),core.nI1(47,"translate"),core.k0s(),core.j41(48,"div",13)(49,"div",14)(50,"input",22),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.accessMode,$event)||(ctx.state.bitstream.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(51,"label",23),core.EFF(52),core.nI1(53,"translate"),core.k0s()(),core.j41(54,"div",14)(55,"input",24),core.mxI("ngModelChange",function($event){return core.eBV(_r1),core.DH7(ctx.state.bitstream.accessMode,$event)||(ctx.state.bitstream.accessMode=$event),core.Njj($event)}),core.k0s(),core.j41(56,"label",25),core.EFF(57),core.nI1(58,"translate"),core.k0s()()()(),core.j41(59,"div")(60,"h3",19),core.EFF(61),core.nI1(62,"translate"),core.k0s(),core.nrm(63,"ds-access-control-array-form",20,1),core.nI1(65,"async"),core.k0s()()(),core.DNE(66,AccessControlFormContainerComponent_Conditional_66_Template,1,0,"hr")(67,AccessControlFormContainerComponent_Conditional_67_Template,7,7,"div",26),core.k0s()()()}if(2&rf){let tmp_16_0,tmp_31_0;core.R7$(3),core.vxM(ctx.titleMessage?3:-1),core.R7$(6),core.SpI(" ",core.bMT(10,32,"access-control-item-header-toggle")," "),core.R7$(2),core.Y8G("ariaLabel",core.bMT(12,34,ctx.state.bitstream.toggleStatus?"access-control-item-toggle.disable":"access-control-item-toggle.enable")),core.R50("ngModel",ctx.state.item.toggleStatus),core.R7$(4),core.SpI(" ",core.bMT(16,36,"access-control-mode")," "),core.R7$(4),core.Y8G("disabled",!ctx.state.item.toggleStatus),core.R50("ngModel",ctx.state.item.accessMode),core.R7$(2),core.SpI(" ",core.bMT(22,38,"access-control-replace-all")," "),core.R7$(3),core.Y8G("disabled",!ctx.state.item.toggleStatus),core.R50("ngModel",ctx.state.item.accessMode),core.R7$(2),core.SpI(" ",core.bMT(27,40,"access-control-add-to-existing")," "),core.R7$(4),core.JRh(core.bMT(31,42,"access-control-access-conditions")),core.R7$(2),core.Y8G("type","item")("mode",ctx.state.item.accessMode)("dropdownOptions",(null==(tmp_16_0=core.bMT(34,44,ctx.dropdownData$))?null:tmp_16_0.itemAccessConditionOptions)||core.lJ4(60,_c2)),core.R7$(7),core.SpI(" ",core.bMT(40,46,"access-control-bitstream-header-toggle")," "),core.R7$(2),core.Y8G("ariaLabel",core.bMT(42,48,ctx.state.bitstream.toggleStatus?"access-control-bitstream-toggle.disable":"access-control-bitstream-toggle.enable")),core.R50("ngModel",ctx.state.bitstream.toggleStatus),core.R7$(2),core.vxM(ctx.showLimitToSpecificBitstreams?43:-1),core.R7$(3),core.SpI(" ",core.bMT(47,50,"access-control-mode")," "),core.R7$(4),core.Y8G("disabled",!ctx.state.bitstream.toggleStatus),core.R50("ngModel",ctx.state.bitstream.accessMode),core.R7$(2),core.SpI(" ",core.bMT(53,52,"access-control-replace-all")," "),core.R7$(3),core.Y8G("disabled",!ctx.state.bitstream.toggleStatus),core.R50("ngModel",ctx.state.bitstream.accessMode),core.R7$(2),core.SpI(" ",core.bMT(58,54,"access-control-add-to-existing")," "),core.R7$(4),core.JRh(core.bMT(62,56,"access-control-access-conditions")),core.R7$(2),core.Y8G("type","bitstream")("mode",ctx.state.bitstream.accessMode)("dropdownOptions",(null==(tmp_31_0=core.bMT(65,58,ctx.dropdownData$))?null:tmp_31_0.bitstreamAccessConditionOptions)||core.lJ4(61,_c2)),core.R7$(3),core.vxM(ctx.showSubmit?66:-1),core.R7$(),core.vxM(ctx.showSubmit?67:-1)}},dependencies:[AccessControlArrayFormComponent,alert_component.C,common.Jj,btn_disabled_directive.A,fesm2022_forms.YN,fesm2022_forms.me,fesm2022_forms.Fm,fesm2022_forms.BC,fesm2022_forms.vS,ngx_translate_core.h,ngx_translate_core.D9,ngx_ui_switch.z,ngx_ui_switch.S],styles:["fieldset[_ngcontent-%COMP%] > legend.col-12.col-md-3[_ngcontent-%COMP%]{width:100%}"]})}}return AccessControlFormContainerComponent2})()},46549:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{r:()=>BulkAccessControlService});var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(60444),_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(83183),_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39022),_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(54663),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2794),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(76623),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(25376),_angular_router__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(18134),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2385);let BulkAccessControlService=(()=>{class BulkAccessControlService2{constructor(notificationsService,router,scriptService,translationService){this.notificationsService=notificationsService,this.router=router,this.scriptService=scriptService,this.translationService=translationService}createPayloadFile(payload){const content=convertToBulkAccessControlFileModel(payload),blob=new Blob([JSON.stringify(content,null,2)],{type:"application/json"}),file=new File([blob],"data.json",{type:"application/json"});return{url:URL.createObjectURL(file),file}}executeScript(uuids,file){console.log("execute",{uuids,file});const params=[{name:"-f",value:file.name}];return uuids.forEach(uuid=>{params.push({name:"-u",value:uuid})}),this.scriptService.invoke("bulk-access-control",params,[file]).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_3__.Tj)(rd=>{if(rd.hasSucceeded){const title=this.translationService.get("process.new.notification.success.title"),content=this.translationService.get("process.new.notification.success.content");return this.notificationsService.success(title,content),(0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.hj)(rd.payload)&&this.router.navigateByUrl((0,_process_page_process_page_routing_paths__WEBPACK_IMPORTED_MODULE_5__.yJ)(rd.payload.processId)),!0}{const title=this.translationService.get("process.new.notification.error.title"),content=this.translationService.get("process.new.notification.error.content");return this.notificationsService.error(title,content),!1}}))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||BulkAccessControlService2)(_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_2__.I),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_angular_router__WEBPACK_IMPORTED_MODULE_7__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_core_data_processes_script_data_service__WEBPACK_IMPORTED_MODULE_0__.ScriptDataService),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__.c$))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_6__.jDH({token:BulkAccessControlService2,factory:BulkAccessControlService2.\u0275fac,providedIn:"root"})}}return BulkAccessControlService2})();const convertToBulkAccessControlFileModel=payload=>{const finalPayload={},bitstreamEnabled=payload.state.bitstream.toggleStatus;if(payload.state.item.toggleStatus&&(finalPayload.item={mode:payload.state.item.accessMode,accessConditions:payload.itemAccess}),bitstreamEnabled){const constraints={uuid:[]};bitstreamEnabled&&"selected"===payload.state.bitstream.changesLimit&&(constraints.uuid=payload.state.bitstream.selectedBitstreams.map(x=>x.id)),finalPayload.bitstream={constraints,mode:payload.state.bitstream.accessMode,accessConditions:payload.bitstreamAccess}}return finalPayload}},72004:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>DSpaceObjectSelect});class DSpaceObjectSelect{}},44631:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{h:()=>ObjectSelectComponent});var core=__webpack_require__(25376),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),dso_name_service=__webpack_require__(11481),authorization_data_service=(__webpack_require__(60795),__webpack_require__(76509)),ngrx_store=(__webpack_require__(86583),__webpack_require__(22609)),empty_util=__webpack_require__(2794),object_select_actions=__webpack_require__(45545);const objectSelectionsStateSelector=state=>state.objectSelection,objectSelectionListStateSelector=state=>state.objectSelection;let ObjectSelectService=(()=>{class ObjectSelectService2{constructor(store,appStore){this.store=store,this.appStore=appStore}getSelected(key,id){return this.store.select(function selectionByKeyAndIdSelector(key,id){return function keyAndIdSelector(key,id){return(0,ngrx_store.Mz)(objectSelectionsStateSelector,state=>{if((0,empty_util.a4)(state)&&(0,empty_util.a4)(state[key]))return state[key][id]})}(key,id)}(key,id)).pipe((0,operators.Tj)(object=>!!object&&object.checked))}getAllSelected(key){return this.appStore.select(objectSelectionListStateSelector).pipe((0,operators.Tj)(state=>(0,empty_util.a4)(state[key])?Object.keys(state[key]).filter(id=>state[key][id].checked):[]))}initialSelect(key,id){this.store.dispatch(new object_select_actions.u7(key,id))}initialDeselect(key,id){this.store.dispatch(new object_select_actions.NE(key,id))}select(key,id){this.store.dispatch(new object_select_actions.AS(key,id))}deselect(key,id){this.store.dispatch(new object_select_actions.Vu(key,id))}switch(key,id){this.store.dispatch(new object_select_actions.YE(key,id))}reset(key){this.store.dispatch(new object_select_actions.bx(key,null))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ObjectSelectService2)(core.KVO(ngrx_store.il),core.KVO(ngrx_store.il))}}static{this.\u0275prov=core.jDH({token:ObjectSelectService2,factory:ObjectSelectService2.\u0275fac,providedIn:"root"})}}return ObjectSelectService2})(),ObjectSelectComponent=(()=>{class ObjectSelectComponent2{constructor(objectSelectService,authorizationService,dsoNameService){this.objectSelectService=objectSelectService,this.authorizationService=authorizationService,this.dsoNameService=dsoNameService,this.cancel=new core.bkB,this.confirm=new core.bkB,this.dangerConfirm=!1}ngOnInit(){this.selectedIds$=this.objectSelectService.getAllSelected(this.key)}ngOnDestroy(){this.objectSelectService.reset(this.key)}switch(id){this.objectSelectService.switch(this.key,id)}getSelected(id){return this.objectSelectService.getSelected(this.key,id)}canSelect(item){return this.featureId?this.authorizationService.isAuthorized(this.featureId,item.self).pipe((0,operators.ql)(!1)):(0,cjs.of)(!0)}confirmSelected(){this.selectedIds$.pipe((0,operators.s)(1)).subscribe(ids=>{this.confirm.emit(ids),this.objectSelectService.reset(this.key)})}onCancel(){this.cancel.emit()}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ObjectSelectComponent2)(core.rXU(ObjectSelectService),core.rXU(authorization_data_service.AuthorizationDataService),core.rXU(dso_name_service.f))}}static{this.\u0275cmp=core.VBU({type:ObjectSelectComponent2,selectors:[["ds-object-select-abstract"]],inputs:{key:"key",dsoRD$:"dsoRD$",paginationOptions:"paginationOptions",sortOptions:"sortOptions",confirmButton:"confirmButton",featureId:"featureId",cancelButton:"cancelButton",dangerConfirm:"dangerConfirm"},outputs:{cancel:"cancel",confirm:"confirm"},standalone:!0,features:[core.aNF],decls:0,vars:0,template:function(rf,ctx){},encapsulation:2})}}return ObjectSelectComponent2})()},67149:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{m:()=>ResourcePolicyCreateComponent});var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2385),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9238),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(60444),_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(11481),_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(23390),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(39022),_item_page_edit_item_page_edit_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(55567),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(76623),_form_resource_policy_form_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(52260),_angular_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(25376),_angular_router__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(18134);let ResourcePolicyCreateComponent=(()=>{class ResourcePolicyCreateComponent2{constructor(dsoNameService,notificationsService,resourcePolicyService,route,router,translate){this.dsoNameService=dsoNameService,this.notificationsService=notificationsService,this.resourcePolicyService=resourcePolicyService,this.route=route,this.router=router,this.translate=translate,this.processing$=new rxjs__WEBPACK_IMPORTED_MODULE_5__.BehaviorSubject(!1)}ngOnInit(){this.route.data.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.Tj)(data=>data),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.s)(1)).subscribe(data=>{this.targetResourceUUID=data.resourcePolicyTarget.payload.id,this.targetResourceName=this.dsoNameService.getName(data.resourcePolicyTarget.payload)})}isProcessing(){return this.processing$.asObservable()}redirectToAuthorizationsPage(){this.router.navigate([`../../${_item_page_edit_item_page_edit_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_7__.K4}`],{relativeTo:this.route})}createResourcePolicy(event){let response$;this.processing$.next(!0),response$="eperson"===event.target.type?this.resourcePolicyService.create(event.object,this.targetResourceUUID,event.target.uuid):this.resourcePolicyService.create(event.object,this.targetResourceUUID,null,event.target.uuid),response$.pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)()).subscribe(responseRD=>{this.processing$.next(!1),responseRD.hasSucceeded?(this.notificationsService.success(null,this.translate.get("resource-policies.create.page.success.content")),this.redirectToAuthorizationsPage()):this.notificationsService.error(null,this.translate.get("resource-policies.create.page.failure.content"))})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ResourcePolicyCreateComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_breadcrumbs_dso_name_service__WEBPACK_IMPORTED_MODULE_0__.f),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__.I),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_1__.ResourcePolicyDataService),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_9__.nX),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_9__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.c$))}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_8__.VBU({type:ResourcePolicyCreateComponent2,selectors:[["ds-resource-policy-create"]],standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_8__.aNF],decls:5,vars:5,consts:[[1,"container"],[1,"mb-3"],[3,"reset","submit","isProcessing"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"div",0)(1,"h1",1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(4,"ds-resource-policy-form",2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.bIt("reset",function(){return ctx.redirectToAuthorizationsPage()})("submit",function($event){return ctx.createResourcePolicy($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Lme("",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(3,3,"resource-policies.create.page.heading")," ",ctx.targetResourceName,""),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("isProcessing",ctx.isProcessing()))},dependencies:[_form_resource_policy_form_component__WEBPACK_IMPORTED_MODULE_4__.y,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.D9],encapsulation:2})}}return ResourcePolicyCreateComponent2})()},79537:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{_:()=>ResourcePolicyEditComponent});var _ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2385),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9238),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(60444),_core_resource_policy_models_resource_policy_resource_type__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10446),_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(23390),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(39022),_item_page_edit_item_page_edit_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(55567),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(76623),_form_resource_policy_form_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(52260),_angular_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(25376),_angular_router__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(18134);let ResourcePolicyEditComponent=(()=>{class ResourcePolicyEditComponent2{constructor(notificationsService,resourcePolicyService,route,router,translate){this.notificationsService=notificationsService,this.resourcePolicyService=resourcePolicyService,this.route=route,this.router=router,this.translate=translate,this.processing$=new rxjs__WEBPACK_IMPORTED_MODULE_5__.BehaviorSubject(!1)}ngOnInit(){this.route.data.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.Tj)(data=>data),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.s)(1)).subscribe(data=>{this.resourcePolicy=data.resourcePolicy.payload})}isProcessing(){return this.processing$.asObservable()}redirectToAuthorizationsPage(){this.router.navigate([`../../${_item_page_edit_item_page_edit_item_page_routing_paths__WEBPACK_IMPORTED_MODULE_7__.K4}`],{relativeTo:this.route})}updateResourcePolicy(event){this.processing$.next(!0);const updatedObject=Object.assign({},event.object,{id:this.resourcePolicy.id,type:_core_resource_policy_models_resource_policy_resource_type__WEBPACK_IMPORTED_MODULE_0__.O.value,_links:this.resourcePolicy._links}),updateTargetSucceeded$=event.updateTarget?this.resourcePolicyService.updateTarget(this.resourcePolicy.id,this.resourcePolicy._links.self.href,event.target.uuid,event.target.type).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.Tj)(responseRD=>responseRD&&responseRD.hasSucceeded)):(0,rxjs__WEBPACK_IMPORTED_MODULE_5__.of)(!0),updateResourcePolicySucceeded$=this.resourcePolicyService.update(updatedObject).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)(),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.Tj)(responseRD=>responseRD&&responseRD.hasSucceeded));(0,rxjs__WEBPACK_IMPORTED_MODULE_5__.combineLatest)([updateTargetSucceeded$,updateResourcePolicySucceeded$]).subscribe(([updateTargetSucceeded,updateResourcePolicySucceeded])=>{this.processing$.next(!1),updateTargetSucceeded&&updateResourcePolicySucceeded?(this.notificationsService.success(null,this.translate.get("resource-policies.edit.page.success.content")),this.redirectToAuthorizationsPage()):this.notificationsService.error(null,this.translate.get(updateResourcePolicySucceeded?"resource-policies.edit.page.target-failure.content":updateTargetSucceeded?"resource-policies.edit.page.other-failure.content":"resource-policies.edit.page.failure.content"))})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ResourcePolicyEditComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__.I),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_1__.ResourcePolicyDataService),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_9__.nX),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_9__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_8__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.c$))}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_8__.VBU({type:ResourcePolicyEditComponent2,selectors:[["ds-resource-policy-edit"]],standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_8__.aNF],decls:5,vars:6,consts:[[1,"container"],[1,"mb-3"],[3,"reset","submit","resourcePolicy","isProcessing"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(0,"div",0)(1,"h1",1),_angular_core__WEBPACK_IMPORTED_MODULE_8__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.nI1(3,"translate"),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_8__.j41(4,"ds-resource-policy-form",2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.bIt("reset",function(){return ctx.redirectToAuthorizationsPage()})("submit",function($event){return ctx.updateResourcePolicy($event)}),_angular_core__WEBPACK_IMPORTED_MODULE_8__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Lme("",_angular_core__WEBPACK_IMPORTED_MODULE_8__.bMT(3,4,"resource-policies.edit.page.heading")," ",ctx.resourcePolicy.id,""),_angular_core__WEBPACK_IMPORTED_MODULE_8__.R7$(2),_angular_core__WEBPACK_IMPORTED_MODULE_8__.Y8G("resourcePolicy",ctx.resourcePolicy)("isProcessing",ctx.isProcessing()))},dependencies:[_form_resource_policy_form_component__WEBPACK_IMPORTED_MODULE_4__.y,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.h,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_10__.D9],encapsulation:2})}}return ResourcePolicyEditComponent2})()},52260:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{y:()=>ResourcePolicyFormComponent});var common=__webpack_require__(87514),core=__webpack_require__(25376),ng_bootstrap=__webpack_require__(87969),fesm2020_core=__webpack_require__(19519),ngx_translate_core=__webpack_require__(2385),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),dso_name_service=__webpack_require__(11481),request_service=__webpack_require__(64806),eperson_data_service=__webpack_require__(15318),group_data_service=__webpack_require__(14557),resource_policy_model=__webpack_require__(20568),resource_policy_resource_type=__webpack_require__(10446),shared_operators=__webpack_require__(39022),btn_disabled_directive=__webpack_require__(69919),date_util=__webpack_require__(13651),empty_util=__webpack_require__(2794),eperson_group_list_component=__webpack_require__(65344),ds_dynamic_input_model=__webpack_require__(72528),ds_dynamic_textarea_model=__webpack_require__(46946),form_component=__webpack_require__(27790),form_service=__webpack_require__(83148),action_type_model=__webpack_require__(6188),policy_type_model=__webpack_require__(47052);const policyTypeList=[{label:policy_type_model.t.TYPE_SUBMISSION,value:policy_type_model.t.TYPE_SUBMISSION},{label:policy_type_model.t.TYPE_WORKFLOW,value:policy_type_model.t.TYPE_WORKFLOW},{label:policy_type_model.t.TYPE_INHERITED,value:policy_type_model.t.TYPE_INHERITED},{label:policy_type_model.t.TYPE_CUSTOM,value:policy_type_model.t.TYPE_CUSTOM}],policyActionList=[{label:action_type_model.X.READ.toString(),value:action_type_model.X.READ},{label:action_type_model.X.WRITE.toString(),value:action_type_model.X.WRITE},{label:action_type_model.X.REMOVE.toString(),value:action_type_model.X.REMOVE},{label:action_type_model.X.ADMIN.toString(),value:action_type_model.X.ADMIN},{label:action_type_model.X.DELETE.toString(),value:action_type_model.X.DELETE},{label:action_type_model.X.WITHDRAWN_READ.toString(),value:action_type_model.X.WITHDRAWN_READ},{label:action_type_model.X.DEFAULT_BITSTREAM_READ.toString(),value:action_type_model.X.DEFAULT_BITSTREAM_READ},{label:action_type_model.X.DEFAULT_ITEM_READ.toString(),value:action_type_model.X.DEFAULT_ITEM_READ}],RESOURCE_POLICY_FORM_NAME_CONFIG={id:"name",label:"resource-policies.form.name.label",maxLength:30,hint:"resource-policies.form.name.hint",metadataFields:[],repeatable:!1,submissionId:"",hasSelectableMetadata:!1},RESOURCE_POLICY_FORM_DESCRIPTION_CONFIG={id:"description",label:"resource-policies.form.description.label",metadataFields:[],repeatable:!1,rows:10,submissionId:"",hasSelectableMetadata:!1},RESOURCE_POLICY_FORM_POLICY_TYPE_CONFIG={id:"policyType",label:"resource-policies.form.policy-type.label",options:policyTypeList,required:!0,validators:{required:null},errorMessages:{required:"resource-policies.form.policy-type.required"}},RESOURCE_POLICY_FORM_ACTION_TYPE_CONFIG={id:"action",label:"resource-policies.form.action-type.label",options:policyActionList,required:!0,validators:{required:null},errorMessages:{required:"resource-policies.form.action-type.required"}},RESOURCE_POLICY_FORM_DATE_GROUP_CONFIG={id:"date",group:[]},RESOURCE_POLICY_FORM_DATE_GROUP_LAYOUT={element:{control:"row"}},RESOURCE_POLICY_FORM_START_DATE_CONFIG={id:"start",label:"resource-policies.form.date.start.label",placeholder:"resource-policies.form.date.start.label",inline:!1,toggleIcon:"far fa-calendar-alt"},RESOURCE_POLICY_FORM_START_DATE_LAYOUT={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-6"}},RESOURCE_POLICY_FORM_END_DATE_CONFIG={id:"end",label:"resource-policies.form.date.end.label",placeholder:"resource-policies.form.date.end.label",inline:!1,toggleIcon:"far fa-calendar-alt"},RESOURCE_POLICY_FORM_END_DATE_LAYOUT={element:{container:"p-0",label:"col-form-label"},grid:{host:"col-md-6"}},_c0=["content"];function ResourcePolicyFormComponent_Conditional_1_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-form",3,2),2&rf){const ctx_r1=core.XpG();core.Y8G("formId",ctx_r1.formId)("formModel",ctx_r1.formModel)("displaySubmit",!1)("displayCancel",!1)}}function ResourcePolicyFormComponent_ng_template_14_Template(rf,ctx){if(1&rf){const _r3=core.RV6();core.j41(0,"ds-eperson-group-list",16),core.bIt("select",function($event){core.eBV(_r3);const ctx_r1=core.XpG();return core.Njj(ctx_r1.updateObjectSelected($event,!0))}),core.k0s()}}function ResourcePolicyFormComponent_ng_template_19_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"ds-eperson-group-list",17),core.bIt("select",function($event){core.eBV(_r4);const ctx_r1=core.XpG();return core.Njj(ctx_r1.updateObjectSelected($event,!1))}),core.k0s()}2&rf&&core.Y8G("isListOfEPerson",!1)}function ResourcePolicyFormComponent_Conditional_32_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",18),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"submission.workflow.tasks.generic.processing")," "))}function ResourcePolicyFormComponent_Conditional_34_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"form.submit")," "))}function ResourcePolicyFormComponent_ng_template_36_Template(rf,ctx){if(1&rf){const _r5=core.RV6();core.j41(0,"div",19)(1,"h4",20),core.EFF(2),core.nI1(3,"translate"),core.k0s(),core.j41(4,"button",21),core.bIt("click",function(){const modal_r6=core.eBV(_r5).$implicit;return core.Njj(modal_r6.close())}),core.k0s()(),core.j41(5,"div",22)(6,"div",23)(7,"div",24),core.nrm(8,"i",25),core.k0s(),core.j41(9,"div"),core.nrm(10,"p",26),core.nI1(11,"translate"),core.nrm(12,"p",27),core.nI1(13,"translate"),core.k0s()()(),core.j41(14,"div",28)(15,"button",29),core.bIt("click",function(){const modal_r6=core.eBV(_r5).$implicit;return core.Njj(modal_r6.close())}),core.EFF(16),core.nI1(17,"translate"),core.k0s()()}if(2&rf){const ctx_r1=core.XpG();core.R7$(2),core.JRh(core.bMT(3,4,"resource-policies.form.eperson-group-list.modal.header")),core.R7$(8),core.Y8G("innerHTML",core.bMT(11,6,"eperson"===ctx_r1.navActiveId?"resource-policies.form.eperson-group-list.modal.text1.toGroup":"resource-policies.form.eperson-group-list.modal.text1.toEPerson"),core.npT),core.R7$(2),core.Y8G("innerHTML",core.bMT(13,8,"resource-policies.form.eperson-group-list.modal.text2"),core.npT),core.R7$(4),core.JRh(core.bMT(17,10,"resource-policies.form.eperson-group-list.modal.close"))}}let ResourcePolicyFormComponent=(()=>{class ResourcePolicyFormComponent2{constructor(dsoNameService,ePersonService,formService,groupService,requestService,modalService){this.dsoNameService=dsoNameService,this.ePersonService=ePersonService,this.formService=formService,this.groupService=groupService,this.requestService=requestService,this.modalService=modalService,this.isProcessing=(0,cjs.of)(!1),this.reset=new core.bkB,this.submit=new core.bkB,this.resourcePolicyTargetName$=new cjs.BehaviorSubject(""),this.subs=[],this.resourcePolicyTargetUpdated=!1}ngOnInit(){if(this.isActive=!0,this.formId=this.formService.getUniqueId("resource-policy-form"),this.formModel=this.buildResourcePolicyForm(),this.isBeingEdited()){const epersonRD$=this.ePersonService.findByHref(this.resourcePolicy._links.eperson.href,!1).pipe((0,shared_operators.yd)()),groupRD$=this.groupService.findByHref(this.resourcePolicy._links.group.href,!1).pipe((0,shared_operators.yd)()),dsoRD$=(0,cjs.combineLatest)([epersonRD$,groupRD$]).pipe((0,operators.Tj)(rdArr=>rdArr.find(rd=>(0,empty_util.hj)(rd.payload))),(0,empty_util.Az)());this.subs.push(dsoRD$.pipe((0,operators.pb)(()=>this.isActive)).subscribe(dsoRD=>{this.resourcePolicyGrant=dsoRD.payload,this.navActiveId=String(dsoRD.payload.type),this.resourcePolicyTargetName$.next(this.getResourcePolicyTargetName())}))}}isFormValid(){return this.formService.isValid(this.formId).pipe((0,operators.Tj)(isValid=>isValid&&(0,empty_util.hj)(this.resourcePolicyGrant)))}buildResourcePolicyForm(){const formModel=[];formModel.push(new ds_dynamic_input_model.C(RESOURCE_POLICY_FORM_NAME_CONFIG),new ds_dynamic_textarea_model.E(RESOURCE_POLICY_FORM_DESCRIPTION_CONFIG),new fesm2020_core.z4z(RESOURCE_POLICY_FORM_POLICY_TYPE_CONFIG),new fesm2020_core.z4z(RESOURCE_POLICY_FORM_ACTION_TYPE_CONFIG));const startDateModel=new fesm2020_core.dku(RESOURCE_POLICY_FORM_START_DATE_CONFIG,RESOURCE_POLICY_FORM_START_DATE_LAYOUT),endDateModel=new fesm2020_core.dku(RESOURCE_POLICY_FORM_END_DATE_CONFIG,RESOURCE_POLICY_FORM_END_DATE_LAYOUT),dateGroupConfig=Object.assign({},RESOURCE_POLICY_FORM_DATE_GROUP_CONFIG,{group:[]});return dateGroupConfig.group.push(startDateModel,endDateModel),formModel.push(new fesm2020_core.iO5(dateGroupConfig,RESOURCE_POLICY_FORM_DATE_GROUP_LAYOUT)),this.initModelsValue(formModel),formModel}initModelsValue(formModel){return this.resourcePolicy&&formModel.forEach(model=>{"date"===model.id?((0,empty_util.a4)(this.resourcePolicy.startDate)&&(model.get(0).value=(0,date_util.PR)(this.resourcePolicy.startDate)),(0,empty_util.a4)(this.resourcePolicy.endDate)&&(model.get(1).value=(0,date_util.PR)(this.resourcePolicy.endDate))):this.resourcePolicy.hasOwnProperty(model.id)&&this.resourcePolicy[model.id]&&(model.value=this.resourcePolicy[model.id])}),formModel}isBeingEdited(){return!(0,empty_util.Im)(this.resourcePolicy)}getResourcePolicyTargetName(){return(0,empty_util.hj)(this.resourcePolicyGrant)?this.dsoNameService.getName(this.resourcePolicyGrant):""}updateObjectSelected(object,isEPerson){this.resourcePolicyTargetUpdated=!0,this.resourcePolicyGrant=object,this.resourcePolicyGrantType=isEPerson?"eperson":"group",this.resourcePolicyTargetName$.next(this.getResourcePolicyTargetName())}onReset(){this.reset.emit()}onSubmit(){this.formService.getFormData(this.formId).pipe((0,operators.s)(1)).subscribe(data=>{const eventPayload=Object.create({});eventPayload.object=this.createResourcePolicyByFormData(data),eventPayload.target={type:this.resourcePolicyGrantType,uuid:this.resourcePolicyGrant.id},eventPayload.updateTarget=this.resourcePolicyTargetUpdated,this.submit.emit(eventPayload)})}createResourcePolicyByFormData(data){const resourcePolicy=new resource_policy_model.h;return resourcePolicy.name=data.name?data.name[0].value:null,resourcePolicy.description=data.description?data.description[0].value:null,resourcePolicy.policyType=data.policyType?data.policyType[0].value:null,resourcePolicy.action=data.action?data.action[0].value:null,resourcePolicy.startDate=data.date&&data.date.start?(0,date_util.Sd)(data.date.start[0].value):null,resourcePolicy.endDate=data.date&&data.date.end?(0,date_util.Sd)(data.date.end[0].value):null,resourcePolicy.type=resource_policy_resource_type.O,resourcePolicy}ngOnDestroy(){this.isActive=!1,this.formModel=null,this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}onNavChange(changeEvent){this.isBeingEdited()&&(changeEvent.preventDefault(),this.modalService.open(this.content))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ResourcePolicyFormComponent2)(core.rXU(dso_name_service.f),core.rXU(eperson_data_service.EPersonDataService),core.rXU(form_service.u),core.rXU(group_data_service.GroupDataService),core.rXU(request_service.B),core.rXU(ng_bootstrap.Bq))}}static{this.\u0275cmp=core.VBU({type:ResourcePolicyFormComponent2,selectors:[["ds-resource-policy-form"]],viewQuery:function(rf,ctx){if(1&rf&&core.GBs(_c0,5),2&rf){let _t;core.mGM(_t=core.lsd())&&(ctx.content=_t.first)}},inputs:{resourcePolicy:"resourcePolicy",isProcessing:"isProcessing"},outputs:{reset:"reset",submit:"submit"},standalone:!0,features:[core.aNF],decls:38,vars:34,consts:[["nav","ngbNav"],["content",""],["formRef","formComponent"],[3,"formId","formModel","displaySubmit","displayCancel"],[1,"container-fluid"],["for","ResourcePolicyObject"],["id","ResourcePolicyObject","type","text",1,"form-control","mb-3",3,"value"],["ngbNav","",1,"nav-pills",3,"activeIdChange","navChange","activeId"],["role","presentation",3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],[1,"mb-3","row"],[1,"col","text-end"],["type","reset",1,"btn","btn-default",3,"click","dsBtnDisabled"],["type","button",1,"btn","btn-primary",3,"click","dsBtnDisabled"],[3,"select"],[3,"select","isListOfEPerson"],[1,"fas","fa-circle-notch","fa-spin"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"d-flex","flex-row"],[1,"me-3"],[1,"fas","fa-info-circle","fa-2x","text-info"],[1,"fw-bold",3,"innerHTML"],[3,"innerHTML"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"div"),core.DNE(1,ResourcePolicyFormComponent_Conditional_1_Template,2,4,"ds-form",3),core.j41(2,"div",4)(3,"label",5),core.EFF(4),core.nI1(5,"translate"),core.k0s(),core.nrm(6,"input",6),core.nI1(7,"async"),core.j41(8,"ul",7,0),core.mxI("activeIdChange",function($event){return core.eBV(_r1),core.DH7(ctx.navActiveId,$event)||(ctx.navActiveId=$event),core.Njj($event)}),core.bIt("navChange",function($event){return core.eBV(_r1),core.Njj(ctx.onNavChange($event))}),core.j41(10,"li",8)(11,"a",9),core.EFF(12),core.nI1(13,"translate"),core.k0s(),core.DNE(14,ResourcePolicyFormComponent_ng_template_14_Template,1,0,"ng-template",10),core.k0s(),core.j41(15,"li",8)(16,"a",9),core.EFF(17),core.nI1(18,"translate"),core.k0s(),core.DNE(19,ResourcePolicyFormComponent_ng_template_19_Template,1,1,"ng-template",10),core.k0s()(),core.nrm(20,"div",11),core.j41(21,"div"),core.nrm(22,"hr"),core.j41(23,"div",12)(24,"div",13)(25,"button",14),core.nI1(26,"async"),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.onReset())}),core.EFF(27),core.nI1(28,"translate"),core.k0s(),core.j41(29,"button",15),core.nI1(30,"async"),core.nI1(31,"async"),core.bIt("click",function(){return core.eBV(_r1),core.Njj(ctx.onSubmit())}),core.DNE(32,ResourcePolicyFormComponent_Conditional_32_Template,4,3,"span"),core.nI1(33,"async"),core.DNE(34,ResourcePolicyFormComponent_Conditional_34_Template,3,3,"span"),core.nI1(35,"async"),core.k0s()()()()()(),core.DNE(36,ResourcePolicyFormComponent_ng_template_36_Template,18,12,"ng-template",null,1,core.C5r)}if(2&rf){const nav_r7=core.sdS(9);core.R7$(),core.vxM(ctx.formModel?1:-1),core.R7$(3),core.JRh(core.bMT(5,14,"resource-policies.form.eperson-group-list.label")),core.R7$(2),core.Y8G("value",core.bMT(7,16,ctx.resourcePolicyTargetName$)),core.R7$(2),core.R50("activeId",ctx.navActiveId),core.R7$(2),core.Y8G("ngbNavItem","eperson"),core.R7$(2),core.JRh(core.bMT(13,18,"resource-policies.form.eperson-group-list.tab.eperson")),core.R7$(3),core.Y8G("ngbNavItem","group"),core.R7$(2),core.JRh(core.bMT(18,20,"resource-policies.form.eperson-group-list.tab.group")),core.R7$(3),core.Y8G("ngbNavOutlet",nav_r7),core.R7$(5),core.Y8G("dsBtnDisabled",core.bMT(26,22,ctx.isProcessing)),core.R7$(2),core.JRh(core.bMT(28,24,"form.cancel")),core.R7$(2),core.Y8G("dsBtnDisabled",!0!==core.bMT(30,26,ctx.isFormValid())||core.bMT(31,28,ctx.isProcessing)),core.R7$(3),core.vxM(core.bMT(33,30,ctx.isProcessing)?32:-1),core.R7$(2),core.vxM(!0!==core.bMT(35,32,ctx.isProcessing)?34:-1)}},dependencies:[common.Jj,btn_disabled_directive.A,eperson_group_list_component.T,form_component.s,ng_bootstrap.Pv,ng_bootstrap.Um,ng_bootstrap.X9,ng_bootstrap.sy,ng_bootstrap.Ri,ng_bootstrap.m_,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return ResourcePolicyFormComponent2})()},23250:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>resourcePolicyTargetResolver});var _angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25376),_angular_router__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(18134),rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(60444),_config_app_config_interface__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3339),_core_lazy_data_service__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(78658),_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39022),_core_shared_resource_type__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(87456),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2794);const resourcePolicyTargetResolver=(route,state,dataServiceMap=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_config_app_config_interface__WEBPACK_IMPORTED_MODULE_0__.l9),parentInjector=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_2__.zZn),router=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_router__WEBPACK_IMPORTED_MODULE_3__.Ix))=>{const targetType=route.queryParamMap.get("targetType"),policyTargetId=route.queryParamMap.get("policyTargetId");((0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.Im)(targetType)||(0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.Im)(policyTargetId))&&router.navigateByUrl("/404",{skipLocationChange:!0});const resourceType=new _core_shared_resource_type__WEBPACK_IMPORTED_MODULE_5__.v(targetType);return(0,_core_lazy_data_service__WEBPACK_IMPORTED_MODULE_6__.M)(dataServiceMap,resourceType.value,parentInjector).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_7__.nx)(dataService=>dataService.findById(policyTargetId)),(0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)())}},59278:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>resourcePolicyResolver});var _angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25376),_angular_router__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(18134),_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23390),_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39022),_empty_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2794),_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(76715);const resourcePolicyResolver=(route,state,router=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_angular_router__WEBPACK_IMPORTED_MODULE_3__.Ix),resourcePolicyService=(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WQX)(_core_resource_policy_resource_policy_data_service__WEBPACK_IMPORTED_MODULE_0__.ResourcePolicyDataService))=>{const policyId=route.queryParamMap.get("policyId");return(0,_empty_util__WEBPACK_IMPORTED_MODULE_4__.Im)(policyId)&&router.navigateByUrl("/404",{skipLocationChange:!0}),resourcePolicyService.findById(policyId,!0,!1,(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_5__.s)("eperson"),(0,_utils_follow_link_config_model__WEBPACK_IMPORTED_MODULE_5__.s)("group")).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)())}},61249:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{e:()=>ResourcePoliciesComponent});var common=__webpack_require__(87514),ngx_translate_core=__webpack_require__(2385),cjs=__webpack_require__(9238),operators=__webpack_require__(60444),dso_name_service=__webpack_require__(11481),request_service=__webpack_require__(64806),eperson_data_service=__webpack_require__(15318),group_data_service=__webpack_require__(14557),resource_policy_data_service=__webpack_require__(23390),shared_operators=__webpack_require__(39022),btn_disabled_directive=__webpack_require__(69919),empty_util=__webpack_require__(2794),notifications_service=__webpack_require__(76623),follow_link_config_model=__webpack_require__(76715),core=__webpack_require__(25376),fesm2022_forms=__webpack_require__(13054),access_control_routing_paths=__webpack_require__(55990),date_util=__webpack_require__(13651),has_value_pipe=__webpack_require__(11431),router=__webpack_require__(18134);const _c0=["ds-resource-policy-entry",""];function ResourcePolicyEntryComponent_Conditional_30_Template(rf,ctx){if(1&rf){const _r1=core.RV6();core.j41(0,"button",6),core.nI1(1,"translate"),core.bIt("click",function(){core.eBV(_r1);const ctx_r1=core.XpG();return core.Njj(ctx_r1.redirectToGroupEditPage())}),core.nrm(2,"i",9),core.k0s()}2&rf&&core.Y8G("title",core.bMT(1,1,"resource-policies.table.headers.edit.group"))}let ResourcePolicyEntryComponent=(()=>{class ResourcePolicyEntryComponent2{constructor(dsoNameService,groupService,route,router2){this.dsoNameService=dsoNameService,this.groupService=groupService,this.route=route,this.router=router2,this.toggleCheckbox=new core.bkB}ngOnInit(){this.epersonName$=this.getName$(this.entry.policy.eperson),this.groupName$=this.getName$(this.entry.policy.group)}getName$(dso$){return dso$.pipe((0,shared_operators.v7)(),(0,operators.Tj)(rd=>{if((0,empty_util.a4)(rd?.payload))return this.dsoNameService.getName(rd.payload)}))}formatDate(date){return(0,empty_util.hj)(date)?(0,date_util.$T)((0,date_util.PR)(date)):""}redirectToResourcePolicyEditPage(){this.router.navigate(["./edit"],{relativeTo:this.route,queryParams:{policyId:this.entry.policy.id}})}redirectToGroupEditPage(){this.groupService.findByHref(this.entry.policy._links.group.href,!1).pipe((0,shared_operators.ak)(),(0,operators.Tj)(group=>group.id)).subscribe(groupUUID=>{this.router.navigate([(0,access_control_routing_paths.xl)(groupUUID)])})}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ResourcePolicyEntryComponent2)(core.rXU(dso_name_service.f),core.rXU(group_data_service.GroupDataService),core.rXU(router.nX),core.rXU(router.Ix))}}static{this.\u0275cmp=core.VBU({type:ResourcePolicyEntryComponent2,selectors:[["tr","ds-resource-policy-entry",""]],inputs:{entry:"entry"},outputs:{toggleCheckbox:"toggleCheckbox"},standalone:!0,features:[core.aNF],attrs:_c0,decls:33,vars:26,consts:[[1,"text-center"],["type","checkbox",1,"form-check-input",3,"ngModelChange","id","ngModel"],[1,"form-check-label",3,"for"],[1,"sr-only"],["scope","row"],[1,"btn-group","edit-field"],[1,"btn","btn-outline-primary","btn-sm",3,"click","title"],["aria-hidden","true",1,"fas","fa-edit","fa-fw"],[1,"btn","btn-outline-primary","btn-sm",3,"title"],["aria-hidden","true",1,"fas","fa-users","fa-fw"]],template:function(rf,ctx){1&rf&&(core.j41(0,"td",0)(1,"div")(2,"input",1),core.bIt("ngModelChange",function($event){return ctx.toggleCheckbox.emit($event)}),core.k0s(),core.j41(3,"label",2)(4,"span",3),core.EFF(5),core.nI1(6,"translate"),core.k0s()()()(),core.j41(7,"th",4),core.EFF(8),core.k0s(),core.j41(9,"td"),core.EFF(10),core.k0s(),core.j41(11,"td"),core.EFF(12),core.k0s(),core.j41(13,"td"),core.EFF(14),core.k0s(),core.j41(15,"td"),core.EFF(16),core.nI1(17,"async"),core.k0s(),core.j41(18,"td"),core.EFF(19),core.nI1(20,"async"),core.k0s(),core.j41(21,"td"),core.EFF(22),core.k0s(),core.j41(23,"td"),core.EFF(24),core.k0s(),core.j41(25,"td",0)(26,"div",5)(27,"button",6),core.nI1(28,"translate"),core.bIt("click",function(){return ctx.redirectToResourcePolicyEditPage()}),core.nrm(29,"i",7),core.k0s(),core.DNE(30,ResourcePolicyEntryComponent_Conditional_30_Template,3,3,"button",8),core.nI1(31,"async"),core.nI1(32,"dsHasValue"),core.k0s()()),2&rf&&(core.R7$(2),core.Y8G("id",ctx.entry.id)("ngModel",ctx.entry.checked),core.R7$(),core.Y8G("for",ctx.entry.id),core.R7$(2),core.JRh(core.bMT(6,14,ctx.entry.checked?"resource-policies.table.headers.deselect":"resource-policies.table.headers.select")),core.R7$(3),core.SpI(" ",ctx.entry.id,"\n"),core.R7$(2),core.JRh(ctx.entry.policy.name),core.R7$(2),core.JRh(ctx.entry.policy.policyType),core.R7$(2),core.JRh(ctx.entry.policy.action),core.R7$(2),core.SpI(" ",core.bMT(17,16,ctx.epersonName$),"\n"),core.R7$(3),core.SpI(" ",core.bMT(20,18,ctx.groupName$),"\n"),core.R7$(3),core.JRh(ctx.formatDate(ctx.entry.policy.startDate)),core.R7$(2),core.JRh(ctx.formatDate(ctx.entry.policy.endDate)),core.R7$(3),core.Y8G("title",core.bMT(28,20,"resource-policies.table.headers.edit.policy")),core.R7$(3),core.vxM(core.bMT(32,24,core.bMT(31,22,ctx.groupName$))?30:-1))},dependencies:[common.Jj,fesm2022_forms.YN,fesm2022_forms.Zm,fesm2022_forms.BC,fesm2022_forms.vS,has_value_pipe.a,ngx_translate_core.h,ngx_translate_core.D9],encapsulation:2})}}return ResourcePolicyEntryComponent2})();function ResourcePoliciesComponent_Conditional_11_Template(rf,ctx){if(1&rf&&core.EFF(0),2&rf){const ctx_r0=core.XpG();core.SpI(" (",ctx_r0.resourceUUID,") ")}}function ResourcePoliciesComponent_Conditional_17_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",11),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"submission.workflow.tasks.generic.processing")," "))}function ResourcePoliciesComponent_Conditional_19_Template(rf,ctx){1&rf&&(core.j41(0,"span"),core.nrm(1,"i",12),core.EFF(2),core.nI1(3,"translate"),core.k0s()),2&rf&&(core.R7$(2),core.SpI(" ",core.bMT(3,1,"resource-policies.delete.btn")," "))}function ResourcePoliciesComponent_Conditional_27_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"tr",10)(1,"th")(2,"div")(3,"input",13,0),core.bIt("change",function($event){core.eBV(_r2);const ctx_r0=core.XpG();return core.Njj(ctx_r0.selectAllCheckbox($event))}),core.k0s(),core.j41(5,"label",14)(6,"span",15),core.EFF(7),core.nI1(8,"translate"),core.k0s()()()(),core.j41(9,"th"),core.EFF(10),core.nI1(11,"translate"),core.k0s(),core.j41(12,"th"),core.EFF(13),core.nI1(14,"translate"),core.k0s(),core.j41(15,"th"),core.EFF(16),core.nI1(17,"translate"),core.k0s(),core.j41(18,"th"),core.EFF(19),core.nI1(20,"translate"),core.k0s(),core.j41(21,"th"),core.EFF(22),core.nI1(23,"translate"),core.k0s(),core.j41(24,"th"),core.EFF(25),core.nI1(26,"translate"),core.k0s(),core.j41(27,"th"),core.EFF(28),core.nI1(29,"translate"),core.k0s(),core.j41(30,"th"),core.EFF(31),core.nI1(32,"translate"),core.k0s(),core.j41(33,"th"),core.EFF(34),core.nI1(35,"translate"),core.k0s()()}if(2&rf){const selectAllBtn_r3=core.sdS(4),ctx_r0=core.XpG();core.R7$(3),core.Y8G("id","selectAll_"+ctx_r0.resourceUUID),core.R7$(2),core.Y8G("for","selectAll_"+ctx_r0.resourceUUID),core.R7$(2),core.JRh(core.bMT(8,12,selectAllBtn_r3.checked?"resource-policies.table.headers.deselect-all":"resource-policies.table.headers.select-all")),core.R7$(3),core.JRh(core.bMT(11,14,"resource-policies.table.headers.id")),core.R7$(3),core.JRh(core.bMT(14,16,"resource-policies.table.headers.name")),core.R7$(3),core.JRh(core.bMT(17,18,"resource-policies.table.headers.policyType")),core.R7$(3),core.JRh(core.bMT(20,20,"resource-policies.table.headers.action")),core.R7$(3),core.JRh(core.bMT(23,22,"resource-policies.table.headers.eperson")),core.R7$(3),core.JRh(core.bMT(26,24,"resource-policies.table.headers.group")),core.R7$(3),core.JRh(core.bMT(29,26,"resource-policies.table.headers.date.start")),core.R7$(3),core.JRh(core.bMT(32,28,"resource-policies.table.headers.date.end")),core.R7$(3),core.JRh(core.bMT(35,30,"resource-policies.table.headers.edit"))}}function ResourcePoliciesComponent_Conditional_29_For_2_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"tr",17),core.bIt("toggleCheckbox",function($event){const entry_r5=core.eBV(_r4).$implicit,ctx_r0=core.XpG(2);return core.Njj(ctx_r0.selectCheckbox(entry_r5,$event))}),core.k0s()}2&rf&&core.Y8G("entry",ctx.$implicit)}function ResourcePoliciesComponent_Conditional_29_Template(rf,ctx){if(1&rf&&(core.j41(0,"tbody"),core.Z7z(1,ResourcePoliciesComponent_Conditional_29_For_2_Template,1,1,"tr",16,core.fX1),core.nI1(3,"async"),core.k0s()),2&rf){const ctx_r0=core.XpG();core.R7$(),core.Dyx(core.bMT(3,0,ctx_r0.getResourcePolicies()))}}let ResourcePoliciesComponent=(()=>{class ResourcePoliciesComponent2{constructor(cdr,dsoNameService,ePersonService,groupService,notificationsService,requestService,resourcePolicyService,route,router2,translate){this.cdr=cdr,this.dsoNameService=dsoNameService,this.ePersonService=ePersonService,this.groupService=groupService,this.notificationsService=notificationsService,this.requestService=requestService,this.resourcePolicyService=resourcePolicyService,this.route=route,this.router=router2,this.translate=translate,this.processingDelete$=new cjs.BehaviorSubject(!1),this.resourcePoliciesEntries$=new cjs.BehaviorSubject([]),this.subs=[]}ngOnInit(){this.isActive=!0,this.initResourcePolicyList()}canDelete(){return(0,cjs.from)(this.resourcePoliciesEntries$.value).pipe((0,operators.pb)(entry=>entry.checked),(0,operators.TS)((acc,value)=>[...acc,value],[]),(0,operators.Tj)(entries=>(0,empty_util.hj)(entries)),(0,operators.F)())}deleteSelectedResourcePolicies(){this.processingDelete$.next(!0);const policiesToDelete=this.resourcePoliciesEntries$.value.filter(entry=>entry.checked);this.subs.push((0,cjs.from)(policiesToDelete).pipe((0,operators.Hh)(entry=>this.resourcePolicyService.delete(entry.policy.id)),(0,operators.SQ)((acc,value)=>[...acc,value],[]),(0,operators.pb)(results=>results.length===policiesToDelete.length),(0,operators.s)(1)).subscribe(results=>{const failureResults=results.filter(result=>!result);(0,empty_util.Im)(failureResults)?this.notificationsService.success(null,this.translate.get("resource-policies.delete.success.content")):this.notificationsService.error(null,this.translate.get("resource-policies.delete.failure.content")),this.processingDelete$.next(!1)}))}getResourcePolicies(){return this.resourcePoliciesEntries$.asObservable()}initResourcePolicyList(){this.subs.push(this.resourcePolicyService.searchByResource(this.resourceUUID,null,!1,!0,(0,follow_link_config_model.s)("eperson"),(0,follow_link_config_model.s)("group")).pipe((0,operators.pb)(()=>this.isActive),(0,shared_operators.v7)()).subscribe(result=>{const entries=result.payload.page.map(policy=>({id:policy.id,policy,checked:!1}));this.resourcePoliciesEntries$.next(entries),this.cdr.detectChanges()}))}isProcessingDelete(){return this.processingDelete$.asObservable()}redirectToResourcePolicyCreatePage(){this.router.navigate(["./create"],{relativeTo:this.route,queryParams:{policyTargetId:this.resourceUUID,targetType:this.resourceType}})}selectAllCheckbox(event){const checked=event.target.checked;this.resourcePoliciesEntries$.value.forEach(entry=>entry.checked=checked)}selectCheckbox(policyEntry,checked){policyEntry.checked=checked}ngOnDestroy(){this.isActive=!1,this.resourcePoliciesEntries$=null,this.subs.filter(subscription=>(0,empty_util.a4)(subscription)).forEach(subscription=>subscription.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ResourcePoliciesComponent2)(core.rXU(core.gRc),core.rXU(dso_name_service.f),core.rXU(eperson_data_service.EPersonDataService),core.rXU(group_data_service.GroupDataService),core.rXU(notifications_service.I),core.rXU(request_service.B),core.rXU(resource_policy_data_service.ResourcePolicyDataService),core.rXU(router.nX),core.rXU(router.Ix),core.rXU(ngx_translate_core.c$))}}static{this.\u0275cmp=core.VBU({type:ResourcePoliciesComponent2,selectors:[["ds-resource-policies"]],inputs:{resourceUUID:"resourceUUID",resourceType:"resourceType",resourceName:"resourceName"},standalone:!0,features:[core.aNF],decls:31,vars:34,consts:[["selectAllBtn",""],[1,"table-responsive"],[1,"table","table-striped","table-bordered","table-hover"],["colspan","10"],[1,"d-flex","justify-content-between","align-items-center","m-0"],[1,"text-info"],[1,"space-children-mr","flex-shrink-0"],[1,"btn","btn-danger","p-1",3,"click","dsBtnDisabled","title"],[1,"btn","btn-success","p-1",3,"click","dsBtnDisabled","title"],["aria-hidden","true",1,"fas","fa-plus"],[1,"text-center"],["aria-hidden","true",1,"fas","fa-circle-notch","fa-spin"],["aria-hidden","true",1,"fas","fa-trash-alt","fa-fw"],["type","checkbox",1,"form-check-input",3,"change","id"],[1,"form-check-label",3,"for"],[1,"sr-only"],["ds-resource-policy-entry","",3,"entry"],["ds-resource-policy-entry","",3,"toggleCheckbox","entry"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",1)(1,"table",2)(2,"thead")(3,"tr")(4,"th",3)(5,"div",4)(6,"span"),core.EFF(7),core.nI1(8,"translate"),core.j41(9,"span",5),core.EFF(10),core.k0s(),core.DNE(11,ResourcePoliciesComponent_Conditional_11_Template,1,1),core.k0s(),core.j41(12,"div",6)(13,"button",7),core.nI1(14,"async"),core.nI1(15,"async"),core.nI1(16,"translate"),core.bIt("click",function(){return ctx.deleteSelectedResourcePolicies()}),core.DNE(17,ResourcePoliciesComponent_Conditional_17_Template,4,3,"span"),core.nI1(18,"async"),core.DNE(19,ResourcePoliciesComponent_Conditional_19_Template,4,3,"span"),core.nI1(20,"async"),core.k0s(),core.j41(21,"button",8),core.nI1(22,"async"),core.nI1(23,"translate"),core.bIt("click",function(){return ctx.redirectToResourcePolicyCreatePage()}),core.nrm(24,"i",9),core.EFF(25),core.nI1(26,"translate"),core.k0s()()()()(),core.DNE(27,ResourcePoliciesComponent_Conditional_27_Template,36,32,"tr",10),core.nI1(28,"async"),core.k0s(),core.DNE(29,ResourcePoliciesComponent_Conditional_29_Template,4,2,"tbody"),core.nI1(30,"async"),core.k0s()()),2&rf){let tmp_10_0,tmp_11_0;core.R7$(7),core.SpI(" ",core.bMT(8,12,"resource-policies.table.headers.title.for."+ctx.resourceType)," "),core.R7$(3),core.SpI(" ",ctx.resourceName," "),core.R7$(),core.vxM("item"!==ctx.resourceType?11:-1),core.R7$(2),core.Y8G("dsBtnDisabled",!0!==core.bMT(14,14,ctx.canDelete())||core.bMT(15,16,ctx.isProcessingDelete()))("title",core.bMT(16,18,"resource-policies.delete.btn.title")),core.R7$(4),core.vxM(core.bMT(18,20,ctx.isProcessingDelete())?17:-1),core.R7$(2),core.vxM(!0!==core.bMT(20,22,ctx.isProcessingDelete())?19:-1),core.R7$(2),core.Y8G("dsBtnDisabled",core.bMT(22,24,ctx.isProcessingDelete()))("title",core.bMT(23,26,"resource-policies.add.for."+ctx.resourceType)),core.R7$(4),core.SpI(" ",core.bMT(26,28,"resource-policies.add.button")," "),core.R7$(2),core.vxM((null==(tmp_10_0=core.bMT(28,30,ctx.getResourcePolicies()))?null:tmp_10_0.length)>0?27:-1),core.R7$(2),core.vxM((null==(tmp_11_0=core.bMT(30,32,ctx.getResourcePolicies()))?null:tmp_11_0.length)>0?29:-1)}},dependencies:[common.Jj,btn_disabled_directive.A,ResourcePolicyEntryComponent,ngx_translate_core.h,ngx_translate_core.D9],styles:["td[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]:focus{box-shadow:none!important}"]})}}return ResourcePoliciesComponent2})()},77998:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{F:()=>AbstractTrackableComponent});var _core_data_object_updates_object_updates_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(55434),_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(76623),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(25376),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2385),_angular_router__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(18134);let AbstractTrackableComponent=(()=>{class AbstractTrackableComponent2{constructor(objectUpdatesService,notificationsService,translateService,router){this.objectUpdatesService=objectUpdatesService,this.notificationsService=notificationsService,this.translateService=translateService,this.router=router,this.notificationsPrefix="static-pages.form.notification"}ngOnInit(){this.url=this.router.url.split("?")[0],this.hasChanges$=this.hasChanges(),this.isReinstatable$=this.isReinstatable()}discard(){const undoNotification=this.notificationsService.info(this.getNotificationTitle("discarded"),this.getNotificationContent("discarded"),{timeOut:this.discardTimeOut});this.objectUpdatesService.discardFieldUpdates(this.url,undoNotification)}reinstate(){this.objectUpdatesService.reinstateFieldUpdates(this.url)}isReinstatable(){return this.objectUpdatesService.isReinstatable(this.url)}hasChanges(){return this.objectUpdatesService.hasUpdates(this.url)}getNotificationTitle(key){return this.translateService.instant(this.notificationsPrefix+key+".title")}getNotificationContent(key){return this.translateService.instant(this.notificationsPrefix+key+".content")}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||AbstractTrackableComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_2__.rXU(_core_data_object_updates_object_updates_service__WEBPACK_IMPORTED_MODULE_0__.F),_angular_core__WEBPACK_IMPORTED_MODULE_2__.rXU(_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_1__.I),_angular_core__WEBPACK_IMPORTED_MODULE_2__.rXU(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_2__.rXU(_angular_router__WEBPACK_IMPORTED_MODULE_4__.Ix))}}static{this.\u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_2__.VBU({type:AbstractTrackableComponent2,selectors:[["ds-abstract-trackable"]],standalone:!0,features:[_angular_core__WEBPACK_IMPORTED_MODULE_2__.aNF],decls:0,vars:0,template:function(rf,ctx){},encapsulation:2})}}return AbstractTrackableComponent2})()},11431:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>HasValuePipe});var _empty_util__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2794),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25376);let HasValuePipe=(()=>{class HasValuePipe2{transform(value){return(0,_empty_util__WEBPACK_IMPORTED_MODULE_0__.a4)(value)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||HasValuePipe2)}}static{this.\u0275pipe=_angular_core__WEBPACK_IMPORTED_MODULE_1__.EJ8({name:"dsHasValue",type:HasValuePipe2,pure:!0,standalone:!0})}}return HasValuePipe2})()},30207:(module,__unused_webpack_exports,__webpack_require__)=>{var map={"./custom/app/dso-shared/dso-edit-metadata/dso-edit-metadata.component":[16889,6889]};function webpackAsyncContext(req){if(!__webpack_require__.o(map,req))return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e});var ids=map[req],id=ids[0];return __webpack_require__.e(ids[1]).then(()=>__webpack_require__(id))}webpackAsyncContext.keys=()=>Object.keys(map),webpackAsyncContext.id=30207,module.exports=webpackAsyncContext},52529:(module,__unused_webpack_exports,__webpack_require__)=>{var map={"./custom/app/item-page/edit-item-page/item-status/item-status.component":[70719,719]};function webpackAsyncContext(req){if(!__webpack_require__.o(map,req))return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e});var ids=map[req],id=ids[0];return __webpack_require__.e(ids[1]).then(()=>__webpack_require__(id))}webpackAsyncContext.keys=()=>Object.keys(map),webpackAsyncContext.id=52529,module.exports=webpackAsyncContext},53359:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{S:()=>UiSwitchComponent,z:()=>UiSwitchModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(25376),_angular_forms__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(13054),_angular_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(87514);const _c0=["*"];function UiSwitchComponent_label_1_Template(rf,ctx){if(1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"label",2)(1,"span",3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(2),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(3,"span",4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.EFF(4),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf){const ctx_r0=_angular_core__WEBPACK_IMPORTED_MODULE_0__.XpG();_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("color",ctx_r0.getColor("checkedTextColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",ctx_r0.checkedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(ctx_r0.checkedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("color",ctx_r0.getColor("uncheckedTextColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-label",ctx_r0.uncheckedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.JRh(ctx_r0.uncheckedLabel)}}const UI_SWITCH_OPTIONS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.nKC("UI_SWITCH_OPTIONS"),UI_SWITCH_CONTROL_VALUE_ACCESSOR={provide:_angular_forms__WEBPACK_IMPORTED_MODULE_1__.kq,useExisting:(0,_angular_core__WEBPACK_IMPORTED_MODULE_0__.Rfq)(()=>UiSwitchComponent),multi:!0};let UiSwitchComponent=(()=>{class UiSwitchComponent2{cdr;_checked;_disabled;_reverse;_loading;_beforeChange;size;color;switchOffColor;switchColor;defaultBgColor;defaultBoColor;checkedLabel;uncheckedLabel;checkedTextColor;uncheckedTextColor;beforeChange;ariaLabel;set checked(v){this._checked=!1!==v}get checked(){return this._checked}set disabled(v){this._disabled=!1!==v}get disabled(){return this._disabled}set reverse(v){this._reverse=!1!==v}get reverse(){return this._reverse}set loading(v){this._loading=!1!==v}get loading(){return this._loading}change=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB;changeEvent=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB;valueChange=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.bkB;constructor(config={},cdr){this.cdr=cdr,this.size=config&&config.size||"medium",this.color=config&&config.color,this.switchOffColor=config&&config.switchOffColor,this.switchColor=config&&config.switchColor,this.defaultBgColor=config&&config.defaultBgColor,this.defaultBoColor=config&&config.defaultBoColor,this.checkedLabel=config&&config.checkedLabel,this.uncheckedLabel=config&&config.uncheckedLabel,this.checkedTextColor=config&&config.checkedTextColor,this.uncheckedTextColor=config&&config.uncheckedTextColor}getColor(flag=""){return"borderColor"===flag?this.defaultBoColor:"switchColor"===flag?this.reverse?this.checked&&this.switchOffColor||this.switchColor:this.checked?this.switchColor:this.switchOffColor||this.switchColor:"checkedTextColor"===flag?this.reverse?this.uncheckedTextColor:this.checkedTextColor:"uncheckedTextColor"===flag?this.reverse?this.checkedTextColor:this.uncheckedTextColor:this.reverse?this.checked?this.defaultBgColor:this.color:this.checked?this.color:this.defaultBgColor}onClick(event){this.disabled||(this.checked=!this.checked,this.change.emit(this.checked),this.valueChange.emit(this.checked),this.changeEvent.emit(event),this.onChangeCallback(this.checked),this.onTouchedCallback(this.checked),this.cdr.markForCheck())}onToggle(event){this.disabled||(this.beforeChange?this._beforeChange=this.beforeChange.subscribe(confirm=>{confirm&&this.onClick(event)}):this.onClick(event))}writeValue(obj){obj!==this.checked&&(this.checked=!!obj),this.onChangeCallback(this.checked),this.cdr&&this.cdr.markForCheck()}registerOnChange(fn){this.onChangeCallback=fn}registerOnTouched(fn){this.onTouchedCallback=fn}setDisabledState(isDisabled){this.disabled=isDisabled}onTouchedCallback=v=>{};onChangeCallback=v=>{};ngOnDestroy(){this._beforeChange&&this._beforeChange.unsubscribe()}static \u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||UiSwitchComponent2)(_angular_core__WEBPACK_IMPORTED_MODULE_0__.rXU(UI_SWITCH_OPTIONS,8),_angular_core__WEBPACK_IMPORTED_MODULE_0__.rXU(_angular_core__WEBPACK_IMPORTED_MODULE_0__.gRc))};static \u0275cmp=_angular_core__WEBPACK_IMPORTED_MODULE_0__.VBU({type:UiSwitchComponent2,selectors:[["ui-switch"]],hostBindings:function(rf,ctx){1&rf&&_angular_core__WEBPACK_IMPORTED_MODULE_0__.bIt("click",function($event){return ctx.onToggle($event)})},inputs:{size:"size",color:"color",switchOffColor:"switchOffColor",switchColor:"switchColor",defaultBgColor:"defaultBgColor",defaultBoColor:"defaultBoColor",checkedLabel:"checkedLabel",uncheckedLabel:"uncheckedLabel",checkedTextColor:"checkedTextColor",uncheckedTextColor:"uncheckedTextColor",beforeChange:"beforeChange",ariaLabel:"ariaLabel",checked:"checked",disabled:"disabled",reverse:"reverse",loading:"loading"},outputs:{change:"change",changeEvent:"changeEvent",valueChange:"valueChange"},features:[_angular_core__WEBPACK_IMPORTED_MODULE_0__.Jv_([UI_SWITCH_CONTROL_VALUE_ACCESSOR])],ngContentSelectors:_c0,decls:4,vars:21,consts:[["type","button","role","switch",1,"switch"],["class","switch-pane",4,"ngIf"],[1,"switch-pane"],[1,"switch-label-checked"],[1,"switch-label-unchecked"]],template:function(rf,ctx){1&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.NAR(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(0,"button",0),_angular_core__WEBPACK_IMPORTED_MODULE_0__.DNE(1,UiSwitchComponent_label_1_Template,5,8,"label",1),_angular_core__WEBPACK_IMPORTED_MODULE_0__.j41(2,"small"),_angular_core__WEBPACK_IMPORTED_MODULE_0__.SdG(3),_angular_core__WEBPACK_IMPORTED_MODULE_0__.k0s()()),2&rf&&(_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("background-color",ctx.getColor())("border-color",ctx.getColor("borderColor")),_angular_core__WEBPACK_IMPORTED_MODULE_0__.AVh("checked",ctx.checked)("disabled",ctx.disabled)("loading",ctx.loading)("switch-large","large"===ctx.size)("switch-medium","medium"===ctx.size)("switch-small","small"===ctx.size),_angular_core__WEBPACK_IMPORTED_MODULE_0__.BMQ("aria-checked",ctx.checked)("aria-label",ctx.ariaLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.Y8G("ngIf",ctx.checkedLabel||ctx.uncheckedLabel),_angular_core__WEBPACK_IMPORTED_MODULE_0__.R7$(),_angular_core__WEBPACK_IMPORTED_MODULE_0__.xc7("background",ctx.getColor("switchColor")))},dependencies:[_angular_common__WEBPACK_IMPORTED_MODULE_2__.bT],encapsulation:2})}return UiSwitchComponent2})(),UiSwitchModule=(()=>{class UiSwitchModule2{static forRoot(config){return{ngModule:UiSwitchModule2,providers:[{provide:UI_SWITCH_OPTIONS,useValue:config||{}}]}}static \u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||UiSwitchModule2)};static \u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_0__.$C({type:UiSwitchModule2});static \u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.G2t({imports:[_angular_common__WEBPACK_IMPORTED_MODULE_2__.MD,_angular_forms__WEBPACK_IMPORTED_MODULE_1__.YN,_angular_forms__WEBPACK_IMPORTED_MODULE_1__.YN]})}return UiSwitchModule2})()}};