exports.id=6188,exports.ids=[6188],exports.modules={54255:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{f:()=>EpersonRegistrationService});var http=__webpack_require__(98465),operators=__webpack_require__(60444),empty_util=__webpack_require__(2794),remote_data_build_service=__webpack_require__(80996),hal_endpoint_service=__webpack_require__(26139),shared_operators=__webpack_require__(39022),registration_model=__webpack_require__(89113),response_models=__webpack_require__(56601),core=__webpack_require__(25376);let RegistrationResponseParsingService=(()=>{class RegistrationResponseParsingService2{parse(request,data){const payload=data.payload,registration=Object.assign(new registration_model.cH,payload);return new response_models.hT(data.statusCode,void 0,registration)}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||RegistrationResponseParsingService2)}}static{this.\u0275prov=core.jDH({token:RegistrationResponseParsingService2,factory:RegistrationResponseParsingService2.\u0275fac,providedIn:"root"})}}return RegistrationResponseParsingService2})();var request_models=__webpack_require__(99381),request_service=__webpack_require__(64806);let EpersonRegistrationService=(()=>{class EpersonRegistrationService2{constructor(requestService,rdbService,halService){this.requestService=requestService,this.rdbService=rdbService,this.halService=halService,this.linkPath="registrations",this.searchByTokenPath="/search/findByToken?token="}getRegistrationEndpoint(){return this.halService.getEndpoint(this.linkPath)}getTokenSearchEndpoint(token){return this.halService.getEndpoint(this.linkPath).pipe((0,operators.pb)(href=>(0,empty_util.hj)(href)),(0,operators.Tj)(href=>`${href}${this.searchByTokenPath}${token}`))}registerEmail(email,captchaToken=null,type){const registration=new registration_model.cH;registration.email=email;const requestId=this.requestService.generateRequestId(),href$=this.getRegistrationEndpoint(),options=Object.create({});let headers=new http.Lr;return captchaToken&&(headers=headers.append("x-captcha-payload",captchaToken)),options.headers=headers,(0,empty_util.a4)(type)&&(options.params=type?new http.Nl({fromString:"accountRequestType="+type}):new http.Nl),href$.pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)),(0,operators.Tj)(href=>{const request=new request_models.Qf(requestId,href,registration,options);this.requestService.send(request)})).subscribe(),this.rdbService.buildFromRequestUUID(requestId).pipe((0,shared_operators.qD)())}searchByTokenAndUpdateData(token){const requestId=this.requestService.generateRequestId(),href$=this.getTokenSearchEndpoint(token).pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)));return href$.subscribe(href=>{const request=new request_models.IP(requestId,href);Object.assign(request,{getResponseParser:()=>RegistrationResponseParsingService}),this.requestService.send(request,!0)}),this.rdbService.buildSingle(href$).pipe((0,operators.Tj)(rd=>rd.hasSucceeded&&(0,empty_util.a4)(rd.payload)?Object.assign(rd,{payload:Object.assign(new registration_model.cH,{email:rd.payload.email,token,user:rd.payload.user})}):rd))}searchByTokenAndHandleError(token){const requestId=this.requestService.generateRequestId(),href$=this.getTokenSearchEndpoint(token).pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)));return href$.subscribe(href=>{const request=new request_models.IP(requestId,href);Object.assign(request,{getResponseParser:()=>RegistrationResponseParsingService}),this.requestService.send(request,!0)}),this.rdbService.buildSingle(href$)}patchUpdateRegistration(values,field,registrationId,token,operator){const requestId=this.requestService.generateRequestId();return this.getRegistrationEndpoint().pipe((0,operators.I6)(href=>(0,empty_util.a4)(href)),(0,operators.Tj)(href=>`${href}/${registrationId}?token=${token}`)).subscribe(href=>{const operations=this.generateOperations(values,field,operator),patchRequest=new request_models.EA(requestId,href,operations);this.requestService.send(patchRequest)}),this.rdbService.buildFromRequestUUID(requestId)}generateOperations(values,field,operator){let operations=[];return values.length>0&&(0,empty_util.a4)(field)&&(operations=[{op:operator,path:`/${field}`,value:values}]),operations}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||EpersonRegistrationService2)(core.KVO(request_service.B),core.KVO(remote_data_build_service.o),core.KVO(hal_endpoint_service.Y))}}static{this.\u0275prov=core.jDH({token:EpersonRegistrationService2,factory:EpersonRegistrationService2.\u0275fac,providedIn:"root"})}}return EpersonRegistrationService2})()},67551:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>RegistrationDataResolver});var _core_data_eperson_registration_service__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(54255),_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39022),_shared_empty_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2794),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(25376);let RegistrationDataResolver=(()=>{class RegistrationDataResolver2{constructor(epersonRegistrationService){this.epersonRegistrationService=epersonRegistrationService}resolve(route,state){const token=route.params.token;if((0,_shared_empty_util__WEBPACK_IMPORTED_MODULE_2__.a4)(token))return this.epersonRegistrationService.searchByTokenAndHandleError(token).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_1__.qD)())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||RegistrationDataResolver2)(_angular_core__WEBPACK_IMPORTED_MODULE_3__.KVO(_core_data_eperson_registration_service__WEBPACK_IMPORTED_MODULE_0__.f))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_3__.jDH({token:RegistrationDataResolver2,factory:RegistrationDataResolver2.\u0275fac,providedIn:"root"})}}return RegistrationDataResolver2})()},77601:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{u:()=>ExternalLoginService});var _ngrx_store__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(22609),rxjs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9238),src_app_core_auth_selectors__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(69570),_core_data_eperson_registration_service__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(54255),_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(39022),_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(76623),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(25376),_angular_router__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(18134),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2385);let ExternalLoginService=(()=>{class ExternalLoginService2{constructor(epersonRegistrationService,router,notificationService,translate,store){this.epersonRegistrationService=epersonRegistrationService,this.router=router,this.notificationService=notificationService,this.translate=translate,this.store=store}patchUpdateRegistration(values,field,registrationId,token,operation){const updatedValues=values.map(value=>value);return this.epersonRegistrationService.patchUpdateRegistration(updatedValues,field,registrationId,token,operation).pipe((0,_core_shared_operators__WEBPACK_IMPORTED_MODULE_2__.qD)(),(0,rxjs__WEBPACK_IMPORTED_MODULE_4__.map)(rd=>(rd.hasSucceeded&&this.router.navigate(["/email-confirmation"]),rd.hasFailed&&this.notificationService.error(this.translate.get("external-login-page.provide-email.notifications.error")),rd)))}getExternalAuthLocation(registrationType){return this.store.pipe((0,_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.Lt)(src_app_core_auth_selectors__WEBPACK_IMPORTED_MODULE_0__.hx),(0,rxjs__WEBPACK_IMPORTED_MODULE_4__.filter)(methods=>methods.length>0),(0,rxjs__WEBPACK_IMPORTED_MODULE_4__.map)(methods=>methods.find(m=>m.authMethodType.toString()===registrationType.toLocaleLowerCase()).location))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ExternalLoginService2)(_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_core_data_eperson_registration_service__WEBPACK_IMPORTED_MODULE_1__.f),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_angular_router__WEBPACK_IMPORTED_MODULE_7__.Ix),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_shared_notifications_notifications_service__WEBPACK_IMPORTED_MODULE_3__.I),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_8__.c$),_angular_core__WEBPACK_IMPORTED_MODULE_6__.KVO(_ngrx_store__WEBPACK_IMPORTED_MODULE_5__.il))}}static{this.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_6__.jDH({token:ExternalLoginService2,factory:ExternalLoginService2.\u0275fac,providedIn:"root"})}}return ExternalLoginService2})()},29687:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ExternalLoginPageComponent:()=>ExternalLoginPageComponent});var common=__webpack_require__(87514),ngx_translate_core=__webpack_require__(2385),cjs=__webpack_require__(9238),core=__webpack_require__(25376),operators=__webpack_require__(60444),auth_service=__webpack_require__(54545),auth_methods_service=__webpack_require__(40458),alert_component=(__webpack_require__(89113),__webpack_require__(6213)),alert_type=__webpack_require__(83113),empty_util=__webpack_require__(2794),themed_log_in_component=__webpack_require__(93611),external_log_in_methods_decorator=__webpack_require__(8504),fesm2022_forms=__webpack_require__(13054),isEqual=__webpack_require__(90326),isEqual_default=__webpack_require__.n(isEqual),eperson_data_service=__webpack_require__(15318),eperson_model=__webpack_require__(65434),window_service=__webpack_require__(97497),shared_operators=__webpack_require__(39022),notifications_service=__webpack_require__(76623),external_login_service=__webpack_require__(77601),hard_redirect_service=__webpack_require__(28403);function ConfirmEmailComponent_Conditional_9_Template(rf,ctx){1&rf&&(core.j41(0,"div",5),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"external-login.confirmation.email-required")," "))}function ConfirmEmailComponent_Conditional_10_Template(rf,ctx){1&rf&&(core.j41(0,"div",5),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"external-login.confirmation.email-invalid")," "))}let ConfirmEmailComponent=(()=>{class ConfirmEmailComponent2{constructor(_window,formBuilder,externalLoginService,epersonDataService,notificationService,translate,authService,hardRedirectService){this._window=_window,this.formBuilder=formBuilder,this.externalLoginService=externalLoginService,this.epersonDataService=epersonDataService,this.notificationService=notificationService,this.translate=translate,this.authService=authService,this.hardRedirectService=hardRedirectService,this.subs=[]}ngOnInit(){this.emailForm=this.formBuilder.group({email:[this.registrationData.email,[fesm2022_forms.k0.required,fesm2022_forms.k0.email]]})}submitForm(){if(this.emailForm.markAllAsTouched(),this.emailForm.valid){const confirmedEmail=this.emailForm.get("email").value;confirmedEmail&&isEqual_default()(this.registrationData.email,confirmedEmail.trim())?this.postCreateAccountFromToken(this.token,this.registrationData):this.patchUpdateRegistration([confirmedEmail])}}patchUpdateRegistration(values){this.subs.push(this.externalLoginService.patchUpdateRegistration(values,"email",this.registrationData.id,this.token,"replace").pipe((0,shared_operators.Bo)()).subscribe())}postCreateAccountFromToken(token,registrationData){if((0,empty_util.Tn)(this.registrationData.netId))return void this.notificationService.error(this.translate.get("external-login-page.confirm-email.create-account.notifications.error.no-netId"));const metadataValues={};for(const[key,value]of Object.entries(registrationData.registrationMetadata))(0,empty_util.a4)(value[0]?.value)&&"email"!==key&&(metadataValues[key]=value);const eperson=new eperson_model.f;eperson.email=registrationData.email,eperson.netid=registrationData.netId,eperson.metadata=metadataValues,eperson.canLogIn=!0,eperson.requireCertificate=!1,eperson.selfRegistered=!0,this.subs.push((0,cjs.combineLatest)([this.epersonDataService.createEPersonForToken(eperson,token).pipe((0,shared_operators.qD)()),this.externalLoginService.getExternalAuthLocation(this.registrationData.registrationType),this.authService.getRedirectUrl().pipe((0,cjs.take)(1))]).subscribe(([rd,location,redirectRoute])=>{if(rd.hasFailed)this.notificationService.error(this.translate.get("external-login-page.provide-email.create-account.notifications.error.header"),this.translate.get("external-login-page.provide-email.create-account.notifications.error.content"));else if(rd.hasSucceeded){this.authService.setRedirectUrl("/profile");const externalServerUrl=this.authService.getExternalServerRedirectUrl(this._window.nativeWindow.origin,redirectRoute,location);this.hardRedirectService.redirect(externalServerUrl)}}))}ngOnDestroy(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ConfirmEmailComponent2)(core.rXU(window_service.lc),core.rXU(fesm2022_forms.ok),core.rXU(external_login_service.u),core.rXU(eperson_data_service.EPersonDataService),core.rXU(notifications_service.I),core.rXU(ngx_translate_core.c$),core.rXU(auth_service.uR),core.rXU(hard_redirect_service.$))}}static{this.\u0275cmp=core.VBU({type:ConfirmEmailComponent2,selectors:[["ds-confirm-email"]],inputs:{registrationData:"registrationData",token:"token"},standalone:!0,features:[core.aNF],decls:16,vars:12,consts:[[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"row"],[1,"col-12","my-2"],["type","email","id","email","formControlName","email","placeholder","profile.email@example.com",1,"form-control","form-control-lg","position-relative"],[1,"text-danger"],[1,"col-12"],["type","submit",1,"btn","btn-lg","btn-primary","w-100"]],template:function(rf,ctx){1&rf&&(core.j41(0,"h4"),core.EFF(1),core.nI1(2,"translate"),core.k0s(),core.j41(3,"form",0),core.bIt("ngSubmit",function(){return ctx.submitForm()}),core.j41(4,"div",1)(5,"div",2)(6,"div",3),core.nrm(7,"input",4),core.nI1(8,"translate"),core.DNE(9,ConfirmEmailComponent_Conditional_9_Template,3,3,"div",5)(10,ConfirmEmailComponent_Conditional_10_Template,3,3,"div",5),core.k0s()(),core.j41(11,"div",2)(12,"div",6)(13,"button",7),core.EFF(14),core.nI1(15,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,6,"external-login.confirm-email.header"),"\n"),core.R7$(2),core.Y8G("formGroup",ctx.emailForm),core.R7$(4),core.BMQ("aria-label",core.bMT(8,8,"external-login.confirmation.email-label")),core.R7$(2),core.vxM(ctx.emailForm.get("email").hasError("required")&&ctx.emailForm.get("email").touched?9:-1),core.R7$(),core.vxM(ctx.emailForm.get("email").hasError("email")&&ctx.emailForm.get("email").touched?10:-1),core.R7$(4),core.SpI(" ",core.bMT(15,10,"external-login.confirm.button.label")," "))},dependencies:[fesm2022_forms.X1,fesm2022_forms.qT,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,ngx_translate_core.h,ngx_translate_core.D9],changeDetection:0})}}return ConfirmEmailComponent2})();function ProvideEmailComponent_Conditional_9_Template(rf,ctx){1&rf&&(core.j41(0,"div",5),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"external-login.confirmation.email-required")," "))}function ProvideEmailComponent_Conditional_10_Template(rf,ctx){1&rf&&(core.j41(0,"div",5),core.EFF(1),core.nI1(2,"translate"),core.k0s()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,1,"external-login.confirmation.email-invalid")," "))}let ProvideEmailComponent=(()=>{class ProvideEmailComponent2{constructor(formBuilder,externalLoginService){this.formBuilder=formBuilder,this.externalLoginService=externalLoginService,this.subs=[],this.emailForm=this.formBuilder.group({email:["",[fesm2022_forms.k0.required,fesm2022_forms.k0.email]]})}submitForm(){if(this.emailForm.markAllAsTouched(),this.emailForm.valid){const email=this.emailForm.get("email").value;this.subs.push(this.externalLoginService.patchUpdateRegistration([email],"email",this.registrationId,this.token,"add").subscribe())}}ngOnDestroy(){this.subs.filter(sub=>(0,empty_util.a4)(sub)).forEach(sub=>sub.unsubscribe())}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ProvideEmailComponent2)(core.rXU(fesm2022_forms.ok),core.rXU(external_login_service.u))}}static{this.\u0275cmp=core.VBU({type:ProvideEmailComponent2,selectors:[["ds-provide-email"]],inputs:{registrationId:"registrationId",token:"token"},standalone:!0,features:[core.aNF],decls:16,vars:12,consts:[[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"row"],[1,"col-12","my-2"],["type","email","id","email","formControlName","email",1,"form-control","form-control-lg","position-relative"],[1,"text-danger"],[1,"col-12"],["type","submit",1,"btn","btn-lg","btn-primary","w-100"]],template:function(rf,ctx){1&rf&&(core.j41(0,"h4"),core.EFF(1),core.nI1(2,"translate"),core.k0s(),core.j41(3,"form",0),core.bIt("ngSubmit",function(){return ctx.submitForm()}),core.j41(4,"div",1)(5,"div",2)(6,"div",3),core.nrm(7,"input",4),core.nI1(8,"translate"),core.DNE(9,ProvideEmailComponent_Conditional_9_Template,3,3,"div",5)(10,ProvideEmailComponent_Conditional_10_Template,3,3,"div",5),core.k0s()(),core.j41(11,"div",2)(12,"div",6)(13,"button",7),core.EFF(14),core.nI1(15,"translate"),core.k0s()()()()()),2&rf&&(core.R7$(),core.SpI(" ",core.bMT(2,6,"external-login.provide-email.header"),"\n"),core.R7$(2),core.Y8G("formGroup",ctx.emailForm),core.R7$(4),core.BMQ("aria-label",core.bMT(8,8,"external-login.confirmation.email")),core.R7$(2),core.vxM(ctx.emailForm.get("email").hasError("required")&&ctx.emailForm.get("email").touched?9:-1),core.R7$(),core.vxM(ctx.emailForm.get("email").hasError("email")&&ctx.emailForm.get("email").touched?10:-1),core.R7$(4),core.SpI(" ",core.bMT(15,10,"external-login.provide-email.button.label")," "))},dependencies:[fesm2022_forms.X1,fesm2022_forms.qT,fesm2022_forms.me,fesm2022_forms.BC,fesm2022_forms.cb,fesm2022_forms.j4,fesm2022_forms.JD,ngx_translate_core.h,ngx_translate_core.D9],changeDetection:0})}}return ProvideEmailComponent2})();var ng_bootstrap=__webpack_require__(87969);function ExternalLogInComponent_ng_container_5_Template(rf,ctx){1&rf&&core.eu8(0)}function ExternalLogInComponent_Conditional_11_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-confirm-email",8),2&rf){const ctx_r0=core.XpG();core.Y8G("registrationData",ctx_r0.registrationData)("token",ctx_r0.token)}}function ExternalLogInComponent_Conditional_12_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-provide-email",9),2&rf){const ctx_r0=core.XpG();core.Y8G("registrationId",ctx_r0.registrationData.id)("token",ctx_r0.token)}}function ExternalLogInComponent_Conditional_13_Template(rf,ctx){if(1&rf){const _r2=core.RV6();core.j41(0,"div",10)(1,"h4",11),core.EFF(2),core.nI1(3,"translate"),core.k0s()(),core.j41(4,"div",7)(5,"button",12),core.bIt("click",function(){core.eBV(_r2);const ctx_r0=core.XpG(),loginModal_r3=core.sdS(16);return core.Njj(ctx_r0.openLoginModal(loginModal_r3))}),core.EFF(6),core.nI1(7,"translate"),core.k0s()()}2&rf&&(core.R7$(2),core.JRh(core.bMT(3,2,"external-login.component.or")),core.R7$(4),core.SpI(" ",core.bMT(7,4,"external-login.connect-to-existing-account.label")," "))}function ExternalLogInComponent_ng_template_15_Template(rf,ctx){if(1&rf){const _r4=core.RV6();core.j41(0,"div",13)(1,"h4",14),core.EFF(2),core.nI1(3,"translate"),core.k0s()(),core.j41(4,"div",15)(5,"div",2),core.nrm(6,"ds-log-in",16),core.k0s()(),core.j41(7,"div",17)(8,"button",18),core.bIt("click",function(){const c_r5=core.eBV(_r4).close,ctx_r0=core.XpG();return c_r5("Close click"),core.Njj(ctx_r0.clearRedirectUrl())}),core.nrm(9,"i",19),core.EFF(10),core.nI1(11,"translate"),core.k0s()()}if(2&rf){const ctx_r0=core.XpG();core.R7$(2),core.SpI(" ",core.bMT(3,5,"external-login.connect-to-existing-account.label"),""),core.R7$(4),core.Y8G("excludedAuthMethod",ctx_r0.relatedAuthMethod)("showRegisterLink",!1)("isStandalonePage",!0),core.R7$(4),core.SpI(" ",core.bMT(11,7,"external-login.modal.label.close")," ")}}let ExternalLogInComponent=(()=>{class ExternalLogInComponent2{constructor(injector,translate,modalService,authService,authMethodsService){this.injector=injector,this.translate=translate,this.modalService=modalService,this.authService=authService,this.authMethodsService=authMethodsService,this.AlertTypeEnum=alert_type.v,this.informationText=""}ngOnInit(){this.objectInjector=core.zZn.create({providers:[{provide:"registrationDataProvider",useFactory:()=>this.registrationData,deps:[]}],parent:this.injector}),this.registrationType=this.registrationData?.registrationType??null,this.relatedAuthMethod=(0,empty_util.Im)(this.registrationType)?null:this.registrationType.replace("VALIDATION_","").toLocaleLowerCase(),this.informationText=(0,empty_util.a4)(this.registrationData?.email)?this.generateInformationTextWhenEmail(this.registrationType):this.generateInformationTextWhenNOEmail(this.registrationType),this.hasAuthMethodTypes=this.authMethodsService.getAuthMethods(this.authMethods,this.relatedAuthMethod).pipe((0,operators.Tj)(methods=>methods.length>0))}getExternalLoginConfirmationType(){return(0,external_log_in_methods_decorator.Mx)(this.registrationType)}openLoginModal(content){this.modalRef=this.modalService.open(content),this.authService.setRedirectUrl(`/review-account/${this.token}`),this.modalRef.dismissed.subscribe(()=>{this.clearRedirectUrl()})}clearRedirectUrl(){this.authService.clearRedirectUrl()}ngOnDestroy(){this.modalRef?.close()}generateInformationTextWhenNOEmail(authMethod){if(authMethod){const authMethodUppercase=authMethod.toUpperCase();return this.translate.instant("external-login.noEmail.informationText",{authMethod:authMethodUppercase})}}generateInformationTextWhenEmail(authMethod){if(authMethod){const authMethodUppercase=authMethod.toUpperCase();return this.translate.instant("external-login.haveEmail.informationText",{authMethod:authMethodUppercase})}}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ExternalLogInComponent2)(core.rXU(core.zZn),core.rXU(ngx_translate_core.c$),core.rXU(ng_bootstrap.Bq),core.rXU(auth_service.uR),core.rXU(auth_methods_service.q))}}static{this.\u0275cmp=core.VBU({type:ExternalLogInComponent2,selectors:[["ds-external-log-in"]],inputs:{registrationData:"registrationData",token:"token",authMethods:"authMethods"},standalone:!0,features:[core.aNF],decls:17,vars:12,consts:[["loginModal",""],[1,"row"],[1,"row","justify-content-center"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[1,"container","mt-2",3,"type"],[1,"row","d-flex","justify-content-center"],[1,"col-6","d-flex"],[1,"col","d-flex","justify-content-center","align-items-center"],[3,"registrationData","token"],[3,"registrationId","token"],[1,"col-1","d-flex","justify-content-center","align-items-center"],[1,"mt-2"],["data-test","open-modal",1,"btn","block","btn-lg","btn-primary",3,"click"],[1,"modal-header"],[1,"modal-title","text-info"],[1,"modal-body"],[3,"excludedAuthMethod","showRegisterLink","isStandalonePage"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-times"]],template:function(rf,ctx){1&rf&&(core.j41(0,"div",1)(1,"h4"),core.EFF(2),core.nI1(3,"translate"),core.k0s()(),core.j41(4,"div",2),core.DNE(5,ExternalLogInComponent_ng_container_5_Template,1,0,"ng-container",3),core.k0s(),core.j41(6,"ds-alert",4),core.EFF(7),core.k0s(),core.j41(8,"div",5)(9,"div",6)(10,"div",7),core.DNE(11,ExternalLogInComponent_Conditional_11_Template,1,2,"ds-confirm-email",8)(12,ExternalLogInComponent_Conditional_12_Template,1,2,"ds-provide-email",9),core.k0s(),core.DNE(13,ExternalLogInComponent_Conditional_13_Template,8,6),core.nI1(14,"async"),core.k0s()(),core.DNE(15,ExternalLogInComponent_ng_template_15_Template,12,9,"ng-template",null,0,core.C5r)),2&rf&&(core.R7$(2),core.JRh(core.bMT(3,8,"external-login.confirmation.header")),core.R7$(3),core.Y8G("ngComponentOutlet",ctx.getExternalLoginConfirmationType())("ngComponentOutletInjector",ctx.objectInjector),core.R7$(),core.Y8G("type",ctx.AlertTypeEnum.Info),core.BMQ("data-test","info-text"),core.R7$(),core.SpI(" ",ctx.informationText,"\n"),core.R7$(4),core.vxM(ctx.registrationData.email?11:12),core.R7$(2),core.vxM(core.bMT(14,10,ctx.hasAuthMethodTypes)?13:-1))},dependencies:[alert_component.C,common.Jj,ConfirmEmailComponent,common.OI,ProvideEmailComponent,themed_log_in_component.W,ngx_translate_core.h,ngx_translate_core.D9],changeDetection:0})}}return ExternalLogInComponent2})();var log_in_methods_decorator=__webpack_require__(67469),router=__webpack_require__(18134);function ExternalLoginPageComponent_Conditional_1_Template(rf,ctx){if(1&rf&&core.nrm(0,"ds-external-log-in",1),2&rf){const ctx_r0=core.XpG();core.Y8G("authMethods",ctx_r0.authMethods)("registrationData",ctx)("token",ctx_r0.token)}}function ExternalLoginPageComponent_Conditional_3_Template(rf,ctx){if(1&rf&&(core.nrm(0,"ds-alert",2),core.nI1(1,"translate")),2&rf){const ctx_r0=core.XpG();core.Y8G("type",ctx_r0.AlertTypeEnum.Error)("content",core.bMT(1,2,"external-login.error.notification"))}}let ExternalLoginPageComponent=(()=>{class ExternalLoginPageComponent2{constructor(arouter){this.arouter=arouter,this.AlertTypeEnum=alert_type.v,this.hasErrors=!1,this.token=this.arouter.snapshot.params.token,this.hasErrors=(0,empty_util.Tn)(this.arouter.snapshot.params.token),this.authMethods=log_in_methods_decorator.y}ngOnInit(){this.registrationData$=this.arouter.data.pipe((0,cjs.first)(),(0,cjs.tap)(data=>this.hasErrors=data.registrationData.hasFailed),(0,cjs.map)(data=>data.registrationData.payload))}static{this.\u0275fac=function(__ngFactoryType__){return new(__ngFactoryType__||ExternalLoginPageComponent2)(core.rXU(router.nX))}}static{this.\u0275cmp=core.VBU({type:ExternalLoginPageComponent2,selectors:[["ng-component"]],standalone:!0,features:[core.aNF],decls:4,vars:4,consts:[[1,"container"],[3,"authMethods","registrationData","token"],[3,"type","content"]],template:function(rf,ctx){if(1&rf&&(core.j41(0,"div",0),core.DNE(1,ExternalLoginPageComponent_Conditional_1_Template,1,3,"ds-external-log-in",1),core.nI1(2,"async"),core.DNE(3,ExternalLoginPageComponent_Conditional_3_Template,2,4,"ds-alert",2),core.k0s()),2&rf){let tmp_0_0;core.R7$(),core.vxM((tmp_0_0=core.bMT(2,2,ctx.registrationData$))?1:-1,tmp_0_0),core.R7$(2),core.vxM(ctx.hasErrors?3:-1)}},dependencies:[alert_component.C,common.Jj,ExternalLogInComponent,ngx_translate_core.h,ngx_translate_core.D9]})}}return ExternalLoginPageComponent2})()},16188:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ROUTES:()=>ROUTES});var core=__webpack_require__(25376),fesm2022_router=__webpack_require__(18134),cjs=__webpack_require__(9238),eperson_registration_service=__webpack_require__(54255),operators=__webpack_require__(39022),empty_util=__webpack_require__(2794),registration_data_resolver=__webpack_require__(67551),themed_component=__webpack_require__(79241);__webpack_require__(29687);const _c0=["*"];function ThemedExternalLoginPageComponent_ng_template_0_Template(rf,ctx){}const ROUTES=[{path:"",pathMatch:"full",component:(()=>{class ThemedExternalLoginPageComponent2 extends themed_component.J{getComponentName(){return"ExternalLoginPageComponent"}importThemedComponent(themeName){return __webpack_require__(41018)(`./${themeName}/app/external-login-page/external-login-page.component`)}importUnthemedComponent(){return Promise.resolve().then(__webpack_require__.bind(__webpack_require__,29687))}static{this.\u0275fac=(()=>{let \u0275ThemedExternalLoginPageComponent_BaseFactory;return function(__ngFactoryType__){return(\u0275ThemedExternalLoginPageComponent_BaseFactory||(\u0275ThemedExternalLoginPageComponent_BaseFactory=core.xGo(ThemedExternalLoginPageComponent2)))(__ngFactoryType__||ThemedExternalLoginPageComponent2)}})()}static{this.\u0275cmp=core.VBU({type:ThemedExternalLoginPageComponent2,selectors:[["ds-external-login-page"]],standalone:!0,features:[core.Vt3,core.aNF],ngContentSelectors:_c0,decls:5,vars:0,consts:[["vcr",""],["content",""]],template:function(rf,ctx){1&rf&&(core.NAR(),core.DNE(0,ThemedExternalLoginPageComponent_ng_template_0_Template,0,0,"ng-template",null,0,core.C5r),core.j41(2,"div",null,1),core.SdG(4),core.k0s())},encapsulation:2})}}return ThemedExternalLoginPageComponent2})(),canActivate:[(route,state)=>{const epersonRegistrationService=(0,core.WQX)(eperson_registration_service.f),router=(0,core.WQX)(fesm2022_router.Ix);return route.params.token?epersonRegistrationService.searchByTokenAndHandleError(route.params.token).pipe((0,operators.qD)(),(0,cjs.map)(data=>{if(data.hasSucceeded&&(0,empty_util.a4)(data))return!0;router.navigate(["/404"])})):(router.navigate(["/404"]),(0,cjs.of)(!1))}],resolve:{registrationData:registration_data_resolver.Q}}]},41018:module=>{function webpackEmptyAsyncContext(req){return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e})}webpackEmptyAsyncContext.keys=()=>[],webpackEmptyAsyncContext.resolve=webpackEmptyAsyncContext,webpackEmptyAsyncContext.id=41018,module.exports=webpackEmptyAsyncContext}};